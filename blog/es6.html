<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <style>


        @import url(//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800);@import url(//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic,900,900italic);html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td {
            margin: 0;
            padding: 0;
            border: 0;
            outline: 0;
            font-weight: inherit;
            font-style: inherit;
            font-size: 100%;
            font-family: inherit;
            vertical-align: baseline
        }

        :focus {
            outline: 0
        }

        body {
            -webkit-backface-visibility: hidden;
            line-height: 1;
            color: black;
            background: white
        }

        ol,ul {
            list-style: none
        }

        table {
            border-collapse: separate;
            border-spacing: 0
        }

        caption,th,td {
            text-align: inherit;
            font-weight: normal
        }

        blockquote:before,blockquote:after,q:before,q:after {
            content: ""
        }

        blockquote,q {
            quotes: "" ""
        }

        button,input[type="submit"],input[type="button"],#mailchimp-subscribe-button,#mailchimp-subscribe-authors-button,#copy-button,#mailchimp-unsubscribe-button,#mailchimp-unsubscribe-authors-button,.pseudo-button {
            -webkit-font-smoothing: antialiased;
            display: inline-block;
            box-sizing: border-box;
            padding: .5em 1.25em;
            border-radius: 4px;
            border: none;
            font-size: 1em;
            line-height: 1;
            text-decoration: none;
            text-align: center;
            color: #fff;
            cursor: pointer;
            vertical-align: middle;
            white-space: nowrap
        }

        button:disabled,input[type="submit"]:disabled,input[type="button"]:disabled,#mailchimp-subscribe-button:disabled,#mailchimp-subscribe-authors-button:disabled,#copy-button:disabled,#mailchimp-unsubscribe-button:disabled,#mailchimp-unsubscribe-authors-button:disabled,.pseudo-button:disabled {
            cursor: not-allowed;
            opacity: 0.5
        }

        .alert:after,.control-group .controls:after,.book-list-wrapper .list-header:after,.bundle-list-wrapper .list-header:after,.book-list:after,.bundle-list:after,.details-list:after,.details-list-stacked:after,#sign-up form:after,#wishlist-container .book:after,.type-system:after,#sign-up:after,#sign-in:after,article:after,#causes:after,.bundle-edit:after,#help article:after,#books-getting-started article:after,.manage-purchased-package:after,.redeem-purchased-package:after,#publisher article:after,#editors-new article:after,.type-system-readable:after,#read-online .read:after,.profile-wrapper:after,.author-profile:after,.contributor-profile:after,.publisher-profile:after,.user-profile:after,.cause-profile:after,.cause-profile .profile-header:after,.book-details-list:after,.vertical-tabs-container:after,#author-hero:after,#try-leanpub .bullet-list:after,#bookstore-navigation .list-header>div:after,.book-grid:after,.cover-image-wrapper:after,.bundle-grid:after,.bullet-list:after,.sliders-wrapper:after,#home-hero .large-container:after,#home-hero #app-container:after,#home-hero #bookstore section:after,#bookstore #home-hero section:after,.button-group:after,#js-view-wrapper:after,#book-list.list-view .book-list-item:after,.inline-book-list-item:after,.package-zip:after {
            content: "";
            display: table;
            clear: both
        }

        .flash-message-container {
            padding: 0 !important;
            width: 100%;
            position: absolute;
            top: 65px;
            text-align: center;
            left: 0;
            right: 0
        }

        .alert.alert-warning,.stealth-mode,.embargo-mode,.not-accepted,.alert.alert-error,.validation_error_box,.alert.alert-info,.alert.alert-success,.alert.alert-generic {
            width: auto;
            position: relative;
            z-index: 10001;
            text-align: center;
            padding: 0.3em 3em 0.3em 2em;
            margin: 0;
            display: inline-block;
            border-radius: 4px
        }

        .alert.alert-warning .flash-message,.stealth-mode .flash-message,.embargo-mode .flash-message,.not-accepted .flash-message,.alert.alert-error .flash-message,.validation_error_box .flash-message,.alert.alert-info .flash-message,.alert.alert-success .flash-message,.alert.alert-generic .flash-message {
            font-weight: 600;
            display: inline-block;
            margin: 0;
            font-size: 0.9em
        }

        .alert.alert-warning .flash-message::before,.stealth-mode .flash-message::before,.embargo-mode .flash-message::before,.not-accepted .flash-message::before,.alert.alert-error .flash-message::before,.validation_error_box .flash-message::before,.alert.alert-info .flash-message::before,.alert.alert-success .flash-message::before,.alert.alert-generic .flash-message::before {
            font-family: FontAwesome;
            margin-right: 0.5em
        }

        .alert.alert-warning,.stealth-mode,.embargo-mode,.not-accepted {
            background: #fff6bf;
            border: 1px solid #ffef8c;
            color: #8c7800
        }

        .alert.alert-warning a,.stealth-mode a,.embargo-mode a,.not-accepted a {
            color: #594c00
        }

        .alert.alert-warning a:active,.stealth-mode a:active,.embargo-mode a:active,.not-accepted a:active,.alert.alert-warning a:visited,.stealth-mode a:visited,.embargo-mode a:visited,.not-accepted a:visited {
            color: #594c00
        }

        .alert.alert-warning a:hover,.stealth-mode a:hover,.embargo-mode a:hover,.not-accepted a:hover {
            color: #000
        }

        .alert.alert-error,.validation_error_box {
            background: #fbe3e4;
            border: 1px solid #f5b6b9;
            color: #96151b
        }

        .alert.alert-error a,.validation_error_box a {
            color: #6a0f13
        }

        .alert.alert-error a:active,.validation_error_box a:active,.alert.alert-error a:visited,.validation_error_box a:visited {
            color: #6a0f13
        }

        .alert.alert-error a:hover,.validation_error_box a:hover {
            color: #110203
        }

        .alert.alert-info {
            background: #f2f9ff;
            border: 1px solid #bfe1ff;
            color: #0067bf
        }

        .alert.alert-info a {
            color: #004b8c
        }

        .alert.alert-info a:active,.alert.alert-info a:visited {
            color: #004b8c
        }

        .alert.alert-info a:hover {
            color: #001426
        }

        .alert.alert-success {
            background: #e6efc2;
            border: 1px solid #d5e49a;
            color: #56651a
        }

        .alert.alert-success a {
            color: #333c10
        }

        .alert.alert-success a:active,.alert.alert-success a:visited {
            color: #333c10
        }

        .alert.alert-success a:hover {
            color: #000
        }

        .alert.alert-generic {
            background: #fbfbfb;
            border: 1px solid #e2e2e2;
            color: #626262
        }

        .alert.alert-generic a {
            color: #484848
        }

        .alert.alert-generic a:active,.alert.alert-generic a:visited {
            color: #484848
        }

        .alert.alert-generic a:hover {
            color: #151515
        }

        body {
            -webkit-font-smoothing: antialiased;
            background-color: #fbfbfb;
            color: #323232;
            font-family: "Whitney SSm A","Whitney SSm B";
            font-size: 100%;
            line-height: 1.5
        }

        h1,h2,h3,h4,h5,h6 {
            text-rendering: optimizeLegibility;
            line-height: 1.25;
            font-family: "Archer SSm A","Archer SSm B";
            margin: 0
        }

        h1 {
            font-size: 2.25em
        }

        h2 {
            font-size: 2em
        }

        h3 {
            font-size: 1.75em
        }

        h4 {
            font-size: 1.5em
        }

        h5 {
            font-size: 1.25em
        }

        h6 {
            font-size: 1em
        }

        p {
            margin: 0 0 0.75em
        }

        a {
            text-decoration: none;
            color: #009aff
        }

        a:hover {
            text-decoration: underline;
            color: #006cb3;
            cursor: pointer
        }

        a:active,a:focus {
            color: #006cb3;
            outline: none
        }

        strong {
            font-weight: 600
        }

        hr {
            border-bottom: 1px solid #e5e5e5;
            border-left: none;
            border-right: none;
            border-top: none;
            margin: 1.5em 0
        }

        img,picture {
            margin: 0;
            max-width: 100%
        }

        blockquote {
            border-left: 2px solid #cbcbcb;
            color: #585858;
            margin: 1.5em 0;
            padding-left: 0.75em
        }

        cite {
            color: #727272;
            font-style: italic
        }

        cite:before {
            content: "\2014 \00A0"
        }

        pre {
            font-family: "Lucida Console",Monaco,monospace;
            overflow-x: auto
        }

        sup {
            vertical-align: super
        }

        sub {
            vertical-align: sub
        }

        .rtl {
            direction: rtl
        }

        .ltr {
            direction: ltr
        }

        fieldset {
            background: transparent;
            border: 0;
            margin: 0 0 0.75em 0;
            padding: 1.5em 0
        }

        input,label,select {
            display: block;
            font-size: 1em
        }

        label {
            margin-bottom: 0.375em
        }

        label.required:after {
            content: "*"
        }

        label abbr {
            display: none
        }

        span.input,textarea,input[type="email"],input[type="number"],input[type="password"],input[type="search"],input[type="tel"],input[type="text"],input[type="url"],input[type="color"],input[type="date"],input[type="datetime"],input[type="datetime-local"],input[type="month"],input[type="time"],input[type="week"],select[multiple=multiple] {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
            -webkit-transition: border-color;
            -moz-transition: border-color;
            transition: border-color;
            background-color: white;
            border-radius: 4px;
            border: 1px solid #cbcbcb;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.06);
            font-family: "Open Sans",sans-serif;
            font-weight: 400;
            font-size: 1em;
            margin-bottom: 0.75em;
            padding: 0.5em 0.5em;
            width: 100%
        }

        span.input:hover,textarea:hover,input[type="email"]:hover,input[type="number"]:hover,input[type="password"]:hover,input[type="search"]:hover,input[type="tel"]:hover,input[type="text"]:hover,input[type="url"]:hover,input[type="color"]:hover,input[type="date"]:hover,input[type="datetime"]:hover,input[type="datetime-local"]:hover,input[type="month"]:hover,input[type="time"]:hover,input[type="week"]:hover,select[multiple=multiple]:hover {
            border-color: #b2b2b2
        }

        span.input:focus,textarea:focus,input[type="email"]:focus,input[type="number"]:focus,input[type="password"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="text"]:focus,input[type="url"]:focus,input[type="color"]:focus,input[type="date"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,input[type="month"]:focus,input[type="time"]:focus,input[type="week"]:focus,select[multiple=multiple]:focus {
            border-color: #009aff;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.06),0 0 5px rgba(0,139,230,0.7);
            outline: none
        }

        textarea {
            resize: vertical
        }

        input[type="search"] {
            -webkit-appearance: none;
            -moz-appearance: none;
            -ms-appearance: none;
            -o-appearance: none;
            appearance: none
        }

        input[type="checkbox"],input[type="radio"] {
            display: inline;
            margin-right: 0.375em
        }

        input[type="file"] {
            padding: 0.75em;
            width: 100%
        }

        select {
            margin-bottom: 1.5em;
            max-width: 100%;
            width: auto
        }

        table {
            border-collapse: collapse;
            margin: 0.75em 0;
            table-layout: fixed
        }

        th {
            border-bottom: 1px solid #a5a5a5;
            padding: 0.75em 0
        }

        td {
            border-bottom: 1px solid #cbcbcb;
            padding: 0.75em 0
        }

        tr,td,th {
            vertical-align: middle
        }

        ul,ol {
            margin: 0;
            padding: 0;
            list-style-type: none
        }

        dl {
            margin-bottom: 0.75em
        }

        dl dt {
            font-weight: normal
        }

        dl dd {
            margin: 0
        }

        * {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box
        }

        .owl-carousel .owl-wrapper:after {
            content: ".";
            display: block;
            clear: both;
            visibility: hidden;
            line-height: 0;
            height: 0
        }

        .owl-carousel {
            display: none;
            position: relative;
            width: 100%;
            -ms-touch-action: pan-y
        }

        .owl-carousel .owl-wrapper {
            display: none;
            position: relative;
            -webkit-transform: translate3d(0px, 0px, 0px)
        }

        .owl-carousel .owl-wrapper-outer {
            overflow: hidden;
            position: relative;
            width: 100%
        }

        .owl-carousel .owl-wrapper-outer.autoHeight {
            -webkit-transition: height 500ms ease-in-out;
            -moz-transition: height 500ms ease-in-out;
            -ms-transition: height 500ms ease-in-out;
            -o-transition: height 500ms ease-in-out;
            transition: height 500ms ease-in-out
        }

        .owl-carousel .owl-item {
            float: left
        }

        .owl-controls .owl-page,.owl-controls .owl-buttons div {
            cursor: pointer
        }

        .owl-controls {
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: rgba(0,0,0,0)
        }

        .grabbing {
            cursor: url(grabbing.png) 8 8,move
        }

        .owl-carousel .owl-wrapper,.owl-carousel .owl-item {
            -webkit-backface-visibility: hidden;
            -moz-backface-visibility: hidden;
            -ms-backface-visibility: hidden;
            -webkit-transform: translate3d(0, 0, 0);
            -moz-transform: translate3d(0, 0, 0);
            -ms-transform: translate3d(0, 0, 0)
        }

        /*!
*  Font Awesome 4.3.0 by @davegandy - http://fontawesome.io - @fontawesome
*  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)
*/
        @font-face {
            font-family: 'FontAwesome';
            src: url("/assets/font-awesome/fontawesome-webfont-23d4e5c8f6421f73f3264e57bc8e38b9.eot");
            src: url("/assets/font-awesome/fontawesome-webfont.eot?#iefix") format("embedded-opentype"),url("/assets/font-awesome/fontawesome-webfont-a6e8c397ee129972dd8114f05c311ae6.woff2") format("woff2"),url("/assets/font-awesome/fontawesome-webfont-2a03499505afef5b69f24ad0ee3b4101.woff") format("woff"),url("/assets/font-awesome/fontawesome-webfont-642c346ad2e7037c946f96c4afd40823.ttf") format("truetype"),url("/assets/font-awesome/fontawesome-webfont.svg#fontawesomeregular") format("svg");
            font-weight: normal;
            font-style: normal
        }

        .fa {
            display: inline-block;
            font: normal normal normal 14px/1 FontAwesome;
            font-size: inherit;
            text-rendering: auto;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transform: translate(0, 0)
        }

        .fa-lg {
            font-size: 1.33333em;
            line-height: 0.75em;
            vertical-align: -15%
        }

        .fa-2x {
            font-size: 2em
        }

        .fa-3x {
            font-size: 3em
        }

        .fa-4x {
            font-size: 4em
        }

        .fa-5x {
            font-size: 5em
        }

        .fa-fw {
            width: 1.28571em;
            text-align: center
        }

        .fa-ul {
            padding-left: 0;
            margin-left: 2.14286em;
            list-style-type: none
        }

        .fa-ul>li {
            position: relative
        }

        .fa-li {
            position: absolute;
            left: -2.14286em;
            width: 2.14286em;
            top: 0.14286em;
            text-align: center
        }

        .fa-li.fa-lg {
            left: -1.85714em
        }

        .fa-border {
            padding: .2em .25em .15em;
            border: solid 0.08em #eee;
            border-radius: .1em
        }

        .pull-right {
            float: right
        }

        .pull-left {
            float: left
        }

        .fa.pull-left {
            margin-right: .3em
        }

        .fa.pull-right {
            margin-left: .3em
        }

        .fa-spin {
            -webkit-animation: fa-spin 2s infinite linear;
            animation: fa-spin 2s infinite linear
        }

        .fa-pulse {
            -webkit-animation: fa-spin 1s infinite steps(8);
            animation: fa-spin 1s infinite steps(8)
        }

        @-webkit-keyframes fa-spin {
            0% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg)
            }

            100% {
                -webkit-transform: rotate(359deg);
                transform: rotate(359deg)
            }
        }

        @keyframes fa-spin {
            0% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg)
            }

            100% {
                -webkit-transform: rotate(359deg);
                transform: rotate(359deg)
            }
        }

        .fa-rotate-90 {
            filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=1);
            -webkit-transform: rotate(90deg);
            -ms-transform: rotate(90deg);
            transform: rotate(90deg)
        }

        .fa-rotate-180 {
            filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=2);
            -webkit-transform: rotate(180deg);
            -ms-transform: rotate(180deg);
            transform: rotate(180deg)
        }

        .fa-rotate-270 {
            filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
            -webkit-transform: rotate(270deg);
            -ms-transform: rotate(270deg);
            transform: rotate(270deg)
        }

        .fa-flip-horizontal {
            filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=0);
            -webkit-transform: scale(-1, 1);
            -ms-transform: scale(-1, 1);
            transform: scale(-1, 1)
        }

        .fa-flip-vertical {
            filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=2);
            -webkit-transform: scale(1, -1);
            -ms-transform: scale(1, -1);
            transform: scale(1, -1)
        }

        :root .fa-rotate-90,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-flip-horizontal,:root .fa-flip-vertical {
            filter: none
        }

        .fa-stack {
            position: relative;
            display: inline-block;
            width: 2em;
            height: 2em;
            line-height: 2em;
            vertical-align: middle
        }

        .fa-stack-1x,.fa-stack-2x {
            position: absolute;
            left: 0;
            width: 100%;
            text-align: center
        }

        .fa-stack-1x {
            line-height: inherit
        }

        .fa-stack-2x {
            font-size: 2em
        }

        .fa-inverse {
            color: #fff
        }

        .fa-glass:before {
            content: "\f000"
        }

        .fa-music:before {
            content: "\f001"
        }

        .fa-search:before {
            content: "\f002"
        }

        .fa-envelope-o:before {
            content: "\f003"
        }

        .fa-heart:before {
            content: "\f004"
        }

        .fa-star:before {
            content: "\f005"
        }

        .fa-star-o:before {
            content: "\f006"
        }

        .fa-user:before {
            content: "\f007"
        }

        .fa-film:before {
            content: "\f008"
        }

        .fa-th-large:before {
            content: "\f009"
        }

        .fa-th:before {
            content: "\f00a"
        }

        .fa-th-list:before {
            content: "\f00b"
        }

        .fa-check:before {
            content: "\f00c"
        }

        .fa-remove:before,.fa-close:before,.fa-times:before {
            content: "\f00d"
        }

        .fa-search-plus:before {
            content: "\f00e"
        }

        .fa-search-minus:before {
            content: "\f010"
        }

        .fa-power-off:before {
            content: "\f011"
        }

        .fa-signal:before {
            content: "\f012"
        }

        .fa-gear:before,.fa-cog:before {
            content: "\f013"
        }

        .fa-trash-o:before {
            content: "\f014"
        }

        .fa-home:before {
            content: "\f015"
        }

        .fa-file-o:before {
            content: "\f016"
        }

        .fa-clock-o:before {
            content: "\f017"
        }

        .fa-road:before {
            content: "\f018"
        }

        .fa-download:before {
            content: "\f019"
        }

        .fa-arrow-circle-o-down:before {
            content: "\f01a"
        }

        .fa-arrow-circle-o-up:before {
            content: "\f01b"
        }

        .fa-inbox:before {
            content: "\f01c"
        }

        .fa-play-circle-o:before {
            content: "\f01d"
        }

        .fa-rotate-right:before,.fa-repeat:before {
            content: "\f01e"
        }

        .fa-refresh:before {
            content: "\f021"
        }

        .fa-list-alt:before {
            content: "\f022"
        }

        .fa-lock:before {
            content: "\f023"
        }

        .fa-flag:before {
            content: "\f024"
        }

        .fa-headphones:before {
            content: "\f025"
        }

        .fa-volume-off:before {
            content: "\f026"
        }

        .fa-volume-down:before {
            content: "\f027"
        }

        .fa-volume-up:before {
            content: "\f028"
        }

        .fa-qrcode:before {
            content: "\f029"
        }

        .fa-barcode:before {
            content: "\f02a"
        }

        .fa-tag:before {
            content: "\f02b"
        }

        .fa-tags:before {
            content: "\f02c"
        }

        .fa-book:before {
            content: "\f02d"
        }

        .fa-bookmark:before {
            content: "\f02e"
        }

        .fa-print:before {
            content: "\f02f"
        }

        .fa-camera:before {
            content: "\f030"
        }

        .fa-font:before {
            content: "\f031"
        }

        .fa-bold:before {
            content: "\f032"
        }

        .fa-italic:before {
            content: "\f033"
        }

        .fa-text-height:before {
            content: "\f034"
        }

        .fa-text-width:before {
            content: "\f035"
        }

        .fa-align-left:before {
            content: "\f036"
        }

        .fa-align-center:before {
            content: "\f037"
        }

        .fa-align-right:before {
            content: "\f038"
        }

        .fa-align-justify:before {
            content: "\f039"
        }

        .fa-list:before {
            content: "\f03a"
        }

        .fa-dedent:before,.fa-outdent:before {
            content: "\f03b"
        }

        .fa-indent:before {
            content: "\f03c"
        }

        .fa-video-camera:before {
            content: "\f03d"
        }

        .fa-photo:before,.fa-image:before,.fa-picture-o:before {
            content: "\f03e"
        }

        .fa-pencil:before {
            content: "\f040"
        }

        .fa-map-marker:before {
            content: "\f041"
        }

        .fa-adjust:before {
            content: "\f042"
        }

        .fa-tint:before {
            content: "\f043"
        }

        .fa-edit:before,.fa-pencil-square-o:before {
            content: "\f044"
        }

        .fa-share-square-o:before {
            content: "\f045"
        }

        .fa-check-square-o:before {
            content: "\f046"
        }

        .fa-arrows:before {
            content: "\f047"
        }

        .fa-step-backward:before {
            content: "\f048"
        }

        .fa-fast-backward:before {
            content: "\f049"
        }

        .fa-backward:before {
            content: "\f04a"
        }

        .fa-play:before {
            content: "\f04b"
        }

        .fa-pause:before {
            content: "\f04c"
        }

        .fa-stop:before {
            content: "\f04d"
        }

        .fa-forward:before {
            content: "\f04e"
        }

        .fa-fast-forward:before {
            content: "\f050"
        }

        .fa-step-forward:before {
            content: "\f051"
        }

        .fa-eject:before {
            content: "\f052"
        }

        .fa-chevron-left:before {
            content: "\f053"
        }

        .fa-chevron-right:before {
            content: "\f054"
        }

        .fa-plus-circle:before {
            content: "\f055"
        }

        .fa-minus-circle:before {
            content: "\f056"
        }

        .fa-times-circle:before {
            content: "\f057"
        }

        .fa-check-circle:before,.alert.alert-success .flash-message:before {
            content: "\f058"
        }

        .fa-question-circle:before {
            content: "\f059"
        }

        .fa-info-circle:before,.alert.alert-info .flash-message:before {
            content: "\f05a"
        }

        .fa-crosshairs:before {
            content: "\f05b"
        }

        .fa-times-circle-o:before {
            content: "\f05c"
        }

        .fa-check-circle-o:before {
            content: "\f05d"
        }

        .fa-ban:before {
            content: "\f05e"
        }

        .fa-arrow-left:before {
            content: "\f060"
        }

        .fa-arrow-right:before {
            content: "\f061"
        }

        .fa-arrow-up:before {
            content: "\f062"
        }

        .fa-arrow-down:before {
            content: "\f063"
        }

        .fa-mail-forward:before,.fa-share:before {
            content: "\f064"
        }

        .fa-expand:before {
            content: "\f065"
        }

        .fa-compress:before {
            content: "\f066"
        }

        .fa-plus:before {
            content: "\f067"
        }

        .fa-minus:before {
            content: "\f068"
        }

        .fa-asterisk:before {
            content: "\f069"
        }

        .fa-exclamation-circle:before {
            content: "\f06a"
        }

        .fa-gift:before {
            content: "\f06b"
        }

        .fa-leaf:before {
            content: "\f06c"
        }

        .fa-fire:before {
            content: "\f06d"
        }

        .fa-eye:before {
            content: "\f06e"
        }

        .fa-eye-slash:before {
            content: "\f070"
        }

        .fa-warning:before,.flash-message:before,.alert.alert-warning .flash-message:before,.stealth-mode .flash-message:before,.embargo-mode .flash-message:before,.not-accepted .flash-message:before,.fa-exclamation-triangle:before {
            content: "\f071"
        }

        .fa-plane:before {
            content: "\f072"
        }

        .fa-calendar:before {
            content: "\f073"
        }

        .fa-random:before {
            content: "\f074"
        }

        .fa-comment:before {
            content: "\f075"
        }

        .fa-magnet:before {
            content: "\f076"
        }

        .fa-chevron-up:before {
            content: "\f077"
        }

        .fa-chevron-down:before {
            content: "\f078"
        }

        .fa-retweet:before {
            content: "\f079"
        }

        .fa-shopping-cart:before {
            content: "\f07a"
        }

        .fa-folder:before {
            content: "\f07b"
        }

        .fa-folder-open:before {
            content: "\f07c"
        }

        .fa-arrows-v:before {
            content: "\f07d"
        }

        .fa-arrows-h:before {
            content: "\f07e"
        }

        .fa-bar-chart-o:before,.fa-bar-chart:before {
            content: "\f080"
        }

        .fa-twitter-square:before {
            content: "\f081"
        }

        .fa-facebook-square:before {
            content: "\f082"
        }

        .fa-camera-retro:before {
            content: "\f083"
        }

        .fa-key:before {
            content: "\f084"
        }

        .fa-gears:before,.fa-cogs:before {
            content: "\f085"
        }

        .fa-comments:before {
            content: "\f086"
        }

        .fa-thumbs-o-up:before {
            content: "\f087"
        }

        .fa-thumbs-o-down:before {
            content: "\f088"
        }

        .fa-star-half:before {
            content: "\f089"
        }

        .fa-heart-o:before {
            content: "\f08a"
        }

        .fa-sign-out:before {
            content: "\f08b"
        }

        .fa-linkedin-square:before {
            content: "\f08c"
        }

        .fa-thumb-tack:before {
            content: "\f08d"
        }

        .fa-external-link:before {
            content: "\f08e"
        }

        .fa-sign-in:before {
            content: "\f090"
        }

        .fa-trophy:before {
            content: "\f091"
        }

        .fa-github-square:before {
            content: "\f092"
        }

        .fa-upload:before {
            content: "\f093"
        }

        .fa-lemon-o:before {
            content: "\f094"
        }

        .fa-phone:before {
            content: "\f095"
        }

        .fa-square-o:before {
            content: "\f096"
        }

        .fa-bookmark-o:before {
            content: "\f097"
        }

        .fa-phone-square:before {
            content: "\f098"
        }

        .fa-twitter:before {
            content: "\f099"
        }

        .fa-facebook-f:before,.fa-facebook:before {
            content: "\f09a"
        }

        .fa-github:before {
            content: "\f09b"
        }

        .fa-unlock:before {
            content: "\f09c"
        }

        .fa-credit-card:before {
            content: "\f09d"
        }

        .fa-rss:before {
            content: "\f09e"
        }

        .fa-hdd-o:before {
            content: "\f0a0"
        }

        .fa-bullhorn:before {
            content: "\f0a1"
        }

        .fa-bell:before {
            content: "\f0f3"
        }

        .fa-certificate:before {
            content: "\f0a3"
        }

        .fa-hand-o-right:before {
            content: "\f0a4"
        }

        .fa-hand-o-left:before {
            content: "\f0a5"
        }

        .fa-hand-o-up:before {
            content: "\f0a6"
        }

        .fa-hand-o-down:before {
            content: "\f0a7"
        }

        .fa-arrow-circle-left:before {
            content: "\f0a8"
        }

        .fa-arrow-circle-right:before {
            content: "\f0a9"
        }

        .fa-arrow-circle-up:before {
            content: "\f0aa"
        }

        .fa-arrow-circle-down:before {
            content: "\f0ab"
        }

        .fa-globe:before {
            content: "\f0ac"
        }

        .fa-wrench:before {
            content: "\f0ad"
        }

        .fa-tasks:before {
            content: "\f0ae"
        }

        .fa-filter:before {
            content: "\f0b0"
        }

        .fa-briefcase:before {
            content: "\f0b1"
        }

        .fa-arrows-alt:before {
            content: "\f0b2"
        }

        .fa-group:before,.fa-users:before {
            content: "\f0c0"
        }

        .fa-chain:before,.fa-link:before {
            content: "\f0c1"
        }

        .fa-cloud:before {
            content: "\f0c2"
        }

        .fa-flask:before {
            content: "\f0c3"
        }

        .fa-cut:before,.fa-scissors:before {
            content: "\f0c4"
        }

        .fa-copy:before,.fa-files-o:before {
            content: "\f0c5"
        }

        .fa-paperclip:before {
            content: "\f0c6"
        }

        .fa-save:before,.fa-floppy-o:before {
            content: "\f0c7"
        }

        .fa-square:before {
            content: "\f0c8"
        }

        .fa-navicon:before,.fa-reorder:before,.fa-bars:before {
            content: "\f0c9"
        }

        .fa-list-ul:before {
            content: "\f0ca"
        }

        .fa-list-ol:before {
            content: "\f0cb"
        }

        .fa-strikethrough:before {
            content: "\f0cc"
        }

        .fa-underline:before {
            content: "\f0cd"
        }

        .fa-table:before {
            content: "\f0ce"
        }

        .fa-magic:before {
            content: "\f0d0"
        }

        .fa-truck:before {
            content: "\f0d1"
        }

        .fa-pinterest:before {
            content: "\f0d2"
        }

        .fa-pinterest-square:before {
            content: "\f0d3"
        }

        .fa-google-plus-square:before {
            content: "\f0d4"
        }

        .fa-google-plus:before {
            content: "\f0d5"
        }

        .fa-money:before {
            content: "\f0d6"
        }

        .fa-caret-down:before {
            content: "\f0d7"
        }

        .fa-caret-up:before {
            content: "\f0d8"
        }

        .fa-caret-left:before {
            content: "\f0d9"
        }

        .fa-caret-right:before {
            content: "\f0da"
        }

        .fa-columns:before {
            content: "\f0db"
        }

        .fa-unsorted:before,.fa-sort:before {
            content: "\f0dc"
        }

        .fa-sort-down:before,.fa-sort-desc:before {
            content: "\f0dd"
        }

        .fa-sort-up:before,.fa-sort-asc:before {
            content: "\f0de"
        }

        .fa-envelope:before {
            content: "\f0e0"
        }

        .fa-linkedin:before {
            content: "\f0e1"
        }

        .fa-rotate-left:before,.fa-undo:before {
            content: "\f0e2"
        }

        .fa-legal:before,.fa-gavel:before {
            content: "\f0e3"
        }

        .fa-dashboard:before,.fa-tachometer:before {
            content: "\f0e4"
        }

        .fa-comment-o:before {
            content: "\f0e5"
        }

        .fa-comments-o:before {
            content: "\f0e6"
        }

        .fa-flash:before,.fa-bolt:before {
            content: "\f0e7"
        }

        .fa-sitemap:before {
            content: "\f0e8"
        }

        .fa-umbrella:before {
            content: "\f0e9"
        }

        .fa-paste:before,.fa-clipboard:before {
            content: "\f0ea"
        }

        .fa-lightbulb-o:before {
            content: "\f0eb"
        }

        .fa-exchange:before {
            content: "\f0ec"
        }

        .fa-cloud-download:before {
            content: "\f0ed"
        }

        .fa-cloud-upload:before {
            content: "\f0ee"
        }

        .fa-user-md:before {
            content: "\f0f0"
        }

        .fa-stethoscope:before {
            content: "\f0f1"
        }

        .fa-suitcase:before {
            content: "\f0f2"
        }

        .fa-bell-o:before {
            content: "\f0a2"
        }

        .fa-coffee:before {
            content: "\f0f4"
        }

        .fa-cutlery:before {
            content: "\f0f5"
        }

        .fa-file-text-o:before {
            content: "\f0f6"
        }

        .fa-building-o:before {
            content: "\f0f7"
        }

        .fa-hospital-o:before {
            content: "\f0f8"
        }

        .fa-ambulance:before {
            content: "\f0f9"
        }

        .fa-medkit:before {
            content: "\f0fa"
        }

        .fa-fighter-jet:before {
            content: "\f0fb"
        }

        .fa-beer:before {
            content: "\f0fc"
        }

        .fa-h-square:before {
            content: "\f0fd"
        }

        .fa-plus-square:before {
            content: "\f0fe"
        }

        .fa-angle-double-left:before {
            content: "\f100"
        }

        .fa-angle-double-right:before {
            content: "\f101"
        }

        .fa-angle-double-up:before {
            content: "\f102"
        }

        .fa-angle-double-down:before {
            content: "\f103"
        }

        .fa-angle-left:before {
            content: "\f104"
        }

        .fa-angle-right:before {
            content: "\f105"
        }

        .fa-angle-up:before {
            content: "\f106"
        }

        .fa-angle-down:before {
            content: "\f107"
        }

        .fa-desktop:before {
            content: "\f108"
        }

        .fa-laptop:before {
            content: "\f109"
        }

        .fa-tablet:before {
            content: "\f10a"
        }

        .fa-mobile-phone:before,.fa-mobile:before {
            content: "\f10b"
        }

        .fa-circle-o:before {
            content: "\f10c"
        }

        .fa-quote-left:before {
            content: "\f10d"
        }

        .fa-quote-right:before {
            content: "\f10e"
        }

        .fa-spinner:before {
            content: "\f110"
        }

        .fa-circle:before {
            content: "\f111"
        }

        .fa-mail-reply:before,.fa-reply:before {
            content: "\f112"
        }

        .fa-github-alt:before {
            content: "\f113"
        }

        .fa-folder-o:before {
            content: "\f114"
        }

        .fa-folder-open-o:before {
            content: "\f115"
        }

        .fa-smile-o:before {
            content: "\f118"
        }

        .fa-frown-o:before {
            content: "\f119"
        }

        .fa-meh-o:before {
            content: "\f11a"
        }

        .fa-gamepad:before {
            content: "\f11b"
        }

        .fa-keyboard-o:before {
            content: "\f11c"
        }

        .fa-flag-o:before {
            content: "\f11d"
        }

        .fa-flag-checkered:before {
            content: "\f11e"
        }

        .fa-terminal:before {
            content: "\f120"
        }

        .fa-code:before {
            content: "\f121"
        }

        .fa-mail-reply-all:before,.fa-reply-all:before {
            content: "\f122"
        }

        .fa-star-half-empty:before,.fa-star-half-full:before,.fa-star-half-o:before {
            content: "\f123"
        }

        .fa-location-arrow:before {
            content: "\f124"
        }

        .fa-crop:before {
            content: "\f125"
        }

        .fa-code-fork:before {
            content: "\f126"
        }

        .fa-unlink:before,.fa-chain-broken:before {
            content: "\f127"
        }

        .fa-question:before {
            content: "\f128"
        }

        .fa-info:before {
            content: "\f129"
        }

        .fa-exclamation:before {
            content: "\f12a"
        }

        .fa-superscript:before {
            content: "\f12b"
        }

        .fa-subscript:before {
            content: "\f12c"
        }

        .fa-eraser:before {
            content: "\f12d"
        }

        .fa-puzzle-piece:before {
            content: "\f12e"
        }

        .fa-microphone:before {
            content: "\f130"
        }

        .fa-microphone-slash:before {
            content: "\f131"
        }

        .fa-shield:before {
            content: "\f132"
        }

        .fa-calendar-o:before {
            content: "\f133"
        }

        .fa-fire-extinguisher:before {
            content: "\f134"
        }

        .fa-rocket:before {
            content: "\f135"
        }

        .fa-maxcdn:before {
            content: "\f136"
        }

        .fa-chevron-circle-left:before {
            content: "\f137"
        }

        .fa-chevron-circle-right:before {
            content: "\f138"
        }

        .fa-chevron-circle-up:before {
            content: "\f139"
        }

        .fa-chevron-circle-down:before {
            content: "\f13a"
        }

        .fa-html5:before {
            content: "\f13b"
        }

        .fa-css3:before {
            content: "\f13c"
        }

        .fa-anchor:before {
            content: "\f13d"
        }

        .fa-unlock-alt:before {
            content: "\f13e"
        }

        .fa-bullseye:before {
            content: "\f140"
        }

        .fa-ellipsis-h:before {
            content: "\f141"
        }

        .fa-ellipsis-v:before {
            content: "\f142"
        }

        .fa-rss-square:before {
            content: "\f143"
        }

        .fa-play-circle:before {
            content: "\f144"
        }

        .fa-ticket:before {
            content: "\f145"
        }

        .fa-minus-square:before {
            content: "\f146"
        }

        .fa-minus-square-o:before {
            content: "\f147"
        }

        .fa-level-up:before {
            content: "\f148"
        }

        .fa-level-down:before {
            content: "\f149"
        }

        .fa-check-square:before {
            content: "\f14a"
        }

        .fa-pencil-square:before {
            content: "\f14b"
        }

        .fa-external-link-square:before {
            content: "\f14c"
        }

        .fa-share-square:before {
            content: "\f14d"
        }

        .fa-compass:before {
            content: "\f14e"
        }

        .fa-toggle-down:before,.fa-caret-square-o-down:before {
            content: "\f150"
        }

        .fa-toggle-up:before,.fa-caret-square-o-up:before {
            content: "\f151"
        }

        .fa-toggle-right:before,.fa-caret-square-o-right:before {
            content: "\f152"
        }

        .fa-euro:before,.fa-eur:before {
            content: "\f153"
        }

        .fa-gbp:before {
            content: "\f154"
        }

        .fa-dollar:before,.fa-usd:before {
            content: "\f155"
        }

        .fa-rupee:before,.fa-inr:before {
            content: "\f156"
        }

        .fa-cny:before,.fa-rmb:before,.fa-yen:before,.fa-jpy:before {
            content: "\f157"
        }

        .fa-ruble:before,.fa-rouble:before,.fa-rub:before {
            content: "\f158"
        }

        .fa-won:before,.fa-krw:before {
            content: "\f159"
        }

        .fa-bitcoin:before,.fa-btc:before {
            content: "\f15a"
        }

        .fa-file:before {
            content: "\f15b"
        }

        .fa-file-text:before {
            content: "\f15c"
        }

        .fa-sort-alpha-asc:before {
            content: "\f15d"
        }

        .fa-sort-alpha-desc:before {
            content: "\f15e"
        }

        .fa-sort-amount-asc:before {
            content: "\f160"
        }

        .fa-sort-amount-desc:before {
            content: "\f161"
        }

        .fa-sort-numeric-asc:before {
            content: "\f162"
        }

        .fa-sort-numeric-desc:before {
            content: "\f163"
        }

        .fa-thumbs-up:before {
            content: "\f164"
        }

        .fa-thumbs-down:before {
            content: "\f165"
        }

        .fa-youtube-square:before {
            content: "\f166"
        }

        .fa-youtube:before {
            content: "\f167"
        }

        .fa-xing:before {
            content: "\f168"
        }

        .fa-xing-square:before {
            content: "\f169"
        }

        .fa-youtube-play:before {
            content: "\f16a"
        }

        .fa-dropbox:before {
            content: "\f16b"
        }

        .fa-stack-overflow:before {
            content: "\f16c"
        }

        .fa-instagram:before {
            content: "\f16d"
        }

        .fa-flickr:before {
            content: "\f16e"
        }

        .fa-adn:before {
            content: "\f170"
        }

        .fa-bitbucket:before {
            content: "\f171"
        }

        .fa-bitbucket-square:before {
            content: "\f172"
        }

        .fa-tumblr:before {
            content: "\f173"
        }

        .fa-tumblr-square:before {
            content: "\f174"
        }

        .fa-long-arrow-down:before {
            content: "\f175"
        }

        .fa-long-arrow-up:before {
            content: "\f176"
        }

        .fa-long-arrow-left:before {
            content: "\f177"
        }

        .fa-long-arrow-right:before {
            content: "\f178"
        }

        .fa-apple:before {
            content: "\f179"
        }

        .fa-windows:before {
            content: "\f17a"
        }

        .fa-android:before {
            content: "\f17b"
        }

        .fa-linux:before {
            content: "\f17c"
        }

        .fa-dribbble:before {
            content: "\f17d"
        }

        .fa-skype:before {
            content: "\f17e"
        }

        .fa-foursquare:before {
            content: "\f180"
        }

        .fa-trello:before {
            content: "\f181"
        }

        .fa-female:before {
            content: "\f182"
        }

        .fa-male:before {
            content: "\f183"
        }

        .fa-gittip:before,.fa-gratipay:before {
            content: "\f184"
        }

        .fa-sun-o:before {
            content: "\f185"
        }

        .fa-moon-o:before {
            content: "\f186"
        }

        .fa-archive:before {
            content: "\f187"
        }

        .fa-bug:before {
            content: "\f188"
        }

        .fa-vk:before {
            content: "\f189"
        }

        .fa-weibo:before {
            content: "\f18a"
        }

        .fa-renren:before {
            content: "\f18b"
        }

        .fa-pagelines:before {
            content: "\f18c"
        }

        .fa-stack-exchange:before {
            content: "\f18d"
        }

        .fa-arrow-circle-o-right:before {
            content: "\f18e"
        }

        .fa-arrow-circle-o-left:before {
            content: "\f190"
        }

        .fa-toggle-left:before,.fa-caret-square-o-left:before {
            content: "\f191"
        }

        .fa-dot-circle-o:before {
            content: "\f192"
        }

        .fa-wheelchair:before {
            content: "\f193"
        }

        .fa-vimeo-square:before {
            content: "\f194"
        }

        .fa-turkish-lira:before,.fa-try:before {
            content: "\f195"
        }

        .fa-plus-square-o:before {
            content: "\f196"
        }

        .fa-space-shuttle:before {
            content: "\f197"
        }

        .fa-slack:before {
            content: "\f198"
        }

        .fa-envelope-square:before {
            content: "\f199"
        }

        .fa-wordpress:before {
            content: "\f19a"
        }

        .fa-openid:before {
            content: "\f19b"
        }

        .fa-institution:before,.fa-bank:before,.fa-university:before {
            content: "\f19c"
        }

        .fa-mortar-board:before,.fa-graduation-cap:before {
            content: "\f19d"
        }

        .fa-yahoo:before {
            content: "\f19e"
        }

        .fa-google:before {
            content: "\f1a0"
        }

        .fa-reddit:before {
            content: "\f1a1"
        }

        .fa-reddit-square:before {
            content: "\f1a2"
        }

        .fa-stumbleupon-circle:before {
            content: "\f1a3"
        }

        .fa-stumbleupon:before {
            content: "\f1a4"
        }

        .fa-delicious:before {
            content: "\f1a5"
        }

        .fa-digg:before {
            content: "\f1a6"
        }

        .fa-pied-piper:before {
            content: "\f1a7"
        }

        .fa-pied-piper-alt:before {
            content: "\f1a8"
        }

        .fa-drupal:before {
            content: "\f1a9"
        }

        .fa-joomla:before {
            content: "\f1aa"
        }

        .fa-language:before {
            content: "\f1ab"
        }

        .fa-fax:before {
            content: "\f1ac"
        }

        .fa-building:before {
            content: "\f1ad"
        }

        .fa-child:before {
            content: "\f1ae"
        }

        .fa-paw:before {
            content: "\f1b0"
        }

        .fa-spoon:before {
            content: "\f1b1"
        }

        .fa-cube:before {
            content: "\f1b2"
        }

        .fa-cubes:before {
            content: "\f1b3"
        }

        .fa-behance:before {
            content: "\f1b4"
        }

        .fa-behance-square:before {
            content: "\f1b5"
        }

        .fa-steam:before {
            content: "\f1b6"
        }

        .fa-steam-square:before {
            content: "\f1b7"
        }

        .fa-recycle:before {
            content: "\f1b8"
        }

        .fa-automobile:before,.fa-car:before {
            content: "\f1b9"
        }

        .fa-cab:before,.fa-taxi:before {
            content: "\f1ba"
        }

        .fa-tree:before {
            content: "\f1bb"
        }

        .fa-spotify:before {
            content: "\f1bc"
        }

        .fa-deviantart:before {
            content: "\f1bd"
        }

        .fa-soundcloud:before {
            content: "\f1be"
        }

        .fa-database:before {
            content: "\f1c0"
        }

        .fa-file-pdf-o:before {
            content: "\f1c1"
        }

        .fa-file-word-o:before {
            content: "\f1c2"
        }

        .fa-file-excel-o:before {
            content: "\f1c3"
        }

        .fa-file-powerpoint-o:before {
            content: "\f1c4"
        }

        .fa-file-photo-o:before,.fa-file-picture-o:before,.fa-file-image-o:before {
            content: "\f1c5"
        }

        .fa-file-zip-o:before,.fa-file-archive-o:before {
            content: "\f1c6"
        }

        .fa-file-sound-o:before,.fa-file-audio-o:before {
            content: "\f1c7"
        }

        .fa-file-movie-o:before,.fa-file-video-o:before {
            content: "\f1c8"
        }

        .fa-file-code-o:before {
            content: "\f1c9"
        }

        .fa-vine:before {
            content: "\f1ca"
        }

        .fa-codepen:before {
            content: "\f1cb"
        }

        .fa-jsfiddle:before {
            content: "\f1cc"
        }

        .fa-life-bouy:before,.fa-life-buoy:before,.fa-life-saver:before,.fa-support:before,.fa-life-ring:before {
            content: "\f1cd"
        }

        .fa-circle-o-notch:before {
            content: "\f1ce"
        }

        .fa-ra:before,.fa-rebel:before {
            content: "\f1d0"
        }

        .fa-ge:before,.fa-empire:before {
            content: "\f1d1"
        }

        .fa-git-square:before {
            content: "\f1d2"
        }

        .fa-git:before {
            content: "\f1d3"
        }

        .fa-hacker-news:before {
            content: "\f1d4"
        }

        .fa-tencent-weibo:before {
            content: "\f1d5"
        }

        .fa-qq:before {
            content: "\f1d6"
        }

        .fa-wechat:before,.fa-weixin:before {
            content: "\f1d7"
        }

        .fa-send:before,.fa-paper-plane:before {
            content: "\f1d8"
        }

        .fa-send-o:before,.fa-paper-plane-o:before {
            content: "\f1d9"
        }

        .fa-history:before {
            content: "\f1da"
        }

        .fa-genderless:before,.fa-circle-thin:before {
            content: "\f1db"
        }

        .fa-header:before {
            content: "\f1dc"
        }

        .fa-paragraph:before {
            content: "\f1dd"
        }

        .fa-sliders:before {
            content: "\f1de"
        }

        .fa-share-alt:before {
            content: "\f1e0"
        }

        .fa-share-alt-square:before {
            content: "\f1e1"
        }

        .fa-bomb:before {
            content: "\f1e2"
        }

        .fa-soccer-ball-o:before,.fa-futbol-o:before {
            content: "\f1e3"
        }

        .fa-tty:before {
            content: "\f1e4"
        }

        .fa-binoculars:before {
            content: "\f1e5"
        }

        .fa-plug:before {
            content: "\f1e6"
        }

        .fa-slideshare:before {
            content: "\f1e7"
        }

        .fa-twitch:before {
            content: "\f1e8"
        }

        .fa-yelp:before {
            content: "\f1e9"
        }

        .fa-newspaper-o:before {
            content: "\f1ea"
        }

        .fa-wifi:before {
            content: "\f1eb"
        }

        .fa-calculator:before {
            content: "\f1ec"
        }

        .fa-paypal:before {
            content: "\f1ed"
        }

        .fa-google-wallet:before {
            content: "\f1ee"
        }

        .fa-cc-visa:before {
            content: "\f1f0"
        }

        .fa-cc-mastercard:before {
            content: "\f1f1"
        }

        .fa-cc-discover:before {
            content: "\f1f2"
        }

        .fa-cc-amex:before {
            content: "\f1f3"
        }

        .fa-cc-paypal:before {
            content: "\f1f4"
        }

        .fa-cc-stripe:before {
            content: "\f1f5"
        }

        .fa-bell-slash:before {
            content: "\f1f6"
        }

        .fa-bell-slash-o:before {
            content: "\f1f7"
        }

        .fa-trash:before {
            content: "\f1f8"
        }

        .fa-copyright:before {
            content: "\f1f9"
        }

        .fa-at:before {
            content: "\f1fa"
        }

        .fa-eyedropper:before {
            content: "\f1fb"
        }

        .fa-paint-brush:before {
            content: "\f1fc"
        }

        .fa-birthday-cake:before {
            content: "\f1fd"
        }

        .fa-area-chart:before {
            content: "\f1fe"
        }

        .fa-pie-chart:before {
            content: "\f200"
        }

        .fa-line-chart:before {
            content: "\f201"
        }

        .fa-lastfm:before {
            content: "\f202"
        }

        .fa-lastfm-square:before {
            content: "\f203"
        }

        .fa-toggle-off:before {
            content: "\f204"
        }

        .fa-toggle-on:before {
            content: "\f205"
        }

        .fa-bicycle:before {
            content: "\f206"
        }

        .fa-bus:before {
            content: "\f207"
        }

        .fa-ioxhost:before {
            content: "\f208"
        }

        .fa-angellist:before {
            content: "\f209"
        }

        .fa-cc:before {
            content: "\f20a"
        }

        .fa-shekel:before,.fa-sheqel:before,.fa-ils:before {
            content: "\f20b"
        }

        .fa-meanpath:before {
            content: "\f20c"
        }

        .fa-buysellads:before {
            content: "\f20d"
        }

        .fa-connectdevelop:before {
            content: "\f20e"
        }

        .fa-dashcube:before {
            content: "\f210"
        }

        .fa-forumbee:before {
            content: "\f211"
        }

        .fa-leanpub:before {
            content: "\f212"
        }

        .fa-sellsy:before {
            content: "\f213"
        }

        .fa-shirtsinbulk:before {
            content: "\f214"
        }

        .fa-simplybuilt:before {
            content: "\f215"
        }

        .fa-skyatlas:before {
            content: "\f216"
        }

        .fa-cart-plus:before {
            content: "\f217"
        }

        .fa-cart-arrow-down:before {
            content: "\f218"
        }

        .fa-diamond:before {
            content: "\f219"
        }

        .fa-ship:before {
            content: "\f21a"
        }

        .fa-user-secret:before {
            content: "\f21b"
        }

        .fa-motorcycle:before {
            content: "\f21c"
        }

        .fa-street-view:before {
            content: "\f21d"
        }

        .fa-heartbeat:before {
            content: "\f21e"
        }

        .fa-venus:before {
            content: "\f221"
        }

        .fa-mars:before {
            content: "\f222"
        }

        .fa-mercury:before {
            content: "\f223"
        }

        .fa-transgender:before {
            content: "\f224"
        }

        .fa-transgender-alt:before {
            content: "\f225"
        }

        .fa-venus-double:before {
            content: "\f226"
        }

        .fa-mars-double:before {
            content: "\f227"
        }

        .fa-venus-mars:before {
            content: "\f228"
        }

        .fa-mars-stroke:before {
            content: "\f229"
        }

        .fa-mars-stroke-v:before {
            content: "\f22a"
        }

        .fa-mars-stroke-h:before {
            content: "\f22b"
        }

        .fa-neuter:before {
            content: "\f22c"
        }

        .fa-facebook-official:before {
            content: "\f230"
        }

        .fa-pinterest-p:before {
            content: "\f231"
        }

        .fa-whatsapp:before {
            content: "\f232"
        }

        .fa-server:before {
            content: "\f233"
        }

        .fa-user-plus:before {
            content: "\f234"
        }

        .fa-user-times:before {
            content: "\f235"
        }

        .fa-hotel:before,.fa-bed:before {
            content: "\f236"
        }

        .fa-viacoin:before {
            content: "\f237"
        }

        .fa-train:before {
            content: "\f238"
        }

        .fa-subway:before {
            content: "\f239"
        }

        .fa-medium:before {
            content: "\f23a"
        }

        input,label,select,.book-subtitle,.book-author,.author-profile .profile-name,.contributor-profile .profile-name,.publisher-profile .profile-name,.user-profile .profile-name,.cause-profile .profile-name,.bundles-authors,.byline,.book-titles>p,.royalties-counter.concise {
            font-family: "Whitney SSm A","Whitney SSm B","Helvetica Neue",Helvetica,Arial,sans-serif;
            font-style: normal;
            font-weight: 300
        }

        .copy p,.vertical-tabs-container .vertical-tab-content p,.input-prepend .add-on,.input-append .add-on,.book-list-wrapper .list-title,.bundle-list-wrapper .list-title,.book-list-item .list-item-author,.edit-book-list-item .list-item-author,.bundle-list-item .list-item-author,#book-list.cover-view .book-list-item .list-item-author,dl dd,.price-regular+.price-text,.price-minimum+.price-text,.price-highlight+.price-text,.includes-vat,.table th,.royalties-table th,.table td,.royalties-table td,.dropdown,.book-progress .last-updated,#try-leanpub .bullet-copy,#royalties-explained .section-subtitle,#how-to-leanpub .bullet-copy,#bookstore .search-message,.featured-book .featured-title,#book-list .list-item-author,#thank-you .section-subtitle {
            font-family: "Whitney SSm A","Whitney SSm B","Helvetica Neue",Helvetica,Arial,sans-serif;
            font-style: normal;
            font-weight: 400
        }

        button,input[type="submit"],input[type="button"],#mailchimp-subscribe-button,#mailchimp-subscribe-authors-button,#copy-button,#mailchimp-unsubscribe-button,#mailchimp-unsubscribe-authors-button,.pseudo-button,form label,.sign-up,.buy-now,.add-to-cart,.add-to-cart-modal,.payment-method,.cancel,.submit,.danger,.generic,.wishlist,.twitter>a,.book-edit-link,.sign-in,.book-list-wrapper .view-all,.bundle-list-wrapper .view-all,.book-list-item .list-item-title,.edit-book-list-item .list-item-title,.bundle-list-item .list-item-title,#book-list.cover-view .book-list-item .list-item-title,.details-list .detail-list-title,.details-list-stacked .detail-list-title,.author-profile .profile-title,.contributor-profile .profile-title,.publisher-profile .profile-title,.user-profile .profile-title,.cause-profile .profile-title,.book-progress .percent-complete,.book-details-list,#account-dropdown .account h3,#account-dropdown .author-account h3,#account-dropdown .publisher-account h3,#account-dropdown .quick-links h3,.tooltip-item .tooltip,#dashboard .dashboard,#about-leanpub .about-copy span,.button-group label .button-group-item,#book-list .list-item-title,#details-panel .selection-details-link {
            font-family: "Whitney SSm A","Whitney SSm B","Helvetica Neue",Helvetica,Arial,sans-serif;
            font-style: normal;
            font-weight: 500
        }

        .guarantee-logo,dl dt,.table-minimal thead th,.filter-header,.book-progress.complete .percent-complete,.royalties-counter.concise .sales sub {
            font-family: "Whitney SSm A","Whitney SSm B","Helvetica Neue",Helvetica,Arial,sans-serif;
            font-style: normal;
            font-weight: 600
        }

        .table tr.important-row td,.royalties-table tr.important-row td,.royalties-counter.sentence h6 {
            font-family: "Whitney SSm A","Whitney SSm B","Helvetica Neue",Helvetica,Arial,sans-serif;
            font-style: normal;
            font-weight: 700
        }

        .section-subtitle,.price-regular,.price-minimum,.price-highlight,#audience .vertical-tab-content-container h4,.price-hint {
            font-family: "Archer SSm A","Archer SSm B",Palatino,"Palatino Linotype","Hoefler Text",Times,"Times New Roman";
            font-style: normal;
            font-weight: 400
        }

        .book-title,.bundle-title,.book-title a,.bundle-title a,.ui-slider .ui-slider-value,.ui-slider .ui-slider-value input {
            font-family: "Archer SSm A","Archer SSm B",Palatino,"Palatino Linotype","Hoefler Text",Times,"Times New Roman";
            font-style: normal;
            font-weight: 500
        }

        .section-title,.guarantee-logo .pc,#quick-buy .book-title,#quick-buy .bundle-title,.book-details-list .detail>span,#author-hero .section-title,.kindle-settings .list li::before,.kindle-settings .detail-list li::before,.sliders-wrapper label,#library .view-header .view-title {
            font-family: "Archer SSm A","Archer SSm B",Palatino,"Palatino Linotype","Hoefler Text",Times,"Times New Roman";
            font-style: normal;
            font-weight: 600
        }

        header.navigation .nav-link a,.vertical-tabs-container .vertical-tab,.vertical-tabs-container .vertical-tab-accordion-heading,#try-leanpub .bullet-icon.free::before,#try-leanpub .bullet-icon.royalties::before,.bullets .bullet-content .video-title,.bullets h2 {
            font-family: "Archer SSm A","Archer SSm B",Palatino,"Palatino Linotype","Hoefler Text",Times,"Times New Roman";
            font-style: normal;
            font-weight: 700
        }

        .footer li:first-child {
            font-family: "Archer SSm A","Archer SSm B",Palatino,"Palatino Linotype","Hoefler Text",Times,"Times New Roman";
            font-style: normal;
            font-weight: 800
        }

        #why-leanpub .section-title,#how-to-leanpub .section-title {
            font-family: "Archer A","Archer B",Palatino,"Palatino Linotype","Hoefler Text",Times,"Times New Roman";
            font-style: normal;
            font-weight: 200
        }

        @font-face {
            font-family: "leanpub-glyphs";
            src: url(/assets/leanpub-glyphs-f6931d204dcb1907c2ece39e4b768f66.eot);
            src: url(/assets/leanpub-glyphs.eot?#iefix) format("embedded-opentype"),url(/assets/leanpub-glyphs-6e364bcdadcc8ef46f0c270b313464b9.woff) format("woff"),url(/assets/leanpub-glyphs-6e91f38ff8f8146218b83c28edf869ca.ttf) format("truetype"),url(/assets/leanpub-glyphs.svg#leanpub-glyphs) format("svg");
            font-weight: normal;
            font-style: normal
        }

        @media screen and (-webkit-min-device-pixel-ratio: 0) {
            @font-face {
                font-family: "leanpub-glyphs";
                src: url(/assets/leanpub-glyphs.svg#leanpub-glyphs) format("svg")
            }
        }

        .guarantee-logo::after,.vertical-tabs-container .vertical-tab-accordion-heading.is-active::after,.vertical-tabs-container .vertical-tab-accordion-heading::after,.vertical-tabs-container .vertical-tab::after,#help .js-vertical-tab::after,#books-getting-started .js-vertical-tab::after,#homepage-essay .continue a::after,.pdf-format-icon::before,.title-logo::before,.screenshot::before,.epub-format-icon::after,.epub-format-icon::before,.mobi-format-icon::before,.package-zip .zip-format-icon::before {
            font-family: "leanpub-glyphs";
            font-style: normal;
            font-weight: normal;
            font-variant: normal
        }

        .guarantee-logo::after {
            content: "\f11f"
        }

        .vertical-tabs-container .vertical-tab-accordion-heading.is-active::after {
            content: "\f120"
        }

        .vertical-tabs-container .vertical-tab-accordion-heading::after {
            content: "\f121"
        }

        .vertical-tabs-container .vertical-tab::after,#help .js-vertical-tab::after,#books-getting-started .js-vertical-tab::after,#homepage-essay .continue a::after {
            content: "\f122"
        }

        .pdf-format-icon::before {
            content: "\f10f"
        }

        .title-logo::before {
            content: "\f11b"
        }

        .screenshot::before {
            content: "\f117"
        }

        .epub-format-icon::after {
            content: "\f11e"
        }

        .epub-format-icon::before,.mobi-format-icon::before {
            content: "\f119"
        }

        .package-zip .zip-format-icon::before {
            content: "\f125"
        }

        .title-logo,.guarantee-logo,.pdf-format-icon,.epub-format-icon,.mobi-format-icon,.screenshot::before,.vertical-tabs-container .vertical-tab,.vertical-tabs-container .vertical-tab-accordion-heading,.vertical-tabs-container .vertical-tab-accordion-heading.is-active,#help .js-vertical-tab,#books-getting-started .js-vertical-tab,#homepage-essay .continue a,.package-zip .zip-format-icon {
            line-height: 1;
            text-decoration: inherit;
            text-transform: none;
            -moz-osx-font-smoothing: grayscale;
            -webkit-font-smoothing: antialiased
        }

        .title-logo:link,.guarantee-logo:link,.pdf-format-icon:link,.epub-format-icon:link,.mobi-format-icon:link,.screenshot:link::before,.vertical-tabs-container .vertical-tab:link,.vertical-tabs-container .vertical-tab-accordion-heading:link,#help .js-vertical-tab:link,#books-getting-started .js-vertical-tab:link,#homepage-essay .continue a:link,.package-zip .zip-format-icon:link {
            text-decoration: none
        }

        .title-logo:visited,.guarantee-logo:visited,.pdf-format-icon:visited,.epub-format-icon:visited,.mobi-format-icon:visited,.screenshot:visited::before,.vertical-tabs-container .vertical-tab:visited,.vertical-tabs-container .vertical-tab-accordion-heading:visited,#help .js-vertical-tab:visited,#books-getting-started .js-vertical-tab:visited,#homepage-essay .continue a:visited,.package-zip .zip-format-icon:visited {
            color: inherit
        }

        #help .js-vertical-tab::after,#books-getting-started .js-vertical-tab::after {
            height: 18px;
            width: 18px;
            font-size: 16px;
            line-height: 18px;
            vertical-align: middle;
            margin-left: 1px;
            margin-right: 1px;
            text-align: center;
            color: inherit
        }

        .vertical-tabs-container .vertical-tab::after {
            height: 24px;
            width: 24px;
            font-size: 22px;
            line-height: 24px;
            vertical-align: middle;
            margin-left: 1px;
            margin-right: 1px;
            text-align: center;
            color: inherit
        }

        .pdf-format-icon::before,.epub-format-icon::before,.epub-format-icon::after,.mobi-format-icon::before {
            height: 25px;
            width: 25px;
            font-size: 23px;
            line-height: 25px;
            vertical-align: middle;
            margin-left: 1px;
            margin-right: 1px;
            text-align: center;
            color: inherit
        }

        #homepage-essay .continue a::after {
            height: 32px;
            width: 32px;
            font-size: 30px;
            line-height: 32px;
            vertical-align: middle;
            margin-left: 1px;
            margin-right: 1px;
            text-align: center;
            color: inherit
        }

        .vertical-tabs-container .vertical-tab-accordion-heading::after,.vertical-tabs-container .vertical-tab-accordion-heading.is-active::after,.package-zip .zip-format-icon::before {
            height: 48px;
            width: 48px;
            font-size: 46px;
            line-height: 48px;
            vertical-align: middle;
            margin-left: 1px;
            margin-right: 1px;
            text-align: center;
            color: inherit
        }

        .screenshot::before {
            height: 50px;
            width: 50px;
            font-size: 48px;
            line-height: 50px;
            vertical-align: middle;
            margin-left: 1px;
            margin-right: 1px;
            text-align: center;
            color: inherit
        }

        .guarantee-logo::after {
            height: 75px;
            width: 75px;
            font-size: 73px;
            line-height: 75px;
            vertical-align: middle;
            margin-left: 1px;
            margin-right: 1px;
            text-align: center;
            color: inherit
        }

        .title-logo::before {
            height: 100px;
            width: 100px;
            font-size: 98px;
            line-height: 100px;
            vertical-align: middle;
            margin-left: 1px;
            margin-right: 1px;
            text-align: center;
            color: inherit
        }

        #upsell #bestsellers-books,#testimonials,#home-index #bestsellers-bundles {
            box-shadow: inset 0 7px 40px -20px rgba(0,0,0,0.4)
        }

        #featured-podcast,.recommended-books {
            box-shadow: inset 0 -7px 40px -20px rgba(0,0,0,0.4)
        }

        #royalties-explained,#about-leanpub,#thank-you {
            box-shadow: inset 0 7px 40px -20px rgba(0,0,0,0.4),inset 0 -7px 40px -20px rgba(0,0,0,0.4)
        }

        #why-leanpub,.featured-book {
            box-shadow: 0 -7px 40px -20px rgba(0,0,0,0.4)
        }

        #how-leanpub-works,#book-categories,.royalties-counter.concise {
            box-shadow: 0 7px 40px -20px rgba(0,0,0,0.4)
        }

        #error-message,#user-books,#user-unpublished,#author-hero,#try-leanpub,#try-publisher,#publisher-videos,#publishers-fine-print {
            box-shadow: 0 7px 40px -20px rgba(0,0,0,0.4),0 -7px 40px -20px rgba(0,0,0,0.4)
        }

        .cover-image img,.cover-image .cover-missing,.cover-image .cover-more,.cover-image .cover-browse,.cover-image.pseudo-cover {
            position: relative;
            box-shadow: 0 2px 3px rgba(0,0,0,0.33)
        }

        .floating-panel,#sign-in article>section:nth-child(2),.royalties-table-wrapper,#quick-buy,#book-box,.modal .modal-inner,#bookstore-navigation,.accordion-tabs-minimal+.tab-content,#home-hero,#details-panel,.thank-you-book .book .preview img,.thank-you-book .bundle .preview img,.thank-you-bundle .book .preview img,.thank-you-bundle .bundle .preview img {
            position: relative;
            box-shadow: 0 0 15px rgba(0,0,0,0.1)
        }

        .anchor-target,#homepage-essay .logo {
            border: 0;
            font: 0/0 a;
            text-shadow: none;
            color: transparent
        }

        .search-and-submit button[type=submit].search-submit,.guarantee-logo::after,.pdf-format-icon::before,.epub-format-icon::before,.epub-format-icon::after,.mobi-format-icon::before,.vertical-tabs-container .vertical-tab-content-container::before,.vertical-tabs-container .vertical-tab-accordion-heading::after,.spinner,.spinner::before {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            margin: auto
        }

        .share-links,#details-panel .details-action-list {
            text-align: center
        }

        .share-links li,#details-panel .details-action-list li {
            text-align: inherit;
            display: inline-block;
            list-style-type: none;
            margin-right: 1em
        }

        .share-links li:last-child,#details-panel .details-action-list li:last-child {
            margin-right: 0
        }

        button[type="submit"],button.submit,button.sign-in,input[type="submit"],input[type="submit"].submit,input[type="submit"].sign-in,input[type="button"][type="submit"],input[type="button"].submit,input[type="button"].sign-in,button.danger,input[type="submit"].danger,input[type="button"].danger,button.wishlist,input[type="submit"].wishlist,input[type="button"].wishlist,button.generic,input[type="submit"].generic,input[type="button"].generic,#mailchimp-subscribe-button,#mailchimp-subscribe-authors-button,#copy-button,#mailchimp-unsubscribe-button,#mailchimp-unsubscribe-authors-button,.pseudo-button.submit,.search-and-submit input[type=search],.trimmed+.show-more,a:not(.ui-slider-handle),.sign-up,.buy-now,.add-to-cart,.add-to-cart-modal,.payment-method,.cancel,.submit,.danger,.generic,.wishlist,.twitter>a,.book-edit-link,.sign-in,.avatar-and-name a,.more,ol.list li a,ol.detail-list li a,ul.list li a,ul.detail-list li a,.book-list-wrapper .view-all,.bundle-list-wrapper .view-all,.book-author a,.author-profile .profile-name a,.contributor-profile .profile-name a,.publisher-profile .profile-name a,.user-profile .profile-name a,.cause-profile .profile-name a,.bundles-authors a,.byline a,.book-titles>p a,.twitter-icon,.google-plus-icon,.github-icon,.facebook-icon,.book-list-item:hover .list-item-overview,.edit-book-list-item:hover .list-item-overview,.bundle-list-item:hover .list-item-overview,#book-list.cover-view .book-list-item:hover .list-item-overview,.list-controls .owl-prev,.list-controls .owl-next,.cover-image.pseudo-cover,.tooltip-item.more-info,.modal .modal-close::before,#dashboard .dashboard,#intro-video .modal-open::after,#book-list .book-list-item .cover-image img,#book-list .book-list-item .list-item-title,#book-list .book-list-item .list-item-author,#share-email .share-option .btn {
            -webkit-transition: all,0.25s,ease-in-out;
            -moz-transition: all,0.25s,ease-in-out;
            transition: all,0.25s,ease-in-out
        }

        html.js .show_if_logged_in,html.js .show_if_logged_out,html.js .hide_if_logged_in,html.js .hide_if_logged_out {
            display: none
        }

        #app-wrapper .form-title {
            margin-bottom: 1em;
            font-weight: 600;
            font-style: normal;
            font-size: 28px;
            line-height: normal
        }

        #app-wrapper .form-title i {
            margin-right: 10px;
            font-size: 24px
        }

        #app-wrapper .form-title span {
            font-size: 16px
        }

        .avatar,.avatar-and-name {
            position: relative
        }

        .avatar a,.avatar-and-name a {
            display: block
        }

        .avatar img,.avatar-and-name img {
            display: block;
            padding: 0;
            margin: auto;
            height: auto;
            overflow: hidden;
            background-color: #fff
        }

        .avatar.full img,.full.avatar-and-name img {
            max-height: 150px;
            width: 150px;
            border-radius: 75px
        }

        .avatar.medium img,.medium.avatar-and-name img {
            max-height: 100px;
            width: 100px;
            border-radius: 50px
        }

        .avatar.small img,.small.avatar-and-name img {
            max-height: 75px;
            width: 75px;
            border-radius: 37.5px
        }

        .avatar.tiny img,.tiny.avatar-and-name img {
            max-height: 32px;
            width: 32px;
            border-radius: 16px
        }

        .avatar-and-name a {
            display: inline-block;
            height: 32px;
            line-height: 32px
        }

        .avatar-and-name img {
            display: inline-block;
            margin-right: .8125em;
            vertical-align: bottom
        }

        button,input[type="submit"],input[type="button"],#mailchimp-subscribe-button,#mailchimp-subscribe-authors-button,#copy-button,#mailchimp-unsubscribe-button,#mailchimp-unsubscribe-authors-button,.pseudo-button {
            -webkit-appearance: none;
            -moz-appearance: none;
            -ms-appearance: none;
            -o-appearance: none;
            appearance: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        button,input[type="submit"],input[type="button"] {
            font-size: 1em
        }

        button[type="submit"],button.submit,button.sign-in,input[type="submit"][type="submit"],input[type="submit"].submit,input[type="submit"].sign-in,input[type="button"][type="submit"],input[type="button"].submit,input[type="button"].sign-in {
            background-color: #009aff;
            border-bottom: 1px solid #006cb3;
            text-shadow: 0 1px 0 #006cb3
        }

        button[type="submit"]:hover,button.submit:hover,button.sign-in:hover,input[type="submit"][type="submit"]:hover,input[type="submit"].submit:hover,input[type="submit"].sign-in:hover,input[type="button"][type="submit"]:hover,input[type="button"].submit:hover,input[type="button"].sign-in:hover {
            background-color: #006cb3;
            border-bottom: 1px solid #005c99
        }

        button.danger,input[type="submit"].danger,input[type="button"].danger {
            background-color: #ff4100;
            border-bottom: 1px solid #b32d00;
            text-shadow: 0 1px 0 #b32d00
        }

        button.danger:hover,input[type="submit"].danger:hover,input[type="button"].danger:hover {
            background-color: #b32d00;
            border-bottom: 1px solid #992700
        }

        button.wishlist,input[type="submit"].wishlist,input[type="button"].wishlist {
            background-color: #ffc72a;
            border-bottom: 1px solid #dda300;
            text-shadow: 0 1px 0 #dda300
        }

        button.wishlist:hover,input[type="submit"].wishlist:hover,input[type="button"].wishlist:hover {
            background-color: #dda300;
            border-bottom: 1px solid #c39000
        }

        button.generic,input[type="submit"].generic,input[type="button"].generic {
            background-color: #999;
            border-bottom: 1px solid #737373;
            text-shadow: 0 1px 0 #737373
        }

        button.generic:hover,input[type="submit"].generic:hover,input[type="button"].generic:hover {
            background-color: #737373;
            border-bottom: 1px solid #666
        }

        #wishlist_button_own,#wishlist_button_in,#wishlist_button_add {
            display: none
        }

        #mailchimp-subscribe-button,#mailchimp-subscribe-authors-button,#copy-button {
            background-color: #009aff;
            border-bottom: 1px solid #006cb3;
            text-shadow: 0 1px 0 #006cb3
        }

        #mailchimp-subscribe-button:hover,#mailchimp-subscribe-authors-button:hover,#copy-button:hover {
            background-color: #006cb3;
            border-bottom: 1px solid #005c99
        }

        #mailchimp-unsubscribe-button,#mailchimp-unsubscribe-authors-button {
            background-color: #999;
            border-bottom: 1px solid #737373;
            text-shadow: 0 1px 0 #737373
        }

        #mailchimp-unsubscribe-button:hover,#mailchimp-unsubscribe-authors-button:hover {
            background-color: #737373;
            border-bottom: 1px solid #666
        }

        .button-group input {
            display: none
        }

        .button-group label {
            margin-bottom: 0
        }

        @media screen and (min-width: 53.75em) {
            .button-group label {
                float:left
            }
        }

        .button-group label .button-group-item {
            background: #fbfbfb;
            border-left: 1px solid silver;
            border-radius: 0;
            border-right: 1px solid silver;
            color: #7f7f7f;
            cursor: pointer;
            display: inline-block;
            font-size: 1em;
            font-weight: normal;
            line-height: 1;
            padding: .75em 1em;
            width: 100%
        }

        @media screen and (min-width: 53.75em) {
            .button-group label .button-group-item {
                border-bottom:1px solid silver;
                border-left: 0;
                border-right: 1px solid #eee;
                border-top: 1px solid silver;
                width: auto
            }
        }

        .button-group label .button-group-item:hover {
            background-color: #f3f3f3
        }

        .button-group label .is-active {
            color: #fff;
            background: #009aff
        }

        .button-group label:first-child .button-group-item {
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
            border-top: 1px solid silver
        }

        @media screen and (min-width: 53.75em) {
            .button-group label:first-child .button-group-item {
                border-bottom-left-radius:4px;
                border-left: 1px solid silver;
                border-top-left-radius: 4px;
                border-top-right-radius: 0
            }
        }

        .button-group label:last-child .button-group-item {
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
            border-bottom: 1px solid silver
        }

        @media screen and (min-width: 53.75em) {
            .button-group label:last-child .button-group-item {
                border-bottom-left-radius:0;
                border-bottom-right-radius: 4px;
                border-right: 1px solid silver;
                border-top-right-radius: 4px
            }
        }

        .button-group label input:checked+.button-group-item {
            background: #009aff;
            border: 1px solid #006cb3;
            box-shadow: inset 0 1px 2px #007bcc;
            color: #fff
        }

        .pseudo-button.generic {
            background-color: #999;
            border-bottom: 1px solid #737373;
            text-shadow: 0 1px 0 #737373
        }

        .pseudo-button.submit {
            background-color: #009aff;
            border-bottom: 1px solid #006cb3;
            text-shadow: 0 1px 0 #006cb3
        }

        .pseudo-button.submit:hover {
            background-color: #006cb3;
            border-bottom: 1px solid #005c99
        }

        .force-wrap {
            word-wrap: break-word;
            overflow-wrap: break-word;
            word-break: break-all
        }

        .all-caps {
            text-transform: uppercase
        }

        .underline {
            text-decoration: underline
        }

        .bold {
            font-weight: 500
        }

        .section-title {
            margin-bottom: 1.25em;
            font-size: 2.25em;
            text-align: center;
            color: #323232
        }

        @media screen and (min-width: 53.75em) {
            .section-title {
                font-size:2.125em
            }
        }

        .section-subtitle {
            margin-bottom: 1em;
            text-align: center;
            font-size: 1.25em;
            color: #009aff
        }

        @media screen and (min-width: 53.75em) {
            .section-subtitle {
                font-size:2.25em
            }
        }

        .copy,.vertical-tabs-container .vertical-tab-content {
            padding: 2.35765%;
            text-align: left
        }

        .copy p,.vertical-tabs-container .vertical-tab-content p {
            line-height: 1.5em;
            font-size: .875em
        }

        @media screen and (min-width: 53.75em) {
            .copy p,.vertical-tabs-container .vertical-tab-content p {
                font-size:1.125em
            }
        }

        .cms-content h1,.book-list-item .list-item-description h1,.edit-book-list-item .list-item-description h1,.bundle-list-item .list-item-description h1,#book-list.cover-view .book-list-item .list-item-description h1,.author-profile .profile-blurb h1,.contributor-profile .profile-blurb h1,.publisher-profile .profile-blurb h1,.user-profile .profile-blurb h1,.cause-profile .profile-blurb h1,.book-description h1,.bundle-description h1,.cms-content h2,.book-list-item .list-item-description h2,.edit-book-list-item .list-item-description h2,.bundle-list-item .list-item-description h2,#book-list.cover-view .book-list-item .list-item-description h2,.author-profile .profile-blurb h2,.contributor-profile .profile-blurb h2,.publisher-profile .profile-blurb h2,.user-profile .profile-blurb h2,.cause-profile .profile-blurb h2,.book-description h2,.bundle-description h2,.cms-content h3,.book-list-item .list-item-description h3,.edit-book-list-item .list-item-description h3,.bundle-list-item .list-item-description h3,#book-list.cover-view .book-list-item .list-item-description h3,.author-profile .profile-blurb h3,.contributor-profile .profile-blurb h3,.publisher-profile .profile-blurb h3,.user-profile .profile-blurb h3,.cause-profile .profile-blurb h3,.book-description h3,.bundle-description h3,.cms-content h4,.book-list-item .list-item-description h4,.edit-book-list-item .list-item-description h4,.bundle-list-item .list-item-description h4,#book-list.cover-view .book-list-item .list-item-description h4,.author-profile .profile-blurb h4,.contributor-profile .profile-blurb h4,.publisher-profile .profile-blurb h4,.user-profile .profile-blurb h4,.cause-profile .profile-blurb h4,.book-description h4,.bundle-description h4,.cms-content h5,.book-list-item .list-item-description h5,.edit-book-list-item .list-item-description h5,.bundle-list-item .list-item-description h5,#book-list.cover-view .book-list-item .list-item-description h5,.author-profile .profile-blurb h5,.contributor-profile .profile-blurb h5,.publisher-profile .profile-blurb h5,.user-profile .profile-blurb h5,.cause-profile .profile-blurb h5,.book-description h5,.bundle-description h5,.cms-content h6,.book-list-item .list-item-description h6,.edit-book-list-item .list-item-description h6,.bundle-list-item .list-item-description h6,#book-list.cover-view .book-list-item .list-item-description h6,.author-profile .profile-blurb h6,.contributor-profile .profile-blurb h6,.publisher-profile .profile-blurb h6,.user-profile .profile-blurb h6,.cause-profile .profile-blurb h6,.book-description h6,.bundle-description h6 {
            margin-bottom: .875em;
            font-family: "Archer SSm A","Archer SSm B";
            color: #323232;
            text-transform: none
        }

        .cms-content h1,.book-list-item .list-item-description h1,.edit-book-list-item .list-item-description h1,.bundle-list-item .list-item-description h1,#book-list.cover-view .book-list-item .list-item-description h1,.author-profile .profile-blurb h1,.contributor-profile .profile-blurb h1,.publisher-profile .profile-blurb h1,.user-profile .profile-blurb h1,.cause-profile .profile-blurb h1,.book-description h1,.bundle-description h1 {
            font-size: 1.25em
        }

        .cms-content h2,.book-list-item .list-item-description h2,.edit-book-list-item .list-item-description h2,.bundle-list-item .list-item-description h2,#book-list.cover-view .book-list-item .list-item-description h2,.author-profile .profile-blurb h2,.contributor-profile .profile-blurb h2,.publisher-profile .profile-blurb h2,.user-profile .profile-blurb h2,.cause-profile .profile-blurb h2,.book-description h2,.bundle-description h2 {
            font-size: 1.1875em
        }

        .cms-content h3,.book-list-item .list-item-description h3,.edit-book-list-item .list-item-description h3,.bundle-list-item .list-item-description h3,#book-list.cover-view .book-list-item .list-item-description h3,.author-profile .profile-blurb h3,.contributor-profile .profile-blurb h3,.publisher-profile .profile-blurb h3,.user-profile .profile-blurb h3,.cause-profile .profile-blurb h3,.book-description h3,.bundle-description h3 {
            font-size: 1.375em
        }

        .cms-content h4,.book-list-item .list-item-description h4,.edit-book-list-item .list-item-description h4,.bundle-list-item .list-item-description h4,#book-list.cover-view .book-list-item .list-item-description h4,.author-profile .profile-blurb h4,.contributor-profile .profile-blurb h4,.publisher-profile .profile-blurb h4,.user-profile .profile-blurb h4,.cause-profile .profile-blurb h4,.book-description h4,.bundle-description h4 {
            font-size: 1.25em
        }

        .cms-content h5,.book-list-item .list-item-description h5,.edit-book-list-item .list-item-description h5,.bundle-list-item .list-item-description h5,#book-list.cover-view .book-list-item .list-item-description h5,.author-profile .profile-blurb h5,.contributor-profile .profile-blurb h5,.publisher-profile .profile-blurb h5,.user-profile .profile-blurb h5,.cause-profile .profile-blurb h5,.book-description h5,.bundle-description h5 {
            font-size: 1.1875em
        }

        .cms-content h6,.book-list-item .list-item-description h6,.edit-book-list-item .list-item-description h6,.bundle-list-item .list-item-description h6,#book-list.cover-view .book-list-item .list-item-description h6,.author-profile .profile-blurb h6,.contributor-profile .profile-blurb h6,.publisher-profile .profile-blurb h6,.user-profile .profile-blurb h6,.cause-profile .profile-blurb h6,.book-description h6,.bundle-description h6 {
            font-size: 0.9375em
        }

        .cms-content em,.book-list-item .list-item-description em,.edit-book-list-item .list-item-description em,.bundle-list-item .list-item-description em,#book-list.cover-view .book-list-item .list-item-description em,.author-profile .profile-blurb em,.contributor-profile .profile-blurb em,.publisher-profile .profile-blurb em,.user-profile .profile-blurb em,.cause-profile .profile-blurb em,.book-description em,.bundle-description em {
            font-style: italic
        }

        .cms-content p,.book-list-item .list-item-description p,.edit-book-list-item .list-item-description p,.bundle-list-item .list-item-description p,#book-list.cover-view .book-list-item .list-item-description p,.author-profile .profile-blurb p,.contributor-profile .profile-blurb p,.publisher-profile .profile-blurb p,.user-profile .profile-blurb p,.cause-profile .profile-blurb p,.book-description p,.bundle-description p {
            line-height: 1.5;
            margin-bottom: .625em
        }

        .cms-content a:hover,.book-list-item .list-item-description a:hover,.edit-book-list-item .list-item-description a:hover,.bundle-list-item .list-item-description a:hover,#book-list.cover-view .book-list-item .list-item-description a:hover,.author-profile .profile-blurb a:hover,.contributor-profile .profile-blurb a:hover,.publisher-profile .profile-blurb a:hover,.user-profile .profile-blurb a:hover,.cause-profile .profile-blurb a:hover,.book-description a:hover,.bundle-description a:hover {
            text-decoration: underline
        }

        .cms-content ol,.book-list-item .list-item-description ol,.edit-book-list-item .list-item-description ol,.bundle-list-item .list-item-description ol,#book-list.cover-view .book-list-item .list-item-description ol,.author-profile .profile-blurb ol,.contributor-profile .profile-blurb ol,.publisher-profile .profile-blurb ol,.user-profile .profile-blurb ol,.cause-profile .profile-blurb ol,.book-description ol,.bundle-description ol,.cms-content ul,.book-list-item .list-item-description ul,.edit-book-list-item .list-item-description ul,.bundle-list-item .list-item-description ul,#book-list.cover-view .book-list-item .list-item-description ul,.author-profile .profile-blurb ul,.contributor-profile .profile-blurb ul,.publisher-profile .profile-blurb ul,.user-profile .profile-blurb ul,.cause-profile .profile-blurb ul,.book-description ul,.bundle-description ul {
            padding-left: 1em
        }

        .cms-content ol li,.book-list-item .list-item-description ol li,.edit-book-list-item .list-item-description ol li,.bundle-list-item .list-item-description ol li,#book-list.cover-view .book-list-item .list-item-description ol li,.author-profile .profile-blurb ol li,.contributor-profile .profile-blurb ol li,.publisher-profile .profile-blurb ol li,.user-profile .profile-blurb ol li,.cause-profile .profile-blurb ol li,.book-description ol li,.bundle-description ol li,.cms-content ul li,.book-list-item .list-item-description ul li,.edit-book-list-item .list-item-description ul li,.bundle-list-item .list-item-description ul li,#book-list.cover-view .book-list-item .list-item-description ul li,.author-profile .profile-blurb ul li,.contributor-profile .profile-blurb ul li,.publisher-profile .profile-blurb ul li,.user-profile .profile-blurb ul li,.cause-profile .profile-blurb ul li,.book-description ul li,.bundle-description ul li {
            margin-bottom: 1em;
            line-height: 1.5
        }

        .cms-content ol li p,.book-list-item .list-item-description ol li p,.edit-book-list-item .list-item-description ol li p,.bundle-list-item .list-item-description ol li p,#book-list.cover-view .book-list-item .list-item-description ol li p,.author-profile .profile-blurb ol li p,.contributor-profile .profile-blurb ol li p,.publisher-profile .profile-blurb ol li p,.user-profile .profile-blurb ol li p,.cause-profile .profile-blurb ol li p,.book-description ol li p,.bundle-description ol li p,.cms-content ul li p,.book-list-item .list-item-description ul li p,.edit-book-list-item .list-item-description ul li p,.bundle-list-item .list-item-description ul li p,#book-list.cover-view .book-list-item .list-item-description ul li p,.author-profile .profile-blurb ul li p,.contributor-profile .profile-blurb ul li p,.publisher-profile .profile-blurb ul li p,.user-profile .profile-blurb ul li p,.cause-profile .profile-blurb ul li p,.book-description ul li p,.bundle-description ul li p {
            display: inline
        }

        .cms-content ol li::before,.book-list-item .list-item-description ol li::before,.edit-book-list-item .list-item-description ol li::before,.bundle-list-item .list-item-description ol li::before,#book-list.cover-view .book-list-item .list-item-description ol li::before,.author-profile .profile-blurb ol li::before,.contributor-profile .profile-blurb ol li::before,.publisher-profile .profile-blurb ol li::before,.user-profile .profile-blurb ol li::before,.cause-profile .profile-blurb ol li::before,.book-description ol li::before,.bundle-description ol li::before,.cms-content ul li::before,.book-list-item .list-item-description ul li::before,.edit-book-list-item .list-item-description ul li::before,.bundle-list-item .list-item-description ul li::before,#book-list.cover-view .book-list-item .list-item-description ul li::before,.author-profile .profile-blurb ul li::before,.contributor-profile .profile-blurb ul li::before,.publisher-profile .profile-blurb ul li::before,.user-profile .profile-blurb ul li::before,.cause-profile .profile-blurb ul li::before,.book-description ul li::before,.bundle-description ul li::before {
            color: #666;
            margin-right: 0.75em
        }

        .cms-content ul li::before,.book-list-item .list-item-description ul li::before,.edit-book-list-item .list-item-description ul li::before,.bundle-list-item .list-item-description ul li::before,#book-list.cover-view .book-list-item .list-item-description ul li::before,.author-profile .profile-blurb ul li::before,.contributor-profile .profile-blurb ul li::before,.publisher-profile .profile-blurb ul li::before,.user-profile .profile-blurb ul li::before,.cause-profile .profile-blurb ul li::before,.book-description ul li::before,.bundle-description ul li::before {
            font-family: FontAwesome;
            content: "\f105"
        }

        .cms-content ol,.book-list-item .list-item-description ol,.edit-book-list-item .list-item-description ol,.bundle-list-item .list-item-description ol,#book-list.cover-view .book-list-item .list-item-description ol,.author-profile .profile-blurb ol,.contributor-profile .profile-blurb ol,.publisher-profile .profile-blurb ol,.user-profile .profile-blurb ol,.cause-profile .profile-blurb ol,.book-description ol,.bundle-description ol {
            margin-left: 1em
        }

        .cms-content ol,.book-list-item .list-item-description ol,.edit-book-list-item .list-item-description ol,.bundle-list-item .list-item-description ol,#book-list.cover-view .book-list-item .list-item-description ol,.author-profile .profile-blurb ol,.contributor-profile .profile-blurb ol,.publisher-profile .profile-blurb ol,.user-profile .profile-blurb ol,.cause-profile .profile-blurb ol,.book-description ol,.bundle-description ol,.cms-content ol li,.book-list-item .list-item-description ol li,.edit-book-list-item .list-item-description ol li,.bundle-list-item .list-item-description ol li,#book-list.cover-view .book-list-item .list-item-description ol li,.author-profile .profile-blurb ol li,.contributor-profile .profile-blurb ol li,.publisher-profile .profile-blurb ol li,.user-profile .profile-blurb ol li,.cause-profile .profile-blurb ol li,.book-description ol li,.bundle-description ol li {
            list-style: decimal
        }

        @media screen and (min-width: 40em) {
            .cms-content h1,.book-list-item .list-item-description h1,.edit-book-list-item .list-item-description h1,.bundle-list-item .list-item-description h1,#book-list.cover-view .book-list-item .list-item-description h1,.author-profile .profile-blurb h1,.contributor-profile .profile-blurb h1,.publisher-profile .profile-blurb h1,.user-profile .profile-blurb h1,.cause-profile .profile-blurb h1,.book-description h1,.bundle-description h1 {
                font-size:1em
            }

            .cms-content h2,.book-list-item .list-item-description h2,.edit-book-list-item .list-item-description h2,.bundle-list-item .list-item-description h2,#book-list.cover-view .book-list-item .list-item-description h2,.author-profile .profile-blurb h2,.contributor-profile .profile-blurb h2,.publisher-profile .profile-blurb h2,.user-profile .profile-blurb h2,.cause-profile .profile-blurb h2,.book-description h2,.bundle-description h2 {
                font-size: 0.9375em
            }

            .cms-content h3,.book-list-item .list-item-description h3,.edit-book-list-item .list-item-description h3,.bundle-list-item .list-item-description h3,#book-list.cover-view .book-list-item .list-item-description h3,.author-profile .profile-blurb h3,.contributor-profile .profile-blurb h3,.publisher-profile .profile-blurb h3,.user-profile .profile-blurb h3,.cause-profile .profile-blurb h3,.book-description h3,.bundle-description h3 {
                font-size: 1.125em
            }

            .cms-content h4,.book-list-item .list-item-description h4,.edit-book-list-item .list-item-description h4,.bundle-list-item .list-item-description h4,#book-list.cover-view .book-list-item .list-item-description h4,.author-profile .profile-blurb h4,.contributor-profile .profile-blurb h4,.publisher-profile .profile-blurb h4,.user-profile .profile-blurb h4,.cause-profile .profile-blurb h4,.book-description h4,.bundle-description h4 {
                font-size: 1em
            }

            .cms-content h5,.book-list-item .list-item-description h5,.edit-book-list-item .list-item-description h5,.bundle-list-item .list-item-description h5,#book-list.cover-view .book-list-item .list-item-description h5,.author-profile .profile-blurb h5,.contributor-profile .profile-blurb h5,.publisher-profile .profile-blurb h5,.user-profile .profile-blurb h5,.cause-profile .profile-blurb h5,.book-description h5,.bundle-description h5 {
                font-size: 0.9375em
            }

            .cms-content h6,.book-list-item .list-item-description h6,.edit-book-list-item .list-item-description h6,.bundle-list-item .list-item-description h6,#book-list.cover-view .book-list-item .list-item-description h6,.author-profile .profile-blurb h6,.contributor-profile .profile-blurb h6,.publisher-profile .profile-blurb h6,.user-profile .profile-blurb h6,.cause-profile .profile-blurb h6,.book-description h6,.bundle-description h6 {
                font-size: 0.75em
            }
        }

        .tagline {
            margin-bottom: 2em
        }

        .tagline div {
            margin-bottom: 1.5em
        }

        #flash-prototype {
            display: none
        }

        .alert {
            padding: 1.25em 2.35765%;
            z-index: 100
        }

        .alert .flash-message {
            vertical-align: middle
        }

        .alert.alert-block {
            padding-right: 3em
        }

        .alert.non-flash {
            position: initial;
            width: auto
        }

        .alert .flash-close {
            position: absolute;
            top: 0.5em;
            right: 0.5em
        }

        .alert .flash-close::before {
            font-size: 1.25em;
            font-family: FontAwesome;
            content: "\f00d";
            line-height: 1
        }

        .alert .flash-close:hover {
            text-decoration: none
        }

        .alert .flash-message {
            max-width: 700px
        }

        form label {
            text-transform: uppercase;
            font-size: .8125em;
            margin-bottom: .625em;
            color: #666
        }

        .control-group {
            margin-bottom: 1em
        }

        .control-group.error .help-inline,.control-group.error .help-block,.control-group.error #details-panel .refund,#details-panel .control-group.error .refund {
            padding: 0 0.75em;
            font-weight: 500;
            color: #e13138
        }

        .control-group.error .help-inline::before,.control-group.error .help-block::before,.control-group.error #details-panel .refund::before,#details-panel .control-group.error .refund::before {
            content: "\f071";
            font-family: FontAwesome;
            margin-right: 4px
        }

        .controls {
            margin-bottom: 1.125em
        }

        table[role=presentation],.controls>input,.controls>textarea,.controls table,.input-prepend,.input-append {
            margin-bottom: 0.625em
        }

        .input-prepend,.input-append {
            position: relative;
            display: table;
            border-collapse: separate
        }

        .input-prepend .add-on,.input-append .add-on {
            position: relative;
            display: table-cell;
            background: #f5f5f5;
            border: 1px solid #cbcbcb;
            padding: 6px 12px;
            vertical-align: middle;
            color: #999
        }

        .input-prepend input,.input-prepend .add-on+span.input,.input-append input,.input-append .add-on+span.input {
            display: table-cell;
            padding: 0.5em 0.5em;
            margin: 0
        }

        .input-prepend .add-on {
            border-top-left-radius: 4px;
            border-bottom-left-radius: 4px;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
            border-right: 0
        }

        .input-prepend input,.input-prepend .add-on+span.input {
            border-top-right-radius: 4px;
            border-bottom-right-radius: 4px;
            border-top-left-radius: 0;
            border-bottom-left-radius: 0
        }

        .input-append .add-on {
            border-top-right-radius: 4px;
            border-bottom-right-radius: 4px;
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
            border-left: 0
        }

        .input-append input,.input-append .add-on+span.input {
            border-top-left-radius: 4px;
            border-bottom-left-radius: 4px;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0
        }

        .well,.type-system pre,#sign-up pre,#sign-in pre,article pre,#causes pre,.bundle-edit pre,#help article pre,#books-getting-started article pre,.manage-purchased-package pre,.redeem-purchased-package pre,#publisher article pre,#editors-new article pre,.cover-image.pseudo-cover {
            background: #f5f5f5;
            padding: 1em .75em;
            margin-bottom: .625em;
            border-radius: 4px;
            border: 1px solid #cbcbcb;
            color: #666
        }

        input[type=text].search-query {
            display: inline-block;
            background: #fff;
            padding: .4em .8em;
            border: 1px solid #cbcbcb;
            border-radius: 1.2em;
            margin: 5px 0;
            font-size: .8125em;
            color: #323232
        }

        .search-and-submit {
            position: relative
        }

        .search-and-submit input[type=search] {
            display: inline-block;
            background: #fff;
            padding: 0.375em 0.75em;
            border: 1px solid #cbcbcb;
            border-radius: 1.5em;
            margin: 5px 0;
            color: #323232
        }

        .search-and-submit input[type=search]:focus+.search-submit {
            color: #009aff
        }

        .search-and-submit button[type=submit].search-submit {
            left: auto;
            padding: 0;
            margin-right: .625em;
            width: 1.125em;
            background-color: transparent;
            outline: none;
            color: #cbcbcb;
            border: none;
            text-shadow: none;
            font-size: normal
        }

        .search-and-submit button[type=submit].search-submit .search-icon::before {
            font-family: FontAwesome;
            content: '\f002';
            font-size: 1.125em
        }

        input[type=radio] {
            cursor: pointer
        }

        .radio {
            cursor: pointer
        }

        .radio i::before {
            padding: 0 0.375em;
            color: #424242;
            vertical-align: middle;
            font-size: 1.5em
        }

        .help-block,#details-panel .refund {
            font-size: .8125em;
            color: #666
        }

        .validation_error_box {
            margin-bottom: 2em
        }

        .index-search-form {
            text-align: right
        }

        .index-search-form form {
            margin-bottom: 0
        }

        .index-search-form input {
            display: inline-block;
            font-size: 0.75em;
            padding: 0.75em
        }

        .index-search-form input[type="submit"] {
            margin-left: 1em;
            padding: 1em;
            float: right
        }

        .graph {
            padding: 0.75em,0;
            text-align: left
        }

        .graph h5 {
            margin-bottom: 0.75em
        }

        .line-graph path {
            stroke: #008be6
        }

        .line-graph circle {
            fill: #008be6
        }

        .hidden,.hide-until-ready,.paginate.book-list,.paginate.bundle-list {
            display: none
        }

        .no-vis {
            visibility: none
        }

        .trimmed {
            position: relative;
            overflow: hidden
        }

        .trimmed::after {
            content: '';
            height: 72px;
            position: absolute;
            right: 0px;
            bottom: 0px;
            left: 0px
        }

        .trimmed.expanded {
            max-height: none !important
        }

        .trimmed.expanded::after {
            visibility: hidden
        }

        .trimmed+.show-more {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            display: block;
            height: 1em;
            padding: 0 2.35765%;
            text-transform: uppercase;
            text-decoration: underline;
            text-align: right;
            font-size: .75em;
            line-height: 1;
            color: #000;
            cursor: pointer
        }

        .trimmed+.show-more:hover {
            color: #009aff
        }

        .clear-contents:after {
            content: "";
            display: table;
            clear: both
        }

        .justify-contents {
            text-align: justify
        }

        .justify-contents>* {
            display: inline-block
        }

        .justify-contents::after {
            content: '';
            width: 100%;
            display: inline-block
        }

        .left-contents {
            text-align: left
        }

        .left-contents>* {
            display: inline-block
        }

        .right-contents {
            text-align: right
        }

        .right-contents>* {
            display: inline-block
        }

        .center-contents {
            text-align: center
        }

        .center-contents>* {
            display: inline-block
        }

        .container,#contact article,#buzz article,#manifesto article,#affiliates article,#age-verification article,#gift-purchase article,#terms article,#request_refund article,#wishlist-container article,#sign-up article,#welcome article,#upsell article,.new-book article,.new-publisher-book article,#new-bundle article {
            max-width: 64em;
            margin-left: auto;
            margin-right: auto;
            padding: 0 1em
        }

        .container:after,#contact article:after,#buzz article:after,#manifesto article:after,#affiliates article:after,#age-verification article:after,#gift-purchase article:after,#terms article:after,#request_refund article:after,#wishlist-container article:after,#sign-up article:after,#welcome article:after,#upsell article:after,.new-book article:after,.new-publisher-book article:after,#new-bundle article:after {
            content: "";
            display: table;
            clear: both
        }

        .large-container,#app-container,#bookstore section {
            max-width: 64em;
            margin-left: auto;
            margin-right: auto;
            padding: 2.35765%;
            max-width: 80em
        }

        .large-container:after,#app-container:after,#bookstore section:after {
            content: "";
            display: table;
            clear: both
        }

        @media screen and (min-width: 53.75em) {
            .large-container,#app-container,#bookstore section {
                padding:0 1em
            }
        }

        .huge-container {
            max-width: 64em;
            margin-left: auto;
            margin-right: auto;
            padding: 2.35765%;
            max-width: 103.125em
        }

        .huge-container:after {
            content: "";
            display: table;
            clear: both
        }

        @media screen and (min-width: 53.75em) {
            .huge-container {
                padding:0 1em
            }
        }

        #error-message {
            background-color: #fff
        }

        #error-message .container,#error-message #contact article,#contact #error-message article,#error-message #buzz article,#buzz #error-message article,#error-message #manifesto article,#manifesto #error-message article,#error-message #affiliates article,#affiliates #error-message article,#error-message #age-verification article,#age-verification #error-message article,#error-message #gift-purchase article,#gift-purchase #error-message article,#error-message #terms article,#terms #error-message article,#error-message #request_refund article,#request_refund #error-message article,#error-message #wishlist-container article,#wishlist-container #error-message article,#error-message #sign-up article,#sign-up #error-message article,#error-message #welcome article,#welcome #error-message article,#error-message #upsell article,#upsell #error-message article,#error-message .new-book article,.new-book #error-message article,#error-message .new-publisher-book article,.new-publisher-book #error-message article,#error-message #new-bundle article,#new-bundle #error-message article {
            padding: 3em 2.35765%
        }

        #error-message .section-title {
            padding: 0
        }

        #error-message .error-message-body,#error-message .section-title {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 48.82117%;
            margin-left: 25.58941%;
            text-align: center
        }

        #error-message .error-message-body:last-child,#error-message .section-title:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 53.75em) {
            #error-message .error-message-body,#error-message .section-title {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 65.88078%;
                margin-left: 17.05961%
            }

            #error-message .error-message-body:last-child,#error-message .section-title:last-child {
                margin-right: 0
            }
        }

        #contact,#buzz,#manifesto,#affiliates,#age-verification,#gift-purchase,#terms,#request_refund,#wishlist-container,#sign-up,#welcome,#upsell,#contact_author,.new-book,.new-publisher-book,.cause-pane,.bundle-edit,.manage-purchased-package,.redeem-purchased-package,.user-deleted,#new-bundle {
            padding: 3em 2.35765%;
            background-color: #fff
        }

        #app-wrapper {
            background-color: #fff
        }

        #app-container {
            padding: 3em 2.35765%;
            background-color: #fff
        }

        #app-container:after {
            content: "";
            display: table;
            clear: both
        }

        #sidebar {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            margin-bottom: 3em
        }

        #sidebar:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 53.75em) {
            #sidebar {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 23.23176%
            }

            #sidebar:last-child {
                margin-right: 0
            }
        }

        #view {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            margin-right: 0;
            padding: 0 1em
        }

        #view:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 53.75em) {
            #view {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 74.41059%
            }

            #view:last-child {
                margin-right: 0
            }
        }

        .columns-1>* {
            width: 100%;
            margin-left: 0%
        }

        @media screen and (min-width: 53.75em) {
            .columns-1>* {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 65.88078%;
                margin-left: 17.05961%
            }

            .columns-1>*:last-child {
                margin-right: 0
            }
        }

        .columns-2>* {
            width: 100%
        }

        @media screen and (min-width: 53.75em) {
            .columns-2>* {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%
            }

            .columns-2>*:last-child {
                margin-right: 0
            }

            .columns-2>*:nth-child(2n) {
                margin-right: 0
            }

            .columns-2>*:nth-child(2n+1) {
                clear: left
            }
        }

        .columns-3>* {
            width: 100%
        }

        @media screen and (min-width: 40em) {
            .columns-3>* {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%
            }

            .columns-3>*:last-child {
                margin-right: 0
            }

            .columns-3>*:nth-child(2n) {
                margin-right: 0
            }

            .columns-3>*:nth-child(2n+1) {
                clear: left
            }
        }

        @media screen and (min-width: 53.75em) {
            .columns-3>* {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 31.76157%
            }

            .columns-3>*:last-child {
                margin-right: 0
            }

            .columns-3>*:nth-child(2n) {
                margin-right: 2.35765%
            }

            .columns-3>*:nth-child(2n+1) {
                clear: none
            }

            .columns-3>*:nth-child(3n) {
                margin-right: 0
            }

            .columns-3>*:nth-child(3n+1) {
                clear: left
            }
        }

        .columns-4>* {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 48.82117%
        }

        .columns-4>*:last-child {
            margin-right: 0
        }

        .columns-4>*:nth-child(2n) {
            margin-right: 0
        }

        .columns-4>*:nth-child(2n+1) {
            clear: left
        }

        @media screen and (min-width: 40em) {
            .columns-4>* {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 31.76157%
            }

            .columns-4>*:last-child {
                margin-right: 0
            }

            .columns-4>*:nth-child(2n) {
                margin-right: 2.35765%
            }

            .columns-4>*:nth-child(2n+1) {
                clear: none
            }

            .columns-4>*:nth-child(3n) {
                margin-right: 0
            }

            .columns-4>*:nth-child(3n+1) {
                clear: left
            }
        }

        @media screen and (min-width: 53.75em) {
            .columns-4>* {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 23.23176%
            }

            .columns-4>*:last-child {
                margin-right: 0
            }

            .columns-4>*:nth-child(3n) {
                margin-right: 2.35765%
            }

            .columns-4>*:nth-child(3n+1) {
                clear: none
            }

            .columns-4>*:nth-child(4n) {
                margin-right: 0
            }

            .columns-4>*:nth-child(4n+1) {
                clear: left
            }
        }

        .columns-5>* {
            float: left;
            display: block;
            margin-right: 5.85151%;
            width: 15.3188%
        }

        .columns-5>*:last-child {
            margin-right: 0
        }

        .columns-5>*:nth-child(5n) {
            margin-right: 0
        }

        .columns-5>*:nth-child(5n+1) {
            clear: left
        }

        .columns-6>* {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 48.82117%
        }

        .columns-6>*:last-child {
            margin-right: 0
        }

        .columns-6>*:nth-child(2n) {
            margin-right: 0
        }

        .columns-6>*:nth-child(2n+1) {
            clear: left
        }

        @media screen and (min-width: 40em) {
            .columns-6>* {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 23.23176%
            }

            .columns-6>*:last-child {
                margin-right: 0
            }

            .columns-6>*:nth-child(2n) {
                margin-right: 2.35765%
            }

            .columns-6>*:nth-child(2n+1) {
                clear: none
            }

            .columns-6>*:nth-child(4n) {
                margin-right: 0
            }

            .columns-6>*:nth-child(4n+1) {
                clear: left
            }
        }

        @media screen and (min-width: 53.75em) {
            .columns-6>* {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 14.70196%
            }

            .columns-6>*:last-child {
                margin-right: 0
            }

            .columns-6>*:nth-child(4n) {
                margin-right: 2.35765%
            }

            .columns-6>*:nth-child(4n+1) {
                clear: none
            }

            .columns-6>*:nth-child(6n) {
                margin-right: 0
            }

            .columns-6>*:nth-child(6n+1) {
                clear: left
            }
        }

        .floating-panel,#sign-in article>section:nth-child(2),.royalties-table-wrapper {
            background-color: #fff;
            border: 1px solid #cbcbcb;
            border-radius: 4px
        }

        .sign-up,.buy-now,.add-to-cart,.add-to-cart-modal,.payment-method,.cancel,.submit,.danger,.generic,.wishlist,.twitter>a,.book-edit-link,.sign-in {
            -webkit-appearance: none;
            -moz-appearance: none;
            -ms-appearance: none;
            -o-appearance: none;
            appearance: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-font-smoothing: antialiased;
            display: inline-block;
            box-sizing: border-box;
            border: none;
            font-size: 1em;
            line-height: 1;
            text-decoration: none;
            text-align: center;
            cursor: pointer;
            vertical-align: middle;
            white-space: nowrap
        }

        .disabled.sign-up,.disabled.buy-now,.disabled.add-to-cart,.disabled.add-to-cart-modal,.disabled.payment-method,.disabled.cancel,.disabled.submit,.disabled.danger,.disabled.generic,.disabled.wishlist,.twitter>a.disabled,.disabled.book-edit-link,.disabled.sign-in {
            cursor: not-allowed;
            opacity: 0.5
        }

        .sign-up,.buy-now,.add-to-cart,.add-to-cart-modal,.payment-method,.cancel,.submit,.danger,.generic,.wishlist,.twitter>a,.book-edit-link {
            padding: .5em 1.25em;
            border-radius: 4px
        }

        .sign-up:hover,.buy-now:hover,.add-to-cart:hover,.add-to-cart-modal:hover,.payment-method:hover,.cancel:hover,.submit:hover,.danger:hover,.generic:hover,.wishlist:hover,.twitter>a:hover,.book-edit-link:hover,.sign-up:visited,.buy-now:visited,.add-to-cart:visited,.add-to-cart-modal:visited,.payment-method:visited,.cancel:visited,.submit:visited,.danger:visited,.generic:visited,.wishlist:visited,.twitter>a:visited,.book-edit-link:visited {
            text-decoration: none
        }

        .sign-in {
            padding: 0;
            font-family: inherit;
            font-weight: inherit;
            color: inherit
        }

        .sign-in:hover {
            text-decoration: underline
        }

        .avatar-and-name a,.more,ol.list li a,ol.detail-list li a,ul.list li a,ul.detail-list li a,.book-list-wrapper .view-all,.bundle-list-wrapper .view-all,.book-author a,.author-profile .profile-name a,.contributor-profile .profile-name a,.publisher-profile .profile-name a,.user-profile .profile-name a,.cause-profile .profile-name a,.bundles-authors a,.byline a,.book-titles>p a {
            text-decoration: inherit;
            color: inherit
        }

        .avatar-and-name a:hover,.more:hover,ol.list li a:hover,ol.detail-list li a:hover,ul.list li a:hover,ul.detail-list li a:hover,.book-list-wrapper .view-all:hover,.bundle-list-wrapper .view-all:hover,.book-author a:hover,.author-profile .profile-name a:hover,.contributor-profile .profile-name a:hover,.publisher-profile .profile-name a:hover,.user-profile .profile-name a:hover,.cause-profile .profile-name a:hover,.bundles-authors a:hover,.byline a:hover,.book-titles>p a:hover {
            color: #009aff;
            text-decoration: underline
        }

        .more {
            text-transform: uppercase;
            text-decoration: underline
        }

        .more:hover {
            color: #009aff
        }

        .sign-in {
            padding: .5em 1.75em;
            text-transform: capitalize;
            color: #009aff
        }

        .sign-in:hover {
            text-decoration: none
        }

        .sign-up,.buy-now,.add-to-cart,.add-to-cart-modal,.payment-method {
            background-color: #009aff;
            border-bottom: 1px solid #006cb3;
            text-shadow: 0 1px 0 #006cb3;
            color: #fff;
            text-transform: capitalize
        }

        .sign-up:hover,.buy-now:hover,.add-to-cart:hover,.add-to-cart-modal:hover,.payment-method:hover {
            background-color: #006cb3;
            border-bottom: 1px solid #005c99;
            color: #d9d9d9
        }

        .sign-up:visited,.sign-up:active,.buy-now:visited,.buy-now:active,.add-to-cart:visited,.add-to-cart:active,.add-to-cart-modal:visited,.add-to-cart-modal:active,.payment-method:visited,.payment-method:active {
            color: #fff
        }

        .cancel {
            background-color: #f2f2f2;
            border-bottom: 1px solid #ccc;
            text-shadow: 0 1px 0 #ccc;
            color: #c5c5c5;
            border: 1px solid #c5c5c5;
            color: #c5c5c5;
            text-shadow: none
        }

        .cancel:hover {
            background-color: #ccc;
            border-bottom: 1px solid #bfbfbf;
            color: #9f9f9f
        }

        .cancel:visited,.cancel:active {
            color: #c5c5c5
        }

        .submit {
            background-color: #009aff;
            border-bottom: 1px solid #006cb3;
            text-shadow: 0 1px 0 #006cb3;
            color: #fff
        }

        .submit:hover {
            background-color: #006cb3;
            border-bottom: 1px solid #005c99;
            color: #d9d9d9
        }

        .submit:visited,.submit:active {
            color: #fff
        }

        .danger {
            background-color: #ff4100;
            border-bottom: 1px solid #b32d00;
            text-shadow: 0 1px 0 #b32d00;
            color: #fff
        }

        .danger:hover {
            background-color: #b32d00;
            border-bottom: 1px solid #992700;
            color: #d9d9d9
        }

        .danger:visited,.danger:active {
            color: #fff
        }

        .generic {
            background-color: #999;
            border-bottom: 1px solid #737373;
            text-shadow: 0 1px 0 #737373;
            color: #fff;
            color: #fff
        }

        .generic:hover {
            background-color: #737373;
            border-bottom: 1px solid #666;
            color: #d9d9d9
        }

        .generic:visited,.generic:active {
            color: #fff
        }

        .wishlist {
            background-color: #ffc72a;
            border-bottom: 1px solid #dda300;
            text-shadow: 0 1px 0 #dda300;
            color: #fff;
            color: #fff
        }

        .wishlist:hover {
            background-color: #dda300;
            border-bottom: 1px solid #c39000;
            color: #d9d9d9
        }

        .wishlist:visited,.wishlist:active {
            color: #fff
        }

        .twitter>a {
            background-color: #4099ff;
            border-bottom: 1px solid #0071f3;
            text-shadow: 0 1px 0 #0071f3;
            color: #fff;
            padding: .375em 1.75em;
            font-size: .75em
        }

        .twitter>a:hover {
            background-color: #0071f3;
            border-bottom: 1px solid #0065d9;
            color: #d9d9d9
        }

        .twitter>a:visited,.twitter>a:active {
            color: #fff
        }

        .twitter-icon,.google-plus-icon,.github-icon,.facebook-icon {
            color: #666
        }

        .twitter-icon:hover,.google-plus-icon:hover,.github-icon:hover,.facebook-icon:hover {
            color: #009aff
        }

        .github-link i::before {
            margin-right: 8px;
            font-size: 1.5em;
            vertical-align: middle
        }

        .share-links li {
            line-height: 1em
        }

        .share-links li.embed {
            position: relative;
            padding-right: 30px
        }

        .share-links li.embed .btn {
            font-size: 11px;
            line-height: 18px;
            padding-top: 0
        }

        .anchor-target {
            height: 0;
            width: 0;
            visibility: hidden
        }

        .title-logo {
            text-align: center;
            color: #323232
        }

        .guarantee-logo {
            position: relative;
            display: inline-block;
            width: 75px;
            margin-bottom: 25px;
            line-height: 1;
            white-space: normal;
            letter-spacing: 1px;
            text-transform: uppercase;
            text-align: center;
            font-size: 9px;
            color: inherit
        }

        .guarantee-logo::after {
            top: auto;
            bottom: -25px;
            height: 25px
        }

        .guarantee-logo .pc {
            box-sizing: border-box;
            padding-left: 3px;
            letter-spacing: 0px;
            font-size: 25px;
            color: inherit
        }

        ol.list,ol.detail-list,ul.list,ul.detail-list {
            padding-left: 1em
        }

        ol.list li,ol.detail-list li,ul.list li,ul.detail-list li {
            margin-bottom: .5em 0;
            line-height: 1.5
        }

        ol.list li p,ol.detail-list li p,ul.list li p,ul.detail-list li p {
            display: inline
        }

        ol.list li::before,ol.detail-list li::before,ul.list li::before,ul.detail-list li::before {
            color: #666;
            margin-right: 0.75em
        }

        ul.list li::before,ul.detail-list li::before {
            font-family: FontAwesome;
            content: "\f105"
        }

        ol.list,ol.detail-list {
            margin-left: 1em
        }

        ol.list,ol.detail-list,ol.list li,ol.detail-list li {
            list-style: decimal
        }

        .list-title {
            margin: 5px 0
        }

        .book-list-wrapper .list-header,.bundle-list-wrapper .list-header {
            padding: 1.5em 0;
            display: block
        }

        .book-list-wrapper .list-title,.bundle-list-wrapper .list-title {
            display: inline-block;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            color: #323232;
            text-transform: capitalize;
            font-size: 1.375em;
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 65.88078%
        }

        .book-list-wrapper .list-title:last-child,.bundle-list-wrapper .list-title:last-child {
            margin-right: 0
        }

        .book-list-wrapper .list-subtitle,.bundle-list-wrapper .list-subtitle {
            font-size: 14px;
            display: inline-block;
            color: #797979
        }

        .book-list-wrapper .list-controls,.bundle-list-wrapper .list-controls {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 31.76157%;
            text-align: right
        }

        .book-list-wrapper .list-controls:last-child,.bundle-list-wrapper .list-controls:last-child {
            margin-right: 0
        }

        .book-list-wrapper .view-all,.bundle-list-wrapper .view-all {
            white-space: nowrap;
            text-transform: uppercase;
            text-decoration: none;
            font-size: 0.75em
        }

        .book-list,.bundle-list {
            padding: 2.35765% 0
        }

        .book-list-item,.edit-book-list-item,.bundle-list-item,#book-list.cover-view .book-list-item {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
            padding: 0 1.125em;
            position: relative;
            overflow: visible;
            text-align: center;
            margin-bottom: 1.5em
        }

        .book-list-item .list-item-title,.edit-book-list-item .list-item-title,.bundle-list-item .list-item-title,#book-list.cover-view .book-list-item .list-item-title,.book-list-item .list-item-author,.edit-book-list-item .list-item-author,.bundle-list-item .list-item-author,#book-list.cover-view .book-list-item .list-item-author {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
            white-space: normal;
            overflow: hidden
        }

        .book-list-item .list-item-title a:hover,.edit-book-list-item .list-item-title a:hover,.bundle-list-item .list-item-title a:hover,#book-list.cover-view .book-list-item .list-item-title a:hover,.book-list-item .list-item-author a:hover,.edit-book-list-item .list-item-author a:hover,.bundle-list-item .list-item-author a:hover,#book-list.cover-view .book-list-item .list-item-author a:hover {
            text-decoration: underline
        }

        .book-list-item .list-item-title,.edit-book-list-item .list-item-title,.bundle-list-item .list-item-title,#book-list.cover-view .book-list-item .list-item-title {
            font-size: .9375em;
            color: #000
        }

        .book-list-item .list-item-title a,.edit-book-list-item .list-item-title a,.bundle-list-item .list-item-title a,#book-list.cover-view .book-list-item .list-item-title a {
            color: inherit
        }

        .book-list-item .list-item-author,.edit-book-list-item .list-item-author,.bundle-list-item .list-item-author,#book-list.cover-view .book-list-item .list-item-author {
            font-size: .8125em;
            color: #424242
        }

        .book-list-item .list-item-author a,.edit-book-list-item .list-item-author a,.bundle-list-item .list-item-author a,#book-list.cover-view .book-list-item .list-item-author a {
            color: inherit
        }

        .book-list-item .list-item-overview,.edit-book-list-item .list-item-overview,.bundle-list-item .list-item-overview,#book-list.cover-view .book-list-item .list-item-overview {
            position: absolute;
            top: auto;
            right: 0px;
            bottom: 0px;
            left: 0px;
            background-color: inherit;
            border: 1px solid transparent;
            margin-bottom: inherit;
            border-top: 1px solid #cbcbcb;
            background-color: rgba(255,255,255,0.75)
        }

        .book-list-item .list-item-overview>div,.edit-book-list-item .list-item-overview>div,.bundle-list-item .list-item-overview>div,#book-list.cover-view .book-list-item .list-item-overview>div {
            text-align: center;
            padding: .25em
        }

        .book-list-item .list-item-overview>div a,.edit-book-list-item .list-item-overview>div a,.bundle-list-item .list-item-overview>div a,#book-list.cover-view .book-list-item .list-item-overview>div a {
            display: inline-block
        }

        .book-list-item .list-item-overview .fa-eye,.edit-book-list-item .list-item-overview .fa-eye,.bundle-list-item .list-item-overview .fa-eye,#book-list.cover-view .book-list-item .list-item-overview .fa-eye,.book-list-item .list-item-overview .fa-eye-slash,.edit-book-list-item .list-item-overview .fa-eye-slash,.bundle-list-item .list-item-overview .fa-eye-slash,#book-list.cover-view .book-list-item .list-item-overview .fa-eye-slash,.book-list-item .list-item-overview .fa-pencil,.edit-book-list-item .list-item-overview .fa-pencil,.bundle-list-item .list-item-overview .fa-pencil,#book-list.cover-view .book-list-item .list-item-overview .fa-pencil,.book-list-item .list-item-overview .fa-gear,.edit-book-list-item .list-item-overview .fa-gear,.bundle-list-item .list-item-overview .fa-gear,#book-list.cover-view .book-list-item .list-item-overview .fa-gear {
            margin: 0 .125em;
            font-size: 1.25em;
            cursor: pointer
        }

        .book-list-item .list-item-overview .fa-eye,.edit-book-list-item .list-item-overview .fa-eye,.bundle-list-item .list-item-overview .fa-eye,#book-list.cover-view .book-list-item .list-item-overview .fa-eye {
            color: #009aff
        }

        .book-list-item .list-item-overview .fa-eye:hover,.edit-book-list-item .list-item-overview .fa-eye:hover,.bundle-list-item .list-item-overview .fa-eye:hover,#book-list.cover-view .book-list-item .list-item-overview .fa-eye:hover {
            color: #005c99
        }

        .book-list-item .list-item-overview .fa-eye-slash,.edit-book-list-item .list-item-overview .fa-eye-slash,.bundle-list-item .list-item-overview .fa-eye-slash,#book-list.cover-view .book-list-item .list-item-overview .fa-eye-slash,.book-list-item .list-item-overview .fa-pencil,.edit-book-list-item .list-item-overview .fa-pencil,.bundle-list-item .list-item-overview .fa-pencil,#book-list.cover-view .book-list-item .list-item-overview .fa-pencil,.book-list-item .list-item-overview .fa-gear,.edit-book-list-item .list-item-overview .fa-gear,.bundle-list-item .list-item-overview .fa-gear,#book-list.cover-view .book-list-item .list-item-overview .fa-gear {
            color: #797979
        }

        .book-list-item .list-item-overview .fa-eye-slash:hover,.edit-book-list-item .list-item-overview .fa-eye-slash:hover,.bundle-list-item .list-item-overview .fa-eye-slash:hover,#book-list.cover-view .book-list-item .list-item-overview .fa-eye-slash:hover,.book-list-item .list-item-overview .fa-pencil:hover,.edit-book-list-item .list-item-overview .fa-pencil:hover,.bundle-list-item .list-item-overview .fa-pencil:hover,#book-list.cover-view .book-list-item .list-item-overview .fa-pencil:hover,.book-list-item .list-item-overview .fa-gear:hover,.edit-book-list-item .list-item-overview .fa-gear:hover,.bundle-list-item .list-item-overview .fa-gear:hover,#book-list.cover-view .book-list-item .list-item-overview .fa-gear:hover {
            color: #464646
        }

        .book-list-item:hover .list-item-overview,.edit-book-list-item:hover .list-item-overview,.bundle-list-item:hover .list-item-overview,#book-list.cover-view .book-list-item:hover .list-item-overview {
            background-color: rgba(255,255,255,0.85)
        }

        @media screen and (min-width: 40em) {
            .book-list-item,.edit-book-list-item,.bundle-list-item,#book-list.cover-view .book-list-item {
                border-bottom:0;
                margin-bottom: 2.5em
            }
        }

        .details-list,.details-list-stacked {
            display: block;
            margin: 0 auto 2em auto;
            text-align: left
        }

        .details-list .detail-list-title,.details-list-stacked .detail-list-title {
            margin-bottom: .625em;
            text-transform: uppercase;
            text-align: inherit;
            color: #000
        }

        .details-list>li,.details-list-stacked>li {
            float: left;
            margin-right: 4.7153%
        }

        .details-list>li:last-child,.details-list-stacked>li:last-child {
            margin-right: 0
        }

        .detail-list li {
            font-size: .75em
        }

        .details-list-stacked>li {
            float: none;
            margin-bottom: 1.5em
        }

        .details-list-stacked>li:last-child {
            margin-bottom: 0
        }

        .download-links-list li,.delete-links-list li {
            display: inline-block;
            position: relative;
            padding-top: 3em;
            margin-right: 0;
            margin-bottom: 1.5em;
            border: 1px solid #cbcbcb;
            border-radius: 4px;
            background-color: #fff
        }

        .download-links-list li div.too-big,.delete-links-list li div.too-big {
            padding: 9px 0;
            margin-bottom: 0;
            font-size: .625em;
            text-align: center
        }

        .download-links-list li div.too-big span,.delete-links-list li div.too-big span {
            margin-right: -4px;
            vertical-align: middle
        }

        .download-links-list li div.too-big .more-info,.delete-links-list li div.too-big .more-info {
            margin-right: 0px
        }

        .download-links-list li a:hover,.delete-links-list li a:hover {
            text-decoration: none
        }

        .download-links-list li p,.delete-links-list li p {
            font-size: .625em;
            margin-bottom: 1em;
            text-align: center
        }

        .download-links-list li p::before,.download-links-list li p::after,.delete-links-list li p::before,.delete-links-list li p::after {
            top: -40px;
            color: inherit
        }

        .download-links-list li p:hover,.delete-links-list li p:hover {
            text-decoration: underline
        }

        @media screen and (min-width: 40em) {
            .download-links-list li,.delete-links-list li {
                margin-right:0
            }

            .download-links-list li:last-child,.delete-links-list li:last-child {
                margin-right: 0
            }
        }

        .download-links-list .generic,.delete-links-list .generic {
            position: relative;
            width: calc(100% + 2px);
            bottom: -1px;
            left: -1px;
            text-transform: uppercase;
            font-size: .75em
        }

        .pdf-format-icon {
            position: relative
        }

        .pdf-format-icon::before {
            top: -25px
        }

        .epub-format-icon {
            position: relative
        }

        .epub-format-icon::before {
            top: -25px;
            left: -20px
        }

        .epub-format-icon::after {
            top: -25px;
            right: -20px
        }

        .mobi-format-icon {
            position: relative
        }

        .mobi-format-icon::before {
            top: -25px
        }

        dl {
            display: block
        }

        dl dt {
            color: #000;
            margin-bottom: 1.5em
        }

        dl dd {
            margin: 0 0 1.5em 1.5em
        }

        .featured-podcast .meta-wrapper,.featured-podcast .podcast-info-wrapper {
            max-width: 64em;
            margin-left: auto;
            margin-right: auto
        }

        .featured-podcast .meta-wrapper:after,.featured-podcast .podcast-info-wrapper:after {
            content: "";
            display: table;
            clear: both
        }

        .featured-podcast .meta-logo {
            float: none;
            text-align: center
        }

        .featured-podcast .meta-logo img {
            height: 200px
        }

        @media screen and (min-width: 40em) {
            .featured-podcast .meta-logo {
                text-align:initial;
                float: left
            }
        }

        .featured-podcast .meta-links {
            padding-bottom: 2em
        }

        .featured-podcast .meta-links p,.featured-podcast .meta-links ul {
            text-align: center
        }

        .featured-podcast .meta-links li {
            display: lock;
            margin-right: 0em;
            margin-bottom: 1em
        }

        @media screen and (min-width: 53.75em) {
            .featured-podcast .meta-links li {
                display:inline-block;
                margin-right: 2em;
                margin-bottom: 0
            }
        }

        .featured-podcast .meta-links li:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 40em) {
            .featured-podcast .meta-links {
                padding-top:2em
            }
        }

        @media screen and (min-width: 53.75em) {
            .featured-podcast .meta-links {
                padding-top:4em
            }
        }

        .featured-podcast .avatar,.featured-podcast .avatar-and-name {
            float: left
        }

        .featured-podcast .avatar img,.featured-podcast .avatar-and-name img {
            height: 150px;
            border-radius: 50%;
            margin: 0 2em 2em 0;
            border: 1px solid #cbcbcb
        }

        .featured-podcast .podcast-info-wrapper {
            padding: 0
        }

        @media screen and (min-width: 40em) {
            .featured-podcast .podcast-info-wrapper {
                padding:1em 3em 0 3em
            }
        }

        .price-regular,.price-minimum,.price-highlight {
            color: #666
        }

        .price-regular+.price-text,.price-minimum+.price-text,.price-highlight+.price-text {
            text-transform: uppercase;
            text-align: inherit;
            font-size: .625em;
            color: #666;
            margin-bottom: 0
        }

        .pricing-wrapper {
            display: block
        }

        .price-detail {
            display: inline-block;
            vertical-align: bottom;
            text-align: center;
            padding: .5em
        }

        .price-detail .free {
            font-weight: 500
        }

        .price-regular {
            text-decoration: line-through
        }

        .price-minimum.coupon-price {
            background-color: #fff6bf
        }

        .price-highlight {
            color: #009aff
        }

        .includes-vat {
            margin-top: 2px;
            text-transform: uppercase;
            text-align: inherit;
            font-size: 0.4em;
            color: #666
        }

        .hll {
            background-color: #ffc
        }

        .c {
            color: #408080;
            font-style: italic
        }

        .err {
            color: red
        }

        .k {
            color: #008000;
            font-weight: 600
        }

        .o {
            color: #666
        }

        .cm {
            color: #408080;
            font-style: italic
        }

        .cp {
            color: #bc7a00
        }

        .c1 {
            color: #408080;
            font-style: italic
        }

        .cs {
            color: #408080;
            font-style: italic
        }

        .gd {
            color: #a00000
        }

        .ge {
            font-style: italic
        }

        .gr {
            color: red
        }

        .gh {
            color: #000080;
            font-weight: 600
        }

        .gi {
            color: #00a000
        }

        .go {
            color: #888
        }

        .gp {
            color: #000080;
            font-weight: 600
        }

        .gs {
            font-weight: 600
        }

        .gu {
            color: #800080;
            font-weight: 600
        }

        .gt {
            color: #04d
        }

        .kc {
            color: #008000;
            font-weight: 600
        }

        .kd {
            color: #008000;
            font-weight: 600
        }

        .kn {
            color: #008000;
            font-weight: 600
        }

        .kp {
            color: green
        }

        .kr {
            color: #008000;
            font-weight: 600
        }

        .kt {
            color: #b00040
        }

        .m {
            color: #666
        }

        .s {
            color: #ba2121
        }

        .na {
            color: #7d9029
        }

        .nb {
            color: green
        }

        .nc {
            color: #0000FF;
            font-weight: 600
        }

        .no {
            color: #800
        }

        .nd {
            color: #a2f
        }

        .ni {
            color: #999999;
            font-weight: 600
        }

        .ne {
            color: #D2413A;
            font-weight: 600
        }

        .nf {
            color: blue
        }

        .nl {
            color: #a0a000
        }

        .nn {
            color: #0000FF;
            font-weight: 600
        }

        .nt {
            color: #008000;
            font-weight: 600
        }

        .nv {
            color: #19177c
        }

        .ow {
            color: #AA22FF;
            font-weight: 600
        }

        .w {
            color: #bbb
        }

        .mf {
            color: #666
        }

        .mh {
            color: #666
        }

        .mi {
            color: #666
        }

        .mo {
            color: #666
        }

        .sb {
            color: #ba2121
        }

        .sc {
            color: #ba2121
        }

        .sd {
            color: #BA2121;
            font-style: italic
        }

        .s2 {
            color: #ba2121
        }

        .se {
            color: #BB6622;
            font-weight: 600
        }

        .sh {
            color: #ba2121
        }

        .si {
            color: #BB6688;
            font-weight: 600
        }

        .sx {
            color: green
        }

        .sr {
            color: #b68
        }

        .s1 {
            color: #ba2121
        }

        .ss {
            color: #19177c
        }

        .bp {
            color: green
        }

        .vc {
            color: #19177c
        }

        .vg {
            color: #19177c
        }

        .vi {
            color: #19177c
        }

        .il {
            color: #666
        }

        span.underline {
            text-decoration: underline
        }

        #leanpub-main .hanging-indent p,#leanpub-doc-main .hanging-indent p {
            padding-left: 2em;
            text-indent: -2em
        }

        #leanpub-main blockquote,#leanpub-doc-main blockquote {
            border-left: none;
            margin-left: 2em
        }

        #leanpub-main blockquote p,#leanpub-doc-main blockquote p {
            font-size: 90%
        }

        #leanpub-main ul,#leanpub-doc-main ul {
            margin: 0.5em 0 1em 2em;
            list-style-type: disc
        }

        #leanpub-main li,#leanpub-doc-main li {
            margin-bottom: 0.4em
        }

        #leanpub-main h4,#leanpub-doc-main h4 {
            margin: 0.4em 0 0.2em 0
        }

        #leanpub-main p,#leanpub-doc-main p {
            line-height: 1.5em
        }

        #leanpub-main code,#leanpub-doc-main code {
            background-color: inherit;
            border: none;
            font-size: 10pt
        }

        #leanpub-main sup,#leanpub-doc-main sup {
            vertical-align: super;
            font-size: smaller
        }

        #leanpub-main div.image-with-caption,#leanpub-doc-main div.image-with-caption {
            width: 100%;
            text-align: center
        }

        #leanpub-main div.image-with-caption img,#leanpub-doc-main div.image-with-caption img {
            display: inline-block
        }

        #leanpub-main div.image-with-caption p.caption,#leanpub-doc-main div.image-with-caption p.caption {
            text-align: center;
            margin: 0em !important;
            padding: 0em !important;
            text-indent: 0em !important;
            page-break-before: avoid
        }

        #leanpub-main div.image-with-caption.floatleft,#leanpub-doc-main div.image-with-caption.floatleft {
            float: left;
            clear: left;
            margin-right: 1em
        }

        #leanpub-main div.image-with-caption.floatright,#leanpub-doc-main div.image-with-caption.floatright {
            float: right;
            clear: right;
            margin-left: 1em
        }

        #leanpub-main div.image-with-caption.floatleft img,#leanpub-main div.image-with-caption.floatright img,#leanpub-doc-main div.image-with-caption.floatleft img,#leanpub-doc-main div.image-with-caption.floatright img {
            width: 100% !important;
            vertical-align: text-top;
            margin: .5em !important
        }

        #leanpub-main div.image-with-caption.floatleft p.caption,#leanpub-main div.image-with-caption.floatright p.caption,#leanpub-doc-main div.image-with-caption.floatleft p.caption,#leanpub-doc-main div.image-with-caption.floatright p.caption {
            width: 100%
        }

        #leanpub-main div.aside,#leanpub-doc-main div.aside {
            border-style: solid;
            border-color: #cbcbcb;
            border-width: thin;
            margin: 1em;
            padding: 1em 1.5em
        }

        #leanpub-main table.sidebarish,#leanpub-doc-main table.sidebarish {
            margin: 1em 1em 1em 0em;
            border-style: none;
            border-collapse: collapse;
            border-top: 1px solid #cbcbcb;
            border-bottom: 1px solid #cbcbcb
        }

        #leanpub-main table.sidebarish>tbody>tr>td,#leanpub-doc-main table.sidebarish>tbody>tr>td {
            vertical-align: top;
            padding-bottom: 1em;
            padding-top: 1em;
            border: 0
        }

        #leanpub-main .sidebarish h1,#leanpub-main .sidebarish h2,#leanpub-main .sidebarish h3,#leanpub-main .sidebarish h4,#leanpub-doc-main .sidebarish h1,#leanpub-doc-main .sidebarish h2,#leanpub-doc-main .sidebarish h3,#leanpub-doc-main .sidebarish h4 {
            margin-bottom: 0.5em;
            margin-top: 0.25em;
            text-align: left;
            border-top: none
        }

        #leanpub-main table.sidebarish td.sidebar-icon,#leanpub-doc-main table.sidebarish td.sidebar-icon {
            width: 50px;
            padding-top: 1.5em;
            padding-left: 0em
        }

        #leanpub-main table.sidebarish td.sidebar-icon img,#leanpub-doc-main table.sidebarish td.sidebar-icon img {
            width: 40px;
            height: 40px;
            margin-right: 10px
        }

        #leanpub-main pre,#leanpub-doc-main pre {
            background-color: inherit;
            border: none
        }

        #leanpub-main div.code-block,#leanpub-doc-main div.code-block {
            margin-top: 10px;
            margin-bottom: 10px
        }

        #leanpub-main div.code-block p.codeblock-title,#leanpub-doc-main div.code-block p.codeblock-title {
            margin: 0px;
            font-size: 0.8em
        }

        #leanpub-main div.code-block hr,#leanpub-doc-main div.code-block hr {
            margin: 0px
        }

        #leanpub-main div.code-block div.highlight,#leanpub-doc-main div.code-block div.highlight {
            margin: 0px
        }

        #leanpub-main div.code-block div.highlight pre,#leanpub-main div.code-block div.highlight pre code,#leanpub-doc-main div.code-block div.highlight pre,#leanpub-doc-main div.code-block div.highlight pre code {
            font-size: 10pt;
            line-height: 12pt
        }

        #leanpub-main div.code-block pre,#leanpub-doc-main div.code-block pre {
            margin: 0px
        }

        #leanpub-main span.lineno,#leanpub-main code.lineno,#leanpub-doc-main span.lineno,#leanpub-doc-main code.lineno {
            color: gray;
            font-size: 80%
        }

        #leanpub-main .sidebarish hr,#leanpub-doc-main .sidebarish hr {
            border-color: #888
        }

        #leanpub-main table,#leanpub-doc-main table {
            margin-top: 10px;
            margin-bottom: 20px;
            border-collapse: collapse
        }

        #leanpub-main tbody,#leanpub-doc-main tbody {
            padding-bottom: 40px
        }

        #leanpub-main td,#leanpub-main th,#leanpub-doc-main td,#leanpub-doc-main th {
            padding-right: 10px
        }

        #leanpub-main td.sidebar-icon,#leanpub-doc-main td.sidebar-icon {
            width: 30px;
            vertical-align: top;
            padding-top: 10px
        }

        #leanpub-main th,#leanpub-doc-main th {
            text-align: left;
            border-bottom: thin solid
        }

        #leanpub-main .centered p,#leanpub-doc-main .centered p {
            text-align: center
        }

        div.on-site img {
            max-width: 90%;
            max-height: 600px
        }

        .udl {
            text-decoration: line-through
        }

        .uil {
            font-weight: 900
        }

        .highlight pre,.highlight pre code {
            font-family: "Lucida Console",Monaco,monospace
        }

        #leanpub-toc ol ol,.toc ol {
            list-style-type: none
        }

        #leanpub-toc ol ul,.toc ul {
            margin: .5em 0 1em;
            list-style-type: circle
        }

        #leanpub-toc ol li,.toc li {
            margin-bottom: .625em;
            padding-left: 0;
            color: #323232
        }

        #leanpub-toc ol li>ul>li,#leanpub-toc ol li>ol>li,.toc li>ul>li,.toc li>ol>li {
            margin-left: 1em
        }

        #leanpub-toc ol a,.toc a {
            color: #323232
        }

        .section-number {
            margin-right: 1em;
            color: #999
        }

        .toc.has-parts>li {
            font-size: 1.25em
        }

        .toc.no-parts>li,#leanpub-toc .columns>ol>li {
            font-size: 1.125em
        }

        .toc.has-parts>li>ul>li {
            font-size: 86.66667%
        }

        .toc.no-parts>li>ul>li,.toc.has-parts>li>ul>li>ul>li,#leanpub-toc ol .section {
            font-size: 86.66667%
        }

        .toc.no-parts>li>ul>li>ul>li,.toc.has-parts>li>ul>li>ul>li>ul>li,#leanpub-toc ol .subsection {
            font-size: 86.66667%
        }

        .toc.no-parts>li>ul>li>ul>li>ul>li,.toc.has-parts>li>ul>li>ul>li>ul>li>ul>li,#leanpub-toc ol .subsubsection {
            font-size: 86.66667%
        }

        .toc.no-parts>li>ul>li>ul>li>ul>li>ul>li,.toc.has-parts>li>ul>li>ul>li>ul>li>ul>li>ul>li,#leanpub-toc ol .subsubsubsection {
            font-size: 86.66667%
        }

        img.inline-equation {
            height: 1.0em;
            vertical-align: baseline
        }

        img.block-equation {
            margin-top: 0.5em;
            margin-right: auto;
            margin-bottom: 0.5em;
            margin-left: auto;
            text-align: center
        }

        #quick-buy {
            position: fixed;
            top: -100%;
            right: 0;
            left: 0;
            z-index: 9999;
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
            padding: 8px 2.35765%;
            background-color: rgba(255,255,255,0.9);
            border-bottom: 1px solid #cbcbcb;
            text-align: center;
            -webkit-transition: top,0.25s,ease-in-out;
            -moz-transition: top,0.25s,ease-in-out;
            transition: top,0.25s,ease-in-out
        }

        #quick-buy.visible {
            top: 0
        }

        #quick-buy .large-container,#quick-buy #app-container,#quick-buy #bookstore section,#bookstore #quick-buy section {
            padding: 0
        }

        #quick-buy .book-title,#quick-buy .bundle-title {
            display: inline-block;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            margin-bottom: .625em;
            line-height: 50px;
            font-size: 18px
        }

        @media screen and (min-width: 53.75em) {
            #quick-buy .book-title,#quick-buy .bundle-title {
                margin-bottom:0
            }
        }

        #quick-buy .quick-buy-info {
            width: 100%;
            display: none
        }

        @media screen and (min-width: 40em) {
            #quick-buy .quick-buy-info {
                display:initial
            }
        }

        @media screen and (min-width: 53.75em) {
            #quick-buy .quick-buy-info {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%;
                white-space: nowrap
            }

            #quick-buy .quick-buy-info:last-child {
                margin-right: 0
            }
        }

        #quick-buy .cover-image {
            display: inline-block;
            overflow: hidden;
            margin-right: 8px
        }

        #quick-buy .cover-image img {
            margin-bottom: 0;
            box-shadow: none;
            border: 1px solid #cbcbcb
        }

        #quick-buy .book-details-list {
            width: 100%;
            text-align: center
        }

        #quick-buy .book-details-list .detail {
            vertical-align: middle;
            margin-right: 0
        }

        @media screen and (min-width: 40em) {
            #quick-buy .book-details-list .detail {
                margin-right:1.5em
            }
        }

        #quick-buy .book-details-list .detail:last-child {
            margin-right: 0
        }

        #quick-buy .book-details-list .detail>span {
            display: none;
            font-size: 1.5em
        }

        @media screen and (min-width: 40em) {
            #quick-buy .book-details-list .detail>span {
                display:initial
            }
        }

        @media screen and (min-width: 53.75em) {
            #quick-buy .book-details-list {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%;
                margin-right: 0;
                text-align: right
            }

            #quick-buy .book-details-list:last-child {
                margin-right: 0
            }
        }

        #quick-buy .add-to-cart-modal,#quick-buy .add-to-cart-with-coupon,#quick-buy .buy-now {
            font-size: .75em
        }

        @media screen and (min-width: 53.75em) {
            #quick-buy {
                text-align:left
            }
        }

        #read-online .read .image-with-caption {
            margin-bottom: 1.5em
        }

        #read-online .read .image-with-caption img {
            margin-bottom: .25em
        }

        #read-online .read sup {
            vertical-align: super;
            font-size: smaller
        }

        #read-online .sidebar {
            text-align: center
        }

        #read-online .sidebar .cc-license {
            font-size: .8125em
        }

        @media screen and (min-width: 53.75em) {
            #read-online .sidebar {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 31.76157%;
                float: right
            }

            #read-online .sidebar:last-child {
                margin-right: 0
            }
        }

        #read-online .new-edition-wrapper {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%
        }

        #read-online .new-edition-wrapper:last-child {
            margin-right: 0
        }

        #read-online .new-edition-warning {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            margin-left: 0%;
            margin: 0 auto 2em;
            padding: 0.5em;
            text-align: center
        }

        #read-online .new-edition-warning:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 53.75em) {
            #read-online .new-edition-warning {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%;
                margin-left: 25.58941%;
                margin-right: 0
            }

            #read-online .new-edition-warning:last-child {
                margin-right: 0
            }
        }

        #book-box {
            padding: 2em 1em;
            margin: 0 0 1.5em 1em;
            background-color: #fff;
            border-radius: 4px;
            border: 1px solid #cbcbcb
        }

        #book-box .book-title,#book-box .bundle-title {
            font-size: .9375em
        }

        #book-box .book-title a:hover,#book-box .bundle-title a:hover {
            color: #009aff;
            text-decoration: none
        }

        #book-box .book-title,#book-box .bundle-title,#book-box .book-author,#book-box .author-profile .profile-name,.author-profile #book-box .profile-name,#book-box .contributor-profile .profile-name,.contributor-profile #book-box .profile-name,#book-box .publisher-profile .profile-name,.publisher-profile #book-box .profile-name,#book-box .user-profile .profile-name,.user-profile #book-box .profile-name,#book-box .cause-profile .profile-name,.cause-profile #book-box .profile-name,#book-box .bundles-authors,#book-box .cover-image,#book-box .pricing {
            margin-bottom: 1.5em
        }

        #book-box .detail {
            font-size: .75em
        }

        #book-box .detail p {
            margin-bottom: 0;
            font-size: .8125em
        }

        #leanpub-main {
            padding: 0 4em
        }

        #leanpub-toc {
            padding-left: 4em;
            margin-bottom: 4em
        }

        #unpublished-read-warning {
            margin: 0 auto;
            width: 400px;
            text-align: center
        }

        @media screen and (min-width: 53.75em) {
            #sign-up #new_user {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%;
                margin-left: 25.58941%
            }

            #sign-up #new_user:last-child {
                margin-right: 0
            }
        }

        #sign-up #recaptcha_table {
            border: none !important
        }

        #sign-up #recaptcha {
            display: inline-block
        }

        #dropbox-email,#github-repo,#in-browser,#byob-upload {
            padding: 0.5em 2.35765%
        }

        #sign-in {
            margin-top: 5em;
            margin-bottom: 5em
        }

        #sign-in article>section {
            width: 100%;
            padding: 3em 2em
        }

        @media screen and (min-width: 53.75em) {
            #sign-in article>section {
                padding:3em 4.5em;
                float: left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%;
                margin-right: 0
            }

            #sign-in article>section:last-child {
                margin-right: 0
            }
        }

        #sign-in article>section:nth-child(1) {
            display: none
        }

        @media screen and (min-width: 53.75em) {
            #sign-in article>section:nth-child(1) {
                display:block
            }
        }

        #sign-in article>section:nth-child(2) h1 {
            margin-bottom: 1em
        }

        #sign-in article>section:nth-child(2) .right-contents {
            margin-top: 3em;
            white-space: nowrap
        }

        #sign-in input[type=submit] {
            margin-bottom: 1em
        }

        #sign-in .more {
            font-size: 0.75em
        }

        #contact section,#buzz section,#manifesto section,#affiliates section,#age-verification section,#gift-purchase section,#terms section,#request_refund section,#wishlist-container section,#sign-up section,#welcome section,#upsell section {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 82.94039%;
            margin-left: 8.5298%
        }

        #contact section:last-child,#buzz section:last-child,#manifesto section:last-child,#affiliates section:last-child,#age-verification section:last-child,#gift-purchase section:last-child,#terms section:last-child,#request_refund section:last-child,#wishlist-container section:last-child,#sign-up section:last-child,#welcome section:last-child,#upsell section:last-child {
            margin-right: 0
        }

        #static {
            padding-top: 3em
        }

        #sign-up section {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 48.82117%;
            margin-left: 25.58941%
        }

        #sign-up section:last-child {
            margin-right: 0
        }

        #sign-up .input-prepend input {
            height: 40px
        }

        #testimonials-container {
            max-width: 64em;
            margin-left: auto;
            margin-right: auto
        }

        #testimonials-container:after {
            content: "";
            display: table;
            clear: both
        }

        #contact_author .container,#contact_author #contact article,#contact #contact_author article,#contact_author #buzz article,#buzz #contact_author article,#contact_author #manifesto article,#manifesto #contact_author article,#contact_author #affiliates article,#affiliates #contact_author article,#contact_author #age-verification article,#age-verification #contact_author article,#contact_author #gift-purchase article,#gift-purchase #contact_author article,#contact_author #terms article,#terms #contact_author article,#contact_author #request_refund article,#request_refund #contact_author article,#contact_author #wishlist-container article,#wishlist-container #contact_author article,#contact_author #sign-up article,#sign-up #contact_author article,#contact_author #welcome article,#welcome #contact_author article,#contact_author #upsell article,#upsell #contact_author article,#contact_author .new-book article,.new-book #contact_author article,#contact_author .new-publisher-book article,.new-publisher-book #contact_author article,#contact_author #new-bundle article,#new-bundle #contact_author article {
            padding: 1em 0
        }

        @media screen and (min-width: 53.75em) {
            #contact_author .feedback,#contact_author .read {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 65.88078%
            }

            #contact_author .feedback:last-child,#contact_author .read:last-child {
                margin-right: 0
            }
        }

        #contact_author .sidebar {
            padding: 1em;
            background: #fbfbfb
        }

        @media screen and (min-width: 53.75em) {
            #contact_author .sidebar {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 31.76157%
            }

            #contact_author .sidebar:last-child {
                margin-right: 0
            }
        }

        #contact_author .sidebar .author-profile {
            text-align: left
        }

        #wishlist-container .book {
            margin-bottom: 1em
        }

        #wishlist-container .book p,#wishlist-container .book h2 {
            margin-bottom: 0.5em
        }

        #wishlist-container .book form.wishlist_book {
            display: inline-block
        }

        #wishlist-container .book .cover-image {
            margin-right: .625em;
            float: left
        }

        #welcome .welcome-title {
            margin-bottom: 1em
        }

        #welcome .user-actions {
            margin: 2em auto;
            text-align: center
        }

        #welcome .user-actions form {
            display: inline-block;
            margin-right: 0.5em
        }

        #upsell {
            padding: 3em 0
        }

        #upsell .center {
            text-align: center
        }

        .stats {
            text-align: center
        }

        .stats h5 {
            text-align: left;
            margin-bottom: 0.75em
        }

        .stats h5 span {
            display: inline
        }

        .stats ul {
            padding: 0
        }

        .stats li {
            border-right: 1px solid rgba(50,50,50,0.2);
            color: #007bcc;
            display: inline;
            float: left;
            font-size: 1.2em;
            line-height: 1.1em;
            padding: 0 0.7em
        }

        .stats li:first-child {
            padding-left: 0
        }

        .stats li:last-child {
            border-right: 0
        }

        .stats span {
            color: #323232;
            display: block;
            font-size: 0.7em;
            font-weight: normal
        }

        .stats p.large-stat {
            text-align: left;
            font-size: 3em;
            margin-bottom: 0 !important;
            line-height: 1em !important;
            color: #009aff
        }

        .type-system,#sign-up,#sign-in,article,#causes,.bundle-edit,#help article,#books-getting-started article,.manage-purchased-package,.redeem-purchased-package,#publisher article,#editors-new article {
            text-align: left
        }

        .type-system .type,#sign-up .type,#sign-in .type,article .type,#causes .type,.bundle-edit .type,#help article .type,#books-getting-started article .type,.manage-purchased-package .type,.redeem-purchased-package .type,#publisher article .type,#editors-new article .type {
            border-bottom: 2px solid;
            display: inline-block;
            font-family: "Whitney SSm A","Whitney SSm B";
            font-size: .7em;
            font-weight: 800;
            margin-bottom: 2em;
            padding: .1em 0;
            text-align: left;
            text-transform: uppercase
        }

        .type-system h1,#sign-up h1,#sign-in h1,article h1,#causes h1,.bundle-edit h1,#help article h1,#books-getting-started article h1,.manage-purchased-package h1,.redeem-purchased-package h1,#publisher article h1,#editors-new article h1 {
            font-family: "Archer SSm A","Archer SSm B";
            font-size: 1.9em;
            font-weight: 600;
            margin-bottom: .3em
        }

        @media screen and (min-width: 40em) {
            .type-system h1,#sign-up h1,#sign-in h1,article h1,#causes h1,.bundle-edit h1,#help article h1,#books-getting-started article h1,.manage-purchased-package h1,.redeem-purchased-package h1,#publisher article h1,#editors-new article h1 {
                font-size:2.6em
            }
        }

        .type-system h2,#sign-up h2,#sign-in h2,article h2,#causes h2,.bundle-edit h2,#help article h2,#books-getting-started article h2,.manage-purchased-package h2,.redeem-purchased-package h2,#publisher article h2,#editors-new article h2 {
            font-family: "Archer SSm A","Archer SSm B";
            font-size: 1.3em;
            font-weight: 600;
            line-height: 1.25em;
            margin-bottom: .9em
        }

        @media screen and (min-width: 40em) {
            .type-system h2,#sign-up h2,#sign-in h2,article h2,#causes h2,.bundle-edit h2,#help article h2,#books-getting-started article h2,.manage-purchased-package h2,.redeem-purchased-package h2,#publisher article h2,#editors-new article h2 {
                font-size:1.5em
            }
        }

        .type-system code,#sign-up code,#sign-in code,article code,#causes code,.bundle-edit code,#help article code,#books-getting-started article code,.manage-purchased-package code,.redeem-purchased-package code,#publisher article code,#editors-new article code {
            white-space: nowrap;
            background: #F7F7F7;
            border: 1px solid #E0E0E0;
            border-radius: 6px;
            padding: .1em .4em;
            font-size: .75em;
            font-style: normal
        }

        .type-system h2 code,#sign-up h2 code,#sign-in h2 code,article h2 code,#causes h2 code,.bundle-edit h2 code,#help article h2 code,#books-getting-started article h2 code,.manage-purchased-package h2 code,.redeem-purchased-package h2 code,#publisher article h2 code,#editors-new article h2 code {
            font-size: .65em
        }

        .type-system h3,#sign-up h3,#sign-in h3,article h3,#causes h3,.bundle-edit h3,#help article h3,#books-getting-started article h3,.manage-purchased-package h3,.redeem-purchased-package h3,#publisher article h3,#editors-new article h3 {
            font-family: "Archer SSm A","Archer SSm B";
            font-size: 1.4em;
            font-style: italic;
            font-weight: 400;
            line-height: 1.3em;
            margin-bottom: .4em
        }

        .type-system p.date,#sign-up p.date,#sign-in p.date,article p.date,#causes p.date,.bundle-edit p.date,#help article p.date,#books-getting-started article p.date,.manage-purchased-package p.date,.redeem-purchased-package p.date,#publisher article p.date,#editors-new article p.date {
            color: rgba(50,50,50,0.4);
            font-family: "Archer SSm A","Archer SSm B";
            font-style: italic;
            margin-bottom: .3em
        }

        .type-system p,#sign-up p,#sign-in p,article p,#causes p,.bundle-edit p,#help article p,#books-getting-started article p,.manage-purchased-package p,.redeem-purchased-package p,#publisher article p,#editors-new article p {
            font-family: "Whitney SSm A","Whitney SSm B";
            letter-spacing: 1;
            margin-bottom: 1.5em;
            line-height: 1.55em
        }

        .type-system a.read-more,#sign-up a.read-more,#sign-in a.read-more,article a.read-more,#causes a.read-more,.bundle-edit a.read-more,#help article a.read-more,#books-getting-started article a.read-more,.manage-purchased-package a.read-more,.redeem-purchased-package a.read-more,#publisher article a.read-more,#editors-new article a.read-more {
            display: inline-block;
            font-family: "Whitney SSm A","Whitney SSm B";
            font-weight: 700;
            font-size: .8em;
            text-transform: uppercase;
            margin-left: .2em;
            position: relative
        }

        .type-system a.read-more span,#sign-up a.read-more span,#sign-in a.read-more span,article a.read-more span,#causes a.read-more span,.bundle-edit a.read-more span,#help article a.read-more span,#books-getting-started article a.read-more span,.manage-purchased-package a.read-more span,.redeem-purchased-package a.read-more span,#publisher article a.read-more span,#editors-new article a.read-more span {
            font-family: "Whitney SSm A","Whitney SSm B";
            font-style: normal;
            position: absolute;
            font-size: 1.5em;
            top: -1px;
            right: -12px
        }

        .type-system pre,#sign-up pre,#sign-in pre,article pre,#causes pre,.bundle-edit pre,#help article pre,#books-getting-started article pre,.manage-purchased-package pre,.redeem-purchased-package pre,#publisher article pre,#editors-new article pre {
            font-family: "Lucida Console",Monaco,monospace
        }

        .type-system section,#sign-up section,#sign-in section,article section,#causes section,.bundle-edit section,#help article section,#books-getting-started article section,.manage-purchased-package section,.redeem-purchased-package section,#publisher article section,#editors-new article section {
            margin-bottom: 2.875em
        }

        .type-system-readable,#read-online .read {
            text-align: left
        }

        .type-system-readable h1,#read-online .read h1,.type-system-readable h2,#read-online .read h2,.type-system-readable h3,#read-online .read h3,.type-system-readable p,#read-online .read p {
            margin: 0
        }

        .type-system-readable hr,#read-online .read hr {
            border-bottom: 1px solid #cbcbcb;
            border-left: none;
            border-right: none;
            border-top: none;
            margin: 1.5em 0
        }

        .type-system-readable p,#read-online .read p {
            color: #323232;
            line-height: 1.5
        }

        .type-system-readable .type,#read-online .read .type {
            border-bottom: 1px solid;
            display: inline-block;
            font-family: "Open Sans",sans-serif,sans-serif;
            font-size: 0.7em;
            font-weight: 800;
            margin-bottom: 2em;
            padding: 0.3em 0;
            text-align: left;
            text-transform: uppercase
        }

        .type-system-readable h1,#read-online .read h1 {
            font-family: "Merriweather",serif;
            font-size: 1.8em;
            font-weight: 700;
            margin-bottom: 0.5em
        }

        @media screen and (min-width: 40em) {
            .type-system-readable h1,#read-online .read h1 {
                font-size:2.6em
            }
        }

        .type-system-readable h2,#read-online .read h2 {
            font-family: "Merriweather",serif;
            font-size: 1.2em;
            font-style: italic;
            font-weight: 400;
            line-height: 1.4em;
            margin-bottom: 1.1em
        }

        @media screen and (min-width: 40em) {
            .type-system-readable h2,#read-online .read h2 {
                font-size:1.3em
            }
        }

        .type-system-readable pre,#read-online .read pre {
            background: #F7F7F7;
            border-radius: 6px;
            border: 1px solid #E0E0E0;
            font-size: 0.7em;
            font-style: normal;
            padding: 1em;
            white-space: pre
        }

        .type-system-readable h3,#read-online .read h3 {
            font-family: "Merriweather",serif;
            font-size: 1.4em;
            font-weight: 400;
            line-height: 1.3em;
            margin-bottom: 0.4em
        }

        .type-system-readable h4,#read-online .read h4,.type-system-readable h5,#read-online .read h5,.type-system-readable h6,#read-online .read h6 {
            font-family: "Merriweather",serif
        }

        .type-system-readable p.date,#read-online .read p.date {
            color: rgba(50,50,50,0.4);
            font-family: "Merriweather",serif;
            font-size: 0.9em;
            font-style: italic;
            margin-bottom: 0.3em
        }

        .type-system-readable p,#read-online .read p {
            font-family: "Open Sans",sans-serif,sans-serif;
            font-size: 1.05em;
            line-height: 1.5em;
            margin-bottom: 1.5em
        }

        .type-system-readable a.read-more,#read-online .read a.read-more {
            display: inline-block;
            font-family: "Open Sans",sans-serif,sans-serif;
            font-size: 0.8em;
            font-weight: 700;
            margin-left: 0.2em;
            position: relative;
            text-transform: uppercase
        }

        .type-system-readable a.read-more span,#read-online .read a.read-more span {
            font-family: "Open Sans",sans-serif,sans-serif;
            font-size: 1.5em;
            font-style: normal;
            position: absolute;
            right: -12px;
            top: -1px
        }

        .type-system-readable hr,#read-online .read hr {
            width: 3em
        }

        .type-system-readable p.author,#read-online .read p.author {
            font-family: "Open Sans",sans-serif,sans-serif
        }

        .type-system-readable ol.numeric,#read-online .read ol.numeric {
            list-style-type: decimal
        }

        .type-system-readable blockquote,#read-online .read blockquote {
            border-left: 1px solid #cbcbcb
        }

        @media only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (min--moz-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2 / 1), only screen and (min-resolution: 192dpi), only screen and (min-resolution: 2dppx) {
            .type-system-readable p,#read-online .read p,.type-system-readable a,#read-online .read a,.type-system-readable .type,#read-online .read .type {
                font-family:"Merriweather",serif
            }

            .type-system-readable h1,#read-online .read h1,.type-system-readable h2,#read-online .read h2,.type-system-readable h3,#read-online .read h3,.type-system-readable h4,#read-online .read h4,.type-system-readable h5,#read-online .read h5,.type-system-readable h6,#read-online .read h6 {
                font-family: "Open Sans",sans-serif,sans-serif
            }
        }

        .table,.royalties-table {
            table-layout: auto
        }

        .table th,.royalties-table th,.table td,.royalties-table td {
            padding: .625em 0;
            font-weight: normal;
            border: 0
        }

        .table th,.royalties-table th {
            font-size: 1.125em;
            color: #009aff
        }

        .table td,.royalties-table td {
            font-size: .875em;
            color: #666
        }

        .table-minimal {
            table-layout: auto;
            border-collapse: separate;
            border-spacing: 0;
            text-align: left
        }

        .table-minimal tbody tr:hover>td,.table-minimal tbody tr:hover>th {
            background-color: #f6f6f6
        }

        .table-minimal tbody tr:first-child td {
            border-top: 1px solid #cbcbcb
        }

        .table-minimal thead th {
            background-color: #fff;
            padding: 0.5em;
            border: 0px;
            border-top: 1px solid #cbcbcb;
            font-size: .875em
        }

        .table-minimal thead th:first-child {
            border-top-left-radius: 4px;
            border-left: 1px solid #cbcbcb
        }

        .table-minimal thead th:last-child {
            border-top-right-radius: 4px;
            border-right: 1px solid #cbcbcb
        }

        .table-minimal tbody {
            background-color: #fbfbfb
        }

        .table-minimal tbody td {
            padding: 0.5em;
            border-top: 1px solid #cbcbcb;
            border-bottom: 0px
        }

        .table-minimal tbody td button {
            border: 1px solid #d7d7d7;
            border-radius: 3px;
            box-shadow: inset 0 1px 0 0 #fff;
            color: #333;
            display: inline-block;
            font-size: inherit;
            font-weight: bold;
            background-color: #fbfbfb;
            background-image: -webkit-linear-gradient(#fbfbfb, #dfdfdf);
            background-image: linear-gradient(#fbfbfb,#dfdfdf);
            padding: 7px 18px;
            text-decoration: none;
            text-shadow: 0 1px 0 #fff;
            background-clip: padding-box;
            border: 1px solid #dbd4d4;
            border-radius: 3px;
            box-shadow: inset 0 1px 0 0 #fff;
            color: #333;
            display: inline-block;
            font-size: inherit;
            font-weight: bold;
            background-color: #fbfbfb;
            background-image: -webkit-linear-gradient(#fbfbfb, #e2dcdc);
            background-image: linear-gradient(#fbfbfb,#e2dcdc);
            padding: 7px 18px;
            text-decoration: none;
            text-shadow: 0 1px 0 #fff;
            background-clip: padding-box;
            margin-right: 0.5em;
            display: inline-block;
            width: 100%;
            margin-bottom: .3em;
            outline: none
        }

        .table-minimal tbody td button:hover:not(:disabled) {
            box-shadow: inset 0 1px 0 0 #fff;
            cursor: pointer;
            background-color: #eee;
            background-image: -webkit-linear-gradient(#eee, #d7d7d7);
            background-image: linear-gradient(#eeeeee,#d7d7d7)
        }

        .table-minimal tbody td button:active:not(:disabled),.table-minimal tbody td button:focus:not(:disabled) {
            border: 1px solid #d7d7d7;
            box-shadow: inset 0 0 8px 4px #d0d0d0,inset 0 0 8px 4px #d0d0d0
        }

        .table-minimal tbody td button:hover:not(:disabled) {
            box-shadow: inset 0 1px 0 0 #fff;
            cursor: pointer;
            background-color: #eee;
            background-image: -webkit-linear-gradient(#eee, #dad4d4);
            background-image: linear-gradient(#eeeeee,#dad4d4)
        }

        .table-minimal tbody td button:active:not(:disabled),.table-minimal tbody td button:focus:not(:disabled) {
            border: 1px solid #dbd4d4;
            box-shadow: inset 0 0 8px 4px #d3cccc,inset 0 0 8px 4px #d3cccc
        }

        .table-minimal tbody td button:disabled {
            opacity: 0.5;
            cursor: not-allowed
        }

        @media screen and (min-width: 40em) {
            .table-minimal tbody td button {
                width:auto;
                margin-bottom: 0
            }
        }

        .royalties-table tr {
            border-bottom: 0
        }

        .royalties-table-wrapper {
            padding: 2.35765%;
            position: relative;
            margin-top: 3em;
            margin-bottom: 3em;
            text-align: center;
            font-size: .5em
        }

        @media screen and (min-width: 53.75em) {
            .royalties-table-wrapper {
                padding:.875em 2em 2em;
                text-align: left;
                font-size: 1em
            }
        }

        .centered {
            text-align: center
        }

        table.small {
            font-size: .8125em
        }

        .no-hover tr:hover,.no-hover td:hover {
            background-color: inherit
        }

        .video {
            position: relative;
            margin: auto
        }

        .video iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%
        }

        .video .video-wrapper {
            position: relative;
            height: 0;
            padding-bottom: 56.25%;
            border: 1px solid #cbcbcb
        }

        .screenshot {
            position: relative
        }

        .screenshot img {
            margin: auto
        }

        .screenshot::before {
            position: absolute;
            top: 0px;
            right: 0px;
            bottom: 0px;
            left: 0px;
            margin: auto;
            color: #fff;
            -webkit-transition: all 0.2s ease-in-out;
            -moz-transition: all 0.2s ease-in-out;
            transition: all 0.2s ease-in-out
        }

        .screenshot:hover::before {
            color: #009aff
        }

        .dropdown {
            display: inline-block;
            vertical-align: middle;
            text-align: left;
            margin: 0 0.75em;
            font-size: .8125em;
            color: #009aff
        }

        .dropdown-container {
            display: block;
            position: relative
        }

        .dropdown-description {
            background: transparent;
            border-bottom-left-radius: 4px;
            border-top-left-radius: 4px;
            color: #989898;
            float: left;
            font-size: .75em;
            line-height: 40px;
            margin-bottom: 0;
            padding: 0 0.5em 0 1em
        }

        @media screen and (min-width: 53.75em) {
            .dropdown-description {
                font-size:1em
            }
        }

        .dropdown-button {
            background: transparent;
            border-bottom-right-radius: 4px;
            border-top-right-radius: 4px;
            cursor: pointer;
            float: right;
            line-height: 40px;
            margin-bottom: 0;
            padding: 0 3.5em 0 0.5em;
            position: relative;
            text-transform: capitalize
        }

        .dropdown-button i.fa {
            margin-right: 0.75em
        }

        .dropdown-button::after {
            font-family: FontAwesome;
            content: "\f107";
            margin-left: 0.75em
        }

        @media screen and (min-width: 53.75em) {
            .dropdown-button {
                font-size:1em;
                padding: 0 2.5em 0 0.5em
            }
        }

        .dropdown-button:hover {
            color: #009aff
        }

        .menu {
            -webkit-transition: all 0.2s ease-in-out;
            -moz-transition: all 0.2s ease-in-out;
            transition: all 0.2s ease-in-out;
            background: #fbfbfb;
            border-radius: 4px;
            border: 1px solid #cbcbcb;
            box-shadow: 0 2px 2px rgba(0,0,0,0.2);
            color: #323232;
            cursor: pointer;
            display: none;
            overflow: visible;
            position: absolute;
            top: 50px;
            z-index: 99999
        }

        .menu.flush-left {
            left: 0
        }

        .menu.flush-center {
            right: -10px
        }

        .menu.flush-right {
            right: 0
        }

        .menu i {
            margin-right: .5em;
            font-size: 1.375em;
            vertical-align: middle
        }

        .menu:before {
            position: absolute;
            right: 16px;
            color: #fbfbfb;
            content: "\25b2";
            font-size: 24px;
            pointer-events: none;
            text-shadow: 0 -1px 1px rgba(0,0,0,0.3);
            top: -23px
        }

        .filter-header {
            margin: 0;
            padding: 0;
            font-size: 1.125em
        }

        .menu li {
            color: #323232;
            padding: .125em 1em;
            line-height: 2.25em
        }

        .menu li a {
            display: block;
            color: inherit
        }

        .menu li:hover {
            background: #f3f3f3
        }

        .menu li:hover a {
            color: #009aff
        }

        .menu li:hover a,.menu li:hover a:hover {
            text-decoration: none
        }

        .menu li:first-child {
            border-top-left-radius: 4px;
            border-top-right-radius: 4px
        }

        .menu li:last-child {
            border-bottom: none;
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px
        }

        .menu li.active {
            color: #009aff
        }

        .show-menu {
            display: block
        }

        #user-books,#user-unpublished {
            background: #fff
        }

        .profile-wrapper {
            margin-bottom: 2em
        }

        .author-profile,.contributor-profile,.publisher-profile,.user-profile,.cause-profile {
            padding: 2.35765%
        }

        .author-profile hr,.contributor-profile hr,.publisher-profile hr,.user-profile hr,.cause-profile hr {
            margin: .5em 0
        }

        .author-profile .profile-details,.contributor-profile .profile-details,.publisher-profile .profile-details,.user-profile .profile-details,.cause-profile .profile-details {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 14.70196%
        }

        .author-profile .profile-details:last-child,.contributor-profile .profile-details:last-child,.publisher-profile .profile-details:last-child,.user-profile .profile-details:last-child,.cause-profile .profile-details:last-child {
            margin-right: 0
        }

        .author-profile .avatar,.contributor-profile .avatar,.publisher-profile .avatar,.user-profile .avatar,.cause-profile .avatar,.author-profile .avatar-and-name,.contributor-profile .avatar-and-name,.publisher-profile .avatar-and-name,.user-profile .avatar-and-name,.cause-profile .avatar-and-name {
            margin-bottom: 1.5em
        }

        .author-profile .profile-icons i,.contributor-profile .profile-icons i,.publisher-profile .profile-icons i,.user-profile .profile-icons i,.cause-profile .profile-icons i {
            font-size: 2em
        }

        .author-profile .profile-name,.contributor-profile .profile-name,.publisher-profile .profile-name,.user-profile .profile-name,.cause-profile .profile-name {
            font-weight: 400;
            font-size: 1.25em
        }

        .author-profile .profile-name a:hover,.contributor-profile .profile-name a:hover,.publisher-profile .profile-name a:hover,.user-profile .profile-name a:hover,.cause-profile .profile-name a:hover {
            text-decoration: none
        }

        .author-profile .profile-title,.contributor-profile .profile-title,.publisher-profile .profile-title,.user-profile .profile-title,.cause-profile .profile-title {
            text-transform: uppercase;
            font-size: .75em;
            color: #797979
        }

        .author-profile .profile-icons a,.contributor-profile .profile-icons a,.publisher-profile .profile-icons a,.user-profile .profile-icons a {
            display: block;
            text-align: center;
            margin-bottom: 0.75em
        }

        .author-profile .profile-info-wrapper,.contributor-profile .profile-info-wrapper,.publisher-profile .profile-info-wrapper,.user-profile .profile-info-wrapper {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 82.94039%
        }

        .author-profile .profile-info-wrapper:last-child,.contributor-profile .profile-info-wrapper:last-child,.publisher-profile .profile-info-wrapper:last-child,.user-profile .profile-info-wrapper:last-child {
            margin-right: 0
        }

        .cause-profile .cause-logo {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 31.76157%
        }

        .cause-profile .cause-logo:last-child {
            margin-right: 0
        }

        .cause-profile .cause-titles {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 65.88078%;
            margin-right: 0
        }

        .cause-profile .cause-titles:last-child {
            margin-right: 0
        }

        .publisher-profile {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 65.88078%;
            margin-left: 17.05961%;
            text-align: center
        }

        .publisher-profile:last-child {
            margin-right: 0
        }

        .publisher-profile .profile-name a {
            color: #009aff
        }

        .publisher-profile .profile-name a:hover {
            color: #006cb3
        }

        .owl-carousel .owl-wrapper-outer {
            overflow: hidden
        }

        .list-controls .owl-controls {
            display: inline-block;
            vertical-align: middle;
            margin-left: 8px
        }

        .list-controls .owl-prev,.list-controls .owl-next {
            display: inline-block;
            vertical-align: sub;
            color: #666;
            padding: 0 4px
        }

        .list-controls .owl-prev.disabled,.list-controls .owl-next.disabled {
            opacity: 0.3;
            cursor: default;
            pointer-events: none
        }

        .list-controls .owl-prev:hover,.list-controls .owl-next:hover {
            color: #009aff
        }

        .list-controls .owl-prev::before {
            font-family: FontAwesome;
            font-size: 1.25em;
            content: "\f053"
        }

        .list-controls .owl-next::before {
            font-family: FontAwesome;
            font-size: 1.25em;
            content: "\f054"
        }

        .book-title,.bundle-title,.book-title a,.bundle-title a {
            margin-bottom: 0.5em;
            font-size: 1.5em;
            color: #000
        }

        @media screen and (min-width: 53.75em) {
            .book-title,.bundle-title,.book-title a,.bundle-title a {
                font-size:1.5em
            }
        }

        .book-subtitle {
            font-size: 1em;
            margin-bottom: 1.5em;
            color: #666
        }

        .book-author,.author-profile .profile-name,.contributor-profile .profile-name,.publisher-profile .profile-name,.user-profile .profile-name,.cause-profile .profile-name,.bundles-authors {
            text-decoration: none;
            color: #000
        }

        .book-author>a,.author-profile .profile-name>a,.contributor-profile .profile-name>a,.publisher-profile .profile-name>a,.user-profile .profile-name>a,.cause-profile .profile-name>a,.bundles-authors>a {
            display: inline-block;
            height: 32px;
            line-height: 32px
        }

        .byline,.book-titles>p {
            text-transform: uppercase;
            font-size: .625em
        }

        .byline a,.book-titles>p a {
            text-transform: none;
            font-family: inherit;
            font-size: 1.5em;
            display: inline;
            line-height: 1.5;
            margin: 0 1px;
            vertical-align: baseline;
            color: inherit
        }

        .book-description,.bundle-description {
            margin-bottom: 1em;
            font-weight: 400;
            font-size: .9375em;
            line-height: 1.5
        }

        .book-description .more,.bundle-description .more {
            font-size: .8125em
        }

        .cover-image {
            position: relative
        }

        .cover-image a {
            display: block
        }

        .cover-image img {
            background-color: #fff;
            font-size: 13px;
            line-height: 16px
        }

        .cover-image img,.cover-image .cover-missing,.cover-image .cover-more,.cover-image .cover-browse {
            display: block;
            width: auto;
            height: auto;
            max-width: 100%;
            margin: 0 auto 0.75em auto;
            padding: 0
        }

        .cover-image.full img {
            max-height: 854px
        }

        .cover-image.hero img {
            max-height: 600px
        }

        .cover-image.large img {
            max-height: 420px
        }

        .cover-image.medium img {
            max-height: 360px
        }

        .cover-image.small img {
            max-height: 180px
        }

        .cover-image.tiny img {
            max-height: 50px
        }

        .cover-image.pseudo-cover {
            border-radius: 0;
            cursor: pointer;
            width: 100%
        }

        .cover-image.pseudo-cover .more::before,.cover-image.pseudo-cover .missing::before,.cover-image.pseudo-cover .search::before {
            position: absolute;
            top: 0px;
            right: 0px;
            bottom: 0px;
            left: 0px;
            height: 2em;
            margin: auto;
            font-family: FontAwesome;
            text-align: center;
            color: inherit;
            font-size: 3em
        }

        .cover-image.pseudo-cover .missing::before {
            content: "\f128"
        }

        .cover-image.pseudo-cover .more::before {
            content: "\f002"
        }

        .cover-image.pseudo-cover .search::before {
            content: "\f002"
        }

        .cover-image.pseudo-cover:hover {
            background-color: #ededed
        }

        .book-edit-link {
            background-color: #009aff;
            border-bottom: 1px solid #006cb3;
            text-shadow: 0 1px 0 #006cb3;
            color: #fff;
            position: absolute;
            top: 0;
            right: 0;
            padding: .25em .5em;
            border-radius: 0
        }

        .book-edit-link:hover {
            background-color: #006cb3;
            border-bottom: 1px solid #005c99;
            color: #d9d9d9
        }

        .book-edit-link:visited,.book-edit-link:active {
            color: #fff
        }

        .stealth-mode,.embargo-mode,.not-accepted {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
            width: 100%;
            margin-bottom: 0;
            padding: .125em .25em;
            border-radius: 0;
            font-size: .8125em;
            text-align: center
        }

        .book-progress {
            width: 80%;
            margin: .75em auto;
            text-align: center
        }

        .book-progress.complete .progress-bar {
            display: none;
            border: 1px solid #009aff;
            background-color: #009aff
        }

        .book-progress.complete .progress-bar .meter {
            display: none
        }

        .book-progress.complete .percent-complete {
            color: #009aff
        }

        .book-progress .progress-bar {
            background-color: #fff;
            display: block;
            position: relative;
            height: 8px;
            border: 1px solid #323232;
            margin: 1px;
            border-radius: 4px;
            margin-bottom: 0.75em
        }

        .book-progress .progress-bar .meter {
            position: absolute;
            top: 0px;
            right: 0px;
            bottom: 0px;
            left: 0px;
            display: inline-block;
            max-width: 99%;
            background-color: #323232;
            border-top-left-radius: 4px;
            border-bottom-left-radius: 4px
        }

        .book-progress .percent-complete {
            margin-bottom: .125em;
            color: #323232
        }

        .book-progress .last-updated {
            text-transform: uppercase;
            font-size: .75em;
            color: #797979
        }

        .book-details-list {
            text-transform: uppercase
        }

        .book-details-list.vertical .detail {
            display: block;
            margin-bottom: 1em
        }

        .book-details-list .detail {
            text-align: center;
            display: inline-block
        }

        .book-details-list .detail>span {
            display: block;
            margin-bottom: 3px;
            line-height: 1.125;
            font-size: 1.75em;
            color: #323232
        }

        .book-details-list .detail>p {
            font-size: .75em;
            color: #666;
            letter-spacing: 1px
        }

        .book-details-list .detail.percentage span {
            padding-left: 1em
        }

        .book-details-list .detail.percentage span::after {
            content: '%';
            font-size: .8125em;
            margin-left: 1px
        }

        .book-details-list .detail.complete p,.book-details-list .detail.complete span {
            color: #009aff
        }

        .book-details-list.pricing .free {
            font-size: 1.25em
        }

        .book-details-list.pricing .regular-price {
            text-decoration: line-through
        }

        .book-details-list.pricing .suggested-price {
            text-shadow: 0 1px 0 #f2f9ff;
            color: #009aff
        }

        .book-details-list.pricing .coupon-price {
            background-color: #fff6bf
        }

        .book-details-list .fa {
            font-size: 2em;
            color: #323232
        }

        .new-book section {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 82.94039%;
            margin-left: 8.5298%
        }

        .new-book section:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 53.75em) {
            .new-book section {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%;
                margin-left: 25.58941%
            }

            .new-book section:last-child {
                margin-right: 0
            }
        }

        .new-publisher-book section {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            margin-left: 0%
        }

        .new-publisher-book section:last-child {
            margin-right: 0
        }

        header.navigation {
            background-color: #fbfbfb;
            width: 100%;
            z-index: 1;
            border-bottom: 1px solid #cbcbcb
        }

        header.navigation .large-container,header.navigation #app-container,header.navigation #bookstore section,#bookstore header.navigation section {
            padding: 0 1em
        }

        header.navigation .nav {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            padding: 0;
            height: 75px
        }

        header.navigation .nav:last-child {
            margin-right: 0
        }

        header.navigation ul#navigation-menu,header.navigation ul#navigation-actions {
            width: 100%
        }

        header.navigation #navigation-actions {
            position: relative;
            z-index: 10
        }

        header.navigation .nav-logo,header.navigation .nav-link,header.navigation .nav-search,header.navigation .nav-icon,header.navigation .nav-mobile,header.navigation .nav-sign-in {
            height: 75px;
            display: inline-block;
            vertical-align: top
        }

        header.navigation .nav-logo {
            height: 75px;
            text-align: left;
            padding-right: 0;
            position: absolute;
            left: calc(50% - 25px)
        }

        header.navigation .nav-logo img {
            height: 100%;
            max-width: 50px
        }

        @media screen and (min-width: 53.75em) {
            header.navigation .nav-logo img {
                max-width:60px
            }
        }

        @media screen and (min-width: 40em) {
            header.navigation .nav-logo {
                padding-right:0.75em;
                position: initial;
                left: initial
            }
        }

        @media screen and (min-width: 53.75em) {
            header.navigation .nav-logo {
                padding-right:2em
            }
        }

        @media screen and (min-width: 64.6875em) {
            header.navigation .nav-logo {
                padding-right:3em
            }
        }

        header.navigation .nav-link {
            display: none;
            text-align: left;
            vertical-align: top;
            padding-right: 1em;
            line-height: 75px
        }

        header.navigation .nav-link a {
            display: inline-block;
            font-size: 1.125em;
            color: #323232;
            padding: 0
        }

        header.navigation .nav-link a:hover {
            color: gray;
            text-decoration: none
        }

        @media screen and (min-width: 40em) {
            header.navigation .nav-link {
                padding-right:0.75em;
                display: inline-block
            }
        }

        @media screen and (min-width: 53.75em) {
            header.navigation .nav-link {
                padding-right:2em
            }
        }

        @media screen and (min-width: 64.6875em) {
            header.navigation .nav-link {
                padding-right:3em
            }
        }

        header.navigation .nav-right-wrapper {
            display: inline-block;
            text-align: right;
            float: right
        }

        header.navigation .nav-search {
            display: none;
            padding-right: 0.375em
        }

        header.navigation .nav-search form {
            display: inline-block;
            position: relative;
            height: 100%
        }

        header.navigation .nav-search button {
            color: gray;
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            background-color: transparent;
            border: none;
            text-shadow: none;
            padding: 0
        }

        header.navigation .nav-search input {
            border: none;
            border-bottom: 1px solid #cbcbcb;
            border-radius: 0;
            background-color: #fbfbfb;
            box-shadow: none;
            margin: 0
        }

        header.navigation .nav-search input:focus {
            border-color: #99d7ff
        }

        header.navigation .nav-search input:focus+button {
            color: #009aff
        }

        @media screen and (min-width: 40em) {
            header.navigation .nav-search input {
                width:155px;
                margin-top: 1.1em
            }
        }

        @media screen and (min-width: 53.75em) {
            header.navigation .nav-search input {
                width:200px;
                margin-top: 1.2em
            }
        }

        @media screen and (min-width: 64.6875em) {
            header.navigation .nav-search input {
                width:300px
            }
        }

        @media screen and (min-width: 40em) {
            header.navigation .nav-search {
                display:inline-block;
                padding-right: 0.125em
            }
        }

        @media screen and (min-width: 53.75em) {
            header.navigation .nav-search {
                padding-right:0.375em
            }
        }

        @media screen and (min-width: 64.6875em) {
            header.navigation .nav-search {
                padding-right:0.5em
            }
        }

        header.navigation .nav-icon {
            font-size: 2em;
            line-height: 75px;
            padding: 0 0.375em;
            position: relative;
            border-left: 1px solid #fbfbfb;
            border-right: 1px solid #fbfbfb
        }

        header.navigation .nav-icon img {
            margin-top: 2px;
            height: 32px;
            border-radius: 50%;
            vertical-align: text-top
        }

        header.navigation .nav-icon a {
            display: inline-block
        }

        header.navigation .nav-icon i {
            color: gray
        }

        header.navigation .nav-icon:hover {
            cursor: pointer;
            text-decoration: none
        }

        header.navigation .nav-icon:hover i {
            color: #009aff
        }

        header.navigation .nav-icon:hover img {
            box-shadow: 0 0 5px 1px #009aff
        }

        header.navigation .nav-icon.open {
            background-color: #fff;
            border-left: 1px solid #cbcbcb;
            border-right: 1px solid #cbcbcb;
            height: 76px;
            z-index: initial
        }

        header.navigation .nav-icon.account {
            display: none;
            margin-right: -0.5em
        }

        @media screen and (min-width: 53.75em) {
            header.navigation .nav-icon.account {
                margin-right:0
            }
        }

        @media screen and (min-width: 40em) {
            header.navigation .nav-icon {
                padding:0 0.125em
            }
        }

        @media screen and (min-width: 53.75em) {
            header.navigation .nav-icon {
                padding:0 0.375em
            }
        }

        @media screen and (min-width: 64.6875em) {
            header.navigation .nav-icon {
                padding:0 0.5em
            }
        }

        header.navigation .nav-sign-in,header.navigation .nav-sign-up {
            display: none;
            line-height: 75px;
            padding: 0 0.375em
        }

        header.navigation .nav-sign-up {
            padding-right: 0
        }

        header.navigation .nav-mobile {
            padding: 0
        }

        @media screen and (min-width: 40em) {
            header.navigation .nav-mobile {
                display:none
            }
        }

        header.navigation #shopping-cart-icon {
            position: relative
        }

        header.navigation #shopping-cart-icon .notification-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #ff4100;
            border-radius: 50%;
            color: #fff;
            padding: 5px;
            font-size: 10px;
            line-height: 5px
        }

        header.navigation #account-icon {
            position: relative;
            display: inline-block;
            vertical-align: middle
        }

        header.navigation #account-icon .dropdown-caret {
            display: inline-block;
            font-size: 21px;
            position: relative;
            top: -5px;
            right: 0
        }

        header.navigation #account-icon.open .dropdown-caret {
            -moz-transform: scaleY(-1);
            -o-transform: scaleY(-1);
            -webkit-transform: scaleY(-1);
            transform: scaleY(-1);
            filter: FlipV;
            -ms-filter: "FlipV"
        }

        @media screen and (min-width: 53.75em) {
            header.navigation.large {
                padding-bottom:4em;
                border-bottom: none
            }
        }

        #account-dropdown {
            position: absolute;
            right: -1px;
            top: 75px;
            font-size: 0.4em;
            background-color: #fff;
            border: 1px solid #cbcbcb;
            z-index: -1;
            padding: 20px;
            text-align: left;
            display: none;
            cursor: initial
        }

        #account-dropdown.open {
            display: block
        }

        #account-dropdown ul.account-section {
            display: flex
        }

        #account-dropdown .account,#account-dropdown .author-account,#account-dropdown .publisher-account,#account-dropdown .quick-links {
            width: 150px;
            display: inline-block;
            vertical-align: top;
            padding-right: 30px
        }

        #account-dropdown .account h3,#account-dropdown .author-account h3,#account-dropdown .publisher-account h3,#account-dropdown .quick-links h3 {
            margin-bottom: 0.8em
        }

        #account-dropdown .account a,#account-dropdown .author-account a,#account-dropdown .publisher-account a,#account-dropdown .quick-links a {
            margin-bottom: 1.2em;
            line-height: 1em;
            color: #323232
        }

        #account-dropdown .account a:hover,#account-dropdown .author-account a:hover,#account-dropdown .publisher-account a:hover,#account-dropdown .quick-links a:hover {
            color: #009aff
        }

        #account-dropdown .publisher-account {
            margin-top: 1.8em
        }

        #account-dropdown .quick-links {
            display: none
        }

        #account-dropdown .quick-links a {
            display: block
        }

        @media screen and (min-width: 40em) {
            #account-dropdown .quick-links {
                display:inline-block
            }
        }

        #account-dropdown .actions {
            padding: 20px;
            margin: 0 -20px -20px;
            background-color: #f6f6f6;
            line-height: 1em
        }

        #account-dropdown .actions .help a {
            color: #666
        }

        #account-dropdown .actions .logout {
            float: right
        }

        #account-dropdown .guest,#account-dropdown .user,#account-dropdown .reader,#account-dropdown .author,#account-dropdown .author-account,#account-dropdown .publisher-account {
            display: none
        }

        .sliding-panel-content {
            position: fixed;
            top: 0px;
            right: auto;
            bottom: 0px;
            left: 0px;
            width: 220px;
            height: 100%;
            -webkit-transform: translateX(-220px);
            -moz-transform: translateX(-220px);
            -ms-transform: translateX(-220px);
            -o-transform: translateX(-220px);
            transform: translateX(-220px);
            -webkit-transition: all 0.25s linear;
            -moz-transition: all 0.25s linear;
            transition: all 0.25s linear;
            background: #8d8d8d;
            z-index: 999999;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch
        }

        .sliding-panel-content ul {
            padding: 0;
            margin: 0
        }

        .sliding-panel-content li {
            list-style: none
        }

        .sliding-panel-content li a {
            border-bottom: 1px solid #999;
            color: #fff;
            display: block;
            font-weight: bold;
            padding: 1em;
            text-decoration: none
        }

        .sliding-panel-content li a:focus {
            background-color: #9a9a9a
        }

        .sliding-panel-content li a:hover {
            background-color: #009aff;
            color: #fff
        }

        .sliding-panel-content.is-visible {
            -webkit-transform: translateX(0);
            -moz-transform: translateX(0);
            -ms-transform: translateX(0);
            -o-transform: translateX(0);
            transform: translateX(0)
        }

        .sliding-panel-content .search-bar form {
            position: relative;
            padding: 0
        }

        .sliding-panel-content .search-bar input {
            border: none;
            border-bottom: 1px solid #999;
            border-radius: 0;
            background-color: #8d8d8d;
            box-shadow: none;
            margin: 0;
            color: #fff;
            padding: 1em
        }

        .sliding-panel-content .search-bar button {
            position: absolute;
            right: 0;
            top: 11px;
            background-color: transparent;
            border: none
        }

        .sliding-panel-fade-screen {
            position: fixed;
            top: 0px;
            right: 0px;
            bottom: 0px;
            left: 0px;
            -webkit-transition: all 0.15s ease-out 0s;
            -moz-transition: all 0.15s ease-out 0s;
            transition: all 0.15s ease-out 0s;
            background: black;
            opacity: 0;
            visibility: hidden;
            z-index: 999998
        }

        .sliding-panel-fade-screen.is-visible {
            opacity: 0.4;
            visibility: visible
        }

        .sliding-panel-button {
            padding: 10px 16px;
            display: inline-block;
            cursor: pointer;
            position: relative;
            outline: none
        }

        .sliding-panel-button img {
            height: 1.3em
        }

        .footer {
            padding: 2em 2.35765% 3em 2.35765%;
            background-color: #323232;
            color: #f2f2f2
        }

        .footer h1.footer-logo {
            width: 90px;
            margin: auto;
            margin-bottom: 40px
        }

        .footer .footer-links {
            margin-bottom: 20px;
            margin-top: 20px
        }

        .footer .footer-links:after {
            content: "";
            display: table;
            clear: both
        }

        .footer ul {
            padding: 0 15px
        }

        @media screen and (max-width: 53.75em) {
            .footer ul {
                width:100%;
                margin-bottom: 10px
            }
        }

        @media screen and (min-width: 40em) {
            .footer ul {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 31.76157%
            }

            .footer ul:last-child {
                margin-right: 0
            }

            .footer ul:nth-child(3) {
                margin-right: 0
            }

            .footer ul:nth-child(3+1) {
                clear: left
            }
        }

        @media screen and (min-width: 53.75em) {
            .footer ul {
                float:left;
                display: block;
                margin-right: 0.4628%;
                width: 19.62976%
            }

            .footer ul:last-child {
                margin-right: 0
            }
        }

        .footer li:first-child {
            margin-bottom: 5px;
            font-size: 1.125em;
            color: inherit
        }

        .footer li a {
            color: inherit;
            font-size: .8125em
        }

        .footer li a:hover {
            text-decoration: underline
        }

        .footer p.copyright {
            padding: 10px;
            width: 75%;
            margin: auto;
            font-size: .75em;
            line-height: 1.5;
            text-align: center;
            color: inherit
        }

        .tooltip-item {
            position: relative;
            border: 0;
            cursor: initial
        }

        .tooltip-item:hover .tooltip {
            visibility: visible;
            opacity: 1
        }

        .tooltip-item.more-info {
            position: relative
        }

        .tooltip-item.more-info:hover {
            color: #009aff;
            cursor: pointer
        }

        .tooltip-item .tooltip {
            position: absolute;
            left: 50%;
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
            -webkit-transition: all 0.2s ease-in-out;
            -moz-transition: all 0.2s ease-in-out;
            transition: all 0.2s ease-in-out;
            bottom: 180%;
            min-width: 12em;
            padding: 10px;
            margin-left: -6em;
            background-color: gray;
            border-radius: 4px;
            box-shadow: 0 2px 2px silver;
            text-align: center;
            line-height: 16px;
            font-size: 12px;
            color: #fff;
            visibility: hidden;
            opacity: 0;
            z-index: 100
        }

        .tooltip-item .tooltip p {
            margin-bottom: 1em;
            font-family: inherit;
            font-size: 1em
        }

        .tooltip-item .tooltip p:last-child {
            margin-bottom: 0
        }

        .tooltip-item .tooltip form {
            margin: 0
        }

        .tooltip-item .tooltip:after {
            position: absolute;
            left: 46%;
            content: '';
            pointer-events: none;
            margin-left: -5px;
            bottom: -10px;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid gray
        }

        .tooltip-for-button {
            display: inline-block;
            position: relative;
            border: 1px solid #cbcbcb;
            border-radius: 4px;
            padding: .5em 1em;
            font-size: .8125em;
            margin-right: 8px
        }

        .tooltip-for-button p {
            margin: 0
        }

        .tooltip-for-button::before,.tooltip-for-button::after {
            content: '';
            background-color: inherit;
            pointer-events: none
        }

        .tooltip-for-button::after {
            height: 0;
            width: 0;
            border-left: 9px solid transparent;
            border-right: 9px solid transparent;
            border-top: 9px solid #fff;
            position: absolute;
            bottom: -9px;
            left: 45%
        }

        .tooltip-for-button::before {
            height: 0;
            width: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid #cbcbcb;
            position: absolute;
            right: 0px;
            bottom: -10px;
            left: 44%
        }

        .noscroll {
            overflow: hidden !important
        }

        .modal {
            display: inline-block
        }

        .modal label {
            cursor: pointer
        }

        .modal label img {
            display: block;
            max-width: 300px
        }

        .modal input[type="checkbox"] {
            display: none
        }

        .modal .btn {
            border: 1px solid #d7d7d7;
            border-radius: 3px;
            box-shadow: inset 0 1px 0 0 #fff;
            color: #333;
            display: inline-block;
            font-size: inherit;
            font-weight: bold;
            background-color: #fbfbfb;
            background-image: -webkit-linear-gradient(#fbfbfb, #dfdfdf);
            background-image: linear-gradient(#fbfbfb,#dfdfdf);
            padding: 7px 18px;
            text-decoration: none;
            text-shadow: 0 1px 0 #fff;
            background-clip: padding-box;
            border: 1px solid #dbd4d4;
            border-radius: 3px;
            box-shadow: inset 0 1px 0 0 #fff;
            color: #333;
            display: inline-block;
            font-size: inherit;
            font-weight: bold;
            background-color: #fbfbfb;
            background-image: -webkit-linear-gradient(#fbfbfb, #e2dcdc);
            background-image: linear-gradient(#fbfbfb,#e2dcdc);
            padding: 7px 18px;
            text-decoration: none;
            text-shadow: 0 1px 0 #fff;
            background-clip: padding-box;
            font-size: 1em;
            margin-bottom: 1.5
        }

        .modal .btn:hover:not(:disabled) {
            box-shadow: inset 0 1px 0 0 #fff;
            cursor: pointer;
            background-color: #eee;
            background-image: -webkit-linear-gradient(#eee, #d7d7d7);
            background-image: linear-gradient(#eeeeee,#d7d7d7)
        }

        .modal .btn:active:not(:disabled),.modal .btn:focus:not(:disabled) {
            border: 1px solid #d7d7d7;
            box-shadow: inset 0 0 8px 4px #d0d0d0,inset 0 0 8px 4px #d0d0d0
        }

        .modal .btn:hover:not(:disabled) {
            box-shadow: inset 0 1px 0 0 #fff;
            cursor: pointer;
            background-color: #eee;
            background-image: -webkit-linear-gradient(#eee, #dad4d4);
            background-image: linear-gradient(#eeeeee,#dad4d4)
        }

        .modal .btn:active:not(:disabled),.modal .btn:focus:not(:disabled) {
            border: 1px solid #dbd4d4;
            box-shadow: inset 0 0 8px 4px #d3cccc,inset 0 0 8px 4px #d3cccc
        }

        .modal .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed
        }

        .modal .modal-open {
            overflow: hidden
        }

        .modal .modal-window {
            -webkit-transition: opacity 0.5s ease;
            -moz-transition: opacity 0.5s ease;
            transition: opacity 0.5s ease;
            position: fixed;
            top: 0px;
            right: 0px;
            bottom: 0px;
            left: 0px;
            background: rgba(0,0,0,0.75);
            opacity: 0;
            text-align: left;
            visibility: hidden;
            z-index: 10
        }

        .modal .modal-window .modal-bg {
            position: absolute;
            top: 0px;
            right: 0px;
            bottom: 0px;
            left: 0px;
            cursor: pointer
        }

        .modal .modal-close {
            position: absolute;
            top: 0.809em;
            right: 0.809em;
            width: 2em;
            height: 2em;
            cursor: pointer
        }

        .modal .modal-close::before {
            font-size: 1.75em;
            display: block;
            font-family: FontAwesome;
            content: "\f00d";
            color: #8a8a8a;
            text-shadow: 0 1px 0 #8a8a8a
        }

        .modal .modal-close:hover::before {
            color: #4d4d4d
        }

        .modal .modal-inner {
            -webkit-transition: opacity 0.25s ease;
            -moz-transition: opacity 0.25s ease;
            transition: opacity 0.25s ease;
            border-radius: 4px;
            border: 1px solid #cbcbcb;
            background: #fff;
            margin: auto;
            max-height: 95%;
            position: relative;
            overflow: auto;
            width: 95%;
            padding: 0.809em;
            margin-top: .6em
        }

        @media screen and (min-width: 40em) {
            .modal .modal-inner {
                padding:1.618em;
                width: 60%;
                max-height: 90%;
                margin-top: 1em
            }
        }

        @media screen and (min-width: 53.75em) {
            .modal .modal-inner {
                width:50%;
                margin-top: 1em
            }
        }

        .modal .modal-inner h1 {
            margin-bottom: .6em;
            text-align: left;
            text-transform: capitalize;
            font-size: 1.75em;
            color: #323232
        }

        .modal .modal-inner p {
            font-size: 1em;
            max-width: 100% !important;
            padding: 0;
            text-align: left
        }

        .modal .modal-inner p.intro {
            color: #009aff;
            line-height: 1.6em
        }

        .modal .modal-inner p.help-block,.modal .modal-inner #details-panel p.refund,#details-panel .modal .modal-inner p.refund {
            font-size: .75em
        }

        .modal .modal-inner p.body {
            color: #323232;
            line-height: 1.45em
        }

        @media screen and (min-width: 40em) {
            .modal .modal-inner p.body {
                -webkit-columns:2 8em;
                -moz-columns: 2 8em;
                columns: 2 8em
            }
        }

        .modal .modal-inner a.cta {
            color: white;
            display: inline-block;
            margin-right: .5em;
            margin-top: 1em
        }

        .modal .modal-inner a.cta:last-child {
            padding: 0 2em
        }

        .modal .modal-state:checked+.modal-window {
            opacity: 1;
            visibility: visible
        }

        .modal .modal-window-visible {
            opacity: 1;
            visibility: visible;
            z-index: 10000
        }

        .modal .modal-state:checked+.modal-window .modal-inner {
            top: 0
        }

        #testimonials {
            background-color: #fbfbfb;
            padding: 3em 0
        }

        .testimonial-list-item {
            text-align: center;
            margin-bottom: 3em
        }

        .testimonial-list-item .avatar,.testimonial-list-item .avatar-and-name {
            margin-bottom: 1em
        }

        .testimonial-list-item .avatar img,.testimonial-list-item .avatar-and-name img {
            border: 1px solid #cbcbcb;
            border-radius: 50%;
            height: 75px;
            width: 75px
        }

        @media screen and (min-width: 40em) {
            .testimonial-list-item .avatar img,.testimonial-list-item .avatar-and-name img {
                height:100px;
                width: 100px
            }
        }

        .testimonial-list-item .text,.testimonial-list-item .meta {
            padding: 0 1em;
            text-align: center
        }

        .testimonial-list-item .meta {
            margin-top: 1em
        }

        .testimonial-list-item .meta .name {
            font-weight: 500
        }

        .testimonial-list-item .meta .title {
            color: #999
        }

        .follow-links a {
            display: none
        }

        .follow-links i {
            margin-right: 10px
        }

        .vertical-tabs-container {
            border: 1px solid transparent
        }

        .vertical-tabs-container .vertical-tabs {
            display: none;
            color: #009aff
        }

        @media screen and (min-width: 40em) {
            .vertical-tabs-container .vertical-tabs {
                display:inline;
                padding-top: 2.25em;
                float: left;
                height: 18.75em;
                width: 33.33333%
            }
        }

        .vertical-tabs-container .vertical-tab {
            line-height: 1.25em;
            color: #009aff
        }

        .vertical-tabs-container .vertical-tab::after {
            display: none;
            height: 24px;
            line-height: inherit;
            vertical-align: baseline
        }

        @media screen and (min-width: 40em) {
            .vertical-tabs-container .vertical-tab {
                display:block;
                margin-right: -1px;
                padding: .5em .75em;
                font-size: 1.5em
            }

            .vertical-tabs-container .vertical-tab.is-active {
                margin-right: -1px;
                color: #323232
            }

            .vertical-tabs-container .vertical-tab.is-active::after {
                display: inline-block
            }

            .vertical-tabs-container .vertical-tab:hover {
                color: #006cb3
            }

            .vertical-tabs-container .vertical-tab:hover::after {
                display: inline-block
            }
        }

        .vertical-tabs-container .vertical-tab:focus {
            outline: none
        }

        .vertical-tabs-container .vertical-tab-content-container {
            position: relative;
            display: block;
            margin: 0 auto
        }

        .vertical-tabs-container .vertical-tab-content-container a:focus {
            outline: none
        }

        .vertical-tabs-container .vertical-tab-content-container::before {
            content: "";
            height: 15px;
            bottom: -15px;
            top: auto;
            background-color: inherit
        }

        @media screen and (min-width: 40em) {
            .vertical-tabs-container .vertical-tab-content-container {
                display:inline-block;
                width: 66.66667%;
                height: auto;
                box-shadow: 0 0 20px rgba(0,0,0,0.1);
                background-color: #fff
            }
        }

        .vertical-tabs-container .vertical-tab-content {
            background-color: #fff;
            padding: 3em 1em;
            text-align: left
        }

        .vertical-tabs-container .vertical-tab-content h4 {
            font-size: 1.125em
        }

        @media screen and (min-width: 40em) {
            .vertical-tabs-container .vertical-tab-content {
                display:none;
                border: none
            }
        }

        @media screen and (min-width: 53.75em) {
            .vertical-tabs-container .vertical-tab-content {
                padding:3em
            }

            .vertical-tabs-container .vertical-tab-content h4 {
                font-size: 1.5em
            }
        }

        .vertical-tabs-container .vertical-tab-accordion-heading {
            position: relative;
            display: block;
            background-color: #eee;
            padding: 1.5em 0.809em;
            border-top: 1px solid #cbcbcb;
            font-size: 1em;
            color: #009aff;
            cursor: pointer
        }

        .vertical-tabs-container .vertical-tab-accordion-heading:hover {
            color: #009aff
        }

        .vertical-tabs-container .vertical-tab-accordion-heading::after {
            left: auto;
            color: #323232
        }

        .vertical-tabs-container .vertical-tab-accordion-heading.is-active {
            border-bottom: none;
            color: #009aff
        }

        @media screen and (min-width: 40em) {
            .vertical-tabs-container .vertical-tab-accordion-heading {
                display:none
            }
        }

        @media screen and (min-width: 40em) {
            .vertical-tabs-container {
                margin-bottom:1.5em;
                text-align: left
            }
        }

        .noscroll {
            overflow: hidden !important
        }

        .modal {
            display: inline-block
        }

        .modal label {
            cursor: pointer
        }

        .modal label img {
            display: block;
            max-width: 300px
        }

        .modal input[type="checkbox"] {
            display: none
        }

        .modal .btn {
            border: 1px solid #d7d7d7;
            border-radius: 3px;
            box-shadow: inset 0 1px 0 0 #fff;
            color: #333;
            display: inline-block;
            font-size: inherit;
            font-weight: bold;
            background-color: #fbfbfb;
            background-image: -webkit-linear-gradient(#fbfbfb, #dfdfdf);
            background-image: linear-gradient(#fbfbfb,#dfdfdf);
            padding: 7px 18px;
            text-decoration: none;
            text-shadow: 0 1px 0 #fff;
            background-clip: padding-box;
            border: 1px solid #dbd4d4;
            border-radius: 3px;
            box-shadow: inset 0 1px 0 0 #fff;
            color: #333;
            display: inline-block;
            font-size: inherit;
            font-weight: bold;
            background-color: #fbfbfb;
            background-image: -webkit-linear-gradient(#fbfbfb, #e2dcdc);
            background-image: linear-gradient(#fbfbfb,#e2dcdc);
            padding: 7px 18px;
            text-decoration: none;
            text-shadow: 0 1px 0 #fff;
            background-clip: padding-box;
            font-size: 1em;
            margin-bottom: 1.5
        }

        .modal .btn:hover:not(:disabled) {
            box-shadow: inset 0 1px 0 0 #fff;
            cursor: pointer;
            background-color: #eee;
            background-image: -webkit-linear-gradient(#eee, #d7d7d7);
            background-image: linear-gradient(#eeeeee,#d7d7d7)
        }

        .modal .btn:active:not(:disabled),.modal .btn:focus:not(:disabled) {
            border: 1px solid #d7d7d7;
            box-shadow: inset 0 0 8px 4px #d0d0d0,inset 0 0 8px 4px #d0d0d0
        }

        .modal .btn:hover:not(:disabled) {
            box-shadow: inset 0 1px 0 0 #fff;
            cursor: pointer;
            background-color: #eee;
            background-image: -webkit-linear-gradient(#eee, #dad4d4);
            background-image: linear-gradient(#eeeeee,#dad4d4)
        }

        .modal .btn:active:not(:disabled),.modal .btn:focus:not(:disabled) {
            border: 1px solid #dbd4d4;
            box-shadow: inset 0 0 8px 4px #d3cccc,inset 0 0 8px 4px #d3cccc
        }

        .modal .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed
        }

        .modal .modal-open {
            overflow: hidden
        }

        .modal .modal-window {
            -webkit-transition: opacity 0.5s ease;
            -moz-transition: opacity 0.5s ease;
            transition: opacity 0.5s ease;
            position: fixed;
            top: 0px;
            right: 0px;
            bottom: 0px;
            left: 0px;
            background: rgba(0,0,0,0.75);
            opacity: 0;
            text-align: left;
            visibility: hidden;
            z-index: 10
        }

        .modal .modal-window .modal-bg {
            position: absolute;
            top: 0px;
            right: 0px;
            bottom: 0px;
            left: 0px;
            cursor: pointer
        }

        .modal .modal-close {
            position: absolute;
            top: 0.809em;
            right: 0.809em;
            width: 2em;
            height: 2em;
            cursor: pointer
        }

        .modal .modal-close::before {
            font-size: 1.75em;
            display: block;
            font-family: FontAwesome;
            content: "\f00d";
            color: #8a8a8a;
            text-shadow: 0 1px 0 #8a8a8a
        }

        .modal .modal-close:hover::before {
            color: #4d4d4d
        }

        .modal .modal-inner {
            -webkit-transition: opacity 0.25s ease;
            -moz-transition: opacity 0.25s ease;
            transition: opacity 0.25s ease;
            border-radius: 4px;
            border: 1px solid #cbcbcb;
            background: #fff;
            margin: auto;
            max-height: 95%;
            position: relative;
            overflow: auto;
            width: 95%;
            padding: 0.809em;
            margin-top: .6em
        }

        @media screen and (min-width: 40em) {
            .modal .modal-inner {
                padding:1.618em;
                width: 60%;
                max-height: 90%;
                margin-top: 1em
            }
        }

        @media screen and (min-width: 53.75em) {
            .modal .modal-inner {
                width:50%;
                margin-top: 1em
            }
        }

        .modal .modal-inner h1 {
            margin-bottom: .6em;
            text-align: left;
            text-transform: capitalize;
            font-size: 1.75em;
            color: #323232
        }

        .modal .modal-inner p {
            font-size: 1em;
            max-width: 100% !important;
            padding: 0;
            text-align: left
        }

        .modal .modal-inner p.intro {
            color: #009aff;
            line-height: 1.6em
        }

        .modal .modal-inner p.help-block,.modal .modal-inner #details-panel p.refund,#details-panel .modal .modal-inner p.refund {
            font-size: .75em
        }

        .modal .modal-inner p.body {
            color: #323232;
            line-height: 1.45em
        }

        @media screen and (min-width: 40em) {
            .modal .modal-inner p.body {
                -webkit-columns:2 8em;
                -moz-columns: 2 8em;
                columns: 2 8em
            }
        }

        .modal .modal-inner a.cta {
            color: white;
            display: inline-block;
            margin-right: .5em;
            margin-top: 1em
        }

        .modal .modal-inner a.cta:last-child {
            padding: 0 2em
        }

        .modal .modal-state:checked+.modal-window {
            opacity: 1;
            visibility: visible
        }

        .modal .modal-window-visible {
            opacity: 1;
            visibility: visible;
            z-index: 10000
        }

        .modal .modal-state:checked+.modal-window .modal-inner {
            top: 0
        }

        #author-hero {
            padding: 2.35765%;
            background-color: #fff;
            text-align: center
        }

        #author-hero .section-title {
            padding: 2.35765% 0;
            margin-bottom: 0;
            text-align: center;
            font-size: 3em
        }

        #author-hero .section-title span {
            display: block
        }

        #author-hero .section-subtitle {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 82.94039%;
            margin-left: 8.5298%;
            float: none;
            font-size: 1.5em;
            margin-bottom: 2em
        }

        #author-hero .section-subtitle:last-child {
            margin-right: 0
        }

        #author-hero .process-graphic {
            width: 75%
        }

        #author-hero .new-book {
            margin-top: 1em
        }

        @media screen and (min-width: 53.75em) {
            #author-hero .new-book {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%;
                margin-left: 25.58941%
            }

            #author-hero .new-book:last-child {
                margin-right: 0
            }
        }

        #what-you-can-do {
            background-color: #fff;
            color: #323232;
            font-size: 15px
        }

        #what-you-can-do .large-container,#what-you-can-do #app-container,#what-you-can-do #bookstore section,#bookstore #what-you-can-do section {
            padding: 3em 2.35765%
        }

        #what-you-can-do .large-container p,#what-you-can-do #app-container p,#what-you-can-do #bookstore section p,#bookstore #what-you-can-do section p {
            margin: 0.5em
        }

        #what-you-can-do .large-container .bullet-content,#what-you-can-do #app-container .bullet-content,#what-you-can-do #bookstore section .bullet-content,#bookstore #what-you-can-do section .bullet-content {
            text-align: left
        }

        #what-you-can-do .container,#what-you-can-do #contact article,#contact #what-you-can-do article,#what-you-can-do #buzz article,#buzz #what-you-can-do article,#what-you-can-do #manifesto article,#manifesto #what-you-can-do article,#what-you-can-do #affiliates article,#affiliates #what-you-can-do article,#what-you-can-do #age-verification article,#age-verification #what-you-can-do article,#what-you-can-do #gift-purchase article,#gift-purchase #what-you-can-do article,#what-you-can-do #terms article,#terms #what-you-can-do article,#what-you-can-do #request_refund article,#request_refund #what-you-can-do article,#what-you-can-do #wishlist-container article,#wishlist-container #what-you-can-do article,#what-you-can-do #sign-up article,#sign-up #what-you-can-do article,#what-you-can-do #welcome article,#welcome #what-you-can-do article,#what-you-can-do #upsell article,#upsell #what-you-can-do article,#what-you-can-do .new-book article,.new-book #what-you-can-do article,#what-you-can-do .new-publisher-book article,.new-publisher-book #what-you-can-do article,#what-you-can-do #new-bundle article,#new-bundle #what-you-can-do article {
            padding: 3em 2.35765%
        }

        #what-you-can-do .container p,#what-you-can-do #contact article p,#contact #what-you-can-do article p,#what-you-can-do #buzz article p,#buzz #what-you-can-do article p,#what-you-can-do #manifesto article p,#manifesto #what-you-can-do article p,#what-you-can-do #affiliates article p,#affiliates #what-you-can-do article p,#what-you-can-do #age-verification article p,#age-verification #what-you-can-do article p,#what-you-can-do #gift-purchase article p,#gift-purchase #what-you-can-do article p,#what-you-can-do #terms article p,#terms #what-you-can-do article p,#what-you-can-do #request_refund article p,#request_refund #what-you-can-do article p,#what-you-can-do #wishlist-container article p,#wishlist-container #what-you-can-do article p,#what-you-can-do #sign-up article p,#sign-up #what-you-can-do article p,#what-you-can-do #welcome article p,#welcome #what-you-can-do article p,#what-you-can-do #upsell article p,#upsell #what-you-can-do article p,#what-you-can-do .new-book article p,.new-book #what-you-can-do article p,#what-you-can-do .new-publisher-book article p,.new-publisher-book #what-you-can-do article p,#what-you-can-do #new-bundle article p,#new-bundle #what-you-can-do article p {
            margin: 0
        }

        #what-you-can-do .container .bullet-content,#what-you-can-do #contact article .bullet-content,#contact #what-you-can-do article .bullet-content,#what-you-can-do #buzz article .bullet-content,#buzz #what-you-can-do article .bullet-content,#what-you-can-do #manifesto article .bullet-content,#manifesto #what-you-can-do article .bullet-content,#what-you-can-do #affiliates article .bullet-content,#affiliates #what-you-can-do article .bullet-content,#what-you-can-do #age-verification article .bullet-content,#age-verification #what-you-can-do article .bullet-content,#what-you-can-do #gift-purchase article .bullet-content,#gift-purchase #what-you-can-do article .bullet-content,#what-you-can-do #terms article .bullet-content,#terms #what-you-can-do article .bullet-content,#what-you-can-do #request_refund article .bullet-content,#request_refund #what-you-can-do article .bullet-content,#what-you-can-do #wishlist-container article .bullet-content,#wishlist-container #what-you-can-do article .bullet-content,#what-you-can-do #sign-up article .bullet-content,#sign-up #what-you-can-do article .bullet-content,#what-you-can-do #welcome article .bullet-content,#welcome #what-you-can-do article .bullet-content,#what-you-can-do #upsell article .bullet-content,#upsell #what-you-can-do article .bullet-content,#what-you-can-do .new-book article .bullet-content,.new-book #what-you-can-do article .bullet-content,#what-you-can-do .new-publisher-book article .bullet-content,.new-publisher-book #what-you-can-do article .bullet-content,#what-you-can-do #new-bundle article .bullet-content,#new-bundle #what-you-can-do article .bullet-content {
            text-align: left
        }

        #try-leanpub {
            background-color: #fff;
            text-align: center
        }

        #try-leanpub .container,#try-leanpub #contact article,#contact #try-leanpub article,#try-leanpub #buzz article,#buzz #try-leanpub article,#try-leanpub #manifesto article,#manifesto #try-leanpub article,#try-leanpub #affiliates article,#affiliates #try-leanpub article,#try-leanpub #age-verification article,#age-verification #try-leanpub article,#try-leanpub #gift-purchase article,#gift-purchase #try-leanpub article,#try-leanpub #terms article,#terms #try-leanpub article,#try-leanpub #request_refund article,#request_refund #try-leanpub article,#try-leanpub #wishlist-container article,#wishlist-container #try-leanpub article,#try-leanpub #sign-up article,#sign-up #try-leanpub article,#try-leanpub #welcome article,#welcome #try-leanpub article,#try-leanpub #upsell article,#upsell #try-leanpub article,#try-leanpub .new-book article,.new-book #try-leanpub article,#try-leanpub .new-publisher-book article,.new-publisher-book #try-leanpub article,#try-leanpub #new-bundle article,#new-bundle #try-leanpub article {
            padding: 2.35765%
        }

        #try-leanpub .section-title {
            padding: 2.35765%;
            color: inherit;
            text-align: center;
            margin-bottom: 0
        }

        @media screen and (min-width: 53.75em) {
            #try-leanpub .section-title {
                padding:1em
            }
        }

        #try-leanpub .bullet-list {
            padding: 2em 0
        }

        #try-leanpub .bullet .bullet-content {
            margin-bottom: 2em
        }

        @media screen and (min-width: 53.75em) {
            #try-leanpub .bullet:nth-child(-n+4) .bullet-content {
                margin-bottom:3em
            }
        }

        #try-leanpub .bullet-icon {
            margin-bottom: 16px;
            font-size: 32px;
            color: #009aff
        }

        #try-leanpub .bullet-icon.free,#try-leanpub .bullet-icon.royalties {
            width: auto;
            font-size: 32px;
            line-height: 1
        }

        #try-leanpub .bullet-icon.free::before {
            content: "$0"
        }

        #try-leanpub .bullet-icon.royalties::before {
            content: "90%"
        }

        #try-leanpub .bullet-copy span {
            display: inline-block;
            margin-top: .75em;
            font-size: .75em
        }

        #audience {
            background-color: #eee
        }

        #audience .container,#audience #contact article,#contact #audience article,#audience #buzz article,#buzz #audience article,#audience #manifesto article,#manifesto #audience article,#audience #affiliates article,#affiliates #audience article,#audience #age-verification article,#age-verification #audience article,#audience #gift-purchase article,#gift-purchase #audience article,#audience #terms article,#terms #audience article,#audience #request_refund article,#request_refund #audience article,#audience #wishlist-container article,#wishlist-container #audience article,#audience #sign-up article,#sign-up #audience article,#audience #welcome article,#welcome #audience article,#audience #upsell article,#upsell #audience article,#audience .new-book article,.new-book #audience article,#audience .new-publisher-book article,.new-publisher-book #audience article,#audience #new-bundle article,#new-bundle #audience article {
            padding: 0
        }

        @media screen and (min-width: 53.75em) {
            #audience .container,#audience #contact article,#contact #audience article,#audience #buzz article,#buzz #audience article,#audience #manifesto article,#manifesto #audience article,#audience #affiliates article,#affiliates #audience article,#audience #age-verification article,#age-verification #audience article,#audience #gift-purchase article,#gift-purchase #audience article,#audience #terms article,#terms #audience article,#audience #request_refund article,#request_refund #audience article,#audience #wishlist-container article,#wishlist-container #audience article,#audience #sign-up article,#sign-up #audience article,#audience #welcome article,#welcome #audience article,#audience #upsell article,#upsell #audience article,#audience .new-book article,.new-book #audience article,#audience .new-publisher-book article,.new-publisher-book #audience article,#audience #new-bundle article,#new-bundle #audience article {
                padding:0 2.35765%
            }
        }

        #audience .section-subtitle {
            padding: 1em .25em;
            margin-bottom: 0
        }

        @media screen and (min-width: 53.75em) {
            #audience .section-subtitle {
                padding:2.5em 1em 0 1em;
                margin-bottom: 2em
            }
        }

        #audience .detail-list {
            padding-left: 1em
        }

        @media screen and (min-width: 53.75em) {
            #audience .vertical-tabs-container {
                margin-bottom:0
            }
        }

        #audience .vertical-tab-content-container {
            min-height: 0;
            padding-right: 0
        }

        #audience .vertical-tab-content-container h4 {
            margin-bottom: 1em;
            color: #000
        }

        @media screen and (min-width: 53.75em) {
            #audience .vertical-tab-content-container {
                min-height:20em;
                padding-right: 3.75em
            }
        }

        #cause-logos {
            width: 100%
        }

        #cause-logos a {
            display: inline-block
        }

        #why-leanpub {
            background-color: #666;
            position: relative;
            z-index: 1
        }

        #why-leanpub .container,#why-leanpub #contact article,#contact #why-leanpub article,#why-leanpub #buzz article,#buzz #why-leanpub article,#why-leanpub #manifesto article,#manifesto #why-leanpub article,#why-leanpub #affiliates article,#affiliates #why-leanpub article,#why-leanpub #age-verification article,#age-verification #why-leanpub article,#why-leanpub #gift-purchase article,#gift-purchase #why-leanpub article,#why-leanpub #terms article,#terms #why-leanpub article,#why-leanpub #request_refund article,#request_refund #why-leanpub article,#why-leanpub #wishlist-container article,#wishlist-container #why-leanpub article,#why-leanpub #sign-up article,#sign-up #why-leanpub article,#why-leanpub #welcome article,#welcome #why-leanpub article,#why-leanpub #upsell article,#upsell #why-leanpub article,#why-leanpub .new-book article,.new-book #why-leanpub article,#why-leanpub .new-publisher-book article,.new-publisher-book #why-leanpub article,#why-leanpub #new-bundle article,#new-bundle #why-leanpub article {
            padding: 3.125em 2.35765%
        }

        #why-leanpub .section-title {
            margin-bottom: .25em;
            padding: 0;
            text-align: center;
            font-size: 3em;
            color: #fff
        }

        @media screen and (min-width: 53.75em) {
            #why-leanpub .section-title {
                padding:0 .5em;
                font-size: 6em
            }
        }

        #why-leanpub .bullets {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 82.94039%;
            margin-left: 8.5298%
        }

        #why-leanpub .bullets:last-child {
            margin-right: 0
        }

        #why-leanpub .bullet-content {
            padding: 0
        }

        #why-leanpub .video-wrapper,#why-leanpub .video-title {
            display: block;
            text-align: center
        }

        #why-leanpub .video-wrapper {
            border: 0
        }

        #how-leanpub-works {
            background-color: #fff
        }

        #how-leanpub-works .container,#how-leanpub-works #contact article,#contact #how-leanpub-works article,#how-leanpub-works #buzz article,#buzz #how-leanpub-works article,#how-leanpub-works #manifesto article,#manifesto #how-leanpub-works article,#how-leanpub-works #affiliates article,#affiliates #how-leanpub-works article,#how-leanpub-works #age-verification article,#age-verification #how-leanpub-works article,#how-leanpub-works #gift-purchase article,#gift-purchase #how-leanpub-works article,#how-leanpub-works #terms article,#terms #how-leanpub-works article,#how-leanpub-works #request_refund article,#request_refund #how-leanpub-works article,#how-leanpub-works #wishlist-container article,#wishlist-container #how-leanpub-works article,#how-leanpub-works #sign-up article,#sign-up #how-leanpub-works article,#how-leanpub-works #welcome article,#welcome #how-leanpub-works article,#how-leanpub-works #upsell article,#upsell #how-leanpub-works article,#how-leanpub-works .new-book article,.new-book #how-leanpub-works article,#how-leanpub-works .new-publisher-book article,.new-publisher-book #how-leanpub-works article,#how-leanpub-works #new-bundle article,#new-bundle #how-leanpub-works article {
            padding: 2.35765%
        }

        #how-leanpub-works .section-subtitle {
            padding: 0
        }

        @media screen and (min-width: 53.75em) {
            #how-leanpub-works .section-subtitle {
                padding:0 3em
            }
        }

        @media screen and (min-width: 53.75em) {
            #how-leanpub-works .copy,#how-leanpub-works .vertical-tabs-container .vertical-tab-content,.vertical-tabs-container #how-leanpub-works .vertical-tab-content {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 65.88078%;
                margin-left: 17.05961%;
                padding: 2.35765%;
                margin-bottom: 1em
            }

            #how-leanpub-works .copy:last-child,#how-leanpub-works .vertical-tabs-container .vertical-tab-content:last-child,.vertical-tabs-container #how-leanpub-works .vertical-tab-content:last-child {
                margin-right: 0
            }
        }

        #royalties-explained {
            background-color: #fbfbfb
        }

        #royalties-explained .container,#royalties-explained #contact article,#contact #royalties-explained article,#royalties-explained #buzz article,#buzz #royalties-explained article,#royalties-explained #manifesto article,#manifesto #royalties-explained article,#royalties-explained #affiliates article,#affiliates #royalties-explained article,#royalties-explained #age-verification article,#age-verification #royalties-explained article,#royalties-explained #gift-purchase article,#gift-purchase #royalties-explained article,#royalties-explained #terms article,#terms #royalties-explained article,#royalties-explained #request_refund article,#request_refund #royalties-explained article,#royalties-explained #wishlist-container article,#wishlist-container #royalties-explained article,#royalties-explained #sign-up article,#sign-up #royalties-explained article,#royalties-explained #welcome article,#welcome #royalties-explained article,#royalties-explained #upsell article,#upsell #royalties-explained article,#royalties-explained .new-book article,.new-book #royalties-explained article,#royalties-explained .new-publisher-book article,.new-publisher-book #royalties-explained article,#royalties-explained #new-bundle article,#new-bundle #royalties-explained article {
            padding: 4em 0
        }

        #royalties-explained .section-title {
            margin-bottom: .75em;
            padding: 0;
            text-align: center;
            color: #797979
        }

        @media screen and (min-width: 53.75em) {
            #royalties-explained .section-title {
                padding:0 2em
            }
        }

        #royalties-explained .section-subtitle {
            padding: 0 0.5em;
            margin-bottom: 2em;
            font-size: 1.125em
        }

        #royalties-explained .copy,#royalties-explained .vertical-tabs-container .vertical-tab-content,.vertical-tabs-container #royalties-explained .vertical-tab-content,#royalties-explained .royalties-table-wrapper {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 82.94039%;
            margin-left: 8.5298%
        }

        #royalties-explained .copy:last-child,#royalties-explained .vertical-tabs-container .vertical-tab-content:last-child,.vertical-tabs-container #royalties-explained .vertical-tab-content:last-child,#royalties-explained .royalties-table-wrapper:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 53.75em) {
            #royalties-explained .copy,#royalties-explained .vertical-tabs-container .vertical-tab-content,.vertical-tabs-container #royalties-explained .vertical-tab-content,#royalties-explained .royalties-table-wrapper {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 65.88078%;
                margin-left: 17.05961%
            }

            #royalties-explained .copy:last-child,#royalties-explained .vertical-tabs-container .vertical-tab-content:last-child,.vertical-tabs-container #royalties-explained .vertical-tab-content:last-child,#royalties-explained .royalties-table-wrapper:last-child {
                margin-right: 0
            }
        }

        #royalties-explained .copy .royalties-table,#royalties-explained .vertical-tabs-container .vertical-tab-content .royalties-table,.vertical-tabs-container #royalties-explained .vertical-tab-content .royalties-table,#royalties-explained .royalties-table-wrapper .royalties-table {
            width: 100%
        }

        #royalties-explained .copy .royalties-table td,#royalties-explained .vertical-tabs-container .vertical-tab-content .royalties-table td,.vertical-tabs-container #royalties-explained .vertical-tab-content .royalties-table td,#royalties-explained .royalties-table-wrapper .royalties-table td {
            text-align: center
        }

        #how-to-leanpub {
            background-color: #323232
        }

        #how-to-leanpub .container,#how-to-leanpub #contact article,#contact #how-to-leanpub article,#how-to-leanpub #buzz article,#buzz #how-to-leanpub article,#how-to-leanpub #manifesto article,#manifesto #how-to-leanpub article,#how-to-leanpub #affiliates article,#affiliates #how-to-leanpub article,#how-to-leanpub #age-verification article,#age-verification #how-to-leanpub article,#how-to-leanpub #gift-purchase article,#gift-purchase #how-to-leanpub article,#how-to-leanpub #terms article,#terms #how-to-leanpub article,#how-to-leanpub #request_refund article,#request_refund #how-to-leanpub article,#how-to-leanpub #wishlist-container article,#wishlist-container #how-to-leanpub article,#how-to-leanpub #sign-up article,#sign-up #how-to-leanpub article,#how-to-leanpub #welcome article,#welcome #how-to-leanpub article,#how-to-leanpub #upsell article,#upsell #how-to-leanpub article,#how-to-leanpub .new-book article,.new-book #how-to-leanpub article,#how-to-leanpub .new-publisher-book article,.new-publisher-book #how-to-leanpub article,#how-to-leanpub #new-bundle article,#new-bundle #how-to-leanpub article {
            padding: 2.35765% 0
        }

        #how-to-leanpub .section-title {
            padding: .25em;
            text-align: center;
            line-height: .8125em;
            font-size: 4em;
            margin-bottom: .5em;
            color: #fff
        }

        @media screen and (min-width: 53.75em) {
            #how-to-leanpub .section-title {
                font-size:7em
            }
        }

        #how-to-leanpub .bullets {
            width: 100%;
            color: #fff
        }

        @media screen and (min-width: 53.75em) {
            #how-to-leanpub .bullets {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 65.88078%;
                margin-left: 17.05961%
            }

            #how-to-leanpub .bullets:last-child {
                margin-right: 0
            }
        }

        #how-to-leanpub .bullet-copy {
            font-size: .875em
        }

        #how-to-leanpub .bullet-copy a {
            font-family: inherit;
            text-decoration: underline;
            color: inherit
        }

        #book-categories {
            background-color: #fff
        }

        #book-categories .container,#book-categories #contact article,#contact #book-categories article,#book-categories #buzz article,#buzz #book-categories article,#book-categories #manifesto article,#manifesto #book-categories article,#book-categories #affiliates article,#affiliates #book-categories article,#book-categories #age-verification article,#age-verification #book-categories article,#book-categories #gift-purchase article,#gift-purchase #book-categories article,#book-categories #terms article,#terms #book-categories article,#book-categories #request_refund article,#request_refund #book-categories article,#book-categories #wishlist-container article,#wishlist-container #book-categories article,#book-categories #sign-up article,#sign-up #book-categories article,#book-categories #welcome article,#welcome #book-categories article,#book-categories #upsell article,#upsell #book-categories article,#book-categories .new-book article,.new-book #book-categories article,#book-categories .new-publisher-book article,.new-publisher-book #book-categories article,#book-categories #new-bundle article,#new-bundle #book-categories article {
            padding: 3.125em 2.35765%
        }

        #book-categories .section-title {
            color: #666
        }

        #book-categories .section-subtitle {
            padding: 0;
            font-size: 1.125em
        }

        #book-categories .section-subtitle a {
            text-decoration: underline
        }

        @media screen and (min-width: 53.75em) {
            #book-categories .section-subtitle {
                padding:0 2.5em;
                font-size: 2em
            }
        }

        #book-categories .category-list {
            width: 100%;
            text-align: left
        }

        #book-categories .category-list ul {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 65.88078%;
            margin-left: 17.05961%
        }

        #book-categories .category-list ul:last-child {
            margin-right: 0
        }

        #book-categories .category-list ul li {
            margin-bottom: .125em;
            text-decoration: underline
        }

        @media screen and (min-width: 53.75em) {
            #book-categories .category-list {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 74.41059%;
                margin-left: 12.79471%;
                padding: 2.35765% 2em
            }

            #book-categories .category-list:last-child {
                margin-right: 0
            }

            #book-categories .category-list ul {
                float: left;
                display: block;
                margin-right: 2.35765%;
                width: 31.76157%;
                margin-left: 0%
            }

            #book-categories .category-list ul:last-child {
                margin-right: 0
            }
        }

        #leanpub-affiliate {
            background-color: #eee
        }

        #leanpub-affiliate .container,#leanpub-affiliate #contact article,#contact #leanpub-affiliate article,#leanpub-affiliate #buzz article,#buzz #leanpub-affiliate article,#leanpub-affiliate #manifesto article,#manifesto #leanpub-affiliate article,#leanpub-affiliate #affiliates article,#affiliates #leanpub-affiliate article,#leanpub-affiliate #age-verification article,#age-verification #leanpub-affiliate article,#leanpub-affiliate #gift-purchase article,#gift-purchase #leanpub-affiliate article,#leanpub-affiliate #terms article,#terms #leanpub-affiliate article,#leanpub-affiliate #request_refund article,#request_refund #leanpub-affiliate article,#leanpub-affiliate #wishlist-container article,#wishlist-container #leanpub-affiliate article,#leanpub-affiliate #sign-up article,#sign-up #leanpub-affiliate article,#leanpub-affiliate #welcome article,#welcome #leanpub-affiliate article,#leanpub-affiliate #upsell article,#upsell #leanpub-affiliate article,#leanpub-affiliate .new-book article,.new-book #leanpub-affiliate article,#leanpub-affiliate .new-publisher-book article,.new-publisher-book #leanpub-affiliate article,#leanpub-affiliate #new-bundle article,#new-bundle #leanpub-affiliate article {
            padding: 2.35765%
        }

        #leanpub-affiliate .section-subtitle {
            padding: 0 1em
        }

        #leanpub-affiliate .section-subtitle a,#leanpub-affiliate .section-subtitle {
            color: #323232
        }

        #leanpub-affiliate .copy,#leanpub-affiliate .vertical-tabs-container .vertical-tab-content,.vertical-tabs-container #leanpub-affiliate .vertical-tab-content {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 82.94039%;
            margin-left: 8.5298%
        }

        #leanpub-affiliate .copy:last-child,#leanpub-affiliate .vertical-tabs-container .vertical-tab-content:last-child,.vertical-tabs-container #leanpub-affiliate .vertical-tab-content:last-child {
            margin-right: 0
        }

        #bookstore {
            padding: 0 1.5em;
            background-color: transparent
        }

        #bookstore .search-message {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
            padding: .5em;
            border-radius: 4px;
            margin-bottom: 1em;
            text-align: center
        }

        #bookstore .search-message.no-matches {
            background: #fff6bf;
            border: 1px solid #ffef8c;
            color: #8c7800
        }

        #bookstore .search-message.no-matches a {
            color: #594c00
        }

        #bookstore .search-message.no-matches a:active,#bookstore .search-message.no-matches a:visited {
            color: #594c00
        }

        #bookstore .search-message.no-matches a:hover {
            color: #000
        }

        #bookstore .search-message.found-matches {
            background: #f2f9ff;
            border: 1px solid #bfe1ff;
            color: #0067bf
        }

        #bookstore .search-message.found-matches a {
            color: #004b8c
        }

        #bookstore .search-message.found-matches a:active,#bookstore .search-message.found-matches a:visited {
            color: #004b8c
        }

        #bookstore .search-message.found-matches a:hover {
            color: #001426
        }

        #bookstore-navigation {
            background-color: #fff;
            border-bottom: 1px solid #cbcbcb;
            margin-bottom: 1.5em;
            padding: 1.5em 0
        }

        #bookstore-navigation .container,#bookstore-navigation #contact article,#contact #bookstore-navigation article,#bookstore-navigation #buzz article,#buzz #bookstore-navigation article,#bookstore-navigation #manifesto article,#manifesto #bookstore-navigation article,#bookstore-navigation #affiliates article,#affiliates #bookstore-navigation article,#bookstore-navigation #age-verification article,#age-verification #bookstore-navigation article,#bookstore-navigation #gift-purchase article,#gift-purchase #bookstore-navigation article,#bookstore-navigation #terms article,#terms #bookstore-navigation article,#bookstore-navigation #request_refund article,#request_refund #bookstore-navigation article,#bookstore-navigation #wishlist-container article,#wishlist-container #bookstore-navigation article,#bookstore-navigation #sign-up article,#sign-up #bookstore-navigation article,#bookstore-navigation #welcome article,#welcome #bookstore-navigation article,#bookstore-navigation #upsell article,#upsell #bookstore-navigation article,#bookstore-navigation .new-book article,.new-book #bookstore-navigation article,#bookstore-navigation .new-publisher-book article,.new-publisher-book #bookstore-navigation article,#bookstore-navigation #new-bundle article,#new-bundle #bookstore-navigation article {
            padding: 0
        }

        #bookstore-navigation .list-header>div {
            width: 100%
        }

        #bookstore-navigation .list-header>div:nth-child(1) {
            text-align: right
        }

        @media screen and (min-width: 53.75em) {
            #bookstore-navigation .list-header>div:nth-child(1) {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 57.35098%;
                text-align: left
            }

            #bookstore-navigation .list-header>div:nth-child(1):last-child {
                margin-right: 0
            }
        }

        #bookstore-navigation .list-header>div:nth-child(2) {
            text-align: right
        }

        @media screen and (min-width: 53.75em) {
            #bookstore-navigation .list-header>div:nth-child(2) {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 40.29137%
            }

            #bookstore-navigation .list-header>div:nth-child(2):last-child {
                margin-right: 0
            }
        }

        #bookstore-navigation .list-title {
            vertical-align: top;
            font-weight: 600
        }

        #bookstore-navigation .list-title,#bookstore-navigation .filter {
            display: block
        }

        @media screen and (min-width: 53.75em) {
            #bookstore-navigation .list-title,#bookstore-navigation .filter {
                display:inline-block;
                vertical-align: bottom
            }
        }

        #bookstore-navigation .active-sub-filter {
            display: inline-block;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            padding: 0;
            font-size: 1.125em;
            text-transform: uppercase
        }

        #bookstore-navigation .filter .menu {
            min-width: 325px;
            max-width: 80vw
        }

        #bookstore-navigation .filter .menu li span {
            display: inline-block;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            display: block
        }

        #bookstore-navigation .filter .menu hr {
            margin: 4px 0
        }

        #bookstore-navigation .filter .menu .default {
            font-weight: 600
        }

        #bookstore-navigation .filter .menu .scrollable {
            max-height: 52vh;
            overflow-y: auto;
            overflow-x: hidden
        }

        #bookstore-loading {
            padding: 30px
        }

        #bookstore-loading .message {
            width: 50vw;
            max-width: 200px;
            margin: 0 auto;
            text-align: center
        }

        #bookstore-loading .message h2 {
            display: block
        }

        #bookstore-loading .message .logo {
            max-width: 100%
        }

        #bookstore-view {
            display: none
        }

        #bookstore-view .book-list-wrapper .list-title {
            line-height: 44px;
            height: 44px;
            display: block
        }

        #bookstore-view .book-list-wrapper .list-subtitle {
            line-height: 18px
        }

        #bookstore-view .filter-explained {
            padding: 2.35765%;
            background-color: #eee;
            border-radius: 4px;
            margin-bottom: 1.5em;
            text-align: center;
            font-size: 1.125em;
            color: #666
        }

        #bookstore-view .filter-explained span {
            color: #424242;
            font-weight: 600
        }

        #bookstore-pagination {
            margin-bottom: 3em
        }

        #bookstore-pagination .pagination {
            width: 100%;
            padding: 2.35765%;
            text-align: center
        }

        #bookstore-pagination .pagination span a {
            color: #323232
        }

        #bookstore-pagination .pagination span a:hover {
            text-decoration: underline
        }

        #bookstore-pagination .pagination .first::before,#bookstore-pagination .pagination .prev::before {
            font-family: FontAwesome;
            margin-left: 1.5em
        }

        #bookstore-pagination .pagination .next::after,#bookstore-pagination .pagination .last::after {
            font-family: FontAwesome;
            margin-right: 1.5em
        }

        #bookstore-pagination .pagination .first::before {
            content: '\f100'
        }

        #bookstore-pagination .pagination .prev::before {
            content: '\f104'
        }

        #bookstore-pagination .pagination .next::after {
            content: '\f105'
        }

        #bookstore-pagination .pagination .last::after {
            content: '\f101'
        }

        #bookstore-pagination .pagination .page a {
            padding: 0.75em
        }

        #bookstore-pagination .pagination .page.current {
            padding: 0.75em;
            color: #009aff;
            font-weight: 800
        }

        @media screen and (min-width: 53.75em) {
            #cause-show .cause-profile {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 65.88078%;
                margin-left: 17.05961%
            }

            #cause-show .cause-profile:last-child {
                margin-right: 0
            }
        }

        @media screen and (min-width: 53.75em) {
            #causes .left {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 65.88078%
            }

            #causes .left:last-child {
                margin-right: 0
            }
        }

        @media screen and (min-width: 53.75em) {
            #causes .right {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 31.76157%
            }

            #causes .right:last-child {
                margin-right: 0
            }
        }

        #causes .jstab-content .submit {
            margin-top: 10px
        }

        #participating-causes .book-list-item {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 23.23176%;
            text-align: center
        }

        #participating-causes .book-list-item:last-child {
            margin-right: 0
        }

        #participating-causes .book-list-item:nth-child(4n) {
            margin-right: 0
        }

        #participating-causes .book-list-item:nth-child(4n+1) {
            clear: left
        }

        #participating-causes .cause-logo {
            text-align: center
        }

        #supporting-causes .book-list-item {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 31.76157%
        }

        #supporting-causes .book-list-item:last-child {
            margin-right: 0
        }

        #supporting-causes .book-list-item:nth-child(3n) {
            margin-right: 0
        }

        #supporting-causes .book-list-item:nth-child(3n+1) {
            clear: left
        }

        @media screen and (min-width: 40em) {
            #supporting-causes .book-list-item {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 23.23176%
            }

            #supporting-causes .book-list-item:last-child {
                margin-right: 0
            }

            #supporting-causes .book-list-item:nth-child(3n) {
                margin-right: 2.35765%
            }

            #supporting-causes .book-list-item:nth-child(3n+1) {
                clear: none
            }

            #supporting-causes .book-list-item:nth-child(4n) {
                margin-right: 0
            }

            #supporting-causes .book-list-item:nth-child(4n+1) {
                clear: left
            }
        }

        @media screen and (min-width: 53.75em) {
            #supporting-causes .book-list-item {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 14.70196%
            }

            #supporting-causes .book-list-item:last-child {
                margin-right: 0
            }

            #supporting-causes .book-list-item:nth-child(4n) {
                margin-right: 2.35765%
            }

            #supporting-causes .book-list-item:nth-child(4n+1) {
                clear: none
            }

            #supporting-causes .book-list-item:nth-child(6n) {
                margin-right: 0
            }

            #supporting-causes .book-list-item:nth-child(6n+1) {
                clear: left
            }
        }

        .accordion-tabs-minimal {
            margin-bottom: 0
        }

        .accordion-tabs-minimal:after {
            content: "";
            display: table;
            clear: both
        }

        .accordion-tabs-minimal>li.active a,.accordion-tabs-minimal>li.is-active a {
            border-bottom: 0;
            pointer-events: none
        }

        @media screen and (min-width: 53.75em) {
            .accordion-tabs-minimal>li.active a,.accordion-tabs-minimal>li.is-active a {
                border:1px solid #cbcbcb;
                background-color: #fff;
                border-bottom: 1px solid #fff;
                border-bottom-color: transparent;
                margin-bottom: -1px
            }
        }

        .accordion-tabs-minimal>li>a {
            border-top-left-radius: 0;
            border-top-right-radius: 0;
            background-color: transparent;
            border-top: 1px solid #cbcbcb;
            color: gray;
            display: block;
            font-weight: 400;
            padding: 0.75em 1em
        }

        @media screen and (min-width: 53.75em) {
            .accordion-tabs-minimal>li>a {
                border-top-left-radius:4px;
                border-top-right-radius: 4px;
                display: inline-block;
                vertical-align: baseline;
                zoom:1;*display: inline;
                *vertical-align: auto;
                border-top: 0
            }
        }

        .accordion-tabs-minimal>li>a:hover {
            color: #009aff
        }

        .accordion-tabs-minimal>li>a:focus {
            outline: none
        }

        @media screen and (min-width: 53.75em) {
            .accordion-tabs-minimal>li {
                display:inline
            }

            .accordion-tabs-minimal>li.active:first-child a {
                border-top: 1px solid #cbcbcb
            }
        }

        .accordion-tabs-minimal+.tab-content {
            position: static;
            width: 100%;
            background-color: #fff;
            border: 1px solid #cbcbcb
        }

        @media screen and (min-width: 53.75em) {
            .accordion-tabs-minimal+.tab-content {
                padding:4.125em 5em;
                border-top: 1px solid #cbcbcb;
                float: left
            }
        }

        .jstab-content {
            display: none
        }

        .jstab-content.is-active {
            display: block
        }

        #dashboard {
            background-color: transparent;
            margin-top: 3em
        }

        #dashboard .container,#dashboard #contact article,#contact #dashboard article,#dashboard #buzz article,#buzz #dashboard article,#dashboard #manifesto article,#manifesto #dashboard article,#dashboard #affiliates article,#affiliates #dashboard article,#dashboard #age-verification article,#age-verification #dashboard article,#dashboard #gift-purchase article,#gift-purchase #dashboard article,#dashboard #terms article,#terms #dashboard article,#dashboard #request_refund article,#request_refund #dashboard article,#dashboard #wishlist-container article,#wishlist-container #dashboard article,#dashboard #sign-up article,#sign-up #dashboard article,#dashboard #welcome article,#welcome #dashboard article,#dashboard #upsell article,#upsell #dashboard article,#dashboard .new-book article,.new-book #dashboard article,#dashboard .new-publisher-book article,.new-publisher-book #dashboard article,#dashboard #new-bundle article,#new-bundle #dashboard article,#dashboard {
            padding: 0
        }

        #dashboard .dashboard {
            color: #009aff;
            padding: 0.625em 1em
        }

        #dashboard .dashboard:hover {
            color: #006cb3
        }

        #user-has-api-key .add-on {
            width: 20%;
            text-align: center
        }

        #user-has-api-key #your-api-key {
            font-family: "Lucida Console",Monaco,monospace;
            color: #323232
        }

        .kindle-settings .list li::before,.kindle-settings .detail-list li::before {
            font-size: 2em
        }

        .email-settings #mailchimp-unsubscribe,.email-settings #mailchimp-subscribe {
            margin-bottom: 1em
        }

        form .avatar,form .avatar-and-name {
            display: inline-block;
            margin-bottom: 1em
        }

        input[type="file"] {
            background: #f5f5f5;
            border: 1px solid #cbcbcb;
            border-radius: 4px;
            color: #999;
            cursor: pointer
        }

        .affiliate-program button {
            font-size: 12px
        }

        .bundle-edit {
            padding: 0
        }

        .bundle-edit>section {
            margin: 0;
            width: 100%;
            padding: 4.125em 5em
        }

        #write .video-title {
            color: #323232
        }

        .accordion-tabs-minimal {
            margin-bottom: 0
        }

        .accordion-tabs-minimal:after {
            content: "";
            display: table;
            clear: both
        }

        .accordion-tabs-minimal>li.active a,.accordion-tabs-minimal>li.is-active a {
            border-bottom: 0;
            pointer-events: none
        }

        @media screen and (min-width: 53.75em) {
            .accordion-tabs-minimal>li.active a,.accordion-tabs-minimal>li.is-active a {
                border:1px solid #cbcbcb;
                background-color: #fff;
                border-bottom: 1px solid #fff;
                border-bottom-color: transparent;
                margin-bottom: -1px
            }
        }

        .accordion-tabs-minimal>li>a {
            border-top-left-radius: 0;
            border-top-right-radius: 0;
            background-color: transparent;
            border-top: 1px solid #cbcbcb;
            color: gray;
            display: block;
            font-weight: 400;
            padding: 0.75em 1em
        }

        @media screen and (min-width: 53.75em) {
            .accordion-tabs-minimal>li>a {
                border-top-left-radius:4px;
                border-top-right-radius: 4px;
                display: inline-block;
                vertical-align: baseline;
                zoom:1;*display: inline;
                *vertical-align: auto;
                border-top: 0
            }
        }

        .accordion-tabs-minimal>li>a:hover {
            color: #009aff
        }

        .accordion-tabs-minimal>li>a:focus {
            outline: none
        }

        @media screen and (min-width: 53.75em) {
            .accordion-tabs-minimal>li {
                display:inline
            }

            .accordion-tabs-minimal>li.active:first-child a {
                border-top: 1px solid #cbcbcb
            }
        }

        .accordion-tabs-minimal+.tab-content {
            position: static;
            width: 100%;
            background-color: #fff;
            border: 1px solid #cbcbcb
        }

        @media screen and (min-width: 53.75em) {
            .accordion-tabs-minimal+.tab-content {
                padding:4.125em 5em;
                border-top: 1px solid #cbcbcb;
                float: left
            }
        }

        .jstab-content {
            display: none
        }

        .jstab-content.is-active {
            display: block
        }

        #help,#books-getting-started {
            background-color: transparent;
            margin-top: 3em
        }

        #help .container,#help #contact article,#contact #help article,#help #buzz article,#buzz #help article,#help #manifesto article,#manifesto #help article,#help #affiliates article,#affiliates #help article,#help #age-verification article,#age-verification #help article,#help #gift-purchase article,#gift-purchase #help article,#help #terms article,#terms #help article,#help #request_refund article,#request_refund #help article,#help #wishlist-container article,#wishlist-container #help article,#help #sign-up article,#sign-up #help article,#help #welcome article,#welcome #help article,#help #upsell article,#upsell #help article,#help .new-book article,.new-book #help article,#help .new-publisher-book article,.new-publisher-book #help article,#help #new-bundle article,#new-bundle #help article,#help,#books-getting-started .container,#books-getting-started #contact article,#contact #books-getting-started article,#books-getting-started #buzz article,#buzz #books-getting-started article,#books-getting-started #manifesto article,#manifesto #books-getting-started article,#books-getting-started #affiliates article,#affiliates #books-getting-started article,#books-getting-started #age-verification article,#age-verification #books-getting-started article,#books-getting-started #gift-purchase article,#gift-purchase #books-getting-started article,#books-getting-started #terms article,#terms #books-getting-started article,#books-getting-started #request_refund article,#request_refund #books-getting-started article,#books-getting-started #wishlist-container article,#wishlist-container #books-getting-started article,#books-getting-started #sign-up article,#sign-up #books-getting-started article,#books-getting-started #welcome article,#welcome #books-getting-started article,#books-getting-started #upsell article,#upsell #books-getting-started article,#books-getting-started .new-book article,.new-book #books-getting-started article,#books-getting-started .new-publisher-book article,.new-publisher-book #books-getting-started article,#books-getting-started #new-bundle article,#new-bundle #books-getting-started article,#books-getting-started {
            padding: 0
        }

        #help article code,#books-getting-started article code {
            padding: 0;
            color: #333
        }

        #help #leanpub-doc-main,#books-getting-started #leanpub-doc-main {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            float: none
        }

        #help #leanpub-doc-main:last-child,#books-getting-started #leanpub-doc-main:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 53.75em) {
            #help #leanpub-doc-main,#books-getting-started #leanpub-doc-main {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 65.88078%
            }

            #help #leanpub-doc-main:last-child,#books-getting-started #leanpub-doc-main:last-child {
                margin-right: 0
            }
        }

        #help #leanpub-toc,#books-getting-started #leanpub-toc {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            font-size: 0.85em
        }

        #help #leanpub-toc:last-child,#books-getting-started #leanpub-toc:last-child {
            margin-right: 0
        }

        #help #leanpub-toc ul,#help #leanpub-toc ol,#books-getting-started #leanpub-toc ul,#books-getting-started #leanpub-toc ol {
            list-style-type: circle;
            padding-left: 1em
        }

        @media screen and (min-width: 53.75em) {
            #help #leanpub-toc,#books-getting-started #leanpub-toc {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 31.76157%;
                padding-left: 2em;
                margin-right: 0;
                float: right
            }

            #help #leanpub-toc:last-child,#books-getting-started #leanpub-toc:last-child {
                margin-right: 0
            }
        }

        #help .double-nav,#books-getting-started .double-nav {
            padding-bottom: 1em
        }

        #help .vertical-tabs,#books-getting-started .vertical-tabs {
            padding-top: 1em
        }

        #help .vertical-tabs a,#books-getting-started .vertical-tabs a {
            font-size: 1em
        }

        #help .vertical-tab-content-container::before,#books-getting-started .vertical-tab-content-container::before {
            height: auto
        }

        .featured-book {
            width: 100%;
            padding: 2em 0;
            position: relative
        }

        .featured-book .featured-title {
            margin-bottom: 1em;
            text-transform: uppercase;
            text-align: left;
            font-size: 1.25em
        }

        @media screen and (min-width: 53.75em) {
            .featured-book .featured-title {
                margin-bottom:3em;
                font-size: 0.8125em
            }
        }

        .featured-book .pricing-wrapper {
            font-size: 2em
        }

        .featured-book .buy-now {
            float: right
        }

        @media screen and (min-width: 53.75em) {
            .featured-book .buy-now {
                font-size:.8125em;
                margin-top: 1em;
                margin-bottom: 0;
                float: none
            }
        }

        .featured-book .featured-rank {
            text-align: right;
            font-weight: 800
        }

        .featured-book .featured-rank::before {
            content: '#';
            font-size: .75em;
            color: #999
        }

        .featured-book>aside {
            width: 100%;
            padding: 2em 1em;
            position: relative;
            overflow: hidden
        }

        @media screen and (min-width: 40em) {
            .featured-book>aside {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%;
                margin-right: 0
            }

            .featured-book>aside:last-child {
                margin-right: 0
            }
        }

        @media screen and (min-width: 53.75em) {
            .featured-book>aside {
                float:left;
                display: block;
                margin-right: 3.57866%;
                width: 48.21067%;
                padding: 2em 0.25em 2em 0.75em;
                margin-right: 0
            }

            .featured-book>aside:last-child {
                margin-right: 0
            }
        }

        .featured-book .book-description,.featured-book .bundle-description {
            margin-bottom: 1em
        }

        @media screen and (min-width: 53.75em) {
            .featured-book {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 65.88078%;
                padding: 0;
                box-shadow: none
            }

            .featured-book:last-child {
                margin-right: 0
            }
        }

        #featured-cover .cover-image {
            width: 100%
        }

        @media screen and (min-width: 40em) {
            #featured-cover .cover-image {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%
            }

            #featured-cover .cover-image:last-child {
                margin-right: 0
            }
        }

        @media screen and (min-width: 53.75em) {
            #featured-cover .cover-image {
                float:left;
                display: block;
                margin-right: 3.57866%;
                width: 48.21067%;
                position: relative;
                bottom: 2em
            }

            #featured-cover .cover-image:last-child {
                margin-right: 0
            }
        }

        .book-list-item .pseudo-cover,.edit-book-list-item .pseudo-cover {
            padding-bottom: 120%
        }

        .edit-book-list-item {
            padding: 0
        }

        .edit-book-list-item .list-item-title {
            font-size: .8125em
        }

        .book-grid .book-list-item {
            padding: 0
        }

        .bundle-list-item.paginate {
            margin-bottom: 0
        }

        .bundle-list-item .pseudo-cover {
            padding-bottom: 65%
        }

        .book-count-inline {
            text-transform: uppercase;
            font-size: .8125em;
            color: inherit
        }

        .cover-image-wrapper {
            width: 100%;
            position: relative;
            overflow: visible
        }

        .cover-image-wrapper[data-count='2'] .cover-image {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 48.82117%
        }

        .cover-image-wrapper[data-count='2'] .cover-image:last-child {
            margin-right: 0
        }

        .cover-image-wrapper[data-count='2'] .cover-image:nth-child(2n) {
            margin-right: 0
        }

        .cover-image-wrapper[data-count='2'] .cover-image:nth-child(2n+1) {
            clear: left
        }

        .cover-image-wrapper[data-count='2'] .cover-image:nth-child(1) img {
            margin-right: 0
        }

        .cover-image-wrapper[data-count='2'] .cover-image:nth-child(2) img {
            margin-left: 0
        }

        .cover-image-wrapper[data-count='3'] .cover-image {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 48.82117%;
            margin-left: -25.58941%
        }

        .cover-image-wrapper[data-count='3'] .cover-image:last-child {
            margin-right: 0
        }

        .cover-image-wrapper[data-count='3'] .cover-image:first-child {
            margin-left: 0
        }

        .cover-image-wrapper[data-count='4'] .cover-image {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 48.82117%;
            margin-left: -34.11922%
        }

        .cover-image-wrapper[data-count='4'] .cover-image:last-child {
            margin-right: 0
        }

        .cover-image-wrapper[data-count='4'] .cover-image:first-child {
            margin-left: 0
        }

        .cover-image-wrapper[data-count='5'] .cover-image {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 48.82117%;
            margin-left: -38.64902%
        }

        .cover-image-wrapper[data-count='5'] .cover-image:last-child {
            margin-right: 0
        }

        .cover-image-wrapper[data-count='5'] .cover-image:first-child {
            margin-left: 0
        }

        .royalties-counter {
            padding: 1em 2.35765%;
            border-radius: 0
        }

        .royalties-counter .royalty-price {
            color: #009aff
        }

        .royalties-counter.concise {
            background-color: #f2f9ff;
            border-bottom: 1px solid #bfe1ff
        }

        .royalties-counter.concise .text {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 82.94039%;
            margin-left: 8.5298%;
            display: inline-block;
            margin-top: 0;
            text-align: center;
            color: #323232
        }

        .royalties-counter.concise .text:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 40em) {
            .royalties-counter.concise .text {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 31.76157%;
                margin-left: 0%;
                margin-top: .5em;
                font-size: 1em;
                text-align: left
            }

            .royalties-counter.concise .text:last-child {
                margin-right: 0
            }
        }

        .royalties-counter.concise .sales {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 82.94039%;
            margin-left: 8.5298%;
            text-align: center
        }

        .royalties-counter.concise .sales:last-child {
            margin-right: 0
        }

        .royalties-counter.concise .sales .royalty-price {
            font-size: 1.75em
        }

        .royalties-counter.concise .sales sub {
            font-size: .75em;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #797979
        }

        @media screen and (min-width: 40em) {
            .royalties-counter.concise .sales {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 31.76157%;
                margin-left: 0%;
                text-align: right
            }

            .royalties-counter.concise .sales:last-child {
                margin-right: 0
            }

            .royalties-counter.concise .sales sub {
                display: block;
                margin-right: 0
            }
        }

        @media screen and (min-width: 53.75em) {
            .royalties-counter.concise .sales sub {
                display:inline;
                margin-right: 1.125em
            }
        }

        .royalties-counter.sentence {
            text-align: center
        }

        .royalties-counter.sentence h6 {
            margin: 0;
            line-height: 1.5;
            color: #999
        }

        @media screen and (min-width: 40em) {
            .royalties-counter {
                border-radius:8px
            }
        }

        .bullets {
            overflow: auto;
            margin-bottom: 1.5em
        }

        .bullets .one-col-bullet {
            width: 100%
        }

        @media screen and (min-width: 53.75em) {
            .bullets .one-col-bullet {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 65.88078%;
                margin-left: 17.05961%
            }

            .bullets .one-col-bullet:last-child {
                margin-right: 0
            }
        }

        @media screen and (min-width: 53.75em) {
            .bullets .two-col-bullet {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%
            }

            .bullets .two-col-bullet:last-child {
                margin-right: 0
            }

            .bullets .two-col-bullet:nth-child(2n) {
                margin-right: 0
            }

            .bullets .two-col-bullet:nth-child(2n+1) {
                clear: left
            }
        }

        @media screen and (min-width: 53.75em) {
            .bullets .three-col-bullet {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 31.76157%
            }

            .bullets .three-col-bullet:last-child {
                margin-right: 0
            }

            .bullets .three-col-bullet:nth-child(3n) {
                margin-right: 0
            }

            .bullets .three-col-bullet:nth-child(3n+1) {
                clear: left
            }
        }

        @media screen and (min-width: 53.75em) {
            .bullets .four-col-bullet {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 23.23176%
            }

            .bullets .four-col-bullet:last-child {
                margin-right: 0
            }

            .bullets .four-col-bullet:nth-child(4n) {
                margin-right: 0
            }

            .bullets .four-col-bullet:nth-child(4n+1) {
                clear: left
            }
        }

        .bullets .bullet-icon {
            margin: 0 auto;
            overflow: visible
        }

        .bullets .bullet-content {
            padding: 0 1.5em;
            margin: 0 auto 2em auto;
            text-align: center;
            color: inherit
        }

        .bullets .bullet-content .video-title {
            margin: .75em 0;
            font-size: 1.125em;
            color: #fff
        }

        .bullets h2 {
            display: inline-block;
            padding-top: 7.14286px;
            margin-bottom: 8.33333px;
            font-size: 20px;
            color: #323232
        }

        .bullets .learn-more {
            display: block;
            margin-bottom: 2.5em;
            color: inherit
        }

        .react-modal .modal-inner {
            position: relative;
            overflow-x: hidden
        }

        .react-modal .modal-spinner {
            display: block;
            padding: 20% 50%
        }

        .react-modal i.fa-close {
            z-index: 1;
            position: absolute;
            right: 1em;
            font-size: 2em;
            cursor: pointer
        }

        .react-price span.strike {
            text-decoration: line-through
        }

        .react-price p.subtext {
            font-size: .40em;
            letter-spacing: 1px;
            color: #666;
            text-decoration: none
        }

        .react-modal .sliders-wrapper {
            padding: 0
        }

        .cartable-meta {
            margin-top: 2em
        }

        .cartable-meta img {
            float: left;
            box-shadow: 0px 1px 5px 0px rgba(0,0,0,0.5);
            margin-right: 2em;
            margin-bottom: 1em
        }

        .cartable-meta h6 {
            margin-left: 1em;
            font-size: 0.825em;
            overflow: wrap
        }

        .cartable-meta .description {
            font-size: 0.9em;
            margin-bottom: 0;
            margin-top: 1em
        }

        .pricing-wrapper {
            text-align: right;
            font-size: 25px
        }

        .pricing-wrapper .regular-price {
            text-decoration: line-through
        }

        .pricing-wrapper .coupon-price {
            background-color: #fff6bf;
            color: #666
        }

        .price-hint {
            font-size: 0.85em;
            margin-bottom: 0.5em
        }

        .modal .modal-inner p {
            font-size: 16px
        }

        .ui-slider {
            position: relative;
            text-align: left
        }

        .ui-slider .ui-slider-handle {
            position: absolute;
            z-index: 5;
            width: 1.2em;
            height: 1.2em;
            cursor: default
        }

        .ui-slider .ui-slider-range {
            position: absolute;
            z-index: 3;
            font-size: .7em;
            display: block;
            border: 0;
            background-position: 0 0
        }

        .scroll-bar-wrap .ui-handle-helper-parent {
            position: relative;
            width: 100%;
            height: 100%;
            margin: 0 auto
        }

        .ui-slider-horizontal {
            height: 100%
        }

        .ui-slider-horizontal .ui-slider-range {
            top: 0;
            height: 100%
        }

        .ui-slider-horizontal .ui-slider-range-min {
            left: 0
        }

        .ui-slider-horizontal .ui-slider-range-max {
            right: 0
        }

        .ui-slider-vertical {
            width: .8em;
            height: 100px
        }

        .ui-slider-vertical .ui-slider-handle {
            left: -.3em;
            margin-left: 0;
            margin-bottom: -.6em
        }

        .ui-slider-vertical .ui-slider-range {
            left: 0;
            width: 100%
        }

        .ui-slider-vertical .ui-slider-range-min {
            bottom: 0
        }

        .ui-slider-vertical .ui-slider-range-max {
            top: 0
        }

        .ui-slider-wrapper {
            -webkit-transition: border,0.2s,linear;
            -moz-transition: border,0.2s,linear;
            transition: border,0.2s,linear;
            height: 32px;
            background-color: #fff;
            padding: 0;
            border: 1px solid #cbcbcb;
            border-radius: 4px;
            margin-bottom: 1em
        }

        .ui-slider .ui-slider-handle {
            top: -11px;
            height: 54px;
            width: 10px;
            border: 1px solid #fff;
            border-radius: 5px;
            background-color: #666;
            box-shadow: 0 2px 10px 0 #666;
            cursor: pointer
        }

        .ui-slider .ui-slider-range {
            height: 30px;
            background-color: #999;
            border-top-left-radius: 2px;
            border-bottom-left-radius: 2px;
            margin: 0
        }

        #you_pay_slider.ui-slider .ui-slider-range,#you_pay_hero_slider.ui-slider .ui-slider-range,#you_pay_modal_slider.ui-slider .ui-slider-range,#you_pay_modal-edit_slider.ui-slider .ui-slider-range {
            background-color: #7ACAFF
        }

        #you_pay_slider.ui-slider .happy-price,#you_pay_hero_slider.ui-slider .happy-price,#you_pay_modal_slider.ui-slider .happy-price,#you_pay_modal-edit_slider.ui-slider .happy-price {
            background-color: #009aff
        }

        #you_pay_slider.ui-slider .ui-slider-handle,#you_pay_hero_slider.ui-slider .ui-slider-handle,#you_pay_modal_slider.ui-slider .ui-slider-handle,#you_pay_modal-edit_slider.ui-slider .ui-slider-handle {
            background-color: #009aff;
            box-shadow: 0 2px 10px 0 #009aff
        }

        #author_earns_slider.ui-slider .ui-slider-range,#author_earns_hero_slider.ui-slider .ui-slider-range,#author_earns_modal_slider.ui-slider .ui-slider-range,#author_earns_modal-edit_slider.ui-slider .ui-slider-range {
            background-color: #999
        }

        #author_earns_slider.ui-slider .happy-price,#author_earns_hero_slider.ui-slider .happy-price,#author_earns_modal_slider.ui-slider .happy-price,#author_earns_modal-edit_slider.ui-slider .happy-price {
            background-color: #666
        }

        .ui-slider .ui-slider-value input:focus {
            border-color: rgba(82,168,236,0.8);
            background-color: #fff
        }

        .ui-slider .ui-slider-value {
            position: absolute;
            z-index: 4;
            line-height: 32px;
            padding: 0;
            margin: 0 7px
        }

        .ui-slider .ui-slider-value,.ui-slider .ui-slider-value input {
            text-align: left;
            font-size: 1.125em;
            line-height: 30px;
            color: #fff
        }

        .ui-slider .ui-slider-value input {
            box-shadow: none;
            display: inline-block;
            height: 30px;
            background: transparent;
            width: 80px;
            padding: 0;
            border: 1px solid transparent;
            margin-bottom: 0;
            overflow: hidden
        }

        .ui-slider .ui-slider-value input:focus {
            padding: 0 5px;
            color: #323232
        }

        .ui-slider .ui-slider-value.inverse,.ui-slider .ui-slider-value.inverse input {
            color: #424242
        }

        .sliders-wrapper {
            width: 100%;
            margin-bottom: 2em;
            display: block
        }

        .sliders-wrapper label {
            margin-bottom: .625em;
            font-size: 1.125em;
            color: #666
        }

        .sliders-wrapper label i {
            margin-left: .25em
        }

        @media screen and (min-width: 53.75em) {
            .sliders-wrapper {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 100%;
                padding: 0 2.35765%;
                margin-bottom: 0
            }

            .sliders-wrapper:last-child {
                margin-right: 0
            }
        }

        .sliders-wrapper label {
            display: inline-block
        }

        .sliders-wrapper i {
            margin-left: 5px
        }

        .sliders-wrapper .submit {
            float: right
        }

        .sliders-wrapper .subtext {
            font-size: 0.75em;
            text-align: right;
            margin-top: 1em;
            margin-right: 0;
            padding-left: 1em
        }

        .gift-form-wrapper {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%
        }

        .gift-form-wrapper:last-child {
            margin-right: 0
        }

        .gift-form-wrapper input[type="checkbox"] {
            display: inline
        }

        .gift-form-wrapper .controls {
            margin-bottom: 0.25em
        }

        .gift-form-wrapper .control-group {
            margin-bottom: 0.25em
        }

        .gift-form-wrapper input {
            margin-bottom: 0
        }

        .gift-form-wrapper .is-gift {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%
        }

        .gift-form-wrapper .is-gift:last-child {
            margin-right: 0
        }

        .gift-form-wrapper .is-gift label {
            display: inline;
            padding-left: 0.3em
        }

        @media screen and (min-width: 53.75em) {
            .gift-form-wrapper .is-gift {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 14.70196%
            }

            .gift-form-wrapper .is-gift:last-child {
                margin-right: 0
            }
        }

        .gift-form-wrapper .giftee-email,.gift-form-wrapper .quantity {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%
        }

        .gift-form-wrapper .giftee-email:last-child,.gift-form-wrapper .quantity:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 53.75em) {
            .gift-form-wrapper .giftee-email,.gift-form-wrapper .quantity {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 40.29137%
            }

            .gift-form-wrapper .giftee-email:last-child,.gift-form-wrapper .quantity:last-child {
                margin-right: 0
            }
        }

        .gift-form-wrapper .quantity input {
            width: 4em;
            margin-bottom: 0
        }

        .gift-form-wrapper .gift-note {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%
        }

        .gift-form-wrapper .gift-note:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 53.75em) {
            .gift-form-wrapper .gift-note {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 40.29137%
            }

            .gift-form-wrapper .gift-note:last-child {
                margin-right: 0
            }
        }

        #home-hero {
            background-color: #fff
        }

        #home-hero .large-container,#home-hero #app-container,#home-hero #bookstore section,#bookstore #home-hero section {
            padding: 0
        }

        @media screen and (min-width: 53.75em) {
            #home-hero .large-container,#home-hero #app-container,#home-hero #bookstore section,#bookstore #home-hero section {
                padding:0 1em
            }
        }

        #home-hero .large-container .left,#home-hero #app-container .left,#home-hero #bookstore section .left,#bookstore #home-hero section .left {
            padding: 3em 0
        }

        @media screen and (min-width: 53.75em) {
            #home-hero .large-container .left,#home-hero #app-container .left,#home-hero #bookstore section .left,#bookstore #home-hero section .left {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 31.76157%
            }

            #home-hero .large-container .left:last-child,#home-hero #app-container .left:last-child,#home-hero #bookstore section .left:last-child,#bookstore #home-hero section .left:last-child {
                margin-right: 0
            }
        }

        @media screen and (max-width: 53.75em) {
            #home-hero .large-container .left,#home-hero #app-container .left,#home-hero #bookstore section .left,#bookstore #home-hero section .left {
                padding:3em 1em
            }
        }

        #homepage-essay {
            position: fixed;
            width: 100%;
            height: 100%;
            background-color: #fff;
            overflow: auto;
            z-index: 10000
        }

        #homepage-essay .intro {
            color: #323232
        }

        #homepage-essay .logo {
            position: relative;
            background-image: url("logos/leanpub-logo-text-black.svg");
            background-image: url("logos/leanpub-logo-text-black.svg");
            background-position: center center;
            background-repeat: no-repeat;
            background-size: auto auto;
            height: auto;
            height: 200px
        }

        #homepage-essay .logo a {
            display: block;
            height: 100%
        }

        #homepage-essay .continue a {
            float: right;
            color: #323232
        }

        #homepage-essay .continue a::after {
            vertical-align: middle;
            margin-left: .25em
        }

        #bestsellers-books {
            overflow: hidden
        }

        #bestsellers-books .book-list-item {
            margin-bottom: 0;
            border-bottom: 0
        }

        #bestsellers-books .list-item-title {
            font-size: .8125em;
            line-height: 1.25
        }

        #bestsellers-bundles {
            overflow: hidden
        }

        #bestsellers-bundles .bundle-list-item {
            margin-bottom: 0;
            border-bottom: 0
        }

        #featured-podcast {
            padding: 1em 2.35765%;
            color: #323232
        }

        #about-leanpub {
            padding: 5em 2.35765%;
            background-color: #fff;
            text-align: center
        }

        #about-leanpub .section-title {
            margin-bottom: 1em
        }

        #about-leanpub .about-copy {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 82.94039%;
            margin-left: 8.5298%;
            float: none;
            margin-bottom: 5em
        }

        #about-leanpub .about-copy:last-child {
            margin-right: 0
        }

        #about-leanpub .about-copy p {
            margin: 0
        }

        #about-leanpub .about-copy span {
            padding: 0 2px;
            color: #009aff;
            font-size: 1.25em;
            text-transform: uppercase
        }

        #about-leanpub .about-copy span sup {
            vertical-align: text-bottom
        }

        #about-leanpub .more {
            display: block;
            margin-bottom: 1em
        }

        #about-leanpub .about-markua {
            margin-bottom: 2em;
            text-align: center
        }

        #about-leanpub .about-markua .postcard {
            background-image: url(/assets/markua-postcard-c5f4ba6c10f319e5fc127310b4bb9e9f.jpg);
            -webkit-transform: rotate(-2.5deg);
            -moz-transform: rotate(-2.5deg);
            -ms-transform: rotate(-2.5deg);
            -o-transform: rotate(-2.5deg);
            transform: rotate(-2.5deg);
            box-shadow: 0px 10px 40px -15px rgba(0,0,0,0.4),0px 5px 10px -3px rgba(0,0,0,0.3);
            width: 237px;
            height: 134px;
            margin: auto;
            margin-bottom: 2.25em;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden
        }

        @media only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 1.3 / 1), only screen and (min-resolution: 125dpi), only screen and (min-resolution: 1.3dppx) {
            #about-leanpub .about-markua .postcard {
                background-image:url(/assets/markua-postcard_2x-6e992e249efb07427690f6908302e1c1.jpg);
                background-size: 237px 134px
            }
        }

        @media screen and (min-width: 53.75em) {
            #about-leanpub .about-markua {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 65.88078%;
                margin-left: 17.05961%
            }

            #about-leanpub .about-markua:last-child {
                margin-right: 0
            }
        }

        #about-leanpub .royalties-counter {
            margin: 3em 0
        }

        #about-leanpub .royalties-counter:after {
            content: "";
            display: table;
            clear: both
        }

        #about-leanpub .bullets {
            width: 100%
        }

        #about-leanpub .bullet-icon {
            color: #666;
            margin-bottom: 8px;
            font-size: 32px
        }

        #about-leanpub .sign-up {
            font-size: .75em;
            margin-top: 1em
        }

        #intro-video {
            padding: 3em 2.35765%;
            position: relative;
            text-align: center;
            color: #323232;
            background-color: #fff
        }

        #intro-video .modal-open::after {
            font-family: FontAwesome;
            content: '\f04b';
            font-size: 2em;
            color: #009aff
        }

        #intro-video .modal-open:hover::after {
            color: #006cb3
        }

        #intro-video .intro-video-copy {
            width: 100%
        }

        #intro-video .intro-video-copy h2 {
            font-weight: 600;
            margin-bottom: .5em
        }

        #intro-video .intro-video-copy p {
            padding: 0 2em
        }

        @media screen and (min-width: 53.75em) {
            #intro-video .intro-video-copy {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%
            }

            #intro-video .intro-video-copy:last-child {
                margin-right: 0
            }

            #intro-video .intro-video-copy:nth-child(2n) {
                margin-right: 0
            }

            #intro-video .intro-video-copy:nth-child(2n+1) {
                clear: left
            }
        }

        .flash-message-container {
            padding: 0 1em
        }

        .button-group input {
            display: none
        }

        .button-group label {
            margin-bottom: 0
        }

        @media screen and (min-width: 53.75em) {
            .button-group label {
                float:left
            }
        }

        .button-group label .button-group-item {
            background: #fbfbfb;
            border-left: 1px solid #cbcbcb;
            border-radius: 0;
            border-right: 1px solid #cbcbcb;
            color: #7f7f7f;
            cursor: pointer;
            display: inline-block;
            font-size: .875em;
            line-height: 1;
            padding: .75em 1em;
            width: 100%
        }

        @media screen and (min-width: 53.75em) {
            .button-group label .button-group-item {
                border-bottom:1px solid #cbcbcb;
                border-left: 0;
                border-right: 1px solid #f9f9f9;
                border-top: 1px solid #cbcbcb;
                width: auto
            }
        }

        .button-group label .button-group-item:hover {
            background-color: #f3f3f3
        }

        .button-group label:first-child .button-group-item {
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
            border-top: 1px solid #cbcbcb
        }

        @media screen and (min-width: 53.75em) {
            .button-group label:first-child .button-group-item {
                border-bottom-left-radius:4px;
                border-left: 1px solid #cbcbcb;
                border-top-left-radius: 4px;
                border-top-right-radius: 0
            }
        }

        .button-group label:last-child .button-group-item {
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
            border-bottom: 1px solid #cbcbcb
        }

        @media screen and (min-width: 53.75em) {
            .button-group label:last-child .button-group-item {
                border-bottom-left-radius:0;
                border-bottom-right-radius: 4px;
                border-right: 1px solid #cbcbcb;
                border-top-right-radius: 4px
            }
        }

        .button-group label input:checked+.button-group-item {
            background: #009aff;
            border: 1px solid #006cb3;
            box-shadow: inset 0 1px 2px #007bcc;
            color: #fff
        }

        .accordion-tabs-minimal {
            margin-bottom: 0
        }

        .accordion-tabs-minimal:after {
            content: "";
            display: table;
            clear: both
        }

        .accordion-tabs-minimal>li.active a,.accordion-tabs-minimal>li.is-active a {
            border-bottom: 0;
            pointer-events: none
        }

        @media screen and (min-width: 53.75em) {
            .accordion-tabs-minimal>li.active a,.accordion-tabs-minimal>li.is-active a {
                border:1px solid #cbcbcb;
                background-color: #fff;
                border-bottom: 1px solid #fff;
                border-bottom-color: transparent;
                margin-bottom: -1px
            }
        }

        .accordion-tabs-minimal>li>a {
            border-top-left-radius: 0;
            border-top-right-radius: 0;
            background-color: transparent;
            border-top: 1px solid #cbcbcb;
            color: gray;
            display: block;
            font-weight: 400;
            padding: 0.75em 1em
        }

        @media screen and (min-width: 53.75em) {
            .accordion-tabs-minimal>li>a {
                border-top-left-radius:4px;
                border-top-right-radius: 4px;
                display: inline-block;
                vertical-align: baseline;
                zoom:1;*display: inline;
                *vertical-align: auto;
                border-top: 0
            }
        }

        .accordion-tabs-minimal>li>a:hover {
            color: #009aff
        }

        .accordion-tabs-minimal>li>a:focus {
            outline: none
        }

        @media screen and (min-width: 53.75em) {
            .accordion-tabs-minimal>li {
                display:inline
            }

            .accordion-tabs-minimal>li.active:first-child a {
                border-top: 1px solid #cbcbcb
            }
        }

        .accordion-tabs-minimal+.tab-content {
            position: static;
            width: 100%;
            background-color: #fff;
            border: 1px solid #cbcbcb
        }

        @media screen and (min-width: 53.75em) {
            .accordion-tabs-minimal+.tab-content {
                padding:4.125em 5em;
                border-top: 1px solid #cbcbcb;
                float: left
            }
        }

        .jstab-content {
            display: none
        }

        .jstab-content.is-active {
            display: block
        }

        .manage-purchased-package .tab-link[data-disabled] {
            opacity: .5
        }

        .manage-purchased-package .control-group .controls {
            margin-bottom: 0
        }

        .manage-purchased-package .control-group .controls .input-prepend .add-on {
            width: 275px
        }

        .manage-purchased-package .header-images {
            height: 190px;
            position: relative;
            width: 200px;
            float: left
        }

        .manage-purchased-package .header-images .book-stack {
            height: 190px;
            width: 175px;
            position: relative;
            margin-left: -30px
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="1"]>li:nth-child(1) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(0deg) translateX(8px);
            -moz-transform: rotate(0deg) translateX(8px);
            -ms-transform: rotate(0deg) translateX(8px);
            -o-transform: rotate(0deg) translateX(8px);
            transform: rotate(0deg) translateX(8px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="1"]>li:nth-child(2) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(5deg) translateX(16px);
            -moz-transform: rotate(5deg) translateX(16px);
            -ms-transform: rotate(5deg) translateX(16px);
            -o-transform: rotate(5deg) translateX(16px);
            transform: rotate(5deg) translateX(16px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="1"]>li:nth-child(3) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(10deg) translateX(24px);
            -moz-transform: rotate(10deg) translateX(24px);
            -ms-transform: rotate(10deg) translateX(24px);
            -o-transform: rotate(10deg) translateX(24px);
            transform: rotate(10deg) translateX(24px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="1"]>li:nth-child(4) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(15deg) translateX(32px);
            -moz-transform: rotate(15deg) translateX(32px);
            -ms-transform: rotate(15deg) translateX(32px);
            -o-transform: rotate(15deg) translateX(32px);
            transform: rotate(15deg) translateX(32px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="1"]>li:nth-child(5) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(20deg) translateX(40px);
            -moz-transform: rotate(20deg) translateX(40px);
            -ms-transform: rotate(20deg) translateX(40px);
            -o-transform: rotate(20deg) translateX(40px);
            transform: rotate(20deg) translateX(40px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="2"]>li:nth-child(1) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(-5deg) translateX(8px);
            -moz-transform: rotate(-5deg) translateX(8px);
            -ms-transform: rotate(-5deg) translateX(8px);
            -o-transform: rotate(-5deg) translateX(8px);
            transform: rotate(-5deg) translateX(8px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="2"]>li:nth-child(2) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(0deg) translateX(16px);
            -moz-transform: rotate(0deg) translateX(16px);
            -ms-transform: rotate(0deg) translateX(16px);
            -o-transform: rotate(0deg) translateX(16px);
            transform: rotate(0deg) translateX(16px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="2"]>li:nth-child(3) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(5deg) translateX(24px);
            -moz-transform: rotate(5deg) translateX(24px);
            -ms-transform: rotate(5deg) translateX(24px);
            -o-transform: rotate(5deg) translateX(24px);
            transform: rotate(5deg) translateX(24px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="2"]>li:nth-child(4) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(10deg) translateX(32px);
            -moz-transform: rotate(10deg) translateX(32px);
            -ms-transform: rotate(10deg) translateX(32px);
            -o-transform: rotate(10deg) translateX(32px);
            transform: rotate(10deg) translateX(32px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="2"]>li:nth-child(5) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(15deg) translateX(40px);
            -moz-transform: rotate(15deg) translateX(40px);
            -ms-transform: rotate(15deg) translateX(40px);
            -o-transform: rotate(15deg) translateX(40px);
            transform: rotate(15deg) translateX(40px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="3"]>li:nth-child(1) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(-10deg) translateX(8px);
            -moz-transform: rotate(-10deg) translateX(8px);
            -ms-transform: rotate(-10deg) translateX(8px);
            -o-transform: rotate(-10deg) translateX(8px);
            transform: rotate(-10deg) translateX(8px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="3"]>li:nth-child(2) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(-5deg) translateX(16px);
            -moz-transform: rotate(-5deg) translateX(16px);
            -ms-transform: rotate(-5deg) translateX(16px);
            -o-transform: rotate(-5deg) translateX(16px);
            transform: rotate(-5deg) translateX(16px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="3"]>li:nth-child(3) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(0deg) translateX(24px);
            -moz-transform: rotate(0deg) translateX(24px);
            -ms-transform: rotate(0deg) translateX(24px);
            -o-transform: rotate(0deg) translateX(24px);
            transform: rotate(0deg) translateX(24px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="3"]>li:nth-child(4) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(5deg) translateX(32px);
            -moz-transform: rotate(5deg) translateX(32px);
            -ms-transform: rotate(5deg) translateX(32px);
            -o-transform: rotate(5deg) translateX(32px);
            transform: rotate(5deg) translateX(32px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="3"]>li:nth-child(5) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(10deg) translateX(40px);
            -moz-transform: rotate(10deg) translateX(40px);
            -ms-transform: rotate(10deg) translateX(40px);
            -o-transform: rotate(10deg) translateX(40px);
            transform: rotate(10deg) translateX(40px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="4"]>li:nth-child(1) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(-15deg) translateX(8px);
            -moz-transform: rotate(-15deg) translateX(8px);
            -ms-transform: rotate(-15deg) translateX(8px);
            -o-transform: rotate(-15deg) translateX(8px);
            transform: rotate(-15deg) translateX(8px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="4"]>li:nth-child(2) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(-10deg) translateX(16px);
            -moz-transform: rotate(-10deg) translateX(16px);
            -ms-transform: rotate(-10deg) translateX(16px);
            -o-transform: rotate(-10deg) translateX(16px);
            transform: rotate(-10deg) translateX(16px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="4"]>li:nth-child(3) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(-5deg) translateX(24px);
            -moz-transform: rotate(-5deg) translateX(24px);
            -ms-transform: rotate(-5deg) translateX(24px);
            -o-transform: rotate(-5deg) translateX(24px);
            transform: rotate(-5deg) translateX(24px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="4"]>li:nth-child(4) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(0deg) translateX(32px);
            -moz-transform: rotate(0deg) translateX(32px);
            -ms-transform: rotate(0deg) translateX(32px);
            -o-transform: rotate(0deg) translateX(32px);
            transform: rotate(0deg) translateX(32px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="4"]>li:nth-child(5) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(5deg) translateX(40px);
            -moz-transform: rotate(5deg) translateX(40px);
            -ms-transform: rotate(5deg) translateX(40px);
            -o-transform: rotate(5deg) translateX(40px);
            transform: rotate(5deg) translateX(40px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="5"]>li:nth-child(1) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(-20deg) translateX(8px);
            -moz-transform: rotate(-20deg) translateX(8px);
            -ms-transform: rotate(-20deg) translateX(8px);
            -o-transform: rotate(-20deg) translateX(8px);
            transform: rotate(-20deg) translateX(8px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="5"]>li:nth-child(2) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(-15deg) translateX(16px);
            -moz-transform: rotate(-15deg) translateX(16px);
            -ms-transform: rotate(-15deg) translateX(16px);
            -o-transform: rotate(-15deg) translateX(16px);
            transform: rotate(-15deg) translateX(16px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="5"]>li:nth-child(3) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(-10deg) translateX(24px);
            -moz-transform: rotate(-10deg) translateX(24px);
            -ms-transform: rotate(-10deg) translateX(24px);
            -o-transform: rotate(-10deg) translateX(24px);
            transform: rotate(-10deg) translateX(24px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="5"]>li:nth-child(4) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(-5deg) translateX(32px);
            -moz-transform: rotate(-5deg) translateX(32px);
            -ms-transform: rotate(-5deg) translateX(32px);
            -o-transform: rotate(-5deg) translateX(32px);
            transform: rotate(-5deg) translateX(32px)
        }

        .manage-purchased-package .header-images .book-stack[data-book-count="5"]>li:nth-child(5) {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transform: rotate(0deg) translateX(40px);
            -moz-transform: rotate(0deg) translateX(40px);
            -ms-transform: rotate(0deg) translateX(40px);
            -o-transform: rotate(0deg) translateX(40px);
            transform: rotate(0deg) translateX(40px)
        }

        .manage-purchased-package table {
            width: 100%
        }

        .redeem-purchased-package .redeem-package {
            margin: 0 auto;
            text-align: center;
            width: 300px
        }

        .redeem-purchased-package .redeem-package h4 {
            margin-bottom: 10px
        }

        .redeem-purchased-package input[type="submit"] {
            float: right
        }

        #library {
            padding: 2em 0;
            background-color: #fff
        }

        #library .large-container,#library #app-container,#library #bookstore section,#bookstore #library section {
            position: relative
        }

        #library .view-header {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 48.82117%;
            padding: 1em 2.35765% 1em 2.35765%;
            border-bottom: 1px solid #cbcbcb;
            position: relative
        }

        #library .view-header:last-child {
            margin-right: 0
        }

        #library .view-header .view-title {
            display: inline-block
        }

        #library .view-button-group {
            display: inline-block;
            float: right;
            margin-top: 10px
        }

        #library .view-button-group label .button-group-item {
            padding: .5em .75em
        }

        #js-view-wrapper {
            position: relative
        }

        #book-list {
            padding: 0;
            position: relative;
            overflow: auto
        }

        #book-list .book-list-item {
            cursor: pointer
        }

        #book-list .book-list-item[data-hidden="true"] {
            opacity: .5
        }

        #book-list .book-list-item.selected .cover-image img {
            box-shadow: 0 0 10px #009aff
        }

        #book-list .book-list-item.selected .list-item-title,#book-list .book-list-item.selected .list-item-author {
            color: #009aff
        }

        #book-list .list-item-title {
            color: #323232;
            line-height: 1.5em
        }

        #book-list .list-item-author {
            color: #999;
            line-height: 1.625em
        }

        #book-list.list-view .book-list-item {
            display: block;
            border-bottom: 1px solid #cbcbcb;
            padding: .375em 1em;
            margin: 0
        }

        #book-list.list-view .book-list-item:last-child {
            border-bottom: 0
        }

        #book-list.list-view .cover-image {
            margin-right: 1em;
            float: left;
            height: 3.375em
        }

        #book-list.list-view .cover-image img {
            box-shadow: none;
            height: inherit;
            vertical-align: top;
            border: 1px solid #cbcbcb
        }

        #book-list.list-view .list-item-title,#book-list.list-view .list-item-author {
            display: inline-block;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            display: block;
            margin: 0;
            text-align: left
        }

        #book-list.list-view .list-item-title {
            font-size: 1.125em
        }

        #book-list.list-view .list-item-author {
            font-size: .9375em;
            color: #323232
        }

        #book-list.cover-view {
            padding: 2.35765%
        }

        #book-list.cover-view .book-list-item {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 48.82117%;
            text-align: center;
            overflow: visible
        }

        #book-list.cover-view .book-list-item:last-child {
            margin-right: 0
        }

        #book-list.cover-view .book-list-item:nth-child(2n) {
            margin-right: 0
        }

        #book-list.cover-view .book-list-item:nth-child(2n+1) {
            clear: left
        }

        #book-list.cover-view .book-list-item .list-item-title {
            font-size: .8125em
        }

        @media screen and (min-width: 53.75em) {
            #book-list.cover-view .book-list-item {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 31.76157%
            }

            #book-list.cover-view .book-list-item:nth-child(2n) {
                margin-right: 2.35765%
            }

            #book-list.cover-view .book-list-item:nth-child(2n+1) {
                clear: none
            }

            #book-list.cover-view .book-list-item:last-child {
                margin-right: 0
            }

            #book-list.cover-view .book-list-item:nth-child(3n) {
                margin-right: 0
            }

            #book-list.cover-view .book-list-item:nth-child(3n+1) {
                clear: left
            }
        }

        @media screen and (min-width: 53.75em) {
            #book-list {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%
            }

            #book-list:last-child {
                margin-right: 0
            }
        }

        #details-panel {
            background-color: #fff;
            background-image: -webkit-linear-gradient(#fff, #eee);
            background-image: linear-gradient(#ffffff,#eeeeee);
            padding: 1.5em;
            background-color: #fff;
            border-radius: 4px;
            border: 1px solid #cbcbcb;
            position: relative
        }

        @media screen and (min-width: 53.75em) {
            #details-panel {
                display:block !important
            }
        }

        #details-panel .details-action-list li.block {
            display: block
        }

        #details-panel .close {
            display: none
        }

        #details-panel .social-sharing i {
            font-size: 15px
        }

        #details-panel #share_email_with_author {
            margin-bottom: 0
        }

        #details-panel #share_email_with_author #share_email_with_author-button {
            padding: 0;
            margin: 0;
            background-color: transparent
        }

        #details-panel #share_email_with_author #share_email_with_author-button,#details-panel #share_email_with_author #share_email_with_author-button:hover {
            text-shadow: none;
            border-bottom: 0
        }

        #details-panel .selection-details-link {
            text-decoration: underline;
            text-transform: uppercase;
            font-size: .75em;
            color: #323232;
            text-shadow: none;
            border: none;
            background: rgba(0,0,0,0);
            padding: 0
        }

        #details-panel .percent-complete {
            font-size: .9375em
        }

        #details-panel .cover-image {
            position: relative;
            bottom: 2.25em
        }

        #details-panel .share-links {
            padding: 1em 0;
            text-align: left
        }

        #details-panel .share-links li {
            vertical-align: top
        }

        #details-panel .details-part {
            width: 100%;
            display: block
        }

        #details-panel .details-part:after {
            content: "";
            display: table;
            clear: both
        }

        #details-panel .details-left,#details-panel .details-right {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 48.82117%;
            position: relative
        }

        #details-panel .details-left:last-child,#details-panel .details-right:last-child {
            margin-right: 0
        }

        #details-panel .manage-purchase {
            margin-bottom: 1em
        }

        #details-panel .download-links-list,#details-panel .delete-links-list {
            width: 100%;
            display: block
        }

        #details-panel .download-links-list:after,#details-panel .delete-links-list:after {
            content: "";
            display: table;
            clear: both
        }

        #details-panel .download-links-list li,#details-panel .delete-links-list li {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 31.76157%;
            padding-top: 2.25em
        }

        #details-panel .download-links-list li:last-child,#details-panel .delete-links-list li:last-child {
            margin-right: 0
        }

        #details-panel .download-links-list li:nth-child(3n),#details-panel .delete-links-list li:nth-child(3n) {
            margin-right: 0
        }

        #details-panel .download-links-list li:nth-child(3n+1),#details-panel .delete-links-list li:nth-child(3n+1) {
            clear: left
        }

        #details-panel .download-links-list p,#details-panel .delete-links-list p {
            margin-bottom: 0;
            padding: 9px 0
        }

        #details-panel .download-links-list .generic,#details-panel .delete-links-list .generic {
            padding: 3px 5px
        }

        #details-panel .download-links-list li {
            text-align: center;
            padding-top: 1.25em
        }

        #details-panel .download-links-list li .fa {
            font-size: 2em
        }

        @media screen and (min-width: 40em) {
            #details-panel .download-links-list li {
                margin-right:2.35765%
            }

            #details-panel .download-links-list li:last-child {
                margin-right: 0
            }
        }

        @media screen and (min-width: 53.75em) {
            #details-panel {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%
            }

            #details-panel:last-child {
                margin-right: 0
            }
        }

        #details-panel .hidden-info {
            position: absolute;
            bottom: -40px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: .8em
        }

        .spinner {
            z-index: 100000
        }

        .spinner::before {
            border-top-left-radius: 4px;
            border-bottom-left-radius: 4px;
            background-color: rgba(255,255,255,0.75);
            content: ''
        }

        .modal-inner .recipient_email {
            margin-bottom: 15px
        }

        @media only screen and (max-width: 860px) {
            #library {
                padding:0
            }

            #library .view-header {
                display: none
            }

            #library #book-list {
                width: 100%
            }

            #library #book-list .book-list-item {
                float: left;
                display: block;
                margin-right: 2.35765%;
                width: 100%
            }

            #library #book-list .book-list-item:last-child {
                margin-right: 0
            }

            #library #details-panel {
                display: none;
                z-index: 100;
                max-height: 85%;
                position: absolute;
                bottom: 0;
                left: 0;
                right: 0
            }

            #library #details-panel .close {
                display: block;
                padding: 5px 10px;
                position: absolute;
                left: 5px;
                top: -15px
            }

            #library #details-panel .hidden-info {
                position: relative
            }
        }

        #publisher,#editors-new {
            background-color: transparent
        }

        #publisher .container,#publisher #contact article,#contact #publisher article,#publisher #buzz article,#buzz #publisher article,#publisher #manifesto article,#manifesto #publisher article,#publisher #affiliates article,#affiliates #publisher article,#publisher #age-verification article,#age-verification #publisher article,#publisher #gift-purchase article,#gift-purchase #publisher article,#publisher #terms article,#terms #publisher article,#publisher #request_refund article,#request_refund #publisher article,#publisher #wishlist-container article,#wishlist-container #publisher article,#publisher #sign-up article,#sign-up #publisher article,#publisher #welcome article,#welcome #publisher article,#publisher #upsell article,#upsell #publisher article,#publisher .new-book article,.new-book #publisher article,#publisher .new-publisher-book article,.new-publisher-book #publisher article,#publisher #new-bundle article,#new-bundle #publisher article,#publisher,#editors-new .container,#editors-new #contact article,#contact #editors-new article,#editors-new #buzz article,#buzz #editors-new article,#editors-new #manifesto article,#manifesto #editors-new article,#editors-new #affiliates article,#affiliates #editors-new article,#editors-new #age-verification article,#age-verification #editors-new article,#editors-new #gift-purchase article,#gift-purchase #editors-new article,#editors-new #terms article,#terms #editors-new article,#editors-new #request_refund article,#request_refund #editors-new article,#editors-new #wishlist-container article,#wishlist-container #editors-new article,#editors-new #sign-up article,#sign-up #editors-new article,#editors-new #welcome article,#welcome #editors-new article,#editors-new #upsell article,#upsell #editors-new article,#editors-new .new-book article,.new-book #editors-new article,#editors-new .new-publisher-book article,.new-publisher-book #editors-new article,#editors-new #new-bundle article,#new-bundle #editors-new article,#editors-new {
            padding: 0
        }

        #publisher {
            margin-top: 3em
        }

        #editors-new .container,#editors-new #contact article,#contact #editors-new article,#editors-new #buzz article,#buzz #editors-new article,#editors-new #manifesto article,#manifesto #editors-new article,#editors-new #affiliates article,#affiliates #editors-new article,#editors-new #age-verification article,#age-verification #editors-new article,#editors-new #gift-purchase article,#gift-purchase #editors-new article,#editors-new #terms article,#terms #editors-new article,#editors-new #request_refund article,#request_refund #editors-new article,#editors-new #wishlist-container article,#wishlist-container #editors-new article,#editors-new #sign-up article,#sign-up #editors-new article,#editors-new #welcome article,#welcome #editors-new article,#editors-new #upsell article,#upsell #editors-new article,#editors-new .new-book article,.new-book #editors-new article,#editors-new .new-publisher-book article,.new-publisher-book #editors-new article,#editors-new #new-bundle article,#new-bundle #editors-new article {
            padding: 2em 0
        }

        #try-publisher {
            background-color: #323232;
            color: #fff
        }

        #try-publisher .container,#try-publisher #contact article,#contact #try-publisher article,#try-publisher #buzz article,#buzz #try-publisher article,#try-publisher #manifesto article,#manifesto #try-publisher article,#try-publisher #affiliates article,#affiliates #try-publisher article,#try-publisher #age-verification article,#age-verification #try-publisher article,#try-publisher #gift-purchase article,#gift-purchase #try-publisher article,#try-publisher #terms article,#terms #try-publisher article,#try-publisher #request_refund article,#request_refund #try-publisher article,#try-publisher #wishlist-container article,#wishlist-container #try-publisher article,#try-publisher #sign-up article,#sign-up #try-publisher article,#try-publisher #welcome article,#welcome #try-publisher article,#try-publisher #upsell article,#upsell #try-publisher article,#try-publisher .new-book article,.new-book #try-publisher article,#try-publisher .new-publisher-book article,.new-publisher-book #try-publisher article,#try-publisher #new-bundle article,#new-bundle #try-publisher article {
            padding: 2.35765%
        }

        #try-publisher .section-title {
            text-align: left
        }

        #publisher-plans .container,#publisher-plans #contact article,#contact #publisher-plans article,#publisher-plans #buzz article,#buzz #publisher-plans article,#publisher-plans #manifesto article,#manifesto #publisher-plans article,#publisher-plans #affiliates article,#affiliates #publisher-plans article,#publisher-plans #age-verification article,#age-verification #publisher-plans article,#publisher-plans #gift-purchase article,#gift-purchase #publisher-plans article,#publisher-plans #terms article,#terms #publisher-plans article,#publisher-plans #request_refund article,#request_refund #publisher-plans article,#publisher-plans #wishlist-container article,#wishlist-container #publisher-plans article,#publisher-plans #sign-up article,#sign-up #publisher-plans article,#publisher-plans #welcome article,#welcome #publisher-plans article,#publisher-plans #upsell article,#upsell #publisher-plans article,#publisher-plans .new-book article,.new-book #publisher-plans article,#publisher-plans .new-publisher-book article,.new-publisher-book #publisher-plans article,#publisher-plans #new-bundle article,#new-bundle #publisher-plans article {
            padding: 3em 0
        }

        @media screen and (min-width: 53.75em) {
            #publisher-plans .planned-features,#publisher-plans .current-features {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%
            }

            #publisher-plans .planned-features:last-child,#publisher-plans .current-features:last-child {
                margin-right: 0
            }
        }

        #publisher-plans .copy p:last-child,#publisher-plans .vertical-tabs-container .vertical-tab-content p:last-child,.vertical-tabs-container #publisher-plans .vertical-tab-content p:last-child {
            margin-top: 2em;
            text-align: center
        }

        #publisher-videos {
            padding: 3em 0;
            border-bottom: 1px solid #cbcbcb;
            border-top: 1px solid #cbcbcb
        }

        #how_it_works {
            padding: 2em 0
        }

        #how-to-markdown {
            padding: 3em 0;
            text-align: center
        }

        #how-to-markdown .section-title+p {
            margin-bottom: 3em
        }

        #how-to-markdown .video-title {
            color: #323232
        }

        #publishers-fine-print {
            padding: 2.5em 2.35765%;
            background-color: gray;
            border-top: 1px solid #666;
            text-align: center
        }

        #publishers-fine-print .section-title,#publishers-fine-print {
            color: #fff
        }

        .inline-book-list-item {
            display: block;
            margin-bottom: 1em
        }

        .inline-book-list-item .cover-image {
            margin-right: 1em;
            float: left
        }

        .inline-book-list-item .book-meta {
            padding-right: 1em
        }

        @media screen and (min-width: 53.75em) {
            .inline-book-list-item {
                float:left;
                display: block;
                margin-right: 0.4628%;
                width: 19.62976%;
                margin-bottom: 0
            }

            .inline-book-list-item:last-child {
                margin-right: 0
            }

            .inline-book-list-item:nth-child(5n) {
                margin-right: 0
            }

            .inline-book-list-item:nth-child(5n+1) {
                clear: left
            }
        }

        .social-sharing li {
            display: inline-block;
            width: 35px;
            color: white;
            text-align: center;
            margin-right: 3px;
            margin-bottom: 3px;
            border-radius: 4px
        }

        @media screen and (min-width: 53.75em) {
            .social-sharing li {
                width:45px;
                margin-right: 5px;
                margin-bottom: 5px
            }
        }

        .social-sharing li.facebook {
            background-color: #4c70ba
        }

        .social-sharing li.facebook:hover {
            background-color: #3b5998
        }

        .social-sharing li.twitter {
            background-color: #73b4ff
        }

        .social-sharing li.twitter:hover {
            background-color: #4099ff
        }

        .social-sharing li.google {
            background-color: #f0273d
        }

        .social-sharing li.google:hover {
            background-color: #d50f25
        }

        .social-sharing li:hover {
            cursor: pointer
        }

        .social-sharing li:last-child {
            margin-right: 0
        }

        .social-sharing i {
            padding: 5px;
            font-size: 20px
        }

        @media screen and (min-width: 53.75em) {
            .social-sharing i {
                padding:10px;
                font-size: 25px
            }
        }

        .react-modal .modal-inner {
            position: relative;
            overflow-x: hidden
        }

        .react-modal .modal-spinner {
            display: block;
            padding: 20% 50%
        }

        .react-modal i.fa-close {
            z-index: 1;
            position: absolute;
            right: 1em;
            font-size: 2em;
            cursor: pointer
        }

        .welcome-modal-wrapper {
            position: relative
        }

        .welcome-modal-wrapper .spinner {
            position: absolute;
            top: -1em;
            bottom: -1em;
            left: -1em;
            right: -1em;
            background-color: #eee;
            opacity: 0.3
        }

        .welcome-modal-wrapper .spinner .spinner {
            opacity: 1
        }

        .welcome-form .row-wrapper {
            display: block
        }

        .welcome-form .row-wrapper:after {
            content: "";
            display: table;
            clear: both
        }

        .welcome-form .username,.welcome-form .password,.welcome-form .password-confirmation {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            margin-bottom: 0
        }

        .welcome-form .username:last-child,.welcome-form .password:last-child,.welcome-form .password-confirmation:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 53.75em) {
            .welcome-form .username,.welcome-form .password,.welcome-form .password-confirmation {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%;
                margin-bottom: 0
            }

            .welcome-form .username:last-child,.welcome-form .password:last-child,.welcome-form .password-confirmation:last-child {
                margin-right: 0
            }
        }

        .welcome-form .username,.welcome-form .password-confirmation {
            margin-right: 0
        }

        .welcome-form .disclaimer {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            font-size: .8125em;
            color: #666;
            margin-bottom: 1em
        }

        .welcome-form .disclaimer:last-child {
            margin-right: 0
        }

        .welcome-form .not-now {
            float: right
        }

        .welcome-form .submit-wrapper {
            float: right;
            text-align: right;
            margin-left: 1em
        }

        .control-group .help-inline {
            color: #ff4100;
            float: left
        }

        .shopping-cart-progress-bar {
            margin-bottom: 2em
        }

        .shopping-cart-progress-bar ul {
            list-style: none;
            margin: 0.5em;
            padding: 0;
            overflow: hidden;
            white-space: nowrap
        }

        .shopping-cart-progress-bar ul li {
            display: inline-block;
            background-color: #eee;
            position: relative;
            text-align: center;
            width: calc(100% / 3);
            padding: 0.5em 0;
            font-size: 1em;
            line-height: 1
        }

        .shopping-cart-progress-bar ul li:hover {
            cursor: pointer
        }

        .shopping-cart-progress-bar ul li.disable-jump:hover {
            cursor: initial
        }

        .shopping-cart-progress-bar ul li:after {
            content: '';
            position: absolute;
            right: 100%;
            top: 2px;
            margin-right: 0.3em;
            width: 1.5em;
            padding-top: 1.5em;
            display: none;
            border: solid 5px white;
            z-index: 1;
            -webkit-transform: rotate(45deg);
            transform: rotate(45deg);
            border-bottom: 0;
            border-left: 0;
            box-shadow: 7px -7px 0 4px #eee
        }

        @media screen and (min-width: 40em) {
            .shopping-cart-progress-bar ul li:after {
                display:initial
            }
        }

        .shopping-cart-progress-bar ul li.active {
            background-color: #009aff;
            color: #fff
        }

        .shopping-cart-progress-bar ul li.active:after {
            box-shadow: 7px -7px 0 4px #009aff
        }

        .app-button {
            text-align: center;
            position: relative
        }

        .app-button img {
            height: 2.2em;
            vertical-align: middle
        }

        #thank-you {
            padding: 3.5em 2.35765%;
            background-color: #eee
        }

        #thank-you .shopping-cart-progress-bar {
            margin-bottom: 3em
        }

        #thank-you .shopping-cart-progress-bar li:not(.active) {
            background-color: #CFCFCF
        }

        #thank-you .shopping-cart-progress-bar li:not(.active):after {
            box-shadow: 7px -7px 0 4px #CFCFCF
        }

        #thank-you .section-title {
            padding: 0 2.35765%;
            font-size: 2em;
            color: #323232;
            text-align: center;
            margin-bottom: 0.5em
        }

        @media screen and (min-width: 53.75em) {
            #thank-you .section-title {
                font-size:2.75em
            }
        }

        #thank-you .section-subtitle {
            margin-bottom: 1em;
            font-size: 1.125em;
            color: #666;
            text-align: left
        }

        #thank-you a.default {
            font-size: .75em
        }

        #thank-you .follow-links {
            margin-top: 1em
        }

        #thank-you .thank-you-actions {
            max-width: 64em;
            margin-left: auto;
            margin-right: auto
        }

        #thank-you .thank-you-actions:after {
            content: "";
            display: table;
            clear: both
        }

        #thank-you .thank-you-actions .subtitle,#thank-you .thank-you-actions .buttons {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            text-align: center;
            margin-bottom: 1em
        }

        #thank-you .thank-you-actions .subtitle:last-child,#thank-you .thank-you-actions .buttons:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 40em) {
            #thank-you .thank-you-actions .subtitle {
                text-align:left
            }
        }

        #thank-you .thank-you-actions .buttons {
            margin-bottom: 2em
        }

        #thank-you .thank-you-actions .buttons a,#thank-you .thank-you-actions .buttons button,#thank-you .thank-you-actions .buttons form {
            vertical-align: bottom;
            display: inline-block;
            margin-bottom: 0.5em;
            margin-right: 0.5em
        }

        #thank-you .thank-you-actions .buttons .app-store {
            display: inline-block;
            vertical-align: bottom
        }

        #thank-you .thank-you-actions .buttons .upsell {
            display: none
        }

        @media only screen and (min-width: 1224px) {
            #thank-you .thank-you-actions .buttons .upsell {
                display:inline-block;
                position: relative;
                vertical-align: top
            }

            #thank-you .thank-you-actions .buttons .upsell .upsell-arrow {
                position: absolute;
                top: 30px;
                left: 0;
                font-size: 2em
            }

            #thank-you .thank-you-actions .buttons .upsell .upsell-bubble {
                font-size: 0.5em;
                margin-left: 5em;
                position: absolute;
                top: 30px;
                width: 200px;
                text-align: left
            }
        }

        .thank-you-purchases {
            background-color: #fff;
            border: 1px solid #cbcbcb;
            border-radius: 4px;
            margin-bottom: 1em
        }

        .thank-you-purchases .thank-you-purchase {
            padding: 2em 0;
            max-width: 64em;
            margin-left: auto;
            margin-right: auto
        }

        .thank-you-purchases .thank-you-purchase:after {
            content: "";
            display: table;
            clear: both
        }

        .thank-you-purchases .thank-you-purchase:last-child {
            border-bottom: none
        }

        .thank-you-purchases .btn {
            font-size: 0.75em
        }

        .thank-you-purchases .actions {
            text-align: center
        }

        @media screen and (min-width: 40em) {
            .thank-you-purchases .actions {
                text-align:right
            }
        }

        .thank-you-purchases hr {
            margin: 0 auto;
            width: 80%
        }

        .thank-you-book .book .preview,.thank-you-book .book .meta,.thank-you-book .book .actions,.thank-you-book .bundle .preview,.thank-you-book .bundle .meta,.thank-you-book .bundle .actions,.thank-you-bundle .book .preview,.thank-you-bundle .book .meta,.thank-you-bundle .book .actions,.thank-you-bundle .bundle .preview,.thank-you-bundle .bundle .meta,.thank-you-bundle .bundle .actions {
            padding: 1em
        }

        .thank-you-book .book .preview h6,.thank-you-book .book .meta h6,.thank-you-book .book .actions h6,.thank-you-book .bundle .preview h6,.thank-you-book .bundle .meta h6,.thank-you-book .bundle .actions h6,.thank-you-bundle .book .preview h6,.thank-you-bundle .book .meta h6,.thank-you-bundle .book .actions h6,.thank-you-bundle .bundle .preview h6,.thank-you-bundle .bundle .meta h6,.thank-you-bundle .bundle .actions h6 {
            font-size: 0.7em;
            margin-bottom: 1em
        }

        @media screen and (min-width: 40em) {
            .thank-you-book .book .preview h6,.thank-you-book .book .meta h6,.thank-you-book .book .actions h6,.thank-you-book .bundle .preview h6,.thank-you-book .bundle .meta h6,.thank-you-book .bundle .actions h6,.thank-you-bundle .book .preview h6,.thank-you-bundle .book .meta h6,.thank-you-bundle .book .actions h6,.thank-you-bundle .bundle .preview h6,.thank-you-bundle .bundle .meta h6,.thank-you-bundle .bundle .actions h6 {
                font-size:0.8em
            }
        }

        @media screen and (min-width: 53.75em) {
            .thank-you-book .book .preview h6,.thank-you-book .book .meta h6,.thank-you-book .book .actions h6,.thank-you-book .bundle .preview h6,.thank-you-book .bundle .meta h6,.thank-you-book .bundle .actions h6,.thank-you-bundle .book .preview h6,.thank-you-bundle .book .meta h6,.thank-you-bundle .book .actions h6,.thank-you-bundle .bundle .preview h6,.thank-you-bundle .bundle .meta h6,.thank-you-bundle .bundle .actions h6 {
                font-size:1em
            }
        }

        .thank-you-book .book .preview,.thank-you-book .bundle .preview,.thank-you-bundle .book .preview,.thank-you-bundle .bundle .preview {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            text-align: center
        }

        .thank-you-book .book .preview:last-child,.thank-you-book .bundle .preview:last-child,.thank-you-bundle .book .preview:last-child,.thank-you-bundle .bundle .preview:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 40em) {
            .thank-you-book .book .preview,.thank-you-book .bundle .preview,.thank-you-bundle .book .preview,.thank-you-bundle .bundle .preview {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 23.23176%
            }

            .thank-you-book .book .preview:last-child,.thank-you-book .bundle .preview:last-child,.thank-you-bundle .book .preview:last-child,.thank-you-bundle .bundle .preview:last-child {
                margin-right: 0
            }
        }

        .thank-you-book .book .preview img,.thank-you-book .bundle .preview img,.thank-you-bundle .book .preview img,.thank-you-bundle .bundle .preview img {
            max-height: 150px
        }

        .thank-you-book .book .meta,.thank-you-book .bundle .meta,.thank-you-bundle .book .meta,.thank-you-bundle .bundle .meta {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            margin-left: 0%;
            text-align: center
        }

        .thank-you-book .book .meta:last-child,.thank-you-book .bundle .meta:last-child,.thank-you-bundle .book .meta:last-child,.thank-you-bundle .bundle .meta:last-child {
            margin-right: 0
        }

        .thank-you-book .book .meta h6,.thank-you-book .bundle .meta h6,.thank-you-bundle .book .meta h6,.thank-you-bundle .bundle .meta h6 {
            margin-bottom: 1em
        }

        .thank-you-book .book .meta .title,.thank-you-book .bundle .meta .title,.thank-you-bundle .book .meta .title,.thank-you-bundle .bundle .meta .title {
            margin-bottom: 0.5em
        }

        @media screen and (min-width: 40em) {
            .thank-you-book .book .meta,.thank-you-book .bundle .meta,.thank-you-bundle .book .meta,.thank-you-bundle .bundle .meta {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 48.82117%;
                text-align: left
            }

            .thank-you-book .book .meta:last-child,.thank-you-book .bundle .meta:last-child,.thank-you-bundle .book .meta:last-child,.thank-you-bundle .bundle .meta:last-child {
                margin-right: 0
            }
        }

        .thank-you-book .book .actions,.thank-you-book .bundle .actions,.thank-you-bundle .book .actions,.thank-you-bundle .bundle .actions {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            margin-left: 0%;
            margin-right: 0
        }

        .thank-you-book .book .actions:last-child,.thank-you-book .bundle .actions:last-child,.thank-you-bundle .book .actions:last-child,.thank-you-bundle .bundle .actions:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 40em) {
            .thank-you-book .book .actions,.thank-you-book .bundle .actions,.thank-you-bundle .book .actions,.thank-you-bundle .bundle .actions {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 23.23176%
            }

            .thank-you-book .book .actions:last-child,.thank-you-book .bundle .actions:last-child,.thank-you-bundle .book .actions:last-child,.thank-you-bundle .bundle .actions:last-child {
                margin-right: 0
            }
        }

        .thank-you-book .book .book-list-item,.thank-you-book .bundle .book-list-item,.thank-you-bundle .book .book-list-item,.thank-you-bundle .bundle .book-list-item {
            margin-bottom: 0
        }

        .thank-you-book .special-message,.thank-you-bundle .special-message {
            padding: 1em 2em;
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            margin-right: 0
        }

        .thank-you-book .special-message:last-child,.thank-you-bundle .special-message:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 40em) {
            .thank-you-book .special-message,.thank-you-bundle .special-message {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 74.41059%;
                margin-left: 25.58941%
            }

            .thank-you-book .special-message:last-child,.thank-you-bundle .special-message:last-child {
                margin-right: 0
            }
        }

        .meta-info {
            font-size: 0.8em
        }

        @media screen and (min-width: 40em) {
            .meta-info {
                font-size:0.9em
            }
        }

        #download-links {
            float: none;
            text-transform: uppercase
        }

        #download-links .download-links-list li {
            text-align: center;
            padding-top: 1.25em
        }

        #download-links .download-links-list li .fa {
            font-size: 1.2em
        }

        #download-links .download-links-list li .generic,#download-links .download-links-list li p {
            font-size: 0.55em
        }

        #download-links .download-links-list li .generic {
            bottom: -4px
        }

        @media screen and (min-width: 53.75em) {
            #download-links .download-links-list li .fa {
                font-size:2em
            }

            #download-links .download-links-list li .generic,#download-links .download-links-list li p {
                font-size: 0.75em
            }

            #download-links .download-links-list li .generic {
                bottom: -1px
            }
        }

        @media screen and (min-width: 40em) {
            #download-links .download-links-list li {
                margin-right:2.35765%
            }

            #download-links .download-links-list li:last-child {
                margin-right: 0
            }
        }

        #download-links .send-to-kindle {
            position: absolute;
            right: 0px;
            bottom: -18px;
            left: 0px
        }

        #download-links .send-to-kindle p {
            margin-bottom: 0
        }

        @media screen and (min-width: 53.75em) {
            #download-links {
                float:none
            }
        }

        .package-zip {
            padding: .75em;
            margin-top: .25em;
            border: 1px solid #cbcbcb;
            border-radius: inherit;
            background-color: #fff;
            text-align: left
        }

        .package-zip .zip-format-icon {
            margin-right: 1em;
            float: left
        }

        .package-zip .zip-link {
            display: inline-block;
            text-transform: uppercase;
            text-decoration: underline;
            font-size: .75em
        }

        .package-zip .help-block,.package-zip #details-panel .refund,#details-panel .package-zip .refund {
            font-size: 0.55em;
            margin-bottom: 0
        }

        @media screen and (min-width: 40em) {
            .package-zip .help-block,.package-zip #details-panel .refund,#details-panel .package-zip .refund {
                font-size:0.85em
            }
        }

        #share-email {
            text-align: right
        }

        #share-email .share-option {
            display: block;
            margin-top: 2.5em;
            text-align: center
        }

        @media screen and (min-width: 40em) {
            #share-email .share-option {
                text-align:right
            }
        }

        #share-email .share-option p {
            font-size: 0.75em;
            margin-bottom: 1em
        }

        #share-email .share-option .btn {
            background-color: #009aff;
            border-bottom: 1px solid #006cb3;
            text-shadow: 0 1px 0 #006cb3;
            font-size: 0.75em
        }

        #share-email .share-option .btn:hover {
            background-color: #006cb3;
            border-bottom: 1px solid #005c99
        }

        #share-email .share-option .submit {
            font-size: 0.75em
        }

        @media screen and (min-width: 40em) {
            #share-email .share-option .submit {
                font-size:1em
            }
        }

        #share-email .share-option form {
            display: block
        }

        .user-deleted {
            text-align: center
        }

        #wishlist-container .book-title,#wishlist-container .bundle-title {
            font-size: 1em
        }

        #new-bundle section {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%;
            margin-left: 0%
        }

        #new-bundle section:last-child {
            margin-right: 0
        }

        .ui-slider {
            position: relative;
            text-align: left
        }

        .ui-slider .ui-slider-handle {
            position: absolute;
            z-index: 5;
            width: 1.2em;
            height: 1.2em;
            cursor: default
        }

        .ui-slider .ui-slider-range {
            position: absolute;
            z-index: 3;
            font-size: .7em;
            display: block;
            border: 0;
            background-position: 0 0
        }

        .scroll-bar-wrap .ui-handle-helper-parent {
            position: relative;
            width: 100%;
            height: 100%;
            margin: 0 auto
        }

        .ui-slider-horizontal {
            height: 100%
        }

        .ui-slider-horizontal .ui-slider-range {
            top: 0;
            height: 100%
        }

        .ui-slider-horizontal .ui-slider-range-min {
            left: 0
        }

        .ui-slider-horizontal .ui-slider-range-max {
            right: 0
        }

        .ui-slider-vertical {
            width: .8em;
            height: 100px
        }

        .ui-slider-vertical .ui-slider-handle {
            left: -.3em;
            margin-left: 0;
            margin-bottom: -.6em
        }

        .ui-slider-vertical .ui-slider-range {
            left: 0;
            width: 100%
        }

        .ui-slider-vertical .ui-slider-range-min {
            bottom: 0
        }

        .ui-slider-vertical .ui-slider-range-max {
            top: 0
        }

        .ui-slider-wrapper {
            -webkit-transition: border,0.2s,linear;
            -moz-transition: border,0.2s,linear;
            transition: border,0.2s,linear;
            height: 32px;
            background-color: #fff;
            padding: 0;
            border: 1px solid #cbcbcb;
            border-radius: 4px;
            margin-bottom: 1em
        }

        .ui-slider .ui-slider-handle {
            top: -11px;
            height: 54px;
            width: 10px;
            border: 1px solid #fff;
            border-radius: 5px;
            background-color: #666;
            box-shadow: 0 2px 10px 0 #666;
            cursor: pointer
        }

        .ui-slider .ui-slider-range {
            height: 30px;
            background-color: #999;
            border-top-left-radius: 2px;
            border-bottom-left-radius: 2px;
            margin: 0
        }

        #you_pay_slider.ui-slider .ui-slider-range,#you_pay_hero_slider.ui-slider .ui-slider-range,#you_pay_modal_slider.ui-slider .ui-slider-range,#you_pay_modal-edit_slider.ui-slider .ui-slider-range {
            background-color: #7ACAFF
        }

        #you_pay_slider.ui-slider .happy-price,#you_pay_hero_slider.ui-slider .happy-price,#you_pay_modal_slider.ui-slider .happy-price,#you_pay_modal-edit_slider.ui-slider .happy-price {
            background-color: #009aff
        }

        #you_pay_slider.ui-slider .ui-slider-handle,#you_pay_hero_slider.ui-slider .ui-slider-handle,#you_pay_modal_slider.ui-slider .ui-slider-handle,#you_pay_modal-edit_slider.ui-slider .ui-slider-handle {
            background-color: #009aff;
            box-shadow: 0 2px 10px 0 #009aff
        }

        #author_earns_slider.ui-slider .ui-slider-range,#author_earns_hero_slider.ui-slider .ui-slider-range,#author_earns_modal_slider.ui-slider .ui-slider-range,#author_earns_modal-edit_slider.ui-slider .ui-slider-range {
            background-color: #999
        }

        #author_earns_slider.ui-slider .happy-price,#author_earns_hero_slider.ui-slider .happy-price,#author_earns_modal_slider.ui-slider .happy-price,#author_earns_modal-edit_slider.ui-slider .happy-price {
            background-color: #666
        }

        .ui-slider .ui-slider-value input:focus {
            border-color: rgba(82,168,236,0.8);
            background-color: #fff
        }

        .ui-slider .ui-slider-value {
            position: absolute;
            z-index: 4;
            line-height: 32px;
            padding: 0;
            margin: 0 7px
        }

        .ui-slider .ui-slider-value,.ui-slider .ui-slider-value input {
            text-align: left;
            font-size: 1.125em;
            line-height: 30px;
            color: #fff
        }

        .ui-slider .ui-slider-value input {
            box-shadow: none;
            display: inline-block;
            height: 30px;
            background: transparent;
            width: 80px;
            padding: 0;
            border: 1px solid transparent;
            margin-bottom: 0;
            overflow: hidden
        }

        .ui-slider .ui-slider-value input:focus {
            padding: 0 5px;
            color: #323232
        }

        .ui-slider .ui-slider-value.inverse,.ui-slider .ui-slider-value.inverse input {
            color: #424242
        }

        .sliders-wrapper {
            width: 100%;
            margin-bottom: 2em;
            display: block
        }

        .sliders-wrapper label {
            margin-bottom: .625em;
            font-size: 1.125em;
            color: #666
        }

        .sliders-wrapper label i {
            margin-left: .25em
        }

        @media screen and (min-width: 53.75em) {
            .sliders-wrapper {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 100%;
                padding: 0 2.35765%;
                margin-bottom: 0
            }

            .sliders-wrapper:last-child {
                margin-right: 0
            }
        }

        .sliders-wrapper label {
            display: inline-block
        }

        .sliders-wrapper i {
            margin-left: 5px
        }

        .sliders-wrapper .submit {
            float: right
        }

        .sliders-wrapper .subtext {
            font-size: 0.75em;
            text-align: right;
            margin-top: 1em;
            margin-right: 0;
            padding-left: 1em
        }

        .gift-form-wrapper {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%
        }

        .gift-form-wrapper:last-child {
            margin-right: 0
        }

        .gift-form-wrapper input[type="checkbox"] {
            display: inline
        }

        .gift-form-wrapper .controls {
            margin-bottom: 0.25em
        }

        .gift-form-wrapper .control-group {
            margin-bottom: 0.25em
        }

        .gift-form-wrapper input {
            margin-bottom: 0
        }

        .gift-form-wrapper .is-gift {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%
        }

        .gift-form-wrapper .is-gift:last-child {
            margin-right: 0
        }

        .gift-form-wrapper .is-gift label {
            display: inline;
            padding-left: 0.3em
        }

        @media screen and (min-width: 53.75em) {
            .gift-form-wrapper .is-gift {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 14.70196%
            }

            .gift-form-wrapper .is-gift:last-child {
                margin-right: 0
            }
        }

        .gift-form-wrapper .giftee-email,.gift-form-wrapper .quantity {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%
        }

        .gift-form-wrapper .giftee-email:last-child,.gift-form-wrapper .quantity:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 53.75em) {
            .gift-form-wrapper .giftee-email,.gift-form-wrapper .quantity {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 40.29137%
            }

            .gift-form-wrapper .giftee-email:last-child,.gift-form-wrapper .quantity:last-child {
                margin-right: 0
            }
        }

        .gift-form-wrapper .quantity input {
            width: 4em;
            margin-bottom: 0
        }

        .gift-form-wrapper .gift-note {
            float: left;
            display: block;
            margin-right: 2.35765%;
            width: 100%
        }

        .gift-form-wrapper .gift-note:last-child {
            margin-right: 0
        }

        @media screen and (min-width: 53.75em) {
            .gift-form-wrapper .gift-note {
                float:left;
                display: block;
                margin-right: 2.35765%;
                width: 40.29137%
            }

            .gift-form-wrapper .gift-note:last-child {
                margin-right: 0
            }
        }
        body{
            max-width:800px;
        }
    </style>
</head>
<body>
<div class="read">

    <h1>
        Understanding ECMAScript 6
    </h1>
    <div id="leanpub-toc">
        <h2>Table of Contents</h2>
        <ol class="toc">
            <ul class="toc no-parts">
                <li>
                    <a href="#leanpub-auto-introduction">Introduction</a>
                    <ul>
                        <li>
                            <a href="#leanpub-auto-browser-and-nodejs-compatibility">Browser and Node.js Compatibility</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-who-this-book-is-for">Who This Book is For</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-overview">Overview</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-help-and-support">Help and Support</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#leanpub-auto-block-bindings">Block Bindings</a>
                    <ul>
                        <li>
                            <a href="#leanpub-auto-let-declarations">Let declarations</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-constant-declarations">Constant declarations</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-the-temporal-dead-zone">The Temporal Dead Zone</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-use-in-loops">Use in Loops</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-global-block-bindings">Global Block Bindings</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-emerging-best-practices">Emerging Best Practices</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-summary">Summary</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#leanpub-auto-destructuring">Destructuring</a>
                    <ul>
                        <li>
                            <a href="#leanpub-auto-object-destructuring">Object Destructuring</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-array-destructuring">Array Destructuring</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-mixed-destructuring">Mixed Destructuring</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-summary-1">Summary</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#leanpub-auto-strings-and-regular-expressions">Strings and Regular Expressions</a>
                    <ul>
                        <li>
                            <a href="#leanpub-auto-better-unicode-support">Better Unicode Support</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-other-string-changes">Other String Changes</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-other-regular-expression-changes">Other Regular Expression Changes</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-template-strings">Template Strings</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-summary-2">Summary</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#leanpub-auto-functions">Functions</a>
                    <ul>
                        <li>
                            <a href="#leanpub-auto-default-parameters">Default Parameters</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-rest-parameters">Rest Parameters</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-destructured-parameters">Destructured Parameters</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-the-spread-operator">The Spread Operator</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-the-name-property">The name Property</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-newtarget-call-and-construct">new.target, [[Call]], and [[Construct]]</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-block-level-functions">Block-Level Functions</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-arrow-functions">Arrow Functions</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-syntax">Syntax</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-summary-3">Summary</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#leanpub-auto-objects">Objects</a>
                    <ul>
                        <li>
                            <a href="#leanpub-auto-object-categories">Object Categories</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-object-literal-extensions">Object Literal Extensions</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-objectis">Object.is()</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-objectassign">Object.assign()</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-duplicate-object-literal-properties">Duplicate Object Literal Properties</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-changing-prototypes">Changing Prototypes</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-super-references">Super References</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-summary-4">Summary</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#leanpub-auto-symbols">Symbols</a>
                    <ul>
                        <li>
                            <a href="#leanpub-auto-creating-symbols">Creating Symbols</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-identifying-symbols">Identifying Symbols</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-using-symbols">Using Symbols</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-sharing-symbols">Sharing Symbols</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-finding-object-symbols">Finding Object Symbols</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-coercing-symbols-to-strings">Coercing Symbols to Strings</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-well-known-symbols">Well-Known Symbols</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-summary-5">Summary</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#leanpub-auto-iterators-and-generators">Iterators and Generators</a>
                    <ul>
                        <li>
                            <a href="#leanpub-auto-what-are-iterators">What are Iterators?</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-generators">Generators</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-iterables-and-for-of">Iterables and for-of</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-built-in-iterators">Built-in Iterators</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-advanced-functionality">Advanced Functionality</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-summary-6">Summary</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#leanpub-auto-classes">Classes</a>
                    <ul>
                        <li>
                            <a href="#leanpub-auto-class-like-structures-in-ecmascript-5">Class-Like Structures in ECMAScript 5</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-class-declarations">Class Declarations</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-class-expressions">Class Expressions</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-accessor-properties">Accessor Properties</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-static-members">Static Members</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-derived-classes">Derived Classes</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-newtarget">new.target</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-summary-7">Summary</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#leanpub-auto-promises">Promises</a>
                    <ul>
                        <li>
                            <a href="#leanpub-auto-asynchronous-programming-background">Asynchronous Programming Background</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-promise-basics">Promise Basics</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-chaining-promises">Chaining Promises</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-returning-promise-in-promise-chains">Returning Promise in Promise Chains</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-responding-to-multiple-promises">Responding to Multiple Promises</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-inheriting-from-promises">Inheriting from Promises</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-summary-8">Summary</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#leanpub-auto-modules">Modules</a>
                    <ul>
                        <li>
                            <a href="#leanpub-auto-what-are-modules">What are Modules?</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-basic-exporting-and-importing">Basic Exporting and Importing</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-renaming-exports-and-imports">Renaming Exports and Imports</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-exporting-and-importing-defaults">Exporting and Importing Defaults</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-re-exporting">Re-exporting</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-importing-without-bindings">Importing Without Bindings</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-summary-9">Summary</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#leanpub-auto-appendix-a-other-changes">Appendix A: Other Changes</a>
                    <ul>
                        <li>
                            <a href="#leanpub-auto-working-with-integers">Working with Integers</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-new-math-methods">New Math Methods</a>
                        </li>
                        <li>
                            <a href="#leanpub-auto-unicode-identifiers">Unicode Identifiers</a>
                        </li>
                    </ul>
                </li>
            </ul>

        </ol>
    </div>
    <div id="leanpub-main">
        <h2 id="leanpub-auto-introduction">Introduction</h2>

        <p>The JavaScript core language features are defined in a standard called ECMA-262. The language defined in this standard is called ECMAScript, of which the JavaScript in the browser and Node.js environments are a superset. While browsers and Node.js may add more capabilities through additional objects and methods, the core of the language remains as defined in ECMAScript, which is why the ongoing development of ECMA-262 is vital to the success of JavaScript as a whole.</p>

        <p>In 2007, JavaScript was at a crossroads. The popularity of Ajax was ushering in a new age of dynamic web applications while JavaScript hadn’t changed since the third edition of ECMA-262 was published in 1999. TC-39, the committee responsible for driving the ECMAScript process, put together a large draft specification for ECMAScript 4. ECMAScript 4 was massive in scope, introducing changes both small and large to the language. Language features included new syntax, modules, classes, classical inheritance, private object members, optional type annotations, and more.</p>

        <p>The scope of the ECMAScript 4 changes caused a rift to form in TC-39, with some members feeling that the fourth edition was trying to accomplish too much. A group of leaders from Yahoo, Google, and Microsoft came up with an alternate proposal for the next version of ECMAScript that they initially called ECMAScript 3.1. The “3.1” was intended to show that this was an incremental change to the existing standard.</p>

        <p>ECMAScript 3.1 introduced very few syntax changes, instead focusing on property attributes, native JSON support, and adding methods to already-existing objects. Although there was an early attempt to reconcile ECMAScript 3.1 and ECMAScript 4, this ultimately failed as the two camps had difficulty with the very different perspectives on how the language should grow.</p>

        <p>In 2008, Brendan Eich, the creator of JavaScript, announced that TC-39 would focus its efforts on standardizing ECMAScript 3.1. They would table the major syntax and feature changes of ECMAScript 4 until after the next version of ECMAScript was standardized, and all members of the committee would work to bring the best pieces of ECMAScript 3.1 and 4 together after that point into an effort initially nicknamed ECMAScript Harmony.</p>

        <p>ECMAScript 3.1 was eventually standardized as the fifth edition of ECMA-262, also described as ECMAScript 5. The committee never released an ECMAScript 4 standard to avoid confusion with the now-defunct effort of the same name. Work then began on ECMAScript Harmony, with ECMAScript 6 being the first standard released in this new “harmonious” spirit.</p>

        <p>ECMAScript 6 reached feature complete status in 2015 was formally dubbed “ECMAScript 2015” (though this text still refers to it as ECMAScript 6, the name most familiar to developers). The features vary widely from completely new objects and patterns to syntax changes to new methods on existing objects. The exciting thing about ECMAScript 6 is that all of these changes are geared towards problems that developers are actually facing. And while it will still take time for adoption and implementation to reach the point where ECMAScript 6 is the minimum that developers can expect, there’s a lot to be gained from a good understanding of what the future of JavaScript looks like.</p>

        <h3 id="leanpub-auto-browser-and-nodejs-compatibility">Browser and Node.js Compatibility</h3>

        <p>Many JavaScript environments, such as web browsers and Node.js, are actively working on implementing ECMAScript 6. This book does not attempt to address the inconsistencies between implementations and instead focuses on what the specification defines as the correct behavior. As such, it’s possible that your JavaScript environment may not conform to the behavior described in this book.</p>

        <h3 id="leanpub-auto-who-this-book-is-for">Who This Book is For</h3>

        <p>This book is intended as a guide for those who are already familiar with JavaScript and ECMAScript 5. While a deep understanding of the language isn’t necessary to use this book, it is helpful in understanding the differences between ECMAScript 5 and 6. In particular, this book is aimed at intermediate-to-advanced JavaScript developers (both browser and Node.js environments) who want to learn about the future of the language.</p>

        <p>This book is not for beginners who have never written JavaScript. You will need to have a good basic understanding of the language to make use of this book.</p>

        <h3 id="leanpub-auto-overview">Overview</h3>

        <p><strong>Chapter 1: Block Bindings</strong> talks about <code>let</code> and <code>const</code>, the block-level replacement for <code>var</code>.</p>

        <p><strong>Chapter 2: Destructuring</strong> introduces object and array destructuring, which allow you to decompose objects and arrays using a concise syntax.</p>

        <p><strong>Chapter 3: Strings and Regular Expressions</strong> covers the additions to string manipulation and inspection as well as the introduction of template strings.</p>

        <p><strong>Chapter 4: Functions</strong> discusses the various changes to functions. This includes the arrow function form, default parameters, rest parameters, and more.</p>

        <p><strong>Chapter 5: Objects</strong> explains the changes to how objects are created, modified, and used. Topics include changes to object literal syntax, and new reflection methods.</p>

        <p><strong>Chapter 6: Symbols</strong> introduces the concept of symbols, a new way to define properties. Symbols are a new primitive type that can be used to obscure (but not hide) object properties and methods.</p>

        <p><strong>Chapter 7: Iterators and Generators</strong> discusses the addition of iterators and generators to the language. These features allow you to work with collections of data in powerful ways that were not possible in previous versions of JavaScript.</p>

        <p><strong>Chapter 8: Classes</strong> introduces the first formal concept of classes in JavaScript. Often a point of confusion for those coming from other languages, the addition of class syntax in JavaScript makes the language more approachable to others and more concise for enthusiasts.</p>

        <p><strong>Chapter 9: Arrays</strong> details the changes to native arrays and the interesting new ways they can be used in JavaScript.</p>

        <p><strong>Chapter 10: Collections</strong> details the new collection types of <code>Set</code>, <code>WeakSet</code>, <code>Map</code>, and <code>WeakMap</code>. These types expand on the usefulness of arrays by adding semantics, de-duping, and memory management designed specifically for JavaScript.</p>

        <p><strong>Chapter 11: Promises</strong> introduces promises as a new part of the language. Promises were a grassroots effort that eventually took off and gained in popularity due to extensive library support. ECMAScript 6 formalizes promises and makes them available by default.</p>

        <p><strong>Chapter 12: Reflection</strong> introduces the formalized reflection API for JavaScript. Similar to other languages, ECMAScript 6 reflection allows you to inspect objects at a granular level, even if you didn’t create the object.</p>

        <p><strong>Chapter 13: Proxies</strong> discusses the new proxy object that allows you to intercept every operation performed on an object. Proxies give developers unprecedented control over objects and, as such, unlimited possibilities for defining new interaction patterns.</p>

        <p><strong>Chapter 14: Modules</strong> details the official module format for JavaScript. The intent is that these modules can replace the numerous ad-hoc module definition formats that have appeared over the years.</p>

        <h3 id="leanpub-auto-help-and-support">Help and Support</h3>

        <p>You can file issues, suggest changes, and open pull requests against this book by visiting: <a href="https://github.com/nzakas/understandinges6">https://github.com/nzakas/understandinges6</a></p>

        <p>For anything else, please send a message to the mailing list: <a href="http://groups.google.com/group/zakasbooks">http://groups.google.com/group/zakasbooks</a>.</p>

        <h2 id="leanpub-auto-block-bindings">Block Bindings</h2>

        <p>Traditionally, one of the tricky parts of JavaScript has been the way that <code>var</code> declarations work. In most C-based languages, variables (or <em>bindings</em>) are created at the spot where the declaration occurs. In JavaScript, however, this is not the case. Variables declared using <code>var</code> are <em>hoisted</em> to the top of the function (or global scope, if declared outside of a function) regardless of where the actual declaration occurs. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">getValue</code><code class="p">(</code><code class="nx">condition</code><code class="p">)</code> <code class="p">{</code>

    <code class="k">if</code> <code class="p">(</code><code class="nx">condition</code><code class="p">)</code> <code class="p">{</code>
        <code class="kd">var</code> <code class="nx">value</code> <code class="o">=</code> <code class="s2">"blue"</code><code class="p">;</code>

        <code class="c1">// other code</code>

        <code class="k">return</code> <code class="nx">value</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>

        <code class="c1">// value exists here with a value of undefined</code>

        <code class="k">return</code> <code class="kc">null</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="c1">// value exists here with a value of undefined</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>If you are unfamiliar with JavaScript, you might expect that the variable <code>value</code> is only defined if <code>condition</code> evaluates to true. In fact, the variable <code>value</code> is declared regardless. The JavaScript engine changes the function to look like this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">getValue</code><code class="p">(</code><code class="nx">condition</code><code class="p">)</code> <code class="p">{</code>

    <code class="kd">var</code> <code class="nx">value</code><code class="p">;</code>

    <code class="k">if</code> <code class="p">(</code><code class="nx">condition</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">value</code> <code class="o">=</code> <code class="s2">"blue"</code><code class="p">;</code>

        <code class="c1">// other code</code>

        <code class="k">return</code> <code class="nx">value</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>

        <code class="k">return</code> <code class="kc">null</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>The declaration of <code>value</code> is moved to the top (hoisted) while the initialization remains in the same spot. That means the variable <code>value</code> is actually still accessible from within the <code>else</code> clause, it just has a value of <code>undefined</code> because it hasn’t been initialized.</p>

        <p>It often takes new JavaScript developers some time to get used to declaration hoisting and this unique behavior can end up causing bugs. For this reason, ECMAScript 6 introduces block level scoping options to make the control of variable lifecycle a little more powerful.</p>

        <h3 id="leanpub-auto-let-declarations">Let declarations</h3>

        <p>The <code>let</code> declaration syntax is the same as for <code>var</code>. You can basically replace <code>var</code> with <code>let</code> to declare a variable but keep its scope to the current code block. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">getValue</code><code class="p">(</code><code class="nx">condition</code><code class="p">)</code> <code class="p">{</code>

    <code class="k">if</code> <code class="p">(</code><code class="nx">condition</code><code class="p">)</code> <code class="p">{</code>
        <code class="kd">let</code> <code class="nx">value</code> <code class="o">=</code> <code class="s2">"blue"</code><code class="p">;</code>

        <code class="c1">// other code</code>

        <code class="k">return</code> <code class="nx">value</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>

        <code class="c1">// value doesn't exist here</code>

        <code class="k">return</code> <code class="kc">null</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="c1">// value doesn't exist here</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This function now behaves much closer to other C-based languages. The variable <code>value</code> is declared using <code>let</code> instead of <code>var</code>. That means the declaration is not hoisted to the top, and the variable <code>value</code> is destroyed once execution has flowed out of the <code>if</code> block. If <code>condition</code> evaluates to false, then <code>value</code> is never declared or initialized.</p>

        <aside class="information blurb">
            <p>Since <code>let</code> declarations are <em>not</em> hoisted to the top of the enclosing block, you may want to always place <code>let</code> declarations first in the block so that they are available to the entire block.</p>

        </aside>

        <p>Perhaps one of the areas where developers most want block level scoping of variables is with <code>for</code> loops. It’s not uncommon to see code such as this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="k">for</code> <code class="p">(</code><code class="kd">var</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="mi">10</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">process</code><code class="p">(</code><code class="nx">items</code><code class="p">[</code><code class="nx">i</code><code class="p">]);</code>
<code class="p">}</code>

<code class="c1">// i is still accessible here</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">i</code><code class="p">);</code>                     <code class="c1">// 10</code>
</pre></div>

        </figure>

        <p>In other languages, where block level scoping is the default, code like this works as intended. In JavaScript, the variable <code>i</code> is still accessible after the loop is completed because the <code>var</code> declaration was hoisted. Using <code>let</code> allows you to get the intended behavior:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="mi">10</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">process</code><code class="p">(</code><code class="nx">items</code><code class="p">[</code><code class="nx">i</code><code class="p">]);</code>
<code class="p">}</code>

<code class="c1">// i is not accessible here - throws an error</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">i</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>In this example, the variable <code>i</code> only exists within the <code>for</code> loop. Once the loop is complete, the variable is destroyed and is no longer accessible elsewhere.</p>

        <h3 id="leanpub-auto-constant-declarations">Constant declarations</h3>

        <p>Another new way to define variables is to use the <code>const</code> declaration syntax. Variables declared using <code>const</code> are considered to be <em>constants</em>, so the value cannot be changed once set. For this reason, every <code>const</code> variable must be initialized. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// Valid constant</code>
<code class="kr">const</code> <code class="nx">maxItems</code> <code class="o">=</code> <code class="mi">30</code><code class="p">;</code>

<code class="c1">// Syntax error: missing initialization</code>
<code class="kr">const</code> <code class="nx">name</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>Constants, like <code>let</code> declarations, are block-level declarations. That means constants are destroyed once execution flows out of the block in which they were declared, and declarations are not hoisted to the top of the block. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="k">if</code> <code class="p">(</code><code class="nx">condition</code><code class="p">)</code> <code class="p">{</code>
    <code class="kr">const</code> <code class="nx">maxItems</code> <code class="o">=</code> <code class="mi">5</code><code class="p">;</code>

    <code class="c1">// more code</code>
<code class="p">}</code>

<code class="c1">// maxItems isn't accessible here</code>
</pre></div>

        </figure>

        <p>In this code, the constant <code>maxItems</code> is declared within an <code>if</code> statement. Once the statement finishes executing, <code>maxItems</code> is destroyed and is not accessible outside of that block.</p>

        <p>Also similar to <code>let</code>, an error is thrown whenever a <code>const</code> declaration is made with an identifier for an already-defined variable in the same scope. It doesn’t matter if that variable was declared using <code>var</code> (for global or function scope) or <code>let</code> (for block scope). For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">message</code> <code class="o">=</code> <code class="s2">"Hello!"</code><code class="p">;</code>
<code class="kd">let</code> <code class="nx">age</code> <code class="o">=</code> <code class="mi">25</code><code class="p">;</code>

<code class="c1">// Each of these would throw an error given the previous declarations</code>
<code class="kr">const</code> <code class="nx">message</code> <code class="o">=</code> <code class="s2">"Goodbye!"</code><code class="p">;</code>
<code class="kr">const</code> <code class="nx">age</code> <code class="o">=</code> <code class="mi">30</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>The big difference between <code>let</code> and <code>const</code> is that attempting to assign to a previously defined constant will throw an error in both strict and non-strict modes:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">const</code> <code class="nx">maxItems</code> <code class="o">=</code> <code class="mi">5</code><code class="p">;</code>

<code class="nx">maxItems</code> <code class="o">=</code> <code class="mi">6</code><code class="p">;</code>      <code class="c1">// throws error</code>
</pre></div>

        </figure>

        <p>Keep in mind that <code>const</code> prevents modification of the binding and not of the value itself. That means <code>const</code> declarations for objects do not prevent modification of those objects. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">const</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Nicholas"</code><code class="p">;</code>
<code class="p">};</code>

<code class="c1">// works</code>
<code class="nx">person</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="s2">"Greg"</code><code class="p">;</code>

<code class="c1">// throws an error</code>
<code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Greg"</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>Here, the binding <code>person</code> is created with an initial value of an object with one property. It’s possible to change <code>person.name</code> without causing an error because you are changing what <code>person</code> contains and not changing the value that <code>person</code> is bound to. If you then attempt to assign a value to <code>person</code> (attempting to change the binding), an error is thrown. This subtlety in how <code>const</code> works with objects is easy to misunderstand. Remember, <code>const</code> prevents modification of the binding, not modification of the bound value.</p>

        <aside class="warning blurb">
            <p>Several browsers implement pre-ECMAScript 6 versions of <code>const</code>. Implementations range from being simply a synonym for <code>var</code> (allowing the value to be overwritten) to actually defining constants but only in the global or function scope. For this reason, be especially careful with using <code>const</code> in a production system. It may not be providing you with the functionality you expect.</p>

        </aside>

        <h3 id="leanpub-auto-the-temporal-dead-zone">The Temporal Dead Zone</h3>

        <p>Unlike <code>var</code>, <code>let</code> and <code>const</code> has no hoisting characteristics. A variable declared with either cannot be accessed until after the declaration. Attempting to do so results in a reference error:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="k">if</code> <code class="p">(</code><code class="nx">condition</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// ReferenceError!</code>
    <code class="kd">let</code> <code class="nx">value</code> <code class="o">=</code> <code class="s2">"blue"</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>In this code, the variable <code>value</code> is defined and initialized using <code>let</code>, but that statement is never executed because the previous line throws an error. The issue is that <code>value</code> exists in what has become known as the <em>temporal dead zone</em> (TDZ). The TDZ is never named explicitly in the specification, but is a term often used to describe the non-hoisting behavior of <code>let</code>.</p>

        <p>When a JavaScript engine looks through the upcoming block to find variable declarations, it results in either hoisting the declaration (for <code>var</code>) or placing the declaration in the TDZ (for <code>let</code> and <code>const</code>, discussed later). Any attempt to access a variable in the TDZ results in a runtime error. Only once execution flows to the variable declaration is that variable removed from the TDZ and therefore safe to use.</p>

        <p>The same is true anytime you attempt to use a variable declared with <code>let</code> inside of the same block prior to it being defined. Even the normally safe <code>typeof</code> operator isn’t safe:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="k">if</code> <code class="p">(</code><code class="nx">condition</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">value</code><code class="p">);</code>     <code class="c1">// ReferenceError!</code>
    <code class="kd">let</code> <code class="nx">value</code> <code class="o">=</code> <code class="s2">"blue"</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>Here, <code>typeof value</code> throws the same error as the previous example. You cannot use a <code>let</code> variable before its declaration within the same block. However, you can use <code>typeof</code> outside of the block:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">value</code><code class="p">);</code>     <code class="c1">// "undefined"</code>

<code class="k">if</code> <code class="p">(</code><code class="nx">condition</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">value</code> <code class="o">=</code> <code class="s2">"blue"</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>The variable <code>value</code> isn’t in the TDZ when the <code>typeof</code> operation executes because it occurs outside of the block in which <code>value</code> is declared. That means there is no <code>value</code> binding and <code>typeof</code> simply returns <code>"undefined"</code>.</p>

        <p>If an identifier has already been defined in the block, then using the identifier in a <code>let</code> declaration causes an error to be thrown. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">count</code> <code class="o">=</code> <code class="mi">30</code><code class="p">;</code>

<code class="c1">// Syntax error</code>
<code class="kd">let</code> <code class="nx">count</code> <code class="o">=</code> <code class="mi">40</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>In this example, <code>count</code> is declared twice, once with <code>var</code> and once with <code>let</code>. Because <code>let</code> will not redefine an identifier that already exists in the same scope, the declaration throws an error. No error is thrown if a <code>let</code> declaration creates a new variable in a scope with the same name as a variable in the containing scope, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">count</code> <code class="o">=</code> <code class="mi">30</code><code class="p">;</code>

<code class="c1">// Does not throw an error</code>
<code class="k">if</code> <code class="p">(</code><code class="nx">condition</code><code class="p">)</code> <code class="p">{</code>

    <code class="kd">let</code> <code class="nx">count</code> <code class="o">=</code> <code class="mi">40</code><code class="p">;</code>

    <code class="c1">// more code</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>Here, the <code>let</code> declaration will not throw an error because it is creating a new variable called <code>count</code> within the <code>if</code> statement. This new variable shadows the global <code>count</code>, preventing access to it from within the <code>if</code> block.</p>

        <aside class="information blurb">
            <p>Although the examples in this section use <code>let</code>, the same is true for <code>const</code>.</p>

        </aside>

        <h3 id="leanpub-auto-use-in-loops">Use in Loops</h3>

        <p>The characteristics of <code>var</code> have long made using variables inside of loops problematic. Consider the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">funcs</code> <code class="o">=</code> <code class="p">[];</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">var</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="mi">10</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">funcs</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="kd">function</code><code class="p">()</code> <code class="p">{</code> <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">i</code><code class="p">);</code> <code class="p">});</code>
<code class="p">}</code>

<code class="nx">funcs</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">func</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">func</code><code class="p">();</code>     <code class="c1">// outputs the number "10" ten times</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>This code will output the number <code>10</code> ten times in a row. That’s because the variable <code>i</code> is shared across each iteration of the loop, meaning the functions created inside the loop all hold a reference to the same variable. The variable <code>i</code> has a value of <code>10</code> once the loop completes, and so that’s the value each function outputs.</p>

        <p>To fix this problem, developers use immediately-invoked function expressions (IIFEs) inside of loops to force a new copy of the variable to be created:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">funcs</code> <code class="o">=</code> <code class="p">[];</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">var</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="mi">10</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">funcs</code><code class="p">.</code><code class="nx">push</code><code class="p">((</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
            <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
        <code class="p">}</code>
    <code class="p">}(</code><code class="nx">i</code><code class="p">)));</code>
<code class="p">}</code>

<code class="nx">funcs</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">func</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">func</code><code class="p">();</code>     <code class="c1">// outputs 0, then 1, then 2, up to 9</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>This version of the example uses an IIFE inside of the loop. The <code>i</code> variable is passed to the IIFE, which creates its own copy and stores it as <code>value</code>. This is the value used of the function for that iteration, so calling each function returns the expected value.</p>

        <h4 id="leanpub-auto-let-declarations-in-loops">Let Declarations in Loops</h4>

        <p>A <code>let</code> declaration simplifies loops by effectively mimicking what the IIFE does in the previous example. Each iteration through the loop results in a new variable being created and initialized to the value of the variable with the same name from the previous iteration. That means you can omit the IIFE altogether and get the results you expect:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">funcs</code> <code class="o">=</code> <code class="p">[];</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="mi">10</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">funcs</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">i</code><code class="p">);</code>
    <code class="p">});</code>
<code class="p">}</code>

<code class="nx">funcs</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">func</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">func</code><code class="p">();</code>     <code class="c1">// outputs 0, then 1, then 2, up to 9</code>
<code class="p">})</code>
</pre></div>

        </figure>

        <p>This code works exactly like the code that used <code>var</code> and an IIFE but is, arguably, cleaner. The <code>let</code> declaration creates a new variable <code>i</code> each time through the loop, so each function created inside the loop gets its own copy of <code>i</code>. Each copy of <code>i</code> has the value it was assigned at the beginning of the loop iteration in which it was created. The same is true for <code>for-in</code> and <code>for-of</code> (discussed in Chapter 7) loops:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">funcs</code> <code class="o">=</code> <code class="p">[],</code>
    <code class="nx">object</code> <code class="o">=</code> <code class="p">{</code>
        <code class="nx">a</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">b</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">c</code><code class="o">:</code> <code class="kc">true</code>
    <code class="p">};</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">key</code> <code class="k">in</code> <code class="nx">object</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">funcs</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">key</code><code class="p">);</code>
    <code class="p">});</code>
<code class="p">}</code>

<code class="nx">funcs</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">func</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">func</code><code class="p">();</code>     <code class="c1">// outputs "a", then "b", then "c"</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this example, <code>for-in</code> loop shows the same behavior as the <code>for</code> loop. Each time through the loop, a new <code>key</code> binding is created and so each function has its own copy. The result is that each function outputs a different value (if <code>var</code> was used, they would all output <code>"c"</code>).</p>

        <aside class="information blurb">
            <p>It’s important to understand that the behavior of <code>let</code> declarations in loops is a specially-defined behavior in the specification and is not necessarily related to the non-hoisting characteristics of <code>let</code>. In fact, early implementions of <code>let</code> did not have this behavior as it was added later on in the process.</p>

        </aside>

        <h4 id="leanpub-auto-constant-declarations-in-loops">Constant Declarations in Loops</h4>

        <p>The specification doesn’t explicitly disallow <code>const</code> declarations in loops, however, there are different behaviors based on the type of loop you’re using. For a normal <code>for</code> loop, you can use <code>const</code> in the initializer, but the loop will throw a warning if you attempt to change the value. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">funcs</code> <code class="o">=</code> <code class="p">[];</code>

<code class="c1">// throws an error after one iteration</code>
<code class="k">for</code> <code class="p">(</code><code class="kr">const</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="mi">10</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">funcs</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">i</code><code class="p">);</code>
    <code class="p">});</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>In this code, the <code>i</code> variable is declared as a constant. The first iteration of the loop, where <code>i</code> is 0, executes successfully. An error is thrown when <code>i++</code> executes because it’s attempting to modify a constant. As such, you can only use <code>const</code> in the loop initializer if you are not modifying it.</p>

        <p>When used in a <code>for-in</code> or <code>for-of</code> loop, <code>const</code> behaves the same as <code>let</code>. So the following will not cause an error:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">funcs</code> <code class="o">=</code> <code class="p">[],</code>
    <code class="nx">object</code> <code class="o">=</code> <code class="p">{</code>
        <code class="nx">a</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">b</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">c</code><code class="o">:</code> <code class="kc">true</code>
    <code class="p">};</code>

<code class="c1">// doesn't cause an error</code>
<code class="k">for</code> <code class="p">(</code><code class="kr">const</code> <code class="nx">key</code> <code class="k">in</code> <code class="nx">object</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">funcs</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">key</code><code class="p">);</code>
    <code class="p">});</code>
<code class="p">}</code>

<code class="nx">funcs</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">func</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">func</code><code class="p">();</code>     <code class="c1">// outputs "a", then "b", then "c"</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>This code functions almost exactly the same as when using <code>let</code>. The only difference is that the value of <code>key</code> cannot be changed inside of the loop. The <code>for-in</code> and <code>for-of</code> loops work with <code>const</code> because the initializer creates a new binding each time through the loop rather than attempting to modify the value of an existing binding (as was the case with the <code>for</code> loop example).</p>

        <h3 id="leanpub-auto-global-block-bindings">Global Block Bindings</h3>

        <p>There is the potential for naming collisions when using <code>let</code> or <code>const</code> in the global scope because the global object has predefined properties. In many JavaScript environments, global variables are assigned as properties on the global object, and global object properties are accessed transparently as non-qualified identifiers (such as <code>name</code> or <code>location</code>). Using a block binding declaration to define a variable that shares a name with a property of the global object can produce an error because global object properties may be nonconfigurable. Since block bindings disallow redefinition of an identifier in the same scope, it’s not possible to shadow nonconfigurable global properties. Attempting to do so will result in an error. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nb">RegExp</code> <code class="o">=</code> <code class="s2">"Hello!"</code><code class="p">;</code>          <code class="c1">// ok</code>
<code class="kd">let</code> <code class="kc">undefined</code> <code class="o">=</code> <code class="s2">"Hello!"</code><code class="p">;</code>       <code class="c1">// throws error</code>
</pre></div>

        </figure>

        <p>The first line of this example redefines the global <code>RegExp</code> as a string. Even though this would be problematic, there is no error thrown. The second line throws an error because <code>undefined</code> is a nonconfigurable own property of the global object. Since its definition is locked down by the environment, the <code>let</code> declaration is illegal.</p>

        <p>It’s unusual to use <code>let</code> or <code>const</code> in the global scope, but if you do, it’s important to understand this situation.</p>

        <h3 id="leanpub-auto-emerging-best-practices">Emerging Best Practices</h3>

        <p>While ECMAScript 6 was in development, there was widespread belief you should use <code>let</code> by default instead of <code>var</code> for variable declarations. For many, <code>let</code> behaves exactly the way they thought <code>var</code> should have behaved, and so the direct replacement makes logical sense. You would then use <code>const</code> for variables that needed modification protection.</p>

        <p>However, as more developers migrated to ECMAScript 6, an alternate approach gained popularity: use <code>const</code> by default and only use <code>let</code> when you know a variable’s value needs to change. The rationale is that most variables should not change their value after initialization because unexpected value changes are a source of bugs. This idea has gained a significant amount of traction and is worth exploring in your code as you adopt ECMAScript 6.</p>

        <h3 id="leanpub-auto-summary">Summary</h3>

        <p>The <code>let</code> and <code>const</code> block bindings introduce lexical scoping to JavaScript. These declarations are not hoisted and only exist within the block in which they are declared. That means behavior that is more like other languages and less likely to cause unintentional errors, as variables can now be declared exactly where they are needed. As a side effect, you cannot access variables before they are declared, even with safe operators such as <code>typeof</code>. Attempting to access a block binding before its declaration results in an error due to the binding’s presence in the temporal dead zone (TDZ).</p>

        <p>In many cases, <code>let</code> and <code>const</code> behave in a manner that is similar to <code>var</code>, however, this is not true for loops. For both <code>let</code> and <code>const</code>, <code>for-in</code> and <code>for-of</code> loops create a new binding with each iteration through the loop. That means functions created inside the loop body can access the loop bindings values as they were during that iteration rather than as they were after the last iteration (the behavior with <code>var</code>). The same is true for <code>let</code> declarations in <code>for</code> loops, while attempting to use <code>const</code> declarations in a <code>for</code> loop may result in an error.</p>

        <p>The current best practice for block bindings is to use <code>const</code> by default and only use <code>let</code> when you know a variable’s value needs to change. This ensures a basic level of immutability in code that can help prevent certain types of errors.</p>

        <h2 id="leanpub-auto-destructuring">Destructuring</h2>

        <p>JavaScript developers spend a lot of time pulling data out of objects and arrays. It’s not uncommon to see code such as this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">options</code> <code class="o">=</code> <code class="p">{</code>
        <code class="nx">repeat</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">save</code><code class="o">:</code> <code class="kc">false</code>
    <code class="p">};</code>

<code class="c1">// later</code>

<code class="kd">var</code> <code class="nx">localRepeat</code> <code class="o">=</code> <code class="nx">options</code><code class="p">.</code><code class="nx">repeat</code><code class="p">,</code>
    <code class="nx">localSave</code> <code class="o">=</code> <code class="nx">options</code><code class="p">.</code><code class="nx">save</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>Frequently, object properties are stored into local variables for more succinct code and easier access. ECMAScript 6 makes this easy by introducing <em>destructuring assignment</em>, which systematically goes through an object or array and stores specified pieces of data into local variables.</p>

        <aside class="warning blurb">
            <p>If the right side value of a destructuring assignment evaluates to <code>null</code> or <code>undefined</code>, an error is thrown.</p>

        </aside>

        <h3 id="leanpub-auto-object-destructuring">Object Destructuring</h3>

        <p>Object destructuring assignment syntax uses an object literal on the left side of an assignment operation. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">options</code> <code class="o">=</code> <code class="p">{</code>
        <code class="nx">repeat</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">save</code><code class="o">:</code> <code class="kc">false</code>
    <code class="p">};</code>

<code class="c1">// later</code>

<code class="kd">var</code> <code class="p">{</code> <code class="nx">repeat</code><code class="o">:</code> <code class="nx">localRepeat</code><code class="p">,</code> <code class="nx">save</code><code class="o">:</code> <code class="nx">localSave</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">options</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">localRepeat</code><code class="p">);</code>       <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">localSave</code><code class="p">);</code>         <code class="c1">// false</code>
</pre></div>

        </figure>

        <p>In this code, the value of <code>options.repeat</code> is stored in a variable called <code>localRepeat</code> and the value of <code>options.save</code> is stored in a variable called <code>localSave</code>. These are both specified using the object literal syntax where the key is the property to find on <code>options</code> and the value is the variable in which to store the property value.</p>

        <aside class="information blurb">
            <p>If the property with the given name doesn’t exist on the object, then the local variable gets a value of <code>undefined</code>.</p>

        </aside>

        <p>If you want to use the property name as the local variable name, you can omit the colon and the identifier, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">options</code> <code class="o">=</code> <code class="p">{</code>
        <code class="nx">repeat</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">save</code><code class="o">:</code> <code class="kc">false</code>
    <code class="p">};</code>

<code class="c1">// later</code>

<code class="kd">var</code> <code class="p">{</code> <code class="nx">repeat</code><code class="p">,</code> <code class="nx">save</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">options</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">repeat</code><code class="p">);</code>        <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">save</code><code class="p">);</code>          <code class="c1">// false</code>
</pre></div>

        </figure>

        <p>Here, two local variables called <code>repeat</code> and <code>save</code> are created. They are initialized with the value of <code>options.repeat</code> and <code>options.save</code>, respectively. This shorthand is helpful when there’s no need to have different variable names.</p>

        <p>Destructuring can also handle nested objects, such as the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">options</code> <code class="o">=</code> <code class="p">{</code>
        <code class="nx">repeat</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">save</code><code class="o">:</code> <code class="kc">false</code><code class="p">,</code>
        <code class="nx">rules</code><code class="o">:</code> <code class="p">{</code>
            <code class="nx">custom</code><code class="o">:</code> <code class="mi">10</code><code class="p">,</code>
        <code class="p">}</code>
    <code class="p">};</code>

<code class="c1">// later</code>

<code class="kd">var</code> <code class="p">{</code> <code class="nx">repeat</code><code class="p">,</code> <code class="nx">save</code><code class="p">,</code> <code class="nx">rules</code><code class="o">:</code> <code class="p">{</code> <code class="nx">custom</code> <code class="p">}}</code> <code class="o">=</code> <code class="nx">options</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">repeat</code><code class="p">);</code>        <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">save</code><code class="p">);</code>          <code class="c1">// false</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">custom</code><code class="p">);</code>        <code class="c1">// 10</code>
</pre></div>

        </figure>

        <p>In this example, the <code>custom</code> property is embedded in another object. The extra set of curly braces allows you to descend into a nested object and pull out its properties.</p>

        <aside>
            <h4 id="leanpub-auto-syntax-gotcha">Syntax Gotcha</h4>

            <p>If you try use destructuring assignment without a <code>var</code>, <code>let</code>, or <code>const</code>, you may be surprised by the result:</p>

            <figure class="code">
                <div class="highlight"><pre><code class="c1">// syntax error</code>
<code class="p">{</code> <code class="nx">repeat</code><code class="p">,</code> <code class="nx">save</code><code class="p">,</code> <code class="nx">rules</code><code class="o">:</code> <code class="p">{</code> <code class="nx">custom</code> <code class="p">}}</code> <code class="o">=</code> <code class="nx">options</code><code class="p">;</code>
</pre></div>

            </figure>

            <p>This causes a syntax error because the opening curly brace is normally the beginning of a block and blocks can’t be part of assignment expressions.</p>

            <p>The solution is to wrap the entire expression in parentheses:</p>

            <figure class="code">
                <div class="highlight"><pre><code class="c1">// no syntax error</code>
<code class="p">({</code> <code class="nx">repeat</code><code class="p">,</code> <code class="nx">save</code><code class="p">,</code> <code class="nx">rules</code><code class="o">:</code> <code class="p">{</code> <code class="nx">custom</code> <code class="p">}}</code> <code class="o">=</code> <code class="nx">options</code><code class="p">);</code>
</pre></div>

            </figure>

            <p>This now works without any problems.</p>

        </aside>

        <h3 id="leanpub-auto-array-destructuring">Array Destructuring</h3>

        <p>Similarly, you can destructure arrays using array literal syntax on the left side of an assignment operation. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">colors</code> <code class="o">=</code> <code class="p">[</code> <code class="s2">"red"</code><code class="p">,</code> <code class="s2">"green"</code><code class="p">,</code> <code class="s2">"blue"</code> <code class="p">];</code>

<code class="c1">// later</code>

<code class="kd">var</code> <code class="p">[</code> <code class="nx">firstColor</code><code class="p">,</code> <code class="nx">secondColor</code> <code class="p">]</code> <code class="o">=</code> <code class="nx">colors</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">firstColor</code><code class="p">);</code>        <code class="c1">// "red"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">secondColor</code><code class="p">);</code>       <code class="c1">// "green"</code>
</pre></div>

        </figure>

        <p>In this example, array destructuring pulls out the first and second values in the <code>colors</code> array. Keep in mind that the array itself isn’t changed in any way.</p>

        <p>Similar to object destructuring, you can also nest array destructuring. Just use another set of square brackets to descend into a subarray:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">colors</code> <code class="o">=</code> <code class="p">[</code> <code class="s2">"red"</code><code class="p">,</code> <code class="p">[</code> <code class="s2">"green"</code><code class="p">,</code> <code class="s2">"lightgreen"</code> <code class="p">],</code> <code class="s2">"blue"</code> <code class="p">];</code>

<code class="c1">// later</code>

<code class="kd">var</code> <code class="p">[</code> <code class="nx">firstColor</code><code class="p">,</code> <code class="p">[</code> <code class="nx">secondColor</code> <code class="p">]</code> <code class="p">]</code> <code class="o">=</code> <code class="nx">colors</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">firstColor</code><code class="p">);</code>        <code class="c1">// "red"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">secondColor</code><code class="p">);</code>       <code class="c1">// "green"</code>
</pre></div>

        </figure>

        <p>Here, the <code>secondColor</code> variable refers to the <code>"green"</code> value inside of the <code>colors</code> array. That item is contained within a second array, so the extra square brackets around <code>secondColor</code> in the destructuring assignment is necessary.</p>

        <h3 id="leanpub-auto-mixed-destructuring">Mixed Destructuring</h3>

        <p>It’s possible to mix objects and arrays together in a destructuring assignment expression using a mix of object and array literals. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">options</code> <code class="o">=</code> <code class="p">{</code>
        <code class="nx">repeat</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">save</code><code class="o">:</code> <code class="kc">false</code><code class="p">,</code>
        <code class="nx">colors</code><code class="o">:</code> <code class="p">[</code> <code class="s2">"red"</code><code class="p">,</code> <code class="s2">"green"</code><code class="p">,</code> <code class="s2">"blue"</code> <code class="p">]</code>
    <code class="p">};</code>

<code class="kd">var</code> <code class="p">{</code> <code class="nx">repeat</code><code class="p">,</code> <code class="nx">save</code><code class="p">,</code> <code class="nx">colors</code><code class="o">:</code> <code class="p">[</code> <code class="nx">firstColor</code><code class="p">,</code> <code class="nx">secondColor</code> <code class="p">]}</code> <code class="o">=</code> <code class="nx">options</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">repeat</code><code class="p">);</code>            <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">save</code><code class="p">);</code>              <code class="c1">// false</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">firstColor</code><code class="p">);</code>        <code class="c1">// "red"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">secondColor</code><code class="p">);</code>       <code class="c1">// "green"</code>
</pre></div>

        </figure>

        <p>This example extracts two property values, <code>repeat</code> and <code>save</code>, and then two items from the <code>colors</code> array, <code>firstColor</code> and <code>secondColor</code>. Of course, you could also choose to retrieve the entire array:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">options</code> <code class="o">=</code> <code class="p">{</code>
        <code class="nx">repeat</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">save</code><code class="o">:</code> <code class="kc">false</code><code class="p">,</code>
        <code class="nx">colors</code><code class="o">:</code> <code class="p">[</code> <code class="s2">"red"</code><code class="p">,</code> <code class="s2">"green"</code><code class="p">,</code> <code class="s2">"blue"</code> <code class="p">]</code>
    <code class="p">};</code>

<code class="kd">var</code> <code class="p">{</code> <code class="nx">repeat</code><code class="p">,</code> <code class="nx">save</code><code class="p">,</code> <code class="nx">colors</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">options</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">repeat</code><code class="p">);</code>                        <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">save</code><code class="p">);</code>                          <code class="c1">// false</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">colors</code><code class="p">);</code>                        <code class="c1">// "red,green,blue"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">colors</code> <code class="o">===</code> <code class="nx">options</code><code class="p">.</code><code class="nx">colors</code><code class="p">);</code>     <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>This modified example retrieves <code>options.colors</code> and stores it in the <code>colors</code> variable. Notice that <code>colors</code> is a direct reference to <code>options.colors</code> and not a copy.</p>

        <p>Mixed destructuring is very useful for pulling values out of JSON configuration structures without navigating the entire structure.</p>

        <h3 id="leanpub-auto-summary-1">Summary</h3>

        <p>Destructuring makes it easier to work with objects and arrays in JavaScript. Using syntax that’s already familiar to many developers, object literals and array literals, you can now pick data structures apart to get at just the information you’re interested in.</p>

        <h2 id="leanpub-auto-strings-and-regular-expressions">Strings and Regular Expressions</h2>

        <p>Strings are arguably one of the most important data types in programming. Found in nearly every higher-level programming language, the way developers work with strings is a fundamental capability for creating useful programs. Regular expressions, by extension, are important because of their relationship to strings and the extra power that developers can wield on strings through regular expressions. That’s why ECMAScript 6 improved strings and regular expressions, adding new capabilities and long-missing functionality.</p>

        <h3 id="leanpub-auto-better-unicode-support">Better Unicode Support</h3>

        <p>Prior to ECMAScript 6, JavaScript strings were based solely on the idea of 16-bit character encodings. All string properties and methods, such as <code>length</code> and <code>charAt()</code>, were based around the idea that every 16-bit sequence represented a single character. ECMAScript 5 allowed JavaScript engines to decide which of two encodings to use, either UCS-2 or UTF-16 (both encodings use 16-bit <em>code units</em>, making all observable operations the same). While it’s true that all of the world’s characters used to fit into 16 bits at one point in time, that is no longer the case.</p>

        <p>Keeping within 16 bits wasn’t possible for Unicode’s stated goal of providing a globally unique identifier to every character in the world. These globally unique identifiers, called <em>code points</em>, are simply numbers starting at 0 (you might think of these as character codes, though there is a subtle difference). A character encoding is responsible for encoding a code point into code units that are internally consistent. While UCS-2 had a one-to-one mapping of code point to code unit, UTF-16 is more variable.</p>

        <p>The first 2^16 code points are represented as single 16-bit code units in UTF-16. This is called the <em>Basic Multilingual Plane</em> (BMP). Everything beyond that range is considered to be in a <em>supplementary plane</em>, where the code points can no longer be represented in just 16-bits. UTF-16 solves this problem by introducing <em>surrogate pairs</em> in which a single code point is represented by two 16-bit code units. That means any single character in a string can be either one code unit (for BMP, total of 16 bits) or two (for supplementary plane characters, total of 32 bits).</p>

        <p>ECMAScript 5 kept all operations as working on 16-bit code units, meaning that you could get unexpected results from strings containing surrogate pairs. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">text</code> <code class="o">=</code> <code class="s2">"𠮷"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">text</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>           <code class="c1">// 2</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sr">/^.$/</code><code class="p">.</code><code class="nx">test</code><code class="p">(</code><code class="nx">text</code><code class="p">));</code>      <code class="c1">// false</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">text</code><code class="p">.</code><code class="nx">charAt</code><code class="p">(</code><code class="mi">0</code><code class="p">));</code>        <code class="c1">// ""</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">text</code><code class="p">.</code><code class="nx">charAt</code><code class="p">(</code><code class="mi">1</code><code class="p">));</code>        <code class="c1">// ""</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">text</code><code class="p">.</code><code class="nx">charCodeAt</code><code class="p">(</code><code class="mi">0</code><code class="p">));</code>    <code class="c1">// 55362</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">text</code><code class="p">.</code><code class="nx">charCodeAt</code><code class="p">(</code><code class="mi">1</code><code class="p">));</code>    <code class="c1">// 57271</code>
</pre></div>

        </figure>

        <p>In this example, a single Unicode character is represented using surrogate pairs, and as such, the JavaScript string operations treat the string as having two 16-bit characters. That means <code>length</code> is 2, a regular expression trying to match a single character fails, and <code>charAt()</code> is unable to return a valid character string. The <code>charCodeAt()</code> method returns the appropriate 16-bit number for each code unit, but that is the closest you could get to the real value in ECMAScript 5.</p>

        <p>ECMAScript 6 enforces encoding of strings in UTF-16. Standardizing on this character encoding means that the language can now support functionality designed to work specifically with surrogate pairs.</p>

        <h4 id="leanpub-auto-the-codepointat-method">The codePointAt() Method</h4>

        <p>The first example of fully supporting UTF-16 is the <code>codePointAt()</code> method, which can be used to retrieve the Unicode code point that maps to a given position in a string. This method accepts the code unit position (not the character position) and returns an integer value:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">text</code> <code class="o">=</code> <code class="s2">"𠮷a"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">text</code><code class="p">.</code><code class="nx">charCodeAt</code><code class="p">(</code><code class="mi">0</code><code class="p">));</code>    <code class="c1">// 55362</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">text</code><code class="p">.</code><code class="nx">charCodeAt</code><code class="p">(</code><code class="mi">1</code><code class="p">));</code>    <code class="c1">// 57271</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">text</code><code class="p">.</code><code class="nx">charCodeAt</code><code class="p">(</code><code class="mi">2</code><code class="p">));</code>    <code class="c1">// 97</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">text</code><code class="p">.</code><code class="nx">codePointAt</code><code class="p">(</code><code class="mi">0</code><code class="p">));</code>   <code class="c1">// 134071</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">text</code><code class="p">.</code><code class="nx">codePointAt</code><code class="p">(</code><code class="mi">1</code><code class="p">));</code>   <code class="c1">// 57271</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">text</code><code class="p">.</code><code class="nx">codePointAt</code><code class="p">(</code><code class="mi">2</code><code class="p">));</code>   <code class="c1">// 97</code>
</pre></div>

        </figure>

        <p>The <code>codePointAt()</code> method works in the same manner as <code>charCodeAt()</code> except for non-BMP characters. The first character in <code>text</code> is non-BMP and is therefore comprised of two code units, meaning the entire length of the string is 3 rather than 2. The <code>charCodeAt()</code> method returns only the first code unit for position 0 whereas <code>codePointAt()</code> returns the full code point even though it spans multiple code units. Both methods return the same value for positions 1 (the second code unit of the first character) and 2 (the <code>"a"</code>).</p>

        <p>This method is the easiest way to determine if a given character is represented by one or two code points:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">is32Bit</code><code class="p">(</code><code class="nx">c</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">c</code><code class="p">.</code><code class="nx">codePointAt</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code> <code class="o">&gt;</code> <code class="mh">0xFFFF</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">is32Bit</code><code class="p">(</code><code class="s2">"𠮷"</code><code class="p">));</code>         <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">is32Bit</code><code class="p">(</code><code class="s2">"a"</code><code class="p">));</code>          <code class="c1">// false</code>
</pre></div>

        </figure>

        <p>The upper bound of 16-bit characters is represented in hexadecimal as <code>FFFF</code>, so any code point above that number must be represented by two code units.</p>

        <h4 id="leanpub-auto-stringfromcodepoint">String.fromCodePoint()</h4>

        <p>When ECMAScript provides a way to do something, it also tends to provide a way to do the reverse. You can use <code>codePointAt()</code> to retrieve the code point for a character in a string, while <code>String.fromCodePoint()</code> produces a single-character string for the given code point. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">String</code><code class="p">.</code><code class="nx">fromCodePoint</code><code class="p">(</code><code class="mi">134071</code><code class="p">));</code>  <code class="c1">// "𠮷"</code>
</pre></div>

        </figure>

        <p>You can think of <code>String.fromCodePoint()</code> as a more complete version of <code>String.fromCharCode()</code>. Each method has the same result for all characters in the BMP; the only difference is with characters outside of that range.</p>

        <h4 id="leanpub-auto-escaping-non-bmp-characters">Escaping Non-BMP Characters</h4>

        <p>ECMAScript 5 allows strings to contain 16-bit Unicode characters represented by an <em>escape sequence</em>. The escape sequence is the <code>\u</code> followed by four hexadecimal values. For example, the escape sequence <code>\u0061</code> represents the letter <code>"a"</code>:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"\u0061"</code><code class="p">);</code>      <code class="c1">// "a"</code>
</pre></div>

        </figure>

        <p>If you try to use an escape sequence with a number past <code>FFFF</code>, the upper bound of the BMP, then you can get some surprising results:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"\u20BB7"</code><code class="p">);</code>     <code class="c1">// "7"</code>
</pre></div>

        </figure>

        <p>Since Unicode escape sequences were defined as always having exactly four hexadecimal characters, ECMAScript evaluates <code>\u20BB7</code> as two characters: <code>\u20BB</code> and <code>"7"</code>. The first character is unprintable and the second is the number 7.</p>

        <p>ECMAScript 6 solves this problem by introducing an extended Unicode escape sequence where the hexadecimal numbers are contained within curly braces. This allows any number of hexadecimal characters to specify a single character:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"\u{20BB7}"</code><code class="p">);</code>     <code class="c1">// "𠮷"</code>
</pre></div>

        </figure>

        <p>Using the extended escape sequence, the correct character is contained in the string.</p>

        <aside class="warning blurb">
            <p>Make sure that you use this new escape sequence only in an ECMAScript 6 environment. In all other environments, doing so causes a syntax error. You may want to check and see if the environment supports the extended escape sequence using a function such as:</p>

            <figure class="code">
                <div class="highlight"><pre><code class="kd">function</code> <code class="nx">supportsExtendedEscape</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">try</code> <code class="p">{</code>
        <code class="nb">eval</code><code class="p">(</code><code class="s2">"'\\u{00FF1}'"</code><code class="p">);</code>
        <code class="k">return</code> <code class="kc">true</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">catch</code> <code class="p">(</code><code class="nx">ex</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="kc">false</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

            </figure>

        </aside>

        <h4 id="leanpub-auto-the-normalize-method">The normalize() Method</h4>

        <p>Another interesting aspect of Unicode is that different characters may be considered equivalent for the purposes of sorting or other comparison-based operations. There are two ways to define these relationships. First, <em>canonical equivalence</em> means that two sequences of code points are considered interchangeable in all respects. That even means that a combination of two characters can be canonically equivalent to one character. The second relationship is <em>compatibility</em>, meaning that two sequences of code points having different appearances but can be used interchangeably in certain situations.</p>

        <p>The important thing to understand is that due to these relationships, it’s possible to have two strings that represent fundamentally the same text and yet have them contain different code point sequences. For example, the character “æ” and the string “ae” may be used interchangeably even though they are different code points. These two strings would therefore be unequal in JavaScript unless they are normalized in some way.</p>

        <p>ECMAScript 6 supports Unicode normalization forms through a new <code>normalize()</code> method on strings. This method optionally accepts a single string parameter indicating the Unicode normalization form to apply: <code>"NFC"</code> (default), <code>"NFD"</code>, <code>"NFKC"</code>, or <code>"NFKD"</code>. It’s beyond the scope of this book to explain the differences between these four forms. Just keep in mind that, when comparing strings, both strings must be normalized to the same form. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">normalized</code> <code class="o">=</code> <code class="nx">values</code><code class="p">.</code><code class="nx">map</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">text</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">text</code><code class="p">.</code><code class="nx">normalize</code><code class="p">();</code>
<code class="p">});</code>

<code class="nx">normalized</code><code class="p">.</code><code class="nx">sort</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">first</code><code class="p">,</code> <code class="nx">second</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">if</code> <code class="p">(</code><code class="nx">first</code> <code class="o">&lt;</code> <code class="nx">second</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="o">-</code><code class="mi">1</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">else</code> <code class="k">if</code> <code class="p">(</code><code class="nx">first</code> <code class="o">===</code> <code class="nx">second</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="mi">0</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
        <code class="k">return</code> <code class="mi">1</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this code, the strings in a <code>values</code> array are converted into a normalized form so that the array can be sorted appropriately. You can accomplish the sort on the original array by calling <code>normalize()</code> as part of the comparator:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">values</code><code class="p">.</code><code class="nx">sort</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">first</code><code class="p">,</code> <code class="nx">second</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">firstNormalized</code> <code class="o">=</code> <code class="nx">first</code><code class="p">.</code><code class="nx">normalize</code><code class="p">(),</code>
        <code class="nx">secondNormalized</code> <code class="o">=</code> <code class="nx">second</code><code class="p">.</code><code class="nx">normalize</code><code class="p">();</code>

    <code class="k">if</code> <code class="p">(</code><code class="nx">firstNormalized</code> <code class="o">&lt;</code> <code class="nx">secondNormalized</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="o">-</code><code class="mi">1</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">else</code> <code class="k">if</code> <code class="p">(</code><code class="nx">firstNormalized</code> <code class="o">===</code> <code class="nx">secondNormalized</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="mi">0</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
        <code class="k">return</code> <code class="mi">1</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>Once again, the most important thing to remember is that both values must be normalized in the same way. These examples have used the default, NFC, but you can just as easily specify one of the others:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">values</code><code class="p">.</code><code class="nx">sort</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">first</code><code class="p">,</code> <code class="nx">second</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">firstNormalized</code> <code class="o">=</code> <code class="nx">first</code><code class="p">.</code><code class="nx">normalize</code><code class="p">(</code><code class="s2">"NFD"</code><code class="p">),</code>
        <code class="nx">secondNormalized</code> <code class="o">=</code> <code class="nx">second</code><code class="p">.</code><code class="nx">normalize</code><code class="p">(</code><code class="s2">"NFD"</code><code class="p">);</code>

    <code class="k">if</code> <code class="p">(</code><code class="nx">firstNormalized</code> <code class="o">&lt;</code> <code class="nx">secondNormalized</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="o">-</code><code class="mi">1</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">else</code> <code class="k">if</code> <code class="p">(</code><code class="nx">firstNormalized</code> <code class="o">===</code> <code class="nx">secondNormalized</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="mi">0</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
        <code class="k">return</code> <code class="mi">1</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>If you’ve never worried about Unicode normalization before, then you probably won’t have much use for this method. However, knowing that it is available will help, should you ever end up working on an internationalized application.</p>

        <h4 id="leanpub-auto-the-regular-expression-u-flag">The Regular Expression u Flag</h4>

        <p>Many common string operations are accomplished by using regular expressions. However, as noted earlier, regular expressions also work on the basis of 16-bit code units each representing a single character. That’s why the single character match in the earlier example didn’t work. To address this problem, ECMAScript 6 defines a new flag for regular expressions: <code>u</code> for “Unicode”.</p>

        <p>When a regular expression has the <code>u</code> flag set, it switches modes to work on characters and not code units. That means the regular expression will no longer get confused about surrogate pairs in strings and can behave as expected. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">text</code> <code class="o">=</code> <code class="s2">"𠮷"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">text</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>           <code class="c1">// 2</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sr">/^.$/</code><code class="p">.</code><code class="nx">test</code><code class="p">(</code><code class="nx">text</code><code class="p">));</code>      <code class="c1">// false</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="err">/^.$/u.test(text));     // true</code>
</pre></div>

        </figure>

        <p>Adding the <code>u</code> flag allows the regular expression to correctly match the string by characters. Unfortunately, ECMAScript 6 does not natively have a way of determining how many code points are present in a string; fortunately, regular expressions with the <code>u</code> flag can be used to figure it out:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">codePointLength</code><code class="p">(</code><code class="nx">text</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">result</code> <code class="o">=</code> <code class="nx">text</code><code class="p">.</code><code class="nx">match</code><code class="p">(</code><code class="err">/[\s\S]/gu);</code>
    <code class="k">return</code> <code class="nx">result</code> <code class="o">?</code> <code class="nx">result</code><code class="p">.</code><code class="nx">length</code> <code class="o">:</code> <code class="mi">0</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">codePointLength</code><code class="p">(</code><code class="s2">"abc"</code><code class="p">));</code>    <code class="c1">// 3</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">codePointLength</code><code class="p">(</code><code class="s2">"𠮷bc"</code><code class="p">));</code>   <code class="c1">// 3</code>
</pre></div>

        </figure>

        <p>The regular expression in this example matches both whitespace and non-whitespace characters, and is applied globally with Unicode enabled. The <code>result</code> contains an array of matches when there’s at least one match, so the array length ends up being the number of code points in the string.</p>

        <aside class="warning blurb">
            <p>Although this approach works, it’s not very fast, especially when applied to long strings. Try to minimize counting code points whenever possible. Hopefully ECMAScript 7 will bring a more performant means by which to count code points.</p>

        </aside>

        <p>Since the <code>u</code> flag is a syntax change, attempting to use it in non-compliant JavaScript engines means a syntax error is thrown. The safest way to determine if the <code>u</code> flag is supported is with a function:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">hasRegExpU</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">try</code> <code class="p">{</code>
        <code class="kd">var</code> <code class="nx">pattern</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">RegExp</code><code class="p">(</code><code class="s2">"."</code><code class="p">,</code> <code class="s2">"u"</code><code class="p">);</code>
        <code class="k">return</code> <code class="kc">true</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">catch</code> <code class="p">(</code><code class="nx">ex</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="kc">false</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This function uses the <code>RegExp</code> constructor to pass in the <code>u</code> flag as an argument. This is valid syntax even in older JavaScript engines, however, the constructor will throw an error if <code>u</code> isn’t supported.</p>

        <aside class="information blurb">
            <p>If your code still needs to work in older JavaScript engines, it’s best to use the <code>RegExp</code> constructor exclusively when using the <code>u</code> flag. This will prevent syntax errors and allow you to optionally detect and use the <code>u</code> flag without aborting execution.</p>

        </aside>

        <h3 id="leanpub-auto-other-string-changes">Other String Changes</h3>

        <p>JavaScript strings have always lagged behind similar features of other languages. It was only in ECMAScript 5 that strings finally gained a <code>trim()</code> method, and ECMAScript 6 continues extending strings with new functionality.</p>

        <h4 id="leanpub-auto-includes-startswith-endswith">includes(), startsWith(), endsWith()</h4>

        <p>Developers have used <code>indexOf()</code> as a way to identify strings inside of other strings since JavaScript was first introduced. ECMAScript 6 adds three new methods whose purpose is to identify strings inside of other strings:</p>

        <ul>
            <li>
                <code>includes()</code> - returns true if the given text is found anywhere within the string or false if not.</li>
            <li>
                <code>startsWith()</code> - returns true if the given text is found at the beginning of the string or false if not.</li>
            <li>
                <code>endsWith()</code> - returns true if the given text is found at the end of the string or false if not.</li>
        </ul>

        <p>Each of these methods accepts two arguments: the text to search for and an optional location from which to start the search. When the second argument is omitted, <code>includes()</code> and <code>startsWith()</code> start search from the beginning of the string while <code>endsWith()</code> starts from the end. In effect, the second argument results in less of the string being searched. Here are some examples:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">msg</code> <code class="o">=</code> <code class="s2">"Hello world!"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">msg</code><code class="p">.</code><code class="nx">startsWith</code><code class="p">(</code><code class="s2">"Hello"</code><code class="p">));</code>       <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">msg</code><code class="p">.</code><code class="nx">endsWith</code><code class="p">(</code><code class="s2">"!"</code><code class="p">));</code>             <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">msg</code><code class="p">.</code><code class="nx">includes</code><code class="p">(</code><code class="s2">"o"</code><code class="p">));</code>             <code class="c1">// true</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">msg</code><code class="p">.</code><code class="nx">startsWith</code><code class="p">(</code><code class="s2">"o"</code><code class="p">));</code>           <code class="c1">// false</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">msg</code><code class="p">.</code><code class="nx">endsWith</code><code class="p">(</code><code class="s2">"world!"</code><code class="p">));</code>        <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">msg</code><code class="p">.</code><code class="nx">includes</code><code class="p">(</code><code class="s2">"x"</code><code class="p">));</code>             <code class="c1">// false</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">msg</code><code class="p">.</code><code class="nx">startsWith</code><code class="p">(</code><code class="s2">"o"</code><code class="p">,</code> <code class="mi">4</code><code class="p">));</code>        <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">msg</code><code class="p">.</code><code class="nx">endsWith</code><code class="p">(</code><code class="s2">"o"</code><code class="p">,</code> <code class="mi">8</code><code class="p">));</code>          <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">msg</code><code class="p">.</code><code class="nx">includes</code><code class="p">(</code><code class="s2">"o"</code><code class="p">,</code> <code class="mi">8</code><code class="p">));</code>          <code class="c1">// false</code>
</pre></div>

        </figure>

        <p>These three methods make it much easier to identify substrings without needing to worry about identifying their exact position.</p>

        <aside class="information blurb">
            <p>All of these methods return a boolean value. If you need to find the position of a string within another, use <code>indexOf()</code> or <code>lastIndexOf()</code>.</p>

        </aside>

        <aside class="warning blurb">
            <p>The <code>startsWith()</code>, <code>endsWith()</code>, and <code>includes()</code> methods will throw an error if you pass a regular expression instead of a string. This stands in contrast to <code>indexOf()</code> and <code>lastIndexOf()</code>, which both convert a regular expression argument into a string and then search for that string.</p>

        </aside>

        <h4 id="leanpub-auto-repeat">repeat()</h4>

        <p>ECMAScript 6 also adds a <code>repeat()</code> method to strings. This method accepts a single argument, which is the number of times to repeat the string, and returns a new string that has the original string repeated the specified number of times. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"x"</code><code class="p">.</code><code class="nx">repeat</code><code class="p">(</code><code class="mi">3</code><code class="p">));</code>         <code class="c1">// "xxx"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"hello"</code><code class="p">.</code><code class="nx">repeat</code><code class="p">(</code><code class="mi">2</code><code class="p">));</code>     <code class="c1">// "hellohello"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"abc"</code><code class="p">.</code><code class="nx">repeat</code><code class="p">(</code><code class="mi">4</code><code class="p">));</code>       <code class="c1">// "abcabcabcabc"</code>
</pre></div>

        </figure>

        <p>This method is really a convenience function above all else, which can be especially useful when dealing with text manipulation. One example where this functionality comes in useful is with code formatting utilities where you need to create indentation levels:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// indent using a specified number of spaces</code>
<code class="kd">var</code> <code class="nx">indent</code> <code class="o">=</code> <code class="s2">" "</code><code class="p">.</code><code class="nx">repeat</code><code class="p">(</code><code class="nx">size</code><code class="p">),</code>
    <code class="nx">indentLevel</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>

<code class="c1">// whenever you increase the indent</code>
<code class="kd">var</code> <code class="nx">newIndent</code> <code class="o">=</code> <code class="nx">indent</code><code class="p">.</code><code class="nx">repeat</code><code class="p">(</code><code class="o">++</code><code class="nx">indentLevel</code><code class="p">);</code>
</pre></div>

        </figure>

        <h3 id="leanpub-auto-other-regular-expression-changes">Other Regular Expression Changes</h3>

        <p>Regular expressions are an important part of working with strings in JavaScript, and like many parts of the language, haven’t really changed very much in recent versions. ECMAScript 6, however, makes several improvements to regular expressions to go along with the updates to strings.</p>

        <h4 id="leanpub-auto-the-regular-expression-y-flag">The Regular Expression y Flag</h4>

        <p>ECMAScript 6 standardized the <code>y</code> flag after it had been implemented in Firefox as a proprietary extension to regular expressions. The <code>y</code> (sticky) flag starts matching at the position specified by its <code>lastIndex</code> property. If there is no match at that location, then the regular expression stops matching. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">text</code> <code class="o">=</code> <code class="s2">"hello1 hello2 hello3"</code><code class="p">,</code>
    <code class="nx">pattern</code> <code class="o">=</code> <code class="sr">/hello\d\s?/</code><code class="p">,</code>
    <code class="nx">result</code> <code class="o">=</code> <code class="nx">pattern</code><code class="p">.</code><code class="nx">exec</code><code class="p">(</code><code class="nx">text</code><code class="p">),</code>
    <code class="nx">globalPattern</code> <code class="o">=</code> <code class="sr">/hello\d\s?/g</code><code class="p">,</code>
    <code class="nx">globalResult</code> <code class="o">=</code> <code class="nx">globalPattern</code><code class="p">.</code><code class="nx">exec</code><code class="p">(</code><code class="nx">text</code><code class="p">),</code>
    <code class="nx">stickyPattern</code> <code class="o">=</code> <code class="err">/hello\d\s?/y,</code>
    <code class="nx">stickyResult</code> <code class="o">=</code> <code class="nx">stickyPattern</code><code class="p">.</code><code class="nx">exec</code><code class="p">(</code><code class="nx">text</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">result</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>         <code class="c1">// "hello1 "</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">globalResult</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>   <code class="c1">// "hello1 "</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">stickyResult</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>   <code class="c1">// "hello1 "</code>

<code class="nx">pattern</code><code class="p">.</code><code class="nx">lastIndex</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>
<code class="nx">globalPattern</code><code class="p">.</code><code class="nx">lastIndex</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>
<code class="nx">stickyPattern</code><code class="p">.</code><code class="nx">lastIndex</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>

<code class="nx">result</code> <code class="o">=</code> <code class="nx">pattern</code><code class="p">.</code><code class="nx">exec</code><code class="p">(</code><code class="nx">text</code><code class="p">);</code>
<code class="nx">globalResult</code> <code class="o">=</code> <code class="nx">globalPattern</code><code class="p">.</code><code class="nx">exec</code><code class="p">(</code><code class="nx">text</code><code class="p">);</code>
<code class="nx">stickyResult</code> <code class="o">=</code> <code class="nx">stickyPattern</code><code class="p">.</code><code class="nx">exec</code><code class="p">(</code><code class="nx">text</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">result</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>         <code class="c1">// "hello1 "</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">globalResult</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>   <code class="c1">// "hello2 "</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">stickyResult</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>   <code class="c1">// Error! stickyResult is null</code>
</pre></div>

        </figure>

        <p>In this example, three regular expressions are used, one each with the <code>y</code> flag, the <code>g</code> flag, and no flags. When used the first time, all three regular expressions return the same value <code>"hello1 "</code> (with a space at the end). After that, the <code>lastIndex</code> property is changed to 1, meaning that the regular expression should start matching from the second character. The regular expression with no flags completely ignores the change to <code>lastIndex</code> and still matches <code>"hello1 "</code>; the regular expression with the <code>g</code> flag goes on to match <code>"hello2 "</code> because it is searching forward from the second character of the string (“e”); the sticky regular expression doesn’t match anything beginning at the second character so <code>stickyResult</code> is <code>null</code>.</p>

        <p>The sticky flag saves the index of the next character after the last match in <code>lastIndex</code> whenever an operation is performed. If an operation results in no match then <code>lastIndex</code> is set back to 0. This behavior is the same as the global flag:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">text</code> <code class="o">=</code> <code class="s2">"hello1 hello2 hello3"</code><code class="p">,</code>
    <code class="nx">pattern</code> <code class="o">=</code> <code class="sr">/hello\d\s?/</code><code class="p">,</code>
    <code class="nx">result</code> <code class="o">=</code> <code class="nx">pattern</code><code class="p">.</code><code class="nx">exec</code><code class="p">(</code><code class="nx">text</code><code class="p">),</code>
    <code class="nx">globalPattern</code> <code class="o">=</code> <code class="sr">/hello\d\s?/g</code><code class="p">,</code>
    <code class="nx">globalResult</code> <code class="o">=</code> <code class="nx">globalPattern</code><code class="p">.</code><code class="nx">exec</code><code class="p">(</code><code class="nx">text</code><code class="p">),</code>
    <code class="nx">stickyPattern</code> <code class="o">=</code> <code class="err">/hello\d\s?/y,</code>
    <code class="nx">stickyResult</code> <code class="o">=</code> <code class="nx">stickyPattern</code><code class="p">.</code><code class="nx">exec</code><code class="p">(</code><code class="nx">text</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">result</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>         <code class="c1">// "hello1 "</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">globalResult</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>   <code class="c1">// "hello1 "</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">stickyResult</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>   <code class="c1">// "hello1 "</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">pattern</code><code class="p">.</code><code class="nx">lastIndex</code><code class="p">);</code>         <code class="c1">// 0</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">globalPattern</code><code class="p">.</code><code class="nx">lastIndex</code><code class="p">);</code>   <code class="c1">// 7</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">stickyPattern</code><code class="p">.</code><code class="nx">lastIndex</code><code class="p">);</code>   <code class="c1">// 7</code>

<code class="nx">result</code> <code class="o">=</code> <code class="nx">pattern</code><code class="p">.</code><code class="nx">exec</code><code class="p">(</code><code class="nx">text</code><code class="p">);</code>
<code class="nx">globalResult</code> <code class="o">=</code> <code class="nx">globalPattern</code><code class="p">.</code><code class="nx">exec</code><code class="p">(</code><code class="nx">text</code><code class="p">);</code>
<code class="nx">stickyResult</code> <code class="o">=</code> <code class="nx">stickyPattern</code><code class="p">.</code><code class="nx">exec</code><code class="p">(</code><code class="nx">text</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">result</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>         <code class="c1">// "hello1 "</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">globalResult</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>   <code class="c1">// "hello2 "</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">stickyResult</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>   <code class="c1">// "hello2 "</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">pattern</code><code class="p">.</code><code class="nx">lastIndex</code><code class="p">);</code>         <code class="c1">// 0</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">globalPattern</code><code class="p">.</code><code class="nx">lastIndex</code><code class="p">);</code>   <code class="c1">// 14</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">stickyPattern</code><code class="p">.</code><code class="nx">lastIndex</code><code class="p">);</code>   <code class="c1">// 14</code>
</pre></div>

        </figure>

        <p>The value of <code>lastIndex</code> changed to 7 after the first call to <code>exec()</code> and to 14 after the second call for both the sticky and global patterns.</p>

        <p>There are also a couple other subtle details to the sticky flag:</p>

        <ol class="numeric">
            <li>The <code>lastIndex</code> property is only honored when calling methods on the regular expression object such as <code>exec()</code> and <code>test()</code>. Passing the regular expression to a string method, such as <code>match()</code>, will not result in the sticky behavior.</li>
            <li>When using the <code>^</code> character to match the start of a string, sticky regular expressions will only match from the start of the string (or start of line in multiline mode). So long as <code>lastIndex</code> is 0, the <code>^</code> makes a sticky regular expression no different from a non-sticky one. If <code>lastIndex</code> doesn’t correspond to the beginning of the string (in single-line mode) or the beginning of a line (in multiline mode), the sticky regular expression will never match</li>
        </ol>

        <p>As with other regular expression flags, you can detect the presence of <code>y</code> by using a property. The <code>sticky</code> property is set to true with the sticky flag is present and false if not:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">pattern</code> <code class="o">=</code> <code class="err">/hello\d/y;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">pattern</code><code class="p">.</code><code class="nx">sticky</code><code class="p">);</code>    <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>The <code>sticky</code> property is read-only based on the presence of the flag and so cannot be changed in code.</p>

        <p>Similar to the <code>u</code> flag, the <code>y</code> flag is a syntax change, so it will cause a syntax error in older JavaScript engines. You can use the same approach to detect support:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">hasRegExpY</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">try</code> <code class="p">{</code>
        <code class="kd">var</code> <code class="nx">pattern</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">RegExp</code><code class="p">(</code><code class="s2">"."</code><code class="p">,</code> <code class="s2">"y"</code><code class="p">);</code>
        <code class="k">return</code> <code class="kc">true</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">catch</code> <code class="p">(</code><code class="nx">ex</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="kc">false</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>Also similar to <code>u</code>, if you need to use <code>y</code> in code that runs in older JavaScript engines, be sure to use the <code>RegExp</code> constructor when defining those regular expressions to avoid a syntax error.</p>

        <h4 id="leanpub-auto-duplicating-regular-expressions">Duplicating Regular Expressions</h4>

        <p>In ECMAScript 5, you can duplicate regular expressions by passing them into the <code>RegExp</code> constructor, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">re1</code> <code class="o">=</code> <code class="sr">/ab/i</code><code class="p">,</code>
    <code class="nx">re2</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">RegExp</code><code class="p">(</code><code class="nx">re1</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>However, if you provide the second argument to <code>RegExp</code>, which specifies the flags for the regular expression, then an error is thrown:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">re1</code> <code class="o">=</code> <code class="sr">/ab/i</code><code class="p">,</code>

    <code class="c1">// throws an error in ES5, okay in ES6</code>
    <code class="nx">re2</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">RegExp</code><code class="p">(</code><code class="nx">re1</code><code class="p">,</code> <code class="s2">"g"</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>If you execute this code in an ECMAScript 5 environment, you’ll get an error stating that the second argument cannot be used when the first argument is a regular expression. ECMAScript 6 changed this behavior such that the second argument is allowed and will override whichever flags are present on the first argument. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">re1</code> <code class="o">=</code> <code class="sr">/ab/i</code><code class="p">,</code>

    <code class="c1">// throws an error in ES5, okay in ES6</code>
    <code class="nx">re2</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">RegExp</code><code class="p">(</code><code class="nx">re1</code><code class="p">,</code> <code class="s2">"g"</code><code class="p">);</code>


<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">re1</code><code class="p">.</code><code class="nx">toString</code><code class="p">());</code>            <code class="c1">// "/ab/i"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">re2</code><code class="p">.</code><code class="nx">toString</code><code class="p">());</code>            <code class="c1">// "/ab/g"</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">re1</code><code class="p">.</code><code class="nx">test</code><code class="p">(</code><code class="s2">"ab"</code><code class="p">));</code>            <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">re2</code><code class="p">.</code><code class="nx">test</code><code class="p">(</code><code class="s2">"ab"</code><code class="p">));</code>            <code class="c1">// true</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">re1</code><code class="p">.</code><code class="nx">test</code><code class="p">(</code><code class="s2">"AB"</code><code class="p">));</code>            <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">re2</code><code class="p">.</code><code class="nx">test</code><code class="p">(</code><code class="s2">"AB"</code><code class="p">));</code>            <code class="c1">// false</code>
</pre></div>

        </figure>

        <p>In this code, <code>re1</code> has the case-insensitive <code>i</code> flag present while <code>re2</code> has only the global <code>g</code> flag. The <code>RegExp</code> constructor duplicated the pattern from <code>re1</code> and then substituted <code>g</code> for <code>i</code>. If the second argument was missing then <code>re2</code> would have the same flags as <code>re1</code>.</p>

        <h4 id="leanpub-auto-the-flags-property">The <code>flags</code> Property</h4>

        <p>In ECMAScript 5, it’s possible to get the text of the regular expression by using the <code>source</code> property, but to get the flag string requires parsing the output of <code>toString()</code>, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">getFlags</code><code class="p">(</code><code class="nx">re</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">text</code> <code class="o">=</code> <code class="nx">re</code><code class="p">.</code><code class="nx">toString</code><code class="p">();</code>
    <code class="k">return</code> <code class="nx">text</code><code class="p">.</code><code class="nx">substring</code><code class="p">(</code><code class="nx">text</code><code class="p">.</code><code class="nx">lastIndexOf</code><code class="p">(</code><code class="s2">"/"</code><code class="p">)</code> <code class="o">+</code> <code class="mi">1</code><code class="p">,</code> <code class="nx">text</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>
<code class="p">}</code>

<code class="c1">// toString() is "/ab/g"</code>
<code class="kd">var</code> <code class="nx">re</code> <code class="o">=</code> <code class="sr">/ab/g</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">getFlags</code><code class="p">(</code><code class="nx">re</code><code class="p">));</code>          <code class="c1">// "g"</code>
</pre></div>

        </figure>

        <p>ECMAScript 6 adds a <code>flags</code> property to go along with <code>source</code>. Both properties are prototype accessor properties with only a getter assigned (making them read-only). The addition of <code>flags</code> makes it easier to inspect regular expressions for both debugging and inheritance purposes.</p>

        <p>A late addition to ECMAScript 6, the <code>flags</code> property returns the string representation of any flags applied to a regular expression. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">re</code> <code class="o">=</code> <code class="sr">/ab/g</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">re</code><code class="p">.</code><code class="nx">source</code><code class="p">);</code>     <code class="c1">// "ab"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">re</code><code class="p">.</code><code class="nx">flags</code><code class="p">);</code>      <code class="c1">// "g"</code>
</pre></div>

        </figure>

        <p>Using <code>source</code> and <code>flags</code> together allow you to extract just the pieces of the regular expression that are necessary without needing to parse the regular expression string directly.</p>

        <h3 id="leanpub-auto-template-strings">Template Strings</h3>

        <p>JavaScript’s strings have been fairly limited when compared to those in other languages. Template strings add new syntax to allow the creation of domain-specific languages (DSLs) for working with content in a way that is safer than the solutions we have today. The description on the template string strawman was as follows:</p>

        <blockquote>
            <p>This scheme extends ECMAScript syntax with syntactic sugar to allow libraries to provide DSLs that easily produce, query, and manipulate content from other languages that are immune or resistant to injection attacks such as XSS, SQL Injection, etc.</p>
        </blockquote>

        <p>In reality, though, template strings are ECMAScript 6’s answer to several ongoing problems in JavaScript:</p>

        <ul>
            <li>
                <strong>Multiline strings</strong> - JavaScript has never had a formal concept of multiline strings.</li>
            <li>
                <strong>Basic string formatting</strong> - The ability to substitute parts of the string for values contained in variables.</li>
            <li>
                <strong>HTML escaping</strong> - The ability to transform a string such that it is safe to insert into HTML.</li>
        </ul>

        <p>Rather than trying to add more functionality to JavaScript’s already-existing strings, template strings represent an entirely new approach to solving these problems.</p>

        <h4 id="leanpub-auto-basic-syntax">Basic Syntax</h4>

        <p>At their simplest, template strings act like regular strings that are delimited by backticks (<code>`</code>) instead of double or single quotes. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">message</code> <code class="o">=</code> <code class="err">`</code><code class="nx">Hello</code> <code class="nx">world</code><code class="o">!</code><code class="err">`</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">);</code>               <code class="c1">// "Hello world!"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">message</code><code class="p">);</code>        <code class="c1">// "string"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>        <code class="c1">// 12</code>
</pre></div>

        </figure>

        <p>This code demonstrates that the variable <code>message</code> contains a normal JavaScript string. The template string syntax only is used to create the string value, which is then assigned to <code>message</code>.</p>

        <p>If you want to use a backtick in your string, then you need only escape it by using a backslash (<code>\</code>):</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">message</code> <code class="o">=</code> <code class="err">`\`</code><code class="nx">Hello</code><code class="err">\`</code> <code class="nx">world</code><code class="o">!</code><code class="err">`</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">);</code>               <code class="c1">// "`Hello` world!"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">message</code><code class="p">);</code>        <code class="c1">// "string"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>        <code class="c1">// 14</code>
</pre></div>

        </figure>

        <p>There’s no need to escape either double or single quotes inside of template strings.</p>

        <h4 id="leanpub-auto-multiline-strings">Multiline Strings</h4>

        <p>Ever since the first version of JavaScript, developers have longed for a way to create multiline strings in JavaScript. When using double or single quotes, strings must be completely contained on a single line. JavaScript has long had a syntax bug that would allow multiline strings by using a backslash (<code>\</code>) before a newline, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">message</code> <code class="o">=</code> <code class="s2">"Multiline \</code>
<code class="s2">string"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">);</code>       <code class="c1">// "Multiline string"</code>
</pre></div>

        </figure>

        <p>Note that the string has no newlines present when output, that’s because the backslash is treated as a continuation rather than a newline. In order to have a newline at that point, you would need to manually include it, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">message</code> <code class="o">=</code> <code class="s2">"Multiline \n\</code>
<code class="s2">string"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">);</code>       <code class="c1">// "Multiline</code>
                            <code class="c1">//  string"</code>
</pre></div>

        </figure>

        <p>Despite this working in all major JavaScript engines, the behavior was defined as a bug and many recommended avoiding its usage.</p>

        <p>Other attempts to create multiline strings usually relied on arrays or string concatenation, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">message</code> <code class="o">=</code> <code class="p">[</code>
    <code class="s2">"Multiline "</code><code class="p">,</code>
    <code class="s2">"string"</code>
<code class="p">].</code><code class="nx">join</code><code class="p">(</code><code class="s2">"\n"</code><code class="p">);</code>

<code class="kd">let</code> <code class="nx">message</code> <code class="o">=</code> <code class="s2">"Multiline \n"</code> <code class="o">+</code>
    <code class="s2">"string"</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>All of the ways developers worked around JavaScript’s lack of multiline strings left something to be desired.</p>

        <p>Template strings make multiline strings easy because there is no special syntax. Just include a newline where you want and it shows up in the result. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">message</code> <code class="o">=</code> <code class="err">`</code><code class="nx">Multiline</code>
<code class="nx">string</code><code class="err">`</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">);</code>           <code class="c1">// "Multiline</code>
                                <code class="c1">//  string"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>    <code class="c1">// 16</code>
</pre></div>

        </figure>

        <p>All whitespace inside of the backticks is considered to be part of the string, so be careful with indentation. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">message</code> <code class="o">=</code> <code class="err">`</code><code class="nx">Multiline</code>
               <code class="nx">string</code><code class="err">`</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">);</code>           <code class="c1">// "Multiline</code>
                                <code class="c1">//                 string"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>    <code class="c1">// 31</code>
</pre></div>

        </figure>

        <p>In this code, all of the whitespace before the second line of the template string is considered to be a part of the string itself. If making the text line up with proper indentation is important to you, then you consider leaving nothing on the first line of a multiline template string and then indenting after that, such as this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">html</code> <code class="o">=</code> <code class="err">`</code>
<code class="o">&lt;</code><code class="nx">div</code><code class="o">&gt;</code>
    <code class="o">&lt;</code><code class="nx">h1</code><code class="o">&gt;</code><code class="nx">Title</code><code class="o">&lt;</code><code class="err">/h1&gt;</code>
<code class="o">&lt;</code><code class="err">/div&gt;`.trim();</code>
</pre></div>

        </figure>

        <p>This code begins the template string on the first line but doesn’t have any text until the second. The HTML tags are indented to look correct and then the <code>trim()</code> method is called to remove the initial (empty) line.</p>

        <aside>
            <p>If you prefer, you can also use <code>\n</code> in a template string to indicate where a newline should be inserted:</p>
            <figure class="code">
                <div class="highlight"><pre><code class="n">let</code> <code class="n">message</code> <code class="o">=</code> <code class="err">`</code><code class="n">Multiline</code><code class="err">\</code><code class="n">nstring</code><code class="err">`</code><code class="p">;</code>

<code class="n">console</code><code class="p">.</code><code class="n">log</code><code class="p">(</code><code class="n">message</code><code class="p">);</code>           <code class="c1">// "Multiline</code>
                                <code class="c1">//  string"</code>
<code class="n">console</code><code class="p">.</code><code class="n">log</code><code class="p">(</code><code class="n">message</code><code class="p">.</code><code class="n">length</code><code class="p">);</code>    <code class="c1">// 16</code>
</pre></div>

            </figure>

        </aside>

        <h4 id="leanpub-auto-substitutions">Substitutions</h4>

        <p>To this point, template strings may look like a fancier way of defining normal JavaScript strings. The real difference is with template string substitutions. Substitutions allow you to embed any valid JavaScript expression inside of a template string and have the result be output as part of the string.</p>

        <p>Substitutions are delimited by an opening <code>${</code> and a closing <code>}</code>, within which you can use any JavaScript expression. At its simplest, substitutions let you embed local variables directly into the result string, like this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">name</code> <code class="o">=</code> <code class="s2">"Nicholas"</code><code class="p">,</code>
    <code class="nx">message</code> <code class="o">=</code> <code class="err">`</code><code class="nx">Hello</code><code class="p">,</code> <code class="nx">$</code><code class="p">{</code><code class="nx">name</code><code class="p">}.</code><code class="err">`</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">);</code>       <code class="c1">// "Hello, Nicholas."</code>
</pre></div>

        </figure>

        <p>The substitution <code>${name}</code> accessed the local variable <code>name</code> to insert it into the string. The <code>message</code> variable then holds the result of the substitution immediately.</p>

        <aside class="information blurb">
            <p>Template strings can access any variable that is accessible in the scope in which it is defined. Attempting to use an undeclared variable in a template string results in an error being thrown in both strict and non-strict modes.</p>

        </aside>

        <p>Since all substitutions are JavaScript expressions, it’s possible to substitute more than just simple variable names. You can easily embed calculations, function calls, and more. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">count</code> <code class="o">=</code> <code class="mi">10</code><code class="p">,</code>
    <code class="nx">price</code> <code class="o">=</code> <code class="mf">0.25</code><code class="p">,</code>
    <code class="nx">message</code> <code class="o">=</code> <code class="err">`</code><code class="nx">$</code><code class="p">{</code><code class="nx">count</code><code class="p">}</code> <code class="nx">items</code> <code class="nx">cost</code> <code class="nx">$$</code><code class="p">{(</code><code class="nx">count</code> <code class="o">*</code> <code class="nx">price</code><code class="p">).</code><code class="nx">toFixed</code><code class="p">(</code><code class="mi">2</code><code class="p">)}.</code><code class="err">`</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">);</code>       <code class="c1">// "10 items cost $2.50."</code>
</pre></div>

        </figure>

        <p>This code performs a calculation as part of the template string. The variables <code>count</code> and <code>price</code> are multiplied together to get a result, and then formatted to two decimal places using <code>.toFixed()</code>. The dollar sign before the second substitution is output as-is because it’s not followed by an opening curly brace.</p>

        <h4 id="leanpub-auto-tagged-templates">Tagged Templates</h4>

        <p>To this point, you’ve seen how template strings can be used for multiline strings and to insert values into strings without using concatenation. The real power of template strings comes from tagged templates. A <em>template tag</em> performs a transformation on the template string and returns the final string value. This tag is specified at the start of the template, just before the first <code>`</code> character, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">message</code> <code class="o">=</code> <code class="nx">tag</code><code class="err">`</code><code class="nx">Hello</code> <code class="nx">world</code><code class="err">`</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>In this example, <code>tag</code> is the template tag to apply to <code>`Hello world`</code>.</p>

        <h5 id="leanpub-auto-defining-tags">Defining Tags</h5>

        <p>A tag is simply a function that is called with the processed template string data. The function receives data about the template string as individual pieces that the tag must then combined to create the finished value. The first argument is an array containing the literal strings as they are interpreted by JavaScript. Each subsequent argument is the interpreted value of each substitution. Tag functions are typically defined using rest arguments to make dealing with the data easier:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">tag</code><code class="p">(</code><code class="nx">literals</code><code class="p">,</code> <code class="p">...</code><code class="nx">substitutions</code><code class="p">)</code> <code class="p">{</code>
    <code class="c1">// return a string</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>To better understand what is passed to tags, consider the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">count</code> <code class="o">=</code> <code class="mi">10</code><code class="p">,</code>
    <code class="nx">price</code> <code class="o">=</code> <code class="mf">0.25</code><code class="p">,</code>
    <code class="nx">message</code> <code class="o">=</code> <code class="nx">passthru</code><code class="err">`</code><code class="nx">$</code><code class="p">{</code><code class="nx">count</code><code class="p">}</code> <code class="nx">items</code> <code class="nx">cost</code> <code class="nx">$$</code><code class="p">{(</code><code class="nx">count</code> <code class="o">*</code> <code class="nx">price</code><code class="p">).</code><code class="nx">toFixed</code><code class="p">(</code><code class="mi">2</code><code class="p">)}.</code><code class="err">`</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>If you had a function called <code>passthru()</code>, that function would receive three arguments:</p>

        <ol class="numeric">
            <li>
                <code>literals</code>, containing:
                <ul>
                    <li>
                        <code>""</code> - the empty string before the first substitution</li>
                    <li>
                        <code>" items cost $"</code> - the string after the first substitution and before the second</li>
                    <li>
                        <code>"."</code> - the string after the second substitution</li>
                </ul>
            </li>
            <li>
                <code>10</code> - the interpreted value for <code>count</code> (this becomes <code>substitutions[0]</code>)</li>
            <li>
                <code>"2.50"</code> - the interpreted value for <code>(count * price).toFixed(2)</code> (this becomes <code>substitutions[1]</code>)</li>
        </ol>

        <p>Note that the first item in <code>literals</code> is an empty string. This is to ensure that <code>literals[0]</code> is always the start of the string, just like <code>literals[literals.length - 1]</code> is always the end of the string. There is always one fewer substitution than literal, which is to say that <code>substitutions.length === literals.length - 1</code> all the time.</p>

        <p>Using this pattern, the <code>literals</code> and <code>substitutions</code> arrays can be interweaved to create the result. The first item in <code>literals</code> comes first, then the first item in <code>substitutions</code>, and so on, until the string has been completed. So to mimic the default behavior of template, you need only define a function that performs this operation:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">passthru</code><code class="p">(</code><code class="nx">literals</code><code class="p">,</code> <code class="p">...</code><code class="nx">substitutions</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">result</code> <code class="o">=</code> <code class="s2">""</code><code class="p">;</code>

    <code class="c1">// run the loop only for the substitution count</code>
    <code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">substitutions</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">result</code> <code class="o">+=</code> <code class="nx">literals</code><code class="p">[</code><code class="nx">i</code><code class="p">];</code>
        <code class="nx">result</code> <code class="o">+=</code> <code class="nx">substitutions</code><code class="p">[</code><code class="nx">i</code><code class="p">];</code>
    <code class="p">}</code>

    <code class="c1">// add the last literal</code>
    <code class="nx">result</code> <code class="o">+=</code> <code class="nx">literals</code><code class="p">[</code><code class="nx">literals</code><code class="p">.</code><code class="nx">length</code> <code class="o">-</code> <code class="mi">1</code><code class="p">];</code>

    <code class="k">return</code> <code class="nx">result</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">count</code> <code class="o">=</code> <code class="mi">10</code><code class="p">,</code>
    <code class="nx">price</code> <code class="o">=</code> <code class="mf">0.25</code><code class="p">,</code>
    <code class="nx">message</code> <code class="o">=</code> <code class="nx">passthru</code><code class="err">`</code><code class="nx">$</code><code class="p">{</code><code class="nx">count</code><code class="p">}</code> <code class="nx">items</code> <code class="nx">cost</code> <code class="nx">$$</code><code class="p">{(</code><code class="nx">count</code> <code class="o">*</code> <code class="nx">price</code><code class="p">).</code><code class="nx">toFixed</code><code class="p">(</code><code class="mi">2</code><code class="p">)}.</code><code class="err">`</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">);</code>       <code class="c1">// "10 items cost $2.50."</code>
</pre></div>

        </figure>

        <p>This example defines a <code>passthru</code> tag that performs the same transformation as the default template string behavior. The only trick is to use <code>substitutions.length</code> for the loop rather than <code>literals.length</code> to avoid accidentally going past the end of <code>substitutions</code>. This works because the relationship between <code>literals</code> and <code>substitutions</code> is well-defined.</p>

        <aside class="information blurb">
            <p>The values contained in <code>substitutions</code> are not necessarily strings. If an expression is evaluated to be a number, as in the previous example, then the numeric value is passed in. It’s part of the tag’s job to determine how such values should be output in the result.</p>

        </aside>

        <h5 id="leanpub-auto-using-raw-values">Using Raw Values</h5>

        <p>Template tags also have access to raw string information, which primarily means access to character escapes before they are transformed into their character equivalents. The simplest way to work with raw string values is to the built-in <code>String.raw()</code> tag. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">message1</code> <code class="o">=</code> <code class="err">`</code><code class="nx">Multiline</code><code class="err">\</code><code class="nx">nstring</code><code class="err">`</code><code class="p">,</code>
    <code class="nx">message2</code> <code class="o">=</code> <code class="nb">String</code><code class="p">.</code><code class="nx">raw</code><code class="err">`</code><code class="nx">Multiline</code><code class="err">\</code><code class="nx">nstring</code><code class="err">`</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message1</code><code class="p">);</code>          <code class="c1">// "Multiline</code>
                                <code class="c1">//  string"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message2</code><code class="p">);</code>          <code class="c1">// "Multiline\\nstring"</code>
</pre></div>

        </figure>

        <p>In this code, the <code>\n</code> in <code>message1</code> is interpreted as a newline while the <code>\n</code> in <code>message2</code> is returned in its raw form of <code>"\\n"</code> (two characters, the slash and <code>n</code>). Retrieving the raw string information in this way allows for more complex processing (when necessary).</p>

        <p>The raw string information is also passed into template tags. The first argument in a tag function is an array with an extra property called <code>raw</code>. The <code>raw</code> property is an array containing the raw equivalent of each literal value. So the value in <code>literals[0]</code> always has an equivalent <code>literals.raw[0]</code> that contains the raw string information. Knowing that, it’s possible to mimic <code>String.raw()</code> using the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">raw</code><code class="p">(</code><code class="nx">literals</code><code class="p">,</code> <code class="p">...</code><code class="nx">substitutions</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">result</code> <code class="o">=</code> <code class="s2">""</code><code class="p">;</code>

    <code class="c1">// run the loop only for the substitution count</code>
    <code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">substitutions</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">result</code> <code class="o">+=</code> <code class="nx">literals</code><code class="p">.</code><code class="nx">raw</code><code class="p">[</code><code class="nx">i</code><code class="p">];</code>      <code class="c1">// use raw values instead</code>
        <code class="nx">result</code> <code class="o">+=</code> <code class="nx">substitutions</code><code class="p">[</code><code class="nx">i</code><code class="p">];</code>
    <code class="p">}</code>

    <code class="c1">// add the last literal</code>
    <code class="nx">result</code> <code class="o">+=</code> <code class="nx">literals</code><code class="p">.</code><code class="nx">raw</code><code class="p">[</code><code class="nx">literals</code><code class="p">.</code><code class="nx">length</code> <code class="o">-</code> <code class="mi">1</code><code class="p">];</code>

    <code class="k">return</code> <code class="nx">result</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">message</code> <code class="o">=</code> <code class="nx">raw</code><code class="err">`</code><code class="nx">Multiline</code><code class="err">\</code><code class="nx">nstring</code><code class="err">`</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">);</code>           <code class="c1">// "Multiline\\nstring"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>    <code class="c1">// 17</code>
</pre></div>

        </figure>

        <p>This example uses <code>literals.raw</code> instead of <code>literals</code> to output the string result. That means any character escapes, including Unicode code point escapes, will be returned in their raw form.</p>

        <h3 id="leanpub-auto-summary-2">Summary</h3>

        <p>Full Unicode support allows JavaScript to start dealing with UTF-16 characters in logical ways. The ability to transfer between code point and character via <code>codePointAt()</code> and <code>String.fromCodePoint()</code> is an important step for string manipulation. The addition of the regular expression <code>u</code> flag makes it possible to operate on code points instead of 16-bit characters, and the <code>normalize()</code> method allows for more appropriate string comparisons.</p>

        <p>Additional methods for working with strings were added, allowing you to more easily identify substrings no matter where they are found, and more functionality was added to regular expressions.</p>

        <p>Template strings are an important addition to ECMAScript 6 that allows the creating of domain-specific languages (DSLs) to make creating strings easier. The ability to embed variables directly into template strings means that developers have a safer tool than string concatenation for composing long strings with variables.</p>

        <p>Built-in support for multiline strings also makes template strings a useful upgrade over normal JavaScript strings, which have never had this ability. Despite allowing newlines directly inside the template string, you can still use <code>\n</code> and other character escape sequences.</p>

        <p>Template tags are the most important part of this feature for creating DSLs. Tags are functions that receive the pieces of the template string as arguments. You can then use that data to return an appropriate string value. The data provided includes literals, their raw equivalents, and any substitution values. These pieces of information can then be used to determine the correct output for the tag.</p>

        <h2 id="leanpub-auto-functions">Functions</h2>

        <p>Functions are an important part of any programming language, and JavaScript functions hadn’t changed much since the language was first introduced. This left a backlog of problems and nuanced behavior that made it easy to make mistakes or require more code just to achieve a very common behavior.</p>

        <p>ECMAScript 6 functions made a big leap forward, taking into account years of complaints and asks from JavaScript developers. The result is a number of incremental improvements on top of ECMAScript 5 functions that make programming in JavaScript less error-prone and more powerful than ever before.</p>

        <h3 id="leanpub-auto-default-parameters">Default Parameters</h3>

        <p>Functions in JavaScript are unique in that they allow any number of parameters to be passed regardless of the number of declared parameters in the function definition. This allows you to define functions that can handle different number of parameters, often by just filling in default values when ones aren’t provided. In ECMAScript 5 and earlier, you would likely use the following pattern to accomplish this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">makeRequest</code><code class="p">(</code><code class="nx">url</code><code class="p">,</code> <code class="nx">timeout</code><code class="p">,</code> <code class="nx">callback</code><code class="p">)</code> <code class="p">{</code>

    <code class="nx">timeout</code> <code class="o">=</code> <code class="nx">timeout</code> <code class="o">||</code> <code class="mi">2000</code><code class="p">;</code>
    <code class="nx">callback</code> <code class="o">=</code> <code class="nx">callback</code> <code class="o">||</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{};</code>

    <code class="c1">// the rest of the function</code>

<code class="p">}</code>
</pre></div>

        </figure>

        <p>In this example, both <code>timeout</code> and <code>callback</code> are actually optional because they are given a default value if not provided. The logical OR operator (<code>||</code>) always returns the second operand when the first is falsy. Since named function parameters that are not explicitly provided are set to <code>undefined</code>, the logical OR operator is frequently used to provide default values for missing parameters. There is a flaw with this approach, however, in that a valid value for <code>timeout</code> might actually be <code>0</code>, but this would replace it with <code>2000</code> because <code>0</code> is falsy.</p>

        <p>Other ways of determining if any parameters are missing include checking <code>arguments.length</code> for the number of parameters that were passed or directly inspecting each parameter to see if it is not <code>undefined</code>.</p>

        <p>ECMAScript 6 makes it easier to provide default values for parameters by providing initializations that are used when the parameter isn’t formally passed. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">makeRequest</code><code class="p">(</code><code class="nx">url</code><code class="p">,</code> <code class="nx">timeout</code> <code class="o">=</code> <code class="mi">2000</code><code class="p">,</code> <code class="nx">callback</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{})</code> <code class="p">{</code>

    <code class="c1">// the rest of the function</code>

<code class="p">}</code>
</pre></div>

        </figure>

        <p>Here, only the first parameter is expected to be passed all the time. The other two parameters have default values, which makes the body of the function much smaller because you don’t need to add any code to check for a missing value. When <code>makeRequest()</code> is called with all three parameters, then the defaults are not used. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// uses default timeout and callback</code>
<code class="nx">makeRequest</code><code class="p">(</code><code class="s2">"/foo"</code><code class="p">);</code>

<code class="c1">// uses default callback</code>
<code class="nx">makeRequest</code><code class="p">(</code><code class="s2">"/foo"</code><code class="p">,</code> <code class="mi">500</code><code class="p">);</code>

<code class="c1">// doesn't use defaults</code>
<code class="nx">makeRequest</code><code class="p">(</code><code class="s2">"/foo"</code><code class="p">,</code> <code class="mi">500</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">body</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">doSomething</code><code class="p">(</code><code class="nx">body</code><code class="p">);</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>Any parameters with a default value are considered to be optional parameters while those without a default value are considered to be required parameters.</p>

        <p>It’s possible to specify default values for any arguments, including those that appear before arguments without default values. For example, this is fine:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">makeRequest</code><code class="p">(</code><code class="nx">url</code><code class="p">,</code> <code class="nx">timeout</code> <code class="o">=</code> <code class="mi">2000</code><code class="p">,</code> <code class="nx">callback</code><code class="p">)</code> <code class="p">{</code>

    <code class="c1">// the rest of the function</code>

<code class="p">}</code>
</pre></div>

        </figure>

        <p>In this case, the default value for <code>timeout</code> will only be used if there is no second argument passed in or if the second argument is explicitly passed in as <code>undefined</code>. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// uses default timeout</code>
<code class="nx">makeRequest</code><code class="p">(</code><code class="s2">"/foo"</code><code class="p">,</code> <code class="kc">undefined</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">body</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">doSomething</code><code class="p">(</code><code class="nx">body</code><code class="p">);</code>
<code class="p">});</code>

<code class="c1">// uses default timeout</code>
<code class="nx">makeRequest</code><code class="p">(</code><code class="s2">"/foo"</code><code class="p">);</code>

<code class="c1">// doesn't use default timeout</code>
<code class="nx">makeRequest</code><code class="p">(</code><code class="s2">"/foo"</code><code class="p">,</code> <code class="kc">null</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">body</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">doSomething</code><code class="p">(</code><code class="nx">body</code><code class="p">);</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In the case of default parameter values, the value of <code>null</code> is considered to be valid and the default value will not be used.</p>

        <p>Perhaps the most interesting feature of default parameter values is that the default value need not be a primitive value. You can, for example, execute a function to retrieve the default parameter:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">getCallback</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
        <code class="c1">// some code</code>
    <code class="p">};</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="nx">makeRequest</code><code class="p">(</code><code class="nx">url</code><code class="p">,</code> <code class="nx">timeout</code> <code class="o">=</code> <code class="mi">2000</code><code class="p">,</code> <code class="nx">callback</code> <code class="o">=</code> <code class="nx">getCallback</code><code class="p">())</code> <code class="p">{</code>

    <code class="c1">// the rest of the function</code>

<code class="p">}</code>
</pre></div>

        </figure>

        <p>Here, if the last argument isn’t provided, the function <code>getCallback()</code> is called to retrieve the correct default value. This opens up a lot of interesting possibilities to dynamically inject information into functions.</p>

        <h3 id="leanpub-auto-rest-parameters">Rest Parameters</h3>

        <p>Since JavaScript functions can be passed any number of parameters, it’s not always necessary to define each parameter specifically. Early on, JavaScript provided the <code>arguments</code> object as a way of inspecting all function parameters that were passed without necessarily defining each one individually. While that worked fine in most cases, it can become a little cumbersome to work with. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">pick</code><code class="p">(</code><code class="nx">object</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">result</code> <code class="o">=</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">create</code><code class="p">(</code><code class="kc">null</code><code class="p">);</code>

    <code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code> <code class="nx">len</code> <code class="o">=</code> <code class="nx">arguments</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">len</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">result</code><code class="p">[</code><code class="nx">arguments</code><code class="p">[</code><code class="nx">i</code><code class="p">]]</code> <code class="o">=</code> <code class="nx">object</code><code class="p">[</code><code class="nx">arguments</code><code class="p">[</code><code class="nx">i</code><code class="p">]];</code>
    <code class="p">}</code>

    <code class="k">return</code> <code class="nx">result</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">book</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">title</code><code class="o">:</code> <code class="s2">"Understanding ECMAScript 6"</code><code class="p">,</code>
    <code class="nx">author</code><code class="o">:</code> <code class="s2">"Nicholas C. Zakas"</code><code class="p">,</code>
    <code class="nx">year</code><code class="o">:</code> <code class="mi">2015</code>
<code class="p">};</code>

<code class="kd">let</code> <code class="nx">bookData</code> <code class="o">=</code> <code class="nx">pick</code><code class="p">(</code><code class="nx">book</code><code class="p">,</code> <code class="s2">"author"</code><code class="p">,</code> <code class="s2">"year"</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">bookData</code><code class="p">.</code><code class="nx">author</code><code class="p">);</code>   <code class="c1">// "Nicholas C. Zakas"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">bookData</code><code class="p">.</code><code class="nx">year</code><code class="p">);</code>     <code class="c1">// 2015</code>
</pre></div>

        </figure>

        <p>This function mimics the <code>pick()</code> method from Underscore. The first argument is the object from which to copy properties and every other argument is the name of a property that should be copied on the result. There are couple of things to notice about this function. First, it’s not at all obvious that the function is capable of handling more than one parameter. You could add in several more named parameters, but you would always fall short of indicating that this function can take any number of parameters. Second, because the first parameter is named and used directly, you have to start looking in the <code>arguments</code> object at index 1 instead of starting at index 0. Remembering to use the appropriate indices with <code>arguments</code> isn’t necessarily difficult, but it’s one more thing to keep track of. ECMAScript 6 introduces rest parameters to help with these issues.</p>

        <p>Rest parameters are indicated by three dots (<code>...</code>) preceding a named parameter. That named parameter then becomes an <code>Array</code> containing the rest of the parameters (which is why these are called “rest” parameters). For example, <code>pick()</code> can be rewritten using rest parameters like this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">pick</code><code class="p">(</code><code class="nx">object</code><code class="p">,</code> <code class="p">...</code><code class="nx">keys</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">result</code> <code class="o">=</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">create</code><code class="p">(</code><code class="kc">null</code><code class="p">);</code>

    <code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="nx">len</code> <code class="o">=</code> <code class="nx">keys</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">len</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">result</code><code class="p">[</code><code class="nx">keys</code><code class="p">[</code><code class="nx">i</code><code class="p">]]</code> <code class="o">=</code> <code class="nx">object</code><code class="p">[</code><code class="nx">keys</code><code class="p">[</code><code class="nx">i</code><code class="p">]];</code>
    <code class="p">}</code>

    <code class="k">return</code> <code class="nx">result</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>In this version of the function, <code>keys</code> is a rest parameter that contains all parameters after the first one (unlike <code>arguments</code>, which contains all parameters including the first one). That means you can iterate over <code>keys</code> from beginning to end without worry. As a bonus, you can tell by looking at the function that it is capable of handling any number of parameters.</p>

        <p>The only restriction on rest parameters is that no other named arguments can follow in the function declaration. For example, this causes syntax error:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// Syntax error: Can't have a named parameter after rest parameters</code>
<code class="kd">function</code> <code class="nx">pick</code><code class="p">(</code><code class="nx">object</code><code class="p">,</code> <code class="p">...</code><code class="nx">keys</code><code class="p">,</code> <code class="nx">last</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">result</code> <code class="o">=</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">create</code><code class="p">(</code><code class="kc">null</code><code class="p">);</code>

    <code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="nx">len</code> <code class="o">=</code> <code class="nx">keys</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">len</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">result</code><code class="p">[</code><code class="nx">keys</code><code class="p">[</code><code class="nx">i</code><code class="p">]]</code> <code class="o">=</code> <code class="nx">object</code><code class="p">[</code><code class="nx">keys</code><code class="p">[</code><code class="nx">i</code><code class="p">]];</code>
    <code class="p">}</code>

    <code class="k">return</code> <code class="nx">result</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>Here, the parameter <code>last</code> follows the rest parameter <code>keys</code> and causes a syntax error.</p>

        <p>Rest parameters were designed to replace <code>arguments</code> in ECMAScript. Originally ECMAScript 4 did away with <code>arguments</code> and added rest parameters to allow for an unlimited number of arguments to be passed to functions. Even though ECMAScript 4 never came into being, the idea was kept around and reintroduced in ECMAScript 6 despite <code>arguments</code> not being removed from the language.</p>

        <h3 id="leanpub-auto-destructured-parameters">Destructured Parameters</h3>

        <p>In Chapter 1, you learned about destructuring assignment. Destructuring can also be used outside of the context of an assignment expression and perhaps the most interesting such case is with destructured parameters.</p>

        <p>It’s common for functions that take a large number of optional parameters to use an options object as one or more parameters. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">setCookie</code><code class="p">(</code><code class="nx">name</code><code class="p">,</code> <code class="nx">value</code><code class="p">,</code> <code class="nx">options</code><code class="p">)</code> <code class="p">{</code>

    <code class="nx">options</code> <code class="o">=</code> <code class="nx">options</code> <code class="o">||</code> <code class="p">{};</code>

    <code class="kd">var</code> <code class="nx">secure</code> <code class="o">=</code> <code class="nx">options</code><code class="p">.</code><code class="nx">secure</code><code class="p">,</code>
        <code class="nx">path</code> <code class="o">=</code> <code class="nx">options</code><code class="p">.</code><code class="nx">path</code><code class="p">,</code>
        <code class="nx">domain</code> <code class="o">=</code> <code class="nx">options</code><code class="p">.</code><code class="nx">domain</code><code class="p">,</code>
        <code class="nx">expires</code> <code class="o">=</code> <code class="nx">options</code><code class="p">.</code><code class="nx">expires</code><code class="p">;</code>

    <code class="c1">// ...</code>
<code class="p">}</code>

<code class="nx">setCookie</code><code class="p">(</code><code class="s2">"type"</code><code class="p">,</code> <code class="s2">"js"</code><code class="p">,</code> <code class="p">{</code>
    <code class="nx">secure</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
    <code class="nx">expires</code><code class="o">:</code> <code class="mi">60000</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>There are many <code>setCookie()</code> functions in JavaScript libraries that look similar to this. The <code>name</code> and <code>value</code> are required but everything else is not. And since there is no priority order for the other data, it makes sense to have an options object with named properties rather than extra named parameters. This approach is okay, although it makes the expected input for the function a bit opaque.</p>

        <p>Using destructured parameters, the previous function can be rewritten as follows:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">setCookie</code><code class="p">(</code><code class="nx">name</code><code class="p">,</code> <code class="nx">value</code><code class="p">,</code> <code class="p">{</code> <code class="nx">secure</code><code class="p">,</code> <code class="nx">path</code><code class="p">,</code> <code class="nx">domain</code><code class="p">,</code> <code class="nx">expires</code> <code class="p">})</code> <code class="p">{</code>

    <code class="c1">// ...</code>
<code class="p">}</code>

<code class="nx">setCookie</code><code class="p">(</code><code class="s2">"type"</code><code class="p">,</code> <code class="s2">"js"</code><code class="p">,</code> <code class="p">{</code>
    <code class="nx">secure</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
    <code class="nx">expires</code><code class="o">:</code> <code class="mi">60000</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>The behavior of this function is similar to the previous example, the biggest difference is the third argument uses destructuring to pull out the necessary data. Doing so makes it clear which parameters are really expected, and the destructured parameters also act like regular parameters in that they are set to <code>undefined</code> if they are not passed.</p>

        <p>One quirk of this pattern is that the destructured parameters throw an error when the argument isn’t provided. If <code>setCookie()</code> is called with just two arguments, it results in a runtime error:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// Error!</code>
<code class="nx">setCookie</code><code class="p">(</code><code class="s2">"type"</code><code class="p">,</code> <code class="s2">"js"</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>This code throws an error because the third argument is missing (<code>undefined</code>). To understand why this is an error, it helps to understand that destructured parameters are really just a shorthand for destructured assignment. The JavaScript engine is actually doing this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">setCookie</code><code class="p">(</code><code class="nx">name</code><code class="p">,</code> <code class="nx">value</code><code class="p">,</code> <code class="nx">options</code><code class="p">)</code> <code class="p">{</code>

    <code class="kd">var</code> <code class="p">{</code> <code class="nx">secure</code><code class="p">,</code> <code class="nx">path</code><code class="p">,</code> <code class="nx">domain</code><code class="p">,</code> <code class="nx">expires</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">options</code><code class="p">;</code>

    <code class="c1">// ...</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>Since destructuring assignment throws an error when the right side expression evaluates to <code>null</code> or <code>undefined</code>, the same is true when the third argument isn’t passed.</p>

        <p>You can work around this behavior by providing a default value for the destructured parameter:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">setCookie</code><code class="p">(</code><code class="nx">name</code><code class="p">,</code> <code class="nx">value</code><code class="p">,</code> <code class="p">{</code> <code class="nx">secure</code><code class="p">,</code> <code class="nx">path</code><code class="p">,</code> <code class="nx">domain</code><code class="p">,</code> <code class="nx">expires</code> <code class="p">}</code> <code class="o">=</code> <code class="p">{})</code> <code class="p">{</code>

    <code class="c1">// ...</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This example now works exactly the same as the first example in this section. Providing the default value for the destructured parameter means that <code>secure</code>, <code>path</code>, <code>domain</code>, and <code>expires</code> will all be <code>undefined</code> if the third argument to <code>setCookie()</code> isn’t provided.</p>

        <aside class="information blurb">
            <p>It’s recommended to always provide the default value for destructured parameters to avoid these types of errors.</p>

        </aside>

        <h3 id="leanpub-auto-the-spread-operator">The Spread Operator</h3>

        <p>Closely related to rest parameters is the spread operator. Whereas rest parameters allow you to specify that multiple independent arguments should be combined into an array, the spread operator allows you to specify an array that should be split and have its items passed in as separate arguments to a function. Consider the <code>Math.max()</code> method, which accepts any number of arguments and returns the one with the highest value. It’s basic usage is as follows:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">value1</code> <code class="o">=</code> <code class="mi">25</code><code class="p">,</code>
    <code class="nx">value2</code> <code class="o">=</code> <code class="mi">50</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Math</code><code class="p">.</code><code class="nx">max</code><code class="p">(</code><code class="nx">value1</code><code class="p">,</code> <code class="nx">value2</code><code class="p">));</code>      <code class="c1">// 50</code>
</pre></div>

        </figure>

        <p>When you’re dealing with just two values, as in this example, <code>Math.max()</code> is very easy to use. The two values are passed in and the higher value is returned. But what if you have been tracking values in an array, and now you want to find the highest value? The <code>Math.max()</code> method doesn’t allow you to pass in an array, so in ECMAScript 5 and earlier, you’d be stuck either searching the array yourself or using <code>apply()</code>:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">values</code> <code class="o">=</code> <code class="p">[</code><code class="mi">25</code><code class="p">,</code> <code class="mi">50</code><code class="p">,</code> <code class="mi">75</code><code class="p">,</code> <code class="mi">100</code><code class="p">]</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Math</code><code class="p">.</code><code class="nx">max</code><code class="p">.</code><code class="nx">apply</code><code class="p">(</code><code class="nb">Math</code><code class="p">,</code> <code class="nx">values</code><code class="p">));</code>  <code class="c1">// 100</code>
</pre></div>

        </figure>

        <p>While possible, using <code>apply()</code> in this manner is a bit confusing - it actually seems to obfuscate the true meaning of the code with additional syntax.</p>

        <p>The ECMAScript 6 spread operator makes this case very simple. Instead of calling <code>apply()</code>, you can pass in the array and prefix it with the same <code>...</code> pattern that is used with rest parameters. The JavaScript engine then splits up the array into individual arguments and passes them in:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">values</code> <code class="o">=</code> <code class="p">[</code><code class="mi">25</code><code class="p">,</code> <code class="mi">50</code><code class="p">,</code> <code class="mi">75</code><code class="p">,</code> <code class="mi">100</code><code class="p">]</code>

<code class="c1">// equivalent to</code>
<code class="c1">// console.log(Math.max(25, 50, 75, 100));</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Math</code><code class="p">.</code><code class="nx">max</code><code class="p">(...</code><code class="nx">values</code><code class="p">));</code>           <code class="c1">// 100</code>
</pre></div>

        </figure>

        <p>Now the call to <code>Math.max()</code> looks a bit more conventional and avoids the complexity of specifying a <code>this</code>-binding for a simple mathematical operation.</p>

        <p>You can mix and match the spread operator with other arguments as well. Suppose you want the smallest number returned from <code>Math.max()</code> to be 0 (just in case negative numbers sneak into the array). You can pass that argument separately and still use the spread operator for the other arguments:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">values</code> <code class="o">=</code> <code class="p">[</code><code class="o">-</code><code class="mi">25</code><code class="p">,</code> <code class="o">-</code><code class="mi">50</code><code class="p">,</code> <code class="o">-</code><code class="mi">75</code><code class="p">,</code> <code class="o">-</code><code class="mi">100</code><code class="p">]</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Math</code><code class="p">.</code><code class="nx">max</code><code class="p">(...</code><code class="nx">values</code><code class="p">,</code> <code class="mi">0</code><code class="p">));</code>        <code class="c1">// 0</code>
</pre></div>

        </figure>

        <p>In this example, the last argument passed to <code>Math.max()</code> is <code>0</code>, which comes after the other arguments are passed in using the spread operator.</p>

        <p>The spread operator for argument passing makes using arrays for function arguments much easier. You’ll likely find it to be a suitable replacement for the <code>apply()</code> method in most circumstances.</p>

        <h3 id="leanpub-auto-the-name-property">The name Property</h3>

        <p>Identifying functions can be challenging in JavaScript given the various ways a function can be defined. Additionally, the prevalence of anonymous function expressions makes debugging a bit more difficult, often resulting in stack traces that are hard to read and decipher. For these reasons, ECMAScript 6 adds the <code>name</code> property to all functions.</p>

        <p>All functions in an ECMAScript 6 program will have an appropriate value for their <code>name</code> property while all others will have an empty string. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">doSomething</code><code class="p">()</code> <code class="p">{</code>
    <code class="c1">// ...</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">doAnotherThing</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="c1">// ...</code>
<code class="p">};</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">doSomething</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>          <code class="c1">// "doSomething"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">doAnotherThing</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>       <code class="c1">// "doAnotherThing"</code>
</pre></div>

        </figure>

        <p>In this code, <code>doSomething()</code> has a <code>name</code> property equal to <code>"doSomething"</code> because it’s a function declaration. The anonymous function expression <code>doAnotherThing()</code> has a <code>name</code> of <code>"doAnotherThing"</code> due to the variable to which it is assigned.</p>

        <p>While appropriate names for function declarations and function expressions are easy to find, ECMAScript 6 goes further to ensure that all functions have appropriate names:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">doSomething</code> <code class="o">=</code> <code class="kd">function</code> <code class="nx">doSomethingElse</code><code class="p">()</code> <code class="p">{</code>
    <code class="c1">// ...</code>
<code class="p">};</code>

<code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">get</code> <code class="nx">firstName</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="s2">"Nicholas"</code>
    <code class="p">},</code>
    <code class="nx">sayName</code><code class="o">:</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">doSomething</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>      <code class="c1">// "doSomethingElse"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">.</code><code class="nx">sayName</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>   <code class="c1">// "sayName"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">.</code><code class="nx">firstName</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code> <code class="c1">// "get firstName"</code>
</pre></div>

        </figure>

        <p>In this example, <code>doSomething.name</code> is <code>"doSomethingElse"</code> because the function expression itself has a name and that name takes priority over the variable to which the function was assigned. The <code>name</code> property of <code>person.sayName()</code> is <code>"sayName"</code>, as the value was interpreted from the object literal. Similarly, <code>person.firstName</code> is actually a getter function, so its name is <code>"get firstName"</code> to indicate this difference (setter functions are prefixed with <code>"set"</code> as well).</p>

        <p>There are a couple of other special cases for function names. Functions created using <code>bind()</code> will have their name prefixed with <code>"bound"</code> and functions created using the <code>Function</code> constructor have a name of <code>"anonymous"</code>:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">doSomething</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="c1">// ...</code>
<code class="p">};</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">doSomething</code><code class="p">.</code><code class="nx">bind</code><code class="p">().</code><code class="nx">name</code><code class="p">);</code>   <code class="c1">// "bound doSomething"</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">((</code><code class="k">new</code> <code class="nb">Function</code><code class="p">()).</code><code class="nx">name</code><code class="p">);</code>     <code class="c1">// "anonymous"</code>
</pre></div>

        </figure>

        <p>The <code>name</code> of a bound function will always be the <code>name</code> of the function being bound prefixed with the <code>"bound "</code>, so the bound version of <code>doSomething()</code> is <code>"bound doSomething"</code>.</p>

        <h3 id="leanpub-auto-newtarget-call-and-construct">new.target, [[Call]], and [[Construct]]</h3>

        <p>In ECMAScript 5 and earlier, functions serve the double purpose of being callable with or without <code>new</code>. When used with <code>new</code>, the <code>this</code> value inside of a function is a new object and that new object is returned. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">Person</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>
<code class="kd">var</code> <code class="nx">notAPerson</code> <code class="o">=</code> <code class="nx">Person</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">);</code>        <code class="c1">// "[Object object]"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">notAPerson</code><code class="p">);</code>    <code class="c1">// "undefined"</code>
</pre></div>

        </figure>

        <p>Calling <code>Person()</code> without <code>new</code> results in <code>undefined</code> (and a <code>name</code> property being set on the global object in non-strict mode). It’s fairly obvious from the code that the intent is to use <code>Person</code> with <code>new</code> to create a new object. The confusion over the dual roles of functions led to some changes in ECMAScript 6.</p>

        <p>First, the specification defines two different internal-only methods that every function has: <code>[[Call]]</code> and <code>[[Construct]]</code>. When a function is called without <code>new</code>, the <code>[[Call]]</code> method is executed, which essentially executes the body of the function as it appears in the code. When a function is called with <code>new</code>, that’s when the <code>[[Construct]]</code> method is called. The <code>[[Construct]]</code> method is responsible for creating a new object, called the <em>new target</em>, and then executing the function body with <code>this</code> set to the new target. Functions that have a <code>[[Construct]]</code> method are called <em>constructors</em>.</p>

        <aside class="information blurb">
            <p>Keep in mind that not all functions have <code>[[Construct]]</code>, and therefore not all function can be called with <code>new</code>. Arrow functions, discussed later in this chapter, do not have a <code>[[Construct]]</code> method.</p>

        </aside>

        <p>The most popular way to determine if a function was called with <code>new</code> in ECMAScript 5 is to use <code>instanceof</code>, for example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">Person</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">if</code> <code class="p">(</code><code class="k">this</code> <code class="k">instanceof</code> <code class="nx">Person</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>   <code class="c1">// using new</code>
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
        <code class="k">throw</code> <code class="k">new</code> <code class="nb">Error</code><code class="p">(</code><code class="s2">"You must use new with Person."</code><code class="p">)</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>
<code class="kd">var</code> <code class="nx">notAPerson</code> <code class="o">=</code> <code class="nx">Person</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>  <code class="c1">// throws error</code>
</pre></div>

        </figure>

        <p>Here, the <code>this</code> value is checked to see if it’s an instance of the constructor, and if so, it continues as normal. If <code>this</code> isn’t an instance of <code>Person</code>, then an error is thrown. This works because the <code>[[Construct]]</code> method creates a new instance of <code>Person</code> and assigns it to <code>this</code>. Unfortunately, this approach is not completely reliable because <code>this</code> can be an instance of <code>Person</code> without using <code>new</code>, for example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">Person</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">if</code> <code class="p">(</code><code class="k">this</code> <code class="k">instanceof</code> <code class="nx">Person</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>   <code class="c1">// using new</code>
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
        <code class="k">throw</code> <code class="k">new</code> <code class="nb">Error</code><code class="p">(</code><code class="s2">"You must use new with Person."</code><code class="p">)</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>
<code class="kd">var</code> <code class="nx">notAPerson</code> <code class="o">=</code> <code class="nx">Person</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="nx">person</code><code class="p">,</code> <code class="s2">"Michael"</code><code class="p">);</code>    <code class="c1">// works!</code>
</pre></div>

        </figure>

        <p>The call to <code>Person.call()</code> passes the <code>person</code> variable as the first argument, which means <code>this</code> is set to <code>person</code> inside of the <code>Person</code> function. To the function, there’s no way to distinguish this from being called with <code>new</code>.</p>

        <p>To solve this problem, ECMAScript 6 introduces the <code>new.target</code> <em>metaproperty</em>. When a function’s <code>[[Construct]]</code> method is called, <code>new.target</code> is filled with the target of the <code>new</code> operator, which is typically the constructor of the newly created object instance that will become <code>this</code> inside the function body. If <code>[[Call]]</code> is executed, then <code>new.target</code> is <code>undefined</code>. That means you can now safely detect if a function is called with <code>new</code> by checking that <code>new.target</code> is defined:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">Person</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">if</code> <code class="p">(</code><code class="k">typeof</code> <code class="k">new</code><code class="p">.</code><code class="nx">target</code> <code class="o">!==</code> <code class="s2">"undefined"</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>   <code class="c1">// using new</code>
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
        <code class="k">throw</code> <code class="k">new</code> <code class="nb">Error</code><code class="p">(</code><code class="s2">"You must use new with Person."</code><code class="p">)</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>
<code class="kd">var</code> <code class="nx">notAPerson</code> <code class="o">=</code> <code class="nx">Person</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="nx">person</code><code class="p">,</code> <code class="s2">"Michael"</code><code class="p">);</code>    <code class="c1">// error!</code>
</pre></div>

        </figure>

        <p>By using <code>new.target</code> instead of <code>this instanceof Person</code>, the <code>Person</code> constructor is now correctly throwing an error when used without <code>new</code>.</p>

        <p>You can also check that <code>new.target</code> was called with a specific constructor, for instance:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">Person</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">if</code> <code class="p">(</code><code class="k">typeof</code> <code class="k">new</code><code class="p">.</code><code class="nx">target</code> <code class="o">===</code> <code class="nx">Person</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>   <code class="c1">// using new</code>
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
        <code class="k">throw</code> <code class="k">new</code> <code class="nb">Error</code><code class="p">(</code><code class="s2">"You must use new with Person."</code><code class="p">)</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="nx">AnotherPerson</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">Person</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="k">this</code><code class="p">,</code> <code class="nx">name</code><code class="p">);</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>
<code class="kd">var</code> <code class="nx">anotherPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">AnotherPerson</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>  <code class="c1">// error!</code>
</pre></div>

        </figure>

        <p>In this example, <code>new.target</code> must be <code>Person</code> in order to work correctly. When <code>new AnotherPerson("Nicholas")</code> is called, <code>new.target</code> is set to <code>AnotherPerson</code>, so the subsequent call to <code>Person.call(this, name)</code> will throw an error even though <code>new.target</code> is defined.</p>

        <aside class="warning blurb">
            <p>Using <code>new.target</code> outside of a function is a syntax error.</p>

        </aside>

        <h3 id="leanpub-auto-block-level-functions">Block-Level Functions</h3>

        <p>In ECMAScript 3 and earlier, a function declaration occurring inside of a block (a <em>block-level function</em>) was technically a syntax error, but many browsers still supported it. Unfortunately, each browser that allowed the syntax behaved in a slightly different way, so it is considered a best practice to avoid function declarations inside of blocks (the best alternative is to use a function expression).</p>

        <p>In an attempt to reign in this incompatible behavior, ECMAScript 5 strict mode introduced an error whenever a function declaration was used inside of a block. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="s2">"use strict"</code><code class="p">;</code>

<code class="k">if</code> <code class="p">(</code><code class="kc">true</code><code class="p">)</code> <code class="p">{</code>

    <code class="c1">// Throws a syntax error in ES5, not so in ES6</code>
    <code class="kd">function</code> <code class="nx">doSomething</code><code class="p">()</code> <code class="p">{</code>
        <code class="c1">// ...</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>In ECMAScript 5, this code throws a syntax error. In ECMAScript 6, the <code>doSomething()</code> function is considered a block-level declaration and can be accessed and called within the same block in which it was defined. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="s2">"use strict"</code><code class="p">;</code>

<code class="k">if</code> <code class="p">(</code><code class="kc">true</code><code class="p">)</code> <code class="p">{</code>

    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">doSomething</code><code class="p">);</code>        <code class="c1">// "function"</code>

    <code class="kd">function</code> <code class="nx">doSomething</code><code class="p">()</code> <code class="p">{</code>
        <code class="c1">// ...</code>
    <code class="p">}</code>

    <code class="nx">doSomething</code><code class="p">();</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">doSomething</code><code class="p">);</code>            <code class="c1">// "undefined"</code>
</pre></div>

        </figure>

        <p>Block level functions are hoisted to the top of the block in which they are defined, so <code>typeof doSomething</code> returns <code>"function"</code> even though it appears before the function declaration in the code. Once the <code>if</code> block is finished executing, <code>doSomething()</code> no longer exists.</p>

        <p>Block level functions are a similar to <code>let</code> function expressions in that the function definition is removed once execution flows out of the block in which it’s defined. The key difference is that block level functions are hoisted to the top of the containing block while <code>let</code> function expressions are not hoisted. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="s2">"use strict"</code><code class="p">;</code>

<code class="k">if</code> <code class="p">(</code><code class="kc">true</code><code class="p">)</code> <code class="p">{</code>

    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">doSomething</code><code class="p">);</code>        <code class="c1">// throws error</code>

    <code class="kd">let</code> <code class="nx">doSomething</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">()</code> <code class="p">{</code>
        <code class="c1">// ...</code>
    <code class="p">}</code>

    <code class="nx">doSomething</code><code class="p">();</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">doSomething</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>Here, code execution stops when <code>typeof doSomething</code> is executed because the <code>let</code> statement hasn’t been executed yet.</p>

        <p>Whether you want to use block level functions or <code>let</code> expressions depends on whether or not you want the hoisting behavior.</p>

        <p>ECMAScript 6 also allows block-level functions in nonstrict mode, but the behavior is slightly different. Instead of hoisting these declarations to the top of the block, they are hoisted all the way to the containing function or global environment. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// ECMAScript 6 behavior</code>
<code class="k">if</code> <code class="p">(</code><code class="kc">true</code><code class="p">)</code> <code class="p">{</code>

    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">doSomething</code><code class="p">);</code>        <code class="c1">// "function"</code>

    <code class="kd">function</code> <code class="nx">doSomething</code><code class="p">()</code> <code class="p">{</code>
        <code class="c1">// ...</code>
    <code class="p">}</code>

    <code class="nx">doSomething</code><code class="p">();</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">doSomething</code><code class="p">);</code>            <code class="c1">// "function"</code>
</pre></div>

        </figure>

        <p>In this example, <code>doSomething()</code> is hoisted into the global scope so that it still exists outside of the <code>if</code> block. ECMAScript 6 standardized this behavior to remove the incompatible browser behaviors that previously existed. ECMAScript 6 runtimes will all behave in the same way.</p>

        <h3 id="leanpub-auto-arrow-functions">Arrow Functions</h3>

        <p>One of the most interesting new parts of ECMAScript 6 are arrow functions. Arrow functions are, as the name suggests, functions defined with a new syntax that uses an “arrow” (<code>=&gt;</code>). However, arrow functions behave differently than traditional JavaScript functions in a number of important ways:</p>

        <ul>
            <li>
                <strong>Lexical <code>this</code> binding</strong> - The value of <code>this</code> inside of the function is determined by where the arrow function is defined not where it is used.</li>
            <li>
                <strong>Not <code>new</code>able</strong> - Arrow functions do not have a <code>[[Construct]]</code> method and therefore cannot be used as constructors. Arrow functions throw an error when used with <code>new</code>.</li>
            <li>
                <strong>Can’t change <code>this</code></strong> - The value of <code>this</code> inside of the function can’t be changed, it remains the same value throughout the entire lifecycle of the function.</li>
            <li>
                <strong>No <code>arguments</code> object</strong> - You can’t access arguments through the <code>arguments</code> object, you must use named arguments or other ES6 features such as rest arguments.</li>
        </ul>

        <p>There are a few reasons why these differences exist. First and foremost, <code>this</code> binding is a common source of error in JavaScript. It’s very easy to lose track of the <code>this</code> value inside of a function, which can result in unintended consequences. Second, by limiting arrow functions to simply executing code with a single <code>this</code> value, JavaScript engines can more easily optimize these operations (as opposed to regular functions, which might be used as a constructor or otherwise modified).</p>

        <aside class="information blurb">
            <p>Arrow functions also have a <code>name</code> property that follows the same rule as other functions.</p>

        </aside>

        <h3 id="leanpub-auto-syntax">Syntax</h3>

        <p>The syntax for arrow functions comes in many flavors depending upon what you are trying to accomplish. All variations begin with function arguments, followed by the arrow, followed by the body of the function. Both the arguments and the body can take different forms depending on usage. For example, the following arrow function takes a single argument and simply returns it:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">reflect</code> <code class="o">=</code> <code class="nx">value</code> <code class="o">=&gt;</code> <code class="nx">value</code><code class="p">;</code>

<code class="c1">// effectively equivalent to:</code>

<code class="kd">var</code> <code class="nx">reflect</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">value</code><code class="p">;</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>When there is only one argument for an arrow function, that one argument can be used directly without any further syntax. The arrow comes next and the expression to the right of the arrow is evaluated and returned. Even though there is no explicit <code>return</code> statement, this arrow function will return the first argument that is passed in.</p>

        <p>If you are passing in more than one argument, then you must include parentheses around those arguments. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">sum</code> <code class="o">=</code> <code class="p">(</code><code class="nx">num1</code><code class="p">,</code> <code class="nx">num2</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">num1</code> <code class="o">+</code> <code class="nx">num2</code><code class="p">;</code>

<code class="c1">// effectively equivalent to:</code>

<code class="kd">var</code> <code class="nx">sum</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">num1</code><code class="p">,</code> <code class="nx">num2</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">num1</code> <code class="o">+</code> <code class="nx">num2</code><code class="p">;</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>The <code>sum()</code> function simply adds two arguments together and returns the result. The only difference is that the arguments are enclosed in parentheses with a comma separating them (same as traditional functions).</p>

        <p>If there are no arguments to the function, then you must include an empty set of parentheses:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">getName</code> <code class="o">=</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="s2">"Nicholas"</code><code class="p">;</code>

<code class="c1">// effectively equivalent to:</code>

<code class="kd">var</code> <code class="nx">getName</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="s2">"Nicholas"</code><code class="p">;</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>When you want to provide a more traditional function body, perhaps consisting of more than one expression, then you need to wrap the function body in braces and explicitly define a return value, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">sum</code> <code class="o">=</code> <code class="p">(</code><code class="nx">num1</code><code class="p">,</code> <code class="nx">num2</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">num1</code> <code class="o">+</code> <code class="nx">num2</code><code class="p">;</code>
<code class="p">};</code>

<code class="c1">// effectively equivalent to:</code>

<code class="kd">var</code> <code class="nx">sum</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">num1</code><code class="p">,</code> <code class="nx">num2</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">num1</code> <code class="o">+</code> <code class="nx">num2</code><code class="p">;</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>You can more or less treat the inside of the curly braces as the same as in a traditional function with the exception that <code>arguments</code> is not available.</p>

        <p>If you want to create a function that does nothing, then you need to include curly braces:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">doNothing</code> <code class="o">=</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{};</code>

<code class="c1">// effectively equivalent to:</code>

<code class="kd">var</code> <code class="nx">doNothing</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{};</code>
</pre></div>

        </figure>

        <p>Because curly braces are used to denote the function’s body, an arrow function that wants to return an object literal outside of a function body must wrap the literal in parentheses. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">getTempItem</code> <code class="o">=</code> <code class="nx">id</code> <code class="o">=&gt;</code> <code class="p">({</code> <code class="nx">id</code><code class="o">:</code> <code class="nx">id</code><code class="p">,</code> <code class="nx">name</code><code class="o">:</code> <code class="s2">"Temp"</code> <code class="p">});</code>

<code class="c1">// effectively equivalent to:</code>

<code class="kd">var</code> <code class="nx">getTempItem</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">id</code><code class="p">)</code> <code class="p">{</code>

    <code class="k">return</code> <code class="p">{</code>
        <code class="nx">id</code><code class="o">:</code> <code class="nx">id</code><code class="p">,</code>
        <code class="nx">name</code><code class="o">:</code> <code class="s2">"Temp"</code>
    <code class="p">};</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>Wrapping the object literal in parentheses signals that the braces are an object literal instead of the function body.</p>

        <h4 id="leanpub-auto-immediately-invoked-function-expressions-iifes">Immediately-Invoked Function Expressions (IIFEs)</h4>

        <p>A popular use of functions in JavaScript is immediately-invoked function expressions (IIFEs). IIFEs allow you to define an anonymous function and call it immediately without saving a reference. This pattern comes in handy when you want to create a scope that is shielded from the rest of a program. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>

    <code class="k">return</code> <code class="p">{</code>
        <code class="nx">getName</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="nx">name</code><code class="p">;</code>
        <code class="p">}</code>
    <code class="p">};</code>

<code class="p">}(</code><code class="s2">"Nicholas"</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">.</code><code class="nx">getName</code><code class="p">());</code>      <code class="c1">// "Nicholas"</code>
</pre></div>

        </figure>

        <p>In this code, the IIFE is used to create an object with a <code>getName()</code> method. The method uses the <code>name</code> argument as the return value, effectively making <code>name</code> a private member of the returned object.</p>

        <p>You can accomplish the same thing using arrow functions so long as you wrap the arrow function in parentheses:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">((</code><code class="nx">name</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="p">{</code>

    <code class="k">return</code> <code class="p">{</code>
        <code class="nx">getName</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="nx">name</code><code class="p">;</code>
        <code class="p">}</code>
    <code class="p">};</code>

<code class="p">})(</code><code class="s2">"Nicholas"</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">.</code><code class="nx">getName</code><code class="p">());</code>      <code class="c1">// "Nicholas"</code>
</pre></div>

        </figure>

        <p>Note that the location of the parentheses is around just the arrow function definition, and does not include <code>("Nicholas")</code>. This is different from a formal function, where the parentheses can be placed outside of the passed-in parameters as well as just as around the function definition.</p>

        <h4 id="leanpub-auto-lexical-this-binding">Lexical this Binding</h4>

        <p>One of the most common areas of error in JavaScript is the binding of <code>this</code> inside of functions. Since the value of <code>this</code> can change inside of a single function depending on the context in which it’s called, it’s possible to mistakenly affect one object when you meant to affect another. Consider the following example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">PageHandler</code> <code class="o">=</code> <code class="p">{</code>

    <code class="nx">id</code><code class="o">:</code> <code class="s2">"123456"</code><code class="p">,</code>

    <code class="nx">init</code><code class="o">:</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
        <code class="nb">document</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s2">"click"</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">event</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">doSomething</code><code class="p">(</code><code class="nx">event</code><code class="p">.</code><code class="nx">type</code><code class="p">);</code>     <code class="c1">// error</code>
        <code class="p">},</code> <code class="kc">false</code><code class="p">);</code>
    <code class="p">},</code>

    <code class="nx">doSomething</code><code class="o">:</code> <code class="kd">function</code><code class="p">(</code><code class="nx">type</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Handling "</code> <code class="o">+</code> <code class="nx">type</code>  <code class="o">+</code> <code class="s2">" for "</code> <code class="o">+</code> <code class="k">this</code><code class="p">.</code><code class="nx">id</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>In this code, the object <code>PageHandler</code> is designed to handle interactions on the page. The <code>init()</code> method is called to set up the interactions and that method in turn assigns an event handler to call <code>this.doSomething()</code>. However, this code doesn’t work as intended. The call to <code>this.doSomething()</code> is broken because <code>this</code> is a reference to the element object (in this case <code>document</code>) that was the target of the event, instead of being bound to <code>PageHandler</code>. If you tried to run this code, you will get an error when the event handler fires because <code>this.doSomething()</code> doesn’t exist on the target <code>document</code> object.</p>

        <p>You can bind the value of <code>this</code> to <code>PageHandler</code> explicitly using the <code>bind()</code> method on the function:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">PageHandler</code> <code class="o">=</code> <code class="p">{</code>

    <code class="nx">id</code><code class="o">:</code> <code class="s2">"123456"</code><code class="p">,</code>

    <code class="nx">init</code><code class="o">:</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
        <code class="nb">document</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s2">"click"</code><code class="p">,</code> <code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">event</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">doSomething</code><code class="p">(</code><code class="nx">event</code><code class="p">.</code><code class="nx">type</code><code class="p">);</code>     <code class="c1">// no error</code>
        <code class="p">}).</code><code class="nx">bind</code><code class="p">(</code><code class="k">this</code><code class="p">),</code> <code class="kc">false</code><code class="p">);</code>
    <code class="p">},</code>

    <code class="nx">doSomething</code><code class="o">:</code> <code class="kd">function</code><code class="p">(</code><code class="nx">type</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Handling "</code> <code class="o">+</code> <code class="nx">type</code>  <code class="o">+</code> <code class="s2">" for "</code> <code class="o">+</code> <code class="k">this</code><code class="p">.</code><code class="nx">id</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>Now the code works as expected, but may look a little bit strange. By calling <code>bind(this)</code>, you’re actually creating a new function whose <code>this</code> is bound to the current <code>this</code>, which is <code>PageHandler</code>. The code now works as you would expect even though you had to create an extra function to get the job done.</p>

        <p>Arrow functions have implicit <code>this</code> binding, which means that the value of <code>this</code> inside of an arrow function is always the same as the value of <code>this</code> in the scope in which the arrow function was defined. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">PageHandler</code> <code class="o">=</code> <code class="p">{</code>

    <code class="nx">id</code><code class="o">:</code> <code class="s2">"123456"</code><code class="p">,</code>

    <code class="nx">init</code><code class="o">:</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
        <code class="nb">document</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s2">"click"</code><code class="p">,</code>
                <code class="nx">event</code> <code class="o">=&gt;</code> <code class="k">this</code><code class="p">.</code><code class="nx">doSomething</code><code class="p">(</code><code class="nx">event</code><code class="p">.</code><code class="nx">type</code><code class="p">),</code> <code class="kc">false</code><code class="p">);</code>
    <code class="p">},</code>

    <code class="nx">doSomething</code><code class="o">:</code> <code class="kd">function</code><code class="p">(</code><code class="nx">type</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Handling "</code> <code class="o">+</code> <code class="nx">type</code>  <code class="o">+</code> <code class="s2">" for "</code> <code class="o">+</code> <code class="k">this</code><code class="p">.</code><code class="nx">id</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>The event handler in this example is an arrow function that calls <code>this.doSomething()</code>. The value of <code>this</code> is the same as it is within <code>init()</code>, so this version of the example works similarly to the one using <code>bind()</code>. Even though the <code>doSomething()</code> method doesn’t return a value, it is still the only statement executed necessary for the function body and so there is no need to include braces.</p>

        <p>Arrow functions are designed to be “throwaway” functions and so cannot be used to define new types. This is evident by the missing <code>prototype</code> property that regular functions have. If you try to use the <code>new</code> operator with an arrow function, you’ll get an error:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">MyType</code> <code class="o">=</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{},</code>
    <code class="nx">object</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">MyType</code><code class="p">();</code>  <code class="c1">// error - you can't use arrow functions with 'ne\</code>
<code class="nx">w</code><code class="err">'</code>
</pre></div>

        </figure>

        <p>Also, since the <code>this</code> value is statically bound to the arrow function, you cannot change the value of <code>this</code> using <code>call()</code>, <code>apply()</code>, or <code>bind()</code>.</p>

        <p>The concise syntax for arrow functions makes them ideal for use with array processing. For example, if you want to sort an array using a custom comparator, you typically write something like this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">result</code> <code class="o">=</code> <code class="nx">values</code><code class="p">.</code><code class="nx">sort</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">a</code><code class="p">,</code> <code class="nx">b</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">a</code> <code class="o">-</code> <code class="nx">b</code><code class="p">;</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>That’s a lot of syntax for a very simple procedure. Compare that to the more terse arrow function version:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">result</code> <code class="o">=</code> <code class="nx">values</code><code class="p">.</code><code class="nx">sort</code><code class="p">((</code><code class="nx">a</code><code class="p">,</code> <code class="nx">b</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">a</code> <code class="o">-</code> <code class="nx">b</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>The array methods that accept callback functions such as <code>sort()</code>, <code>map()</code>, and <code>reduce()</code> all can benefit from simpler syntax with arrow functions to change what would appear to be more complex processes into simpler code.</p>

        <p>Generally speaking, arrow functions are designed to be used in places where anonymous functions have traditionally been used. They are not really designed to be kept around for long periods of time, hence the inability to use arrow functions as constructors. Arrow functions are best used for callbacks that are passed into other functions, as seen in the examples in this section.</p>

        <h4 id="leanpub-auto-lexical-arguments-binding">Lexical arguments Binding</h4>

        <p>Even though arrow functions don’t have their own <code>arguments</code> object, it’s possible for them to access the <code>arguments</code> object from a containing function. That <code>arguments</code> object is then available no matter where the arrow function is executed later on. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">createArrowFunctionReturningFirstArg</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="nx">arguments</code><code class="p">[</code><code class="mi">0</code><code class="p">];</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">arrowFunction</code> <code class="o">=</code> <code class="nx">createArrowFunctionReturningFirstArg</code><code class="p">(</code><code class="mi">5</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">arrowFunction</code><code class="p">());</code>       <code class="c1">// 5</code>
</pre></div>

        </figure>

        <p>Inside of <code>createArrowFunctionReturningFirstArg()</code>, <code>arguments[0]</code> is referenced by the created arrow function. That reference contains the first argument passed to <code>createArrowFunctionReturningFirstArg()</code>. When the arrow function is later executed, it returns <code>5</code>, which was the first argument passed in to <code>createArrowFunctionReturningFirstArg()</code>. Even though the arrow function is no longer in the scope of the function that created it, <code>arguments</code> remains accessible as a lexical binding.</p>

        <h4 id="leanpub-auto-identifying-arrow-functions">Identifying Arrow Functions</h4>

        <p>Despite the different syntax, arrow functions are still functions and are identified as such:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">comparator</code> <code class="o">=</code> <code class="p">(</code><code class="nx">a</code><code class="p">,</code> <code class="nx">b</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">a</code> <code class="o">-</code> <code class="nx">b</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">comparator</code><code class="p">);</code>                 <code class="c1">// "function"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">comparator</code> <code class="k">instanceof</code> <code class="nb">Function</code><code class="p">);</code>    <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>Both <code>typeof</code> and <code>instanceof</code> behave the same with arrow functions as they do with other functions.</p>

        <p>Also like other functions, you can still use <code>call()</code>, <code>apply()</code>, and <code>bind()</code>, although the <code>this</code>-binding of the function will not be affected. Here are some examples:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">sum</code> <code class="o">=</code> <code class="p">(</code><code class="nx">num1</code><code class="p">,</code> <code class="nx">num2</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">num1</code> <code class="o">+</code> <code class="nx">num2</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">sum</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="kc">null</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">));</code>      <code class="c1">// 3</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">sum</code><code class="p">.</code><code class="nx">apply</code><code class="p">(</code><code class="kc">null</code><code class="p">,</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">]));</code>   <code class="c1">// 3</code>

<code class="kd">var</code> <code class="nx">boundSum</code> <code class="o">=</code> <code class="nx">sum</code><code class="p">.</code><code class="nx">bind</code><code class="p">(</code><code class="kc">null</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">boundSum</code><code class="p">());</code>                <code class="c1">// 3</code>
</pre></div>

        </figure>

        <p>In this example, the <code>sum()</code> function is called using <code>call()</code> and <code>apply()</code> to pass arguments as you would with any function. The <code>bind()</code> method is used to create <code>boundSum()</code>, which has its two arguments bound to <code>1</code> and <code>2</code> so that they don’t need to be passed directly.</p>

        <p>Arrow functions are appropriate to use anywhere you’re currently using an anonymous function expression, such as with callbacks.</p>

        <h3 id="leanpub-auto-summary-3">Summary</h3>

        <p>Functions haven’t undergone a huge change in ECMAScript 6, but rather, a series of incremental changes that make them easier to work with.</p>

        <p>Default function parameters allow you to easily specify what value to use when a particular argument isn’t passed. Prior to ECMAScript 6, this would require some extra code inside of the function to both check for the presence of arguments and assign a different value.</p>

        <p>Rest parameters allow you to specify an array into which all remaining parameters should be placed. Using a real array and letting you indicate which parameters to include makes rest parameters a much more flexible solution than <code>arguments</code>.</p>

        <p>Destructured parameters use the destructuring syntax to make options objects more transparent when used as function parameters. The actual data you’re interested in can be listed out along with other named parameters.</p>

        <p>The spread operator is a companion to rest parameters, allowing you to destructure an array into separate parameters when calling a function. Prior to ECMAScript 6, the only ways to pass individual parameters that were contained in an array were either manually specifying each parameter or using <code>apply()</code>. With the spread operator, you can easily pass an array to any function without worrying about the <code>this</code> binding of the function.</p>

        <p>The addition of the <code>name</code> property helps to more easily identify functions for debugging and evaluation purposes. Additionally, ECMAScript 6 formally defines the behavior of block-level functions so they are no longer a syntax error in strict mode.</p>

        <p>The behavior of a function has been defined by <code>[[Call]]</code>, normal function execution, and <code>[[Construct]]</code>, when a function is called with <code>new</code>. The <code>new.target</code> metaproperty allows you to determine if a function was called using <code>new</code> or not.</p>

        <p>The biggest change to functions in ECMAScript 6 was the addition of arrow functions. Arrow functions are designed to be used in places where anonymous function expressions have traditionally been used. Arrow functions have a more concise syntax, lexical <code>this</code> binding, and no <code>arguments</code> object. Additionally, arrow functions can’t change their <code>this</code> binding and so can’t be used as constructors.</p>

        <h2 id="leanpub-auto-objects">Objects</h2>

        <p>A lot of ECMAScript 6 focused on improving the utility of objects. The focus makes sense given that nearly every value in JavaScript is represented by some type of object. Additionally, the number of objects used in an average JavaScript program continues to increase, meaning that developers are writing more objects all the time. With more objects comes the necessity to use them more effectively.</p>

        <p>ECMAScript 6 improves objects in a number of ways, from simple syntax to new ways of manipulating and interacting with objects.</p>

        <h3 id="leanpub-auto-object-categories">Object Categories</h3>

        <p>The ECMAScript 6 specification introduced some new terminology to help distinguish between categories of objects. JavaScript has long been littered with a mix of terminology used to describe objects found in the standard as opposed to those that are added by execution environments such as the browser. ECMAScript 6 takes the time to clearly define each category of object, and it’s important to understand this terminology to have a good understanding of the language as a whole. The object categories are:</p>

        <ul>
            <li>
                <em>Ordinary objects</em> are objects that have all of the default internal behaviors for objects in JavaScript.</li>
            <li>
                <em>Exotic objects</em> are objects whose internal behavior is different than the default in some way.</li>
            <li>
                <em>Standard objects</em> are objects defined by ECMAScript 6, such as <code>Array</code>, <code>Date</code>, etc. Standard objects may be ordinary or exotic.</li>
            <li>
                <em>Built-in objects</em> are objects that are present in a JavaScript execution environment when a script begins to execute. All standard objects are built-in objects.</li>
        </ul>

        <p>These terms are used throughout the book to explain the various objects defined by ECMAScript 6.</p>

        <h3 id="leanpub-auto-object-literal-extensions">Object Literal Extensions</h3>

        <p>One of the most popular patterns in JavaScript is the object literal. It’s the syntax upon which JSON is built and can be seen in nearly every JavaScript file on the Internet. The reason for the popularity is clear: a succinct syntax for creating objects that otherwise would take several lines of code to accomplish. ECMAScript 6 recognized the popularity of the object literal and extends the syntax in several ways to make object literals more powerful and even more succinct.</p>

        <h4 id="leanpub-auto-property-initializer-shorthand">Property Initializer Shorthand</h4>

        <p>In ECMAScript 5 and earlier, object literals were simply collections of name-value pairs. That meant there could be some duplication when property values are being initialized. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">createPerson</code><code class="p">(</code><code class="nx">name</code><code class="p">,</code> <code class="nx">age</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="p">{</code>
        <code class="nx">name</code><code class="o">:</code> <code class="nx">name</code><code class="p">,</code>
        <code class="nx">age</code><code class="o">:</code> <code class="nx">age</code>
    <code class="p">};</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>The <code>createPerson()</code> function creates an object whose property names are the same as the function parameter names. The result is what appears to be duplication of <code>name</code> and <code>age</code> even though each represents a different aspect of the process.</p>

        <p>In ECMAScript 6, you can eliminate the duplication that exists around property names and local variables by using the property initializer shorthand. When the property name is going to be the same as the local variable name, you can simply include the name without a colon and value. For example, <code>createPerson()</code> can be rewritten as follows:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">createPerson</code><code class="p">(</code><code class="nx">name</code><code class="p">,</code> <code class="nx">age</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="p">{</code>
        <code class="nx">name</code><code class="p">,</code>
        <code class="nx">age</code>
    <code class="p">};</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>When a property in an object literal only has a name and no value, the JavaScript engine looks into the surrounding scope for a variable of the same name. If found, that value is assigned to the same name on the object literal. So in this example, the object literal property <code>name</code> is assigned the value of the local variable <code>name</code>.</p>

        <p>The purpose of this extension is to make object literal initialization even more succinct than it already was. Assigning a property with the same name as a local variable is a very common pattern in JavaScript and so this extension is a welcome addition.</p>

        <h4 id="leanpub-auto-method-initializer-shorthand">Method Initializer Shorthand</h4>

        <p>ECMAScript 6 also improves syntax for assigning methods to object literals. In ECMAScript 5 and earlier, you must specify a name and then the full function definition to add a method to an object. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Nicholas"</code><code class="p">,</code>
    <code class="nx">sayName</code><code class="o">:</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>In ECMAScript 6, the syntax is made more succinct by eliminating the colon and the <code>function</code> keyword. You can then rewrite the previous example as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Nicholas"</code><code class="p">,</code>
    <code class="nx">sayName</code><code class="p">()</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>This shorthand syntax, also called <em>concise method</em> syntax, creates a method on the <code>person</code> object just as the previous example did. There is no difference aside from saving you some keystrokes, so <code>sayName()</code> is assigned an anonymous function expression and has all of the same characteristics as the function defined in the previous example.</p>

        <aside class="information blurb">
            <p>The <code>name</code> property of a method created using this shorthand is the name used before the parentheses. In the previous example, the <code>name</code> property for <code>person.sayName()</code> is <code>"sayName"</code>.</p>

        </aside>

        <h4 id="leanpub-auto-computed-property-names">Computed Property Names</h4>

        <p>JavaScript objects have long had computed property names through the use of square brackets instead of dot notation. The square brackets allow you to specify property names using variables and string literals that may contain characters that would be a syntax error if used in an identifier. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{},</code>
    <code class="nx">lastName</code> <code class="o">=</code> <code class="s2">"last name"</code><code class="p">;</code>

<code class="nx">person</code><code class="p">[</code><code class="s2">"first name"</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Nicholas"</code><code class="p">;</code>
<code class="nx">person</code><code class="p">[</code><code class="nx">lastName</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Zakas"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">[</code><code class="s2">"first name"</code><code class="p">]);</code>      <code class="c1">// "Nicholas"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">[</code><code class="nx">lastName</code><code class="p">]);</code>          <code class="c1">// "Zakas"</code>
</pre></div>

        </figure>

        <p>Both of the property names in this example have a space, making it impossible to reference those names using dot notation. However, bracket notation allows any string value to be used as a property name.</p>

        <p>In ECMAScript 5, you could use string literals as property names in object literals, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="s2">"first name"</code><code class="o">:</code> <code class="s2">"Nicholas"</code>
<code class="p">};</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">[</code><code class="s2">"first name"</code><code class="p">]);</code>      <code class="c1">// "Nicholas"</code>
</pre></div>

        </figure>

        <p>If you could provide the string literal inside of the object literal property definition then you were all set. If, however, the property name was contained in a variable or had to be calculated, then there was no way to define that property using an object literal.</p>

        <p>ECMAScript 6 adds computed property names to object literal syntax by using the same square bracket notation that has been used to reference computed property names in object instances. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">lastName</code> <code class="o">=</code> <code class="s2">"last name"</code><code class="p">;</code>

<code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="s2">"first name"</code><code class="o">:</code> <code class="s2">"Nicholas"</code><code class="p">,</code>
    <code class="p">[</code><code class="nx">lastName</code><code class="p">]</code><code class="o">:</code> <code class="s2">"Zakas"</code>
<code class="p">};</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">[</code><code class="s2">"first name"</code><code class="p">]);</code>      <code class="c1">// "Nicholas"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">[</code><code class="nx">lastName</code><code class="p">]);</code>          <code class="c1">// "Zakas"</code>
</pre></div>

        </figure>

        <p>The square brackets inside of the object literal indicate that the property name is computed, so its contents are evaluated as a string. That means you can also include expressions such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">suffix</code> <code class="o">=</code> <code class="s2">" name"</code><code class="p">;</code>

<code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="p">[</code><code class="s2">"first"</code> <code class="o">+</code> <code class="nx">suffix</code><code class="p">]</code><code class="o">:</code> <code class="s2">"Nicholas"</code><code class="p">,</code>
    <code class="p">[</code><code class="s2">"last"</code> <code class="o">+</code> <code class="nx">suffix</code><code class="p">]</code><code class="o">:</code> <code class="s2">"Zakas"</code>
<code class="p">};</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">[</code><code class="s2">"first name"</code><code class="p">]);</code>      <code class="c1">// "Nicholas"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">[</code><code class="s2">"last name"</code><code class="p">]);</code>       <code class="c1">// "Zakas"</code>
</pre></div>

        </figure>

        <p>Anything you would put inside of square brackets while using bracket notation on object instances will also work for computed property names inside of object literals.</p>

        <h3 id="leanpub-auto-objectis">Object.is()</h3>

        <p>When you want to compare two values, you’re probably used to using either the equals operator (<code>==</code>) or the identically equals operator (<code>===</code>). Many prefer to use the latter to avoid type coercion during the comparison. However, even the identically equals operator isn’t entirely accurate. For example, the values +0 and -0 are considered equal by <code>===</code> even though they are represented differently in the JavaScript engine. Also <code>NaN === NaN</code> returns <code>false</code>, which necessitates using <code>isNaN()</code> to detect <code>NaN</code> properly.</p>

        <p>ECMAScript 6 introduces <code>Object.is()</code> to make up for the remaining quirks of the identically equals operator. This method accepts two arguments and returns <code>true</code> if the values are equivalent. Two values are considered equivalent when they are of the same type and have the same value. In many cases, <code>Object.is()</code> works the same as <code>===</code>. The only differences are that +0 and -0 are considered not equivalent and <code>NaN</code> is considered equivalent to <code>NaN</code>. Here are some examples:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="o">+</code><code class="mi">0</code> <code class="o">==</code> <code class="o">-</code><code class="mi">0</code><code class="p">);</code>              <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="o">+</code><code class="mi">0</code> <code class="o">===</code> <code class="o">-</code><code class="mi">0</code><code class="p">);</code>             <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">is</code><code class="p">(</code><code class="o">+</code><code class="mi">0</code><code class="p">,</code> <code class="o">-</code><code class="mi">0</code><code class="p">));</code>     <code class="c1">// false</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="kc">NaN</code> <code class="o">==</code> <code class="kc">NaN</code><code class="p">);</code>            <code class="c1">// false</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="kc">NaN</code> <code class="o">===</code> <code class="kc">NaN</code><code class="p">);</code>           <code class="c1">// false</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">is</code><code class="p">(</code><code class="kc">NaN</code><code class="p">,</code> <code class="kc">NaN</code><code class="p">));</code>   <code class="c1">// true</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="mi">5</code> <code class="o">==</code> <code class="mi">5</code><code class="p">);</code>                <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="mi">5</code> <code class="o">==</code> <code class="s2">"5"</code><code class="p">);</code>              <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="mi">5</code> <code class="o">===</code> <code class="mi">5</code><code class="p">);</code>               <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="mi">5</code> <code class="o">===</code> <code class="s2">"5"</code><code class="p">);</code>             <code class="c1">// false</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">is</code><code class="p">(</code><code class="mi">5</code><code class="p">,</code> <code class="mi">5</code><code class="p">));</code>       <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">is</code><code class="p">(</code><code class="mi">5</code><code class="p">,</code> <code class="s2">"5"</code><code class="p">));</code>     <code class="c1">// false</code>
</pre></div>

        </figure>

        <p>In most cases you will probably still want to use <code>==</code> or <code>===</code> for comparing values, as special cases covered by <code>Object.is()</code> may not affect you directly.</p>

        <h3 id="leanpub-auto-objectassign">Object.assign()</h3>

        <p>One of the most popular patterns for object composition is <em>mixins</em>, in which one object receives properties and methods from another object. Many JavaScript libraries have a mixin method similar to this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">mixin</code><code class="p">(</code><code class="nx">receiver</code><code class="p">,</code> <code class="nx">supplier</code><code class="p">)</code> <code class="p">{</code>
    <code class="nb">Object</code><code class="p">.</code><code class="nx">keys</code><code class="p">(</code><code class="nx">supplier</code><code class="p">).</code><code class="nx">forEach</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">key</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">receiver</code><code class="p">[</code><code class="nx">key</code><code class="p">]</code> <code class="o">=</code> <code class="nx">supplier</code><code class="p">[</code><code class="nx">key</code><code class="p">];</code>
    <code class="p">});</code>

    <code class="k">return</code> <code class="nx">receiver</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>The <code>mixin()</code> function iterates over the own properties of <code>supplier</code> and copies them onto <code>receiver</code>. This allows the <code>receiver</code> to gain new behaviors without inheritance. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">EventTarget</code><code class="p">()</code> <code class="p">{</code> <code class="cm">/*...*/</code> <code class="p">}</code>
<code class="nx">EventTarget</code><code class="p">.</code><code class="nx">prototype</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="o">:</code> <code class="nx">EventTarget</code><code class="p">,</code>
    <code class="nx">emit</code><code class="o">:</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code> <code class="cm">/*...*/</code> <code class="p">},</code>
    <code class="nx">on</code><code class="o">:</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code> <code class="cm">/*...*/</code> <code class="p">}</code>
<code class="p">};</code>

<code class="kd">var</code> <code class="nx">myObject</code> <code class="o">=</code> <code class="p">{};</code>
<code class="nx">mixin</code><code class="p">(</code><code class="nx">myObject</code><code class="p">,</code> <code class="nx">EventTarget</code><code class="p">.</code><code class="nx">prototype</code><code class="p">);</code>

<code class="nx">myObject</code><code class="p">.</code><code class="nx">emit</code><code class="p">(</code><code class="s2">"somethingChanged"</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>In this example, <code>myObject</code> receives behavior from <code>EventTarget.prototype</code>. This gives <code>myObject</code> the ability to publish events and let others subscribe to them using <code>emit()</code> and <code>on()</code>, respectively.</p>

        <p>This pattern became popular enough that ECMAScript 6 added <code>Object.assign()</code>, which behaves the same way. The difference in name is to reflect the actual operation that occurs. Since the <code>mixin()</code> method uses the assignment operator (<code>=</code>), it cannot copy accessor properties to the receiver as accessor properties. The name <code>Object.assign()</code> was chosen to reflect this distinction.</p>

        <aside class="information blurb">
            <p>Similar methods in various libraries may have other names. Some popular alternate names for the same basic functionality are <code>extend()</code> and <code>mix()</code>. There was also, briefly, an <code>Object.mixin()</code> method in ECMAScript 6 in addition to <code>Object.assign()</code>. The primary difference was that <code>Object.mixin()</code> also copied over accessor properties, but the method was removed due to concerns over the use of <code>super</code> (discussed later in this chapter).</p>

        </aside>

        <p>You can use <code>Object.assign()</code> anywhere the <code>mixin()</code> function would have been used:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">EventTarget</code><code class="p">()</code> <code class="p">{</code> <code class="cm">/*...*/</code> <code class="p">}</code>
<code class="nx">EventTarget</code><code class="p">.</code><code class="nx">prototype</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="o">:</code> <code class="nx">EventTarget</code><code class="p">,</code>
    <code class="nx">emit</code><code class="o">:</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code> <code class="cm">/*...*/</code> <code class="p">},</code>
    <code class="nx">on</code><code class="o">:</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code> <code class="cm">/*...*/</code> <code class="p">}</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">myObject</code> <code class="o">=</code> <code class="p">{}</code>
<code class="nb">Object</code><code class="p">.</code><code class="nx">assign</code><code class="p">(</code><code class="nx">myObject</code><code class="p">,</code> <code class="nx">EventTarget</code><code class="p">.</code><code class="nx">prototype</code><code class="p">);</code>

<code class="nx">myObject</code><code class="p">.</code><code class="nx">emit</code><code class="p">(</code><code class="s2">"somethingChanged"</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>The <code>Object.assign()</code> method accepts any number of suppliers, and the receiver receives the properties in the order in which the suppliers are specified. That means the second supplier might overwrite a value from the first supplier on the receiver. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">receiver</code> <code class="o">=</code> <code class="p">{};</code>

<code class="nb">Object</code><code class="p">.</code><code class="nx">assign</code><code class="p">(</code><code class="nx">receiver</code><code class="p">,</code> <code class="p">{</code>
        <code class="nx">type</code><code class="o">:</code> <code class="s2">"js"</code><code class="p">,</code>
        <code class="nx">name</code><code class="o">:</code> <code class="s2">"file.js"</code>
    <code class="p">},</code> <code class="p">{</code>
        <code class="nx">type</code><code class="o">:</code> <code class="s2">"css"</code>
    <code class="p">}</code>
<code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">receiver</code><code class="p">.</code><code class="nx">type</code><code class="p">);</code>     <code class="c1">// "css"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">receiver</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>     <code class="c1">// "file.js"</code>
</pre></div>

        </figure>

        <p>The value of <code>receiver.type</code> is <code>"css"</code> because the second supplier overwrote the value of the first.</p>

        <p>The <code>Object.assign()</code> method isn’t a big addition to ECMAScript 6, but it does formalize a common function that is found in many JavaScript libraries.</p>

        <aside>
            <h4 id="leanpub-auto-working-with-accessor-properties">Working with Accessor Properties</h4>

            <p>Keep in mind that you cannot create accessor properties on the receiver by using a supplier with accessor properties. Since <code>Object.assign()</code> uses the assignment operator, an accessor property on a supplier will become a data property on the receiver. For example:</p>

            <figure class="code">
                <div class="highlight"><pre><code class="kd">var</code> <code class="nx">receiver</code> <code class="o">=</code> <code class="p">{},</code>
    <code class="nx">supplier</code> <code class="o">=</code> <code class="p">{</code>
        <code class="nx">get</code> <code class="nx">name</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="s2">"file.js"</code>
        <code class="p">}</code>
    <code class="p">};</code>

<code class="nb">Object</code><code class="p">.</code><code class="nx">assign</code><code class="p">(</code><code class="nx">receiver</code><code class="p">,</code> <code class="nx">supplier</code><code class="p">);</code>

<code class="kd">var</code> <code class="nx">descriptor</code> <code class="o">=</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">getOwnPropertyDescriptor</code><code class="p">(</code><code class="nx">receiver</code><code class="p">,</code> <code class="s2">"name"</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">descriptor</code><code class="p">.</code><code class="nx">value</code><code class="p">);</code>      <code class="c1">// "file.js"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">descriptor</code><code class="p">.</code><code class="nx">get</code><code class="p">);</code>        <code class="c1">// undefined</code>
</pre></div>

            </figure>

            <p>In this code, the <code>supplier</code> has an accessor property called <code>name</code>. After using <code>Object.assign()</code>, <code>receiver.name</code> exists as a data property with the value of <code>"file.js"</code>. That’s because <code>supplier.name</code> returned “file.js” at the time <code>Object.assign()</code> was called.</p>

        </aside>

        <h3 id="leanpub-auto-duplicate-object-literal-properties">Duplicate Object Literal Properties</h3>

        <p>ECMAScript 5 strict mode introduced a check for duplicate object literal properties that would throw an error if a duplicate was found. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Nicholas"</code><code class="p">,</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Greg"</code>        <code class="c1">// syntax error in ES5 strict mode</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>When running in ECMAScript 5 strict mode, this example results in a syntax error on the second <code>name</code> property.</p>

        <p>In ECMAScript 6, the duplicate property check has been removed. Both strict and nonstrict mode code no longer check for duplicate properties and instead take the last property of the given name as the actual value.</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Nicholas"</code><code class="p">,</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Greg"</code>        <code class="c1">// not an error in ES6</code>
<code class="p">};</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>       <code class="c1">// "Greg"</code>
</pre></div>

        </figure>

        <p>In this example, the value of <code>person.name</code> is <code>"Greg"</code> because that was the last value assigned to the property.</p>

        <h3 id="leanpub-auto-changing-prototypes">Changing Prototypes</h3>

        <p>Prototypes are the foundation of inheritance in JavaScript, and so ECMAScript 6 continues to make prototypes more powerful. ECMAScript 5 added the <code>Object.getPrototypeOf()</code> method for retrieving the prototype of any given object. ECMAScript 6 adds the reverse operation, <code>Object.setPrototypeOf()</code>, which allows you to change the prototype of any given object.</p>

        <p>Normally, the prototype of an object is specified at the time of its creation, either by using a constructor or via <code>Object.create()</code>. Prior to ECMAScript 6, there was no standard way to change an object’s prototype after it had already been created. In a way, <code>Object.setPrototypeOf()</code> changes one of the biggest assumptions about objects in JavaScript to this point, which is that an object’s prototype remains unchanged after creation.</p>

        <p>The <code>Object.setPrototypeOf()</code> method accepts two arguments, the object whose prototype should be changed and the object that should become the first argument’s prototype. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="s2">"Hello"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="kd">let</code> <code class="nx">dog</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="s2">"Woof"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="c1">// prototype is person</code>
<code class="kd">let</code> <code class="nx">friend</code> <code class="o">=</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">create</code><code class="p">(</code><code class="nx">person</code><code class="p">);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>                      <code class="c1">// "Hello"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">getPrototypeOf</code><code class="p">(</code><code class="nx">friend</code><code class="p">)</code> <code class="o">===</code> <code class="nx">person</code><code class="p">);</code>  <code class="c1">// true</code>

<code class="c1">// set prototype to dog</code>
<code class="nb">Object</code><code class="p">.</code><code class="nx">setPrototypeOf</code><code class="p">(</code><code class="nx">friend</code><code class="p">,</code> <code class="nx">dog</code><code class="p">);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>                      <code class="c1">// "Woof"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">getPrototypeOf</code><code class="p">(</code><code class="nx">friend</code><code class="p">)</code> <code class="o">===</code> <code class="nx">dog</code><code class="p">);</code>     <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>This code defines two base objects: <code>person</code> and <code>dog</code>. Both objects have a method <code>getGreeting()</code> that returns a string. The object <code>friend</code> starts out inheriting from <code>person</code>, meaning that <code>getGreeting()</code> will output <code>"Hello"</code>. When the prototype is changed to be <code>dog</code> instead, <code>person.getGreeting()</code> outputs <code>"Woof"</code> because the original relationship to <code>person</code> is broken.</p>

        <p>The actual value of an object’s prototype is stored in an internal-only property called <code>[[Prototype]]</code>. The <code>Object.getPrototypeOf()</code> method returns the value stored in <code>[[Prototype]]</code> and <code>Object.setPrototypeOf()</code> changes the value stored in <code>[[Prototype]]</code>. However, these aren’t the only ways to work with the value of <code>[[Prototype]]</code>.</p>

        <p>Even before ECMAScript 5 was finished, several JavaScript engines already implemented a custom property called <code>__proto__</code> that could be used to both get and set the prototype of an object. Effectively, <code>__proto__</code> was an early precursor to both <code>Object.getPrototypeOf()</code> and <code>Object.setPrototypeOf()</code>. It was unrealistic to expect all of the JavaScript engines to remove this property, so ECMAScript 6 formalized the behavior of <code>__proto__</code>.</p>

        <p>In ECMAScript 6 engines, <code>Object.prototype.__proto__</code> is defined as an accessor property whose <code>get</code> method calls <code>Object.getPrototypeOf()</code> and whose <code>set</code> method calls <code>Object.setPrototypeOf()</code>. This means that there is no real difference between using <code>__proto__</code> and the other methods except that <code>__proto__</code> allows you to set the prototype of an object literal directly. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="s2">"Hello"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="kd">let</code> <code class="nx">dog</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="s2">"Woof"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="c1">// prototype is person</code>
<code class="kd">let</code> <code class="nx">friend</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">__proto__</code><code class="o">:</code> <code class="nx">person</code>
<code class="p">};</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>                      <code class="c1">// "Hello"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">getPrototypeOf</code><code class="p">(</code><code class="nx">friend</code><code class="p">)</code> <code class="o">===</code> <code class="nx">person</code><code class="p">);</code>  <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">__proto__</code> <code class="o">===</code> <code class="nx">person</code><code class="p">);</code>               <code class="c1">// true</code>

<code class="c1">// set prototype to dog</code>
<code class="nx">friend</code><code class="p">.</code><code class="nx">__proto__</code> <code class="o">=</code> <code class="nx">dog</code><code class="p">;</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>                      <code class="c1">// "Woof"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">__proto__</code> <code class="o">===</code> <code class="nx">dog</code><code class="p">);</code>                  <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">getPrototypeOf</code><code class="p">(</code><code class="nx">friend</code><code class="p">)</code> <code class="o">===</code> <code class="nx">dog</code><code class="p">);</code>     <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>This example is functionally equivalent to the previous. The call to <code>Object.create()</code> has been replaced with an object literal that assigns a value to <code>__proto__</code>. The only real difference between creating an object using <code>Object.create()</code> or an object literal with <code>__proto__</code> is that the former requires you to specify full property descriptors for any additional object properties while the latter is just a standard object literal.</p>

        <aside class="warning blurb">
            <p>The <code>__proto__</code> property is special in a number of ways:</p>

            <ol class="numeric">
                <li>You can only specify it once in an object literal. If you specify two <code>__proto__</code> properties, then an error is thrown. This is the only object literal property that has this restriction.</li>
                <li>The computed form <code>["__proto__"]</code> acts like a regular property and does not set or return the current object’s prototype. All rules related to object literal properties apply in this form, as opposed to the non-computed form, for which there are exceptions.</li>
            </ol>

            <p>It’s best to be careful when using <code>__proto__</code> to make sure you don’t get caught by these differences.</p>

        </aside>

        <h3 id="leanpub-auto-super-references">Super References</h3>

        <p>As previously mentioned, prototypes are very important for JavaScript and a lot of work went into making them easier to use in ECMAScript 6. Among the improvements is the introduction of <code>super</code> references to more easily access functionality on an object’s prototype. For example, if you want to override a method on an object instance such that it also calls the prototype method of the same name, you would need to do the following in ECMAScript 5:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="s2">"Hello"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="kd">let</code> <code class="nx">dog</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="s2">"Woof"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="c1">// prototype is person</code>
<code class="kd">let</code> <code class="nx">friend</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">__proto__</code><code class="o">:</code> <code class="nx">person</code><code class="p">,</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="c1">// same as this.__proto__.getGreeting.call(this)</code>
        <code class="k">return</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">getPrototypeOf</code><code class="p">(</code><code class="k">this</code><code class="p">).</code><code class="nx">getGreeting</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="k">this</code><code class="p">)</code> <code class="o">+</code> <code class="s2">", hi!"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>                      <code class="c1">// "Hello, hi!"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">getPrototypeOf</code><code class="p">(</code><code class="nx">friend</code><code class="p">)</code> <code class="o">===</code> <code class="nx">person</code><code class="p">);</code>  <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">__proto__</code> <code class="o">===</code> <code class="nx">person</code><code class="p">);</code>               <code class="c1">// true</code>

<code class="c1">// set prototype to dog</code>
<code class="nx">friend</code><code class="p">.</code><code class="nx">__proto__</code> <code class="o">=</code> <code class="nx">dog</code><code class="p">;</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>                      <code class="c1">// "Woof, hi!"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">__proto__</code> <code class="o">===</code> <code class="nx">dog</code><code class="p">);</code>                  <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">getPrototypeOf</code><code class="p">(</code><code class="nx">friend</code><code class="p">)</code> <code class="o">===</code> <code class="nx">dog</code><code class="p">);</code>     <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>In this example, <code>getGreeting()</code> on <code>friend</code> calls the prototype method of the same name. The <code>Object.getPrototypeOf()</code> method is used to ensure the method is always getting the accurate prototype and then an additional string is appended. The additional <code>.call(this)</code> ensures that the <code>this</code> value inside the prototype method is set correctly.</p>

        <p>Needing to remember to use <code>Object.getPrototypeOf()</code> and <code>.call(this)</code> to call a method on the prototype is a bit involved, so ECMAScript 6 introduced <code>super</code>.</p>

        <p>At it’s simplest, <code>super</code> acts as a pointer to the current object’s prototype, effectively acting like <code>Object.getPrototypeOf(this)</code>. So you can simplify the <code>getGreeting()</code> method by rewriting it as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">friend</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">__proto__</code><code class="o">:</code> <code class="nx">person</code><code class="p">,</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="c1">// in the previous example, this is the same as:</code>
        <code class="c1">// 1. Object.getPrototypeOf(this).getGreeting.call(this)</code>
        <code class="c1">// 2. this.__proto__.getGreeting.call(this)</code>
        <code class="k">return</code> <code class="kr">super</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">()</code> <code class="o">+</code> <code class="s2">", hi!"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>The call to <code>super.getGreeting()</code> is the same as <code>Object.getPrototypeOf(this).getGreeting.call(this)</code> or <code>this.__proto__.getGreeting.call(this)</code>. Similarly, you can call any method on an object’s prototype by using a <code>super</code> reference.</p>

        <p>Where <code>super</code> is really powerful is when you have multiple levels of inheritance. In such a case, <code>Object.getPrototypeOf()</code> no longer works in all circumstances. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="s2">"Hello"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="c1">// prototype is person</code>
<code class="kd">let</code> <code class="nx">friend</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">__proto__</code><code class="o">:</code> <code class="nx">person</code><code class="p">,</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">getPrototypeOf</code><code class="p">(</code><code class="k">this</code><code class="p">).</code><code class="nx">getGreeting</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="k">this</code><code class="p">)</code> <code class="o">+</code> <code class="s2">", hi!"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="c1">// prototype is friend</code>
<code class="kd">let</code> <code class="nx">relative</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">__proto__</code><code class="o">:</code> <code class="nx">friend</code>
<code class="p">};</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>                  <code class="c1">// "Hello"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>                  <code class="c1">// "Hello, hi!"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">relative</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>                <code class="c1">// error!</code>
</pre></div>

        </figure>

        <p>In this example, <code>Object.getPrototypeOf()</code> results in an error when <code>relative.getGreeting()</code> is called. That’s because <code>this</code> is <code>relative</code>, and the prototype of <code>relative</code> is <code>friend</code>. When <code>friend.getGreeting().call()</code> is called with <code>relative</code> as <code>this</code>, the process starts over again and continues to call recursively until a stack overflow error occurs. This is a difficult problem to solve in ECMAScript 5, but with ECMAScript 6 and <code>super</code>, it’s easy:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="s2">"Hello"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="c1">// prototype is person</code>
<code class="kd">let</code> <code class="nx">friend</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">__proto__</code><code class="o">:</code> <code class="nx">person</code><code class="p">,</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="kr">super</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">()</code> <code class="o">+</code> <code class="s2">", hi!"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="c1">// prototype is friend</code>
<code class="kd">let</code> <code class="nx">relative</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">__proto__</code><code class="o">:</code> <code class="nx">friend</code>
<code class="p">};</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>                  <code class="c1">// "Hello"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>                  <code class="c1">// "Hello, hi!"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">relative</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>                <code class="c1">// "Hello, hi!"</code>
</pre></div>

        </figure>

        <p>Because <code>super</code> references are not dynamic, they always refer to the correct object. In this case, <code>super.getGreeting()</code> always refers to <code>person.getGreeting()</code>, regardless of how many other object inherit this method.</p>

        <aside class="warning blurb">
            <p><code>super</code> references can only be used inside of concise methods and cannot be used in other functions or the global scope. Attempting to use <code>super</code> outside of concise methods results in a syntax error.</p>

        </aside>

        <h4 id="leanpub-auto-methods">Methods</h4>

        <p>Prior to ECMAScript 6, there was no formal definition of a “method” - methods were just object properties that contained functions instead of data. ECMAScript 6 formally defines a method as a function that has an internal <code>[[HomeObject]]</code> property containing the object to which the method belongs. Consider the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>

    <code class="c1">// method</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="s2">"Hello"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="c1">// not a method</code>
<code class="kd">function</code> <code class="nx">shareGreeting</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="s2">"Hi!"</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This example defines <code>person</code> with a single method called <code>getGreeting()</code>. The <code>[[HomeObject]]</code> for <code>getGreeting()</code> is <code>person</code> by virtue of assigning the function directly to an object. The <code>shareGreeting()</code> function, on the other hand, has no <code>[[HomeObject]]</code> specified because it wasn’t assigned to an object when it was created. In most cases this difference isn’t important, but it becomes very important when using <code>super</code>.</p>

        <p>Any reference to <code>super</code> uses the <code>[[HomeObject]]</code> to determine what to do. The first step is to call <code>Object.getPrototypeOf()</code> on the <code>[[HomeObject]]</code> to retrieve a reference to the prototype. Then, the prototype is searched for a function with the same name as the executing function. Last, the <code>this</code>-binding is set and the method is called. If a function has no <code>[[HomeObject]]</code>, or has a different one than expected, then this process won’t work. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="s2">"Hello"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="c1">// prototype is person</code>
<code class="kd">let</code> <code class="nx">friend</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">__proto__</code><code class="o">:</code> <code class="nx">person</code><code class="p">,</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="kr">super</code><code class="p">()</code> <code class="o">+</code> <code class="s2">", hi!"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="kd">function</code> <code class="nx">getGlobalGreeting</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="kr">super</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">()</code> <code class="o">+</code> <code class="s2">", yo!"</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>  <code class="c1">// "Hello, hi!"</code>

<code class="nx">getGlobalGreeting</code><code class="p">();</code>                      <code class="c1">// throws error</code>
</pre></div>

        </figure>

        <p>Calling <code>friend.getGreeting()</code> returns a string while calling <code>getGlobalGreeting()</code> throws an error for improper use of <code>super</code>. Since the <code>getGlobalGreeting()</code> function has no <code>[[HomeObject]]</code>, it’s not possible to perform a lookup. Interestingly, the situation doesn’t change if <code>getGlobalGreeting()</code> is later assigned as a method on <code>friend</code>:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// prototype is person</code>
<code class="kd">let</code> <code class="nx">friend</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">__proto__</code><code class="o">:</code> <code class="nx">person</code><code class="p">,</code>
    <code class="nx">getGreeting</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="kr">super</code><code class="p">()</code> <code class="o">+</code> <code class="s2">", hi!"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="kd">function</code> <code class="nx">getGlobalGreeting</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="kr">super</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">()</code> <code class="o">+</code> <code class="s2">", yo!"</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">friend</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">());</code>  <code class="c1">// "Hello, hi!"</code>

<code class="c1">// assign getGreeting to the global function</code>
<code class="nx">friend</code><code class="p">.</code><code class="nx">getGreeting</code> <code class="o">=</code> <code class="nx">getGlobalGreeting</code><code class="p">;</code>

<code class="nx">friend</code><code class="p">.</code><code class="nx">getGreeting</code><code class="p">();</code>               <code class="c1">// throws error</code>
</pre></div>

        </figure>

        <p>Here the global <code>getGlobalGreeting()</code> function is used to overwrite the previously-defined <code>getGreeting()</code> method on <code>friend</code>. Calling <code>friend.getGreeting()</code> at that point results in an error as well. The value of <code>[[HomeObject]]</code> is only set when the function is first created, so even assigning onto an object doesn’t fix the problem.</p>

        <h3 id="leanpub-auto-summary-4">Summary</h3>

        <p>Objects are at the center of programming in JavaScript, and ECMAScript 6 has made some helpful changes to objects that both make them easier to deal with and more powerful.</p>

        <p>ECMAScript 6 makes several changes to object literals. Shorthand property definitions make it easier to assign properties whose names are the same as in-scope variables. Computed property names allow you to specify non-literal values as property names, which is something you’ve already been able to do in other areas of the language. Shorthand methods let you type a lot fewer characters in order to define methods on object literals by completely omitting the colon and <code>function</code> keyword. A loosening of the strict mode check for duplicate object literal property names was introduced as well, meaning you can now have two properties with the same name in a single object literal without an error being thrown.</p>

        <p>The <code>Object.assign()</code> method makes it easier to change multiple properties on a single object at once. This can be very useful if you use the mixin pattern. The <code>Object.is()</code> method performs strict equality on any value, effectively becoming a safer version of <code>===</code> when dealing with special JavaScript values.</p>

        <p>It’s now possible to modify an object’s prototype after it’s already created using <code>Object.setPrototypeOf()</code>. ECMAScript 6 also defines the behavior of the <code>__proto__</code> property, which is an accessor property whose getter calls <code>Object.getPrototypeOf()</code> and whose setter calls <code>Object.setPrototypeOf()</code>.</p>

        <p>The <code>super</code> keyword can now be used to call methods on an object’s prototype. It can be used either standalone as a method, such as <code>super()</code>, or as a reference to the prototype itself, such as <code>super.getGreeting()</code>. In both cases, the <code>this</code>-binding is setup automatically to work with the current value of <code>this</code>.</p>

        <h2 id="leanpub-auto-symbols">Symbols</h2>

        <aside class="warning blurb">
            <p>This chapter is a work-in-progress. As such, it may have more typos or content errors than others.</p>

        </aside>

        <p>ECMAScript 6 symbols began as a way to create private object members, a feature JavaScript developers have long wanted. The focus was around creating properties that were not identified by string names. Any property with a string name was easy picking to access regardless of the obscurity of the name. The initial “private names” feature aimed to create non-string property names. That way, normal techniques for detecting these private names wouldn’t work.</p>

        <p>The private names proposal eventually evolved into ECMAScript 6 symbols. While the implementation details remained the same (non-string values for property identifiers), TC-39 dropped the requirement that these properties be private. Instead, the properties would be categorized separately, being non-enumerable by default but still discoverable.</p>

        <p>Symbols are actually a new kind of primitive value, joining strings, numbers, booleans, <code>null</code>, and <code>undefined</code>. They are unique among JavaScript primitives in that they do not have a literal form. The ECMAScript 6 standard uses a special notation to indicate symbols, prefixing the identifier with <code>@@</code>, such as <code>@@create</code>. This book uses this same convention for ease of understanding.</p>

        <aside class="warning blurb">
            <p>Despite the notation, symbols do not exactly map to strings beginning with “@@”. Don’t try to use string values where symbols are required.</p>

        </aside>

        <h3 id="leanpub-auto-creating-symbols">Creating Symbols</h3>

        <p>You can create a symbol by using the <code>Symbol</code> function, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">firstName</code> <code class="o">=</code> <code class="nx">Symbol</code><code class="p">();</code>
<code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{};</code>

<code class="nx">person</code><code class="p">[</code><code class="nx">firstName</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Nicholas"</code><code class="p">;</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">[</code><code class="nx">firstName</code><code class="p">]);</code>     <code class="c1">// "Nicholas"</code>
</pre></div>

        </figure>

        <p>In this example, the symbol <code>firstName</code> is created and used to assign a new property on <code>person</code>. That symbol must be used each time you want to access that same property. It’s a good idea to name the symbol variable appropriately so you can easily tell what the symbol represents.</p>

        <aside class="warning blurb">
            <p>Because symbols are primitive values, <code>new Symbol()</code> throws an error when called. It is possible to create an instance of <code>Symbol</code> via <code>new Object(yourSymbol)</code>, but it’s unclear when this capability would be useful.</p>

        </aside>

        <p>The <code>Symbol</code> function accepts an optional argument that is the description of the symbol. The description itself cannot be used to access the property but is used for debugging purposes. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">firstName</code> <code class="o">=</code> <code class="nx">Symbol</code><code class="p">(</code><code class="s2">"first name"</code><code class="p">);</code>
<code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{};</code>

<code class="nx">person</code><code class="p">[</code><code class="nx">firstName</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Nicholas"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"first name"</code> <code class="k">in</code> <code class="nx">person</code><code class="p">);</code>        <code class="c1">// false</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">[</code><code class="nx">firstName</code><code class="p">]);</code>             <code class="c1">// "Nicholas"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">firstName</code><code class="p">);</code>                     <code class="c1">// "Symbol(first name)"</code>
</pre></div>

        </figure>

        <p>A symbol’s description is stored internally in a property called <code>[[Description]]</code>. This property is read whenever the symbol’s <code>toString()</code> method is called either explicitly or implicitly (as in this example). It is not otherwise possible to access <code>[[Description]]</code> directly from code. It’s recommended to always provide a description to make both reading and debugging code using symbols easier.</p>

        <h3 id="leanpub-auto-identifying-symbols">Identifying Symbols</h3>

        <p>Since symbols are primitive values, you can use the <code>typeof</code> operator to identify them. ECMAScript 6 extends <code>typeof</code> to return <code>"symbol"</code> when used on a symbol. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">symbol</code> <code class="o">=</code> <code class="nx">Symbol</code><code class="p">(</code><code class="s2">"test symbol"</code><code class="p">);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">symbol</code><code class="p">);</code>         <code class="c1">// "symbol"</code>
</pre></div>

        </figure>

        <p>While there are other indirect ways of determining whether a variable is a symbol, <code>typeof</code> is the most accurate and preferred way of doing so.</p>

        <h3 id="leanpub-auto-using-symbols">Using Symbols</h3>

        <p>You can use symbols anywhere you would use a computed property name. You’ve already seen the use of bracket notation in the previous sections, but you can use symbols in computed object literal property names as well as with <code>Object.defineProperty()</code>, and <code>Object.defineProperties()</code>, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">firstName</code> <code class="o">=</code> <code class="nx">Symbol</code><code class="p">(</code><code class="s2">"first name"</code><code class="p">);</code>
<code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="p">{</code>
    <code class="p">[</code><code class="nx">firstName</code><code class="p">]</code><code class="o">:</code> <code class="s2">"Nicholas"</code>
<code class="p">};</code>

<code class="c1">// make the property read only</code>
<code class="nb">Object</code><code class="p">.</code><code class="nx">defineProperty</code><code class="p">(</code><code class="nx">person</code><code class="p">,</code> <code class="nx">firstName</code><code class="p">,</code> <code class="p">{</code> <code class="nx">writable</code><code class="o">:</code> <code class="kc">false</code> <code class="p">});</code>

<code class="kd">var</code> <code class="nx">lastName</code> <code class="o">=</code> <code class="nx">Symbol</code><code class="p">(</code><code class="s2">"last name"</code><code class="p">);</code>

<code class="nb">Object</code><code class="p">.</code><code class="nx">defineProperties</code><code class="p">(</code><code class="nx">person</code><code class="p">,</code> <code class="p">{</code>
    <code class="p">[</code><code class="nx">lastName</code><code class="p">]</code><code class="o">:</code> <code class="p">{</code>
        <code class="nx">value</code><code class="o">:</code> <code class="s2">"Zakas"</code><code class="p">,</code>
        <code class="nx">writable</code><code class="o">:</code> <code class="kc">false</code>
    <code class="p">}</code>
<code class="p">});</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">[</code><code class="nx">firstName</code><code class="p">]);</code>     <code class="c1">// "Nicholas"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code><code class="p">[</code><code class="nx">lastName</code><code class="p">]);</code>      <code class="c1">// "Zakas"</code>
</pre></div>

        </figure>

        <p>With computed property names in object literals, symbols are very easy to work with.</p>

        <h3 id="leanpub-auto-sharing-symbols">Sharing Symbols</h3>

        <p>You may find that you want different parts of your code to use the same symbols. For example, suppose you have two different object types in your application that should use the same symbol property to represent a unique identifier. Keeping track of symbols across files or large codebases can be difficult and error-prone. That’s why ECMAScript 6 provides a global symbol registry that you can access at any point in time.</p>

        <p>When you want to create a symbol to be shared, use the <code>Symbol.for()</code> method instead of calling <code>Symbol()</code>. The <code>Symbol.for()</code> method accepts a single parameter, which is a string identifier for the symbol you want to create (this value is also used as the description). For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">uid</code> <code class="o">=</code> <code class="nx">Symbol</code><code class="p">.</code><code class="k">for</code><code class="p">(</code><code class="s2">"uid"</code><code class="p">);</code>
<code class="kd">var</code> <code class="nx">object</code> <code class="o">=</code> <code class="p">{};</code>

<code class="nx">object</code><code class="p">[</code><code class="nx">uid</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"12345"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">object</code><code class="p">[</code><code class="nx">uid</code><code class="p">]);</code>       <code class="c1">// "12345"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">uid</code><code class="p">);</code>               <code class="c1">// "Symbol(uid)"</code>
</pre></div>

        </figure>

        <p>The <code>Symbol.for()</code> method first searches the global symbol registry to see if a symbol with the key <code>"uid"</code> exists. If so, then it returns the already existing symbol. If no such symbol exists, then a new symbol is created and registered into the global symbol registry using the specified key. The new symbol is then returned. That means subsequent calls to <code>Symbol.for()</code> using the same key will return the same symbol:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">uid</code> <code class="o">=</code> <code class="nx">Symbol</code><code class="p">.</code><code class="k">for</code><code class="p">(</code><code class="s2">"uid"</code><code class="p">);</code>
<code class="kd">var</code> <code class="nx">object</code> <code class="o">=</code> <code class="p">{</code>
    <code class="p">[</code><code class="nx">uid</code><code class="p">]</code><code class="o">:</code> <code class="s2">"12345"</code>
<code class="p">};</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">object</code><code class="p">[</code><code class="nx">uid</code><code class="p">]);</code>       <code class="c1">// "12345"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">uid</code><code class="p">);</code>               <code class="c1">// "Symbol(uid)"</code>

<code class="kd">var</code> <code class="nx">uid2</code> <code class="o">=</code> <code class="nx">Symbol</code><code class="p">.</code><code class="k">for</code><code class="p">(</code><code class="s2">"uid"</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">uid</code> <code class="o">===</code> <code class="nx">uid2</code><code class="p">);</code>      <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">object</code><code class="p">[</code><code class="nx">uid2</code><code class="p">]);</code>      <code class="c1">// "12345"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">uid2</code><code class="p">);</code>              <code class="c1">// "Symbol(uid)"</code>
</pre></div>

        </figure>

        <p>In this example, <code>uid</code> and <code>uid2</code> contain the same symbol and so they can be used interchangeably. The first call to <code>Symbol.for()</code> creates the symbol and second call retrieves the symbol from the global symbol registry.</p>

        <p>Another unique aspect of shared symbols is that you can retrieve the key associated with a symbol in the global symbol registry by using <code>Symbol.keyFor()</code>, for example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">uid</code> <code class="o">=</code> <code class="nx">Symbol</code><code class="p">.</code><code class="k">for</code><code class="p">(</code><code class="s2">"uid"</code><code class="p">);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">Symbol</code><code class="p">.</code><code class="nx">keyFor</code><code class="p">(</code><code class="nx">uid</code><code class="p">));</code>    <code class="c1">// "uid"</code>

<code class="kd">var</code> <code class="nx">uid2</code> <code class="o">=</code> <code class="nx">Symbol</code><code class="p">.</code><code class="k">for</code><code class="p">(</code><code class="s2">"uid"</code><code class="p">);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">Symbol</code><code class="p">.</code><code class="nx">keyFor</code><code class="p">(</code><code class="nx">uid2</code><code class="p">));</code>   <code class="c1">// "uid"</code>

<code class="kd">var</code> <code class="nx">uid3</code> <code class="o">=</code> <code class="nx">Symbol</code><code class="p">(</code><code class="s2">"uid"</code><code class="p">);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">Symbol</code><code class="p">.</code><code class="nx">keyFor</code><code class="p">(</code><code class="nx">uid3</code><code class="p">));</code>   <code class="c1">// undefined</code>
</pre></div>

        </figure>

        <p>Notice that both <code>uid</code> and <code>uid2</code> return the key <code>"uid"</code>. The symbol <code>uid3</code> doesn’t exist in the global symbol registry, so it has no key associated with it and <code>Symbol.keyFor()</code> returns <code>undefined</code>.</p>

        <aside class="warning blurb">
            <p>The global symbol registry is a shared environment, just like the global scope. That means you can’t make assumptions about what is or is not already present in that environment. You should use namespacing of symbol keys to reduce the likelihood of naming collisions when using third-party components. For example, jQuery might prefix all keys with <code>"jquery."</code>, such as <code>"jquery.element"</code>.</p>

        </aside>

        <h3 id="leanpub-auto-finding-object-symbols">Finding Object Symbols</h3>

        <p>Similar to other properties on objects, you can access symbol properties using the <code>Object.getOwnPropertySymbols()</code> method. This method works exactly the same as <code>Object.getOwnPropertyNames()</code> except that the returned values are symbols rather than strings. Since symbols technically aren’t property names, they are omitted from the result of <code>Object.getOwnPropertyNames()</code>.</p>

        <p>The return value of <code>Object.getOwnPropertySymbols()</code> is an array of symbols that represent own properties. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">uid</code> <code class="o">=</code> <code class="nx">Symbol</code><code class="p">.</code><code class="k">for</code><code class="p">(</code><code class="s2">"uid"</code><code class="p">);</code>
<code class="kd">var</code> <code class="nx">object</code> <code class="o">=</code> <code class="p">{</code>
    <code class="p">[</code><code class="nx">uid</code><code class="p">]</code><code class="o">:</code> <code class="s2">"12345"</code>
<code class="p">};</code>

<code class="kd">var</code> <code class="nx">symbols</code> <code class="o">=</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">getOwnPropertySymbols</code><code class="p">(</code><code class="nx">object</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">symbols</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>        <code class="c1">// 1</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">symbols</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>            <code class="c1">// "Symbol(uid)"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">object</code><code class="p">[</code><code class="nx">symbols</code><code class="p">[</code><code class="mi">0</code><code class="p">]]);</code>    <code class="c1">// "12345"</code>
</pre></div>

        </figure>

        <p>In this code, <code>object</code> has a single symbol property. The array returned from <code>Object.getOwnPropertySymbols()</code> is an array containing just that symbol.</p>

        <aside class="information blurb">
            <p>All objects start off with zero own symbol properties (although they do have some inherited symbol properties).</p>

        </aside>

        <h3 id="leanpub-auto-coercing-symbols-to-strings">Coercing Symbols to Strings</h3>

        <p>TODO</p>

        <p>String(symbol) works but symbol + “” throws</p>

        <h3 id="leanpub-auto-well-known-symbols">Well-Known Symbols</h3>

        <p>In addition to the symbols you defined, there are some predefined symbols as well (called <em>well-known</em> symbols in the specification). These symbols represent common behaviors in JavaScript that were previously considered internal-only operations. Each well-known symbol is represented by a property on <code>Symbol</code>, such as <code>Symbol.create</code> for the <code>@@create</code> symbol.</p>

        <p>A central theme for both ECMAScript 5 and ECMAScript 6 was exposing and defining some of the “magic” parts of JavaScript - the parts that couldn’t be emulated by a developer. ECMAScript 6 follows this tradition by exposing even more of the previously internal-only logic of the language. It does so primarily through the use of symbol prototype properties that define the basic behavior of certain objects.</p>

        <aside class="information blurb">
            <p>Overwriting a method defined with a well-known symbol changes an ordinary object to an exotic object because this changes some internal default behavior.</p>

        </aside>

        <p>The well-known symbols are:</p>

        <ul>
            <li>
                <code>@@hasInstance</code> - a method used by <code>instanceof</code> to determine an object’s inheritance.</li>
            <li>
                <code>@@isConcatSpreadable</code> - a Boolean value indicating if use with <code>Array.prototype.concat()</code> should flatten the collection’s elements.</li>
            <li>
                <code>@@iterator</code> - a method that returns an iterator (see Chapter 7).</li>
            <li>
                <code>@@match</code> - a method used by <code>String.prototype.match()</code> to compare strings.</li>
            <li>
                <code>@@replace</code> - a method used by <code>String.prototype.replace()</code> to replace substrings.</li>
            <li>
                <code>@@search</code> - a method used by <code>String.prototype.search()</code> to locate substrings.</li>
            <li>
                <code>@@species</code> - the constructor from which derived objects are made.</li>
            <li>
                <code>@@split</code> - a method used by <code>String.prototype.split()</code> to split up strings.</li>
            <li>
                <code>@@toPrimitive</code> - a method that returns a primitive value representation of the object.</li>
            <li>
                <code>@@toStringTag</code> - a string used by <code>Object.prototype.toString()</code> to create an object description.</li>
            <li>
                <code>@@unscopeables</code> - an object whose properties are the names of object properties that should not be included in a <code>with</code> statement.</li>
        </ul>

        <p>Some of the well-known symbols are discussed below while others are discussed throughout the book to keep them in the correct context.</p>

        <h4 id="leanpub-auto-tostringtag">@@toStringTag</h4>

        <p>One of the most interesting problems in JavaScript has been the availability of multiple global execution environments. This occurs in web browsers when a page includes an iframe, as the page and the iframe each have their own execution environments. In most cases, this isn’t a problem, as data can be passed back and forth between the environments with little cause for concern. The problem arises when trying to identify what type of an object you’re dealing with.</p>

        <p>The canonical example of this is passing an array from the iframe into the containing page or vice-versa. Now in a different execution environment, <code>instanceof Array</code> returns <code>false</code> because the array was created with a constructor from a different environment.</p>

        <p>Developers soon found a good way to identify arrays. It was discovered that by calling the standard <code>toString()</code> method on the object, a predictable string was always returned. Thus, many JavaScript libraries began including a function that works similar to this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">isArray</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">toString</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="o">===</code> <code class="s2">"[object Array]"</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">isArray</code><code class="p">([]));</code>   <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>This may look a bit roundabout, but in reality it was found to work quite well in all browsers. The <code>toString()</code> method on arrays isn’t very useful for this purpose because it returns a string representation of the items it contains. The <code>toString()</code> method on <code>Object.prototype</code>, however, had this quirk where it included some internally-defined name in the result. By using this method on an object, you could retrieve what the JavaScript environment thought the data type was.</p>

        <p>Developers quickly realized that since there was no way to change this behavior, it was possible to use the same approach to distinguish between native objects and those created by developers. The most important case of this was the ECMAScript 5 <code>JSON</code> object.</p>

        <p>Prior to ECMAScript 5, many used Douglas Crockford’s <code>json2.js</code>, which created a global <code>JSON</code> object. As browsers started to implement the <code>JSON</code> global object, it became necessary to tell whether the global <code>JSON</code> was provided by the JavaScript environment itself or through some other library. Using the same technique, many created functions like this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">supportsNativeJSON</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">typeof</code> <code class="nx">JSON</code> <code class="o">!==</code> <code class="s2">"undefined"</code> <code class="o">&amp;&amp;</code>
        <code class="nb">Object</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">toString</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="nx">JSON</code><code class="p">)</code> <code class="o">===</code> <code class="s2">"[object JSON]"</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>Here, the same characteristic that allowed developers to identify arrays across iframe boundaries also provided a way to tell if <code>JSON</code> was the native one or not. A non-native <code>JSON</code> object would return <code>[object Object]</code> while the native version returned <code>[object JSON]</code>. From that point on, this approach became the de facto standard for identifying native objects.</p>

        <p>ECMAScript 6 explains this behavior through the <code>@@toStringTag</code> symbol. This symbol represents a property on each object that defines what value should be produced when <code>Object.prototype.toString.call()</code> is called on it. So the value returned for arrays is explained by having the <code>@@toStringTag</code> property equal <code>"Array"</code>. Likewise, you can define that value for your own objects:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">Person</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">Person</code><code class="p">.</code><code class="nx">prototype</code><code class="p">[</code><code class="nx">Symbol</code><code class="p">.</code><code class="nx">toStringTag</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Person"</code><code class="p">;</code>

<code class="kd">var</code> <code class="nx">me</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">me</code><code class="p">.</code><code class="nx">toString</code><code class="p">());</code>                         <code class="c1">// "[object Person]"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">toString</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="nx">me</code><code class="p">));</code>    <code class="c1">// "[object Person]"</code>
</pre></div>

        </figure>

        <p>In this example, a <code>@@toStringTag</code> property is defined on <code>Person.prototype</code> to provide the default behavior for creating a string representation. Since <code>Person.prototype</code> inherits <code>Object.prototype.toString()</code>, the value returned from <code>@@toStringTag</code> is also used when calling <code>me.toString()</code>. However, you can still define your own <code>toString()</code> that provides a different behavior without affecting the use of <code>Object.prototype.toString.call()</code>:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">Person</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">Person</code><code class="p">.</code><code class="nx">prototype</code><code class="p">[</code><code class="nx">Symbol</code><code class="p">.</code><code class="nx">toStringTag</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Person"</code><code class="p">;</code>

<code class="nx">Person</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">toString</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="p">;</code>
<code class="p">};</code>

<code class="kd">var</code> <code class="nx">me</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">me</code><code class="p">.</code><code class="nx">toString</code><code class="p">());</code>                         <code class="c1">// "Nicholas"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">toString</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="nx">me</code><code class="p">));</code>    <code class="c1">// "[object Person]"</code>
</pre></div>

        </figure>

        <p>This code defines <code>Person.prototype.toString()</code> to return the value of the <code>name</code> property. Since <code>Person</code> instances no longer inherit <code>Object.prototype.toString()</code>, calling <code>me.toString()</code> exhibits a different behavior.</p>

        <aside class="information blurb">
            <p>All objects inherit <code>@@toStringTag</code> from <code>Object.prototype</code> unless otherwise specified. This default property value is <code>"Object"</code>.</p>

        </aside>

        <p>There is no restriction on which values can be used for <code>@@toStringTag</code> on developer-defined objects. For example, there’s nothing preventing you from using <code>"Array"</code> as the value of <code>@@toStringTag</code>, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">Person</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">Person</code><code class="p">.</code><code class="nx">prototype</code><code class="p">[</code><code class="nx">Symbol</code><code class="p">.</code><code class="nx">toStringTag</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Array"</code><code class="p">;</code>

<code class="nx">Person</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">toString</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="p">;</code>
<code class="p">};</code>

<code class="kd">var</code> <code class="nx">me</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">me</code><code class="p">.</code><code class="nx">toString</code><code class="p">());</code>                         <code class="c1">// "Nicholas"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">toString</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="nx">me</code><code class="p">));</code>    <code class="c1">// "[object Array]"</code>
</pre></div>

        </figure>

        <p>Here, the result of calling <code>Object.prototype.toString()</code> is <code>"[object Array]"</code>, which is the same as you would get from an actual array. This highlights the fact that <code>Object.prototype.toString()</code> is no longer a completely reliable way of identifying an object’s type.</p>

        <p>It’s possible to change the string tag for native objects by assigning to <code>@@toStringTag</code> on their prototype. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nb">Array</code><code class="p">.</code><code class="nx">prototype</code><code class="p">[</code><code class="nx">Symbol</code><code class="p">.</code><code class="nx">toStringTag</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Magic"</code><code class="p">;</code>

<code class="kd">var</code> <code class="nx">values</code> <code class="o">=</code> <code class="p">[];</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Object</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">toString</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="nx">values</code><code class="p">));</code>    <code class="c1">// "[object Magic]"</code>
</pre></div>

        </figure>

        <p>Even though <code>@@toStringTag</code> is overwritten for arrays in this example, the call to <code>Object.prototype.toString()</code> results in <code>"[object Magic]"</code>. While it’s recommended not to change built-in objects in this way, there’s nothing in the language that forbids it.</p>

        <h4 id="leanpub-auto-toprimitive">@@toPrimitive</h4>

        <p>JavaScript frequently attempts to convert objects into primitive values implicitly when certain operations are applied. For instance, when you compare a string to an object using double equals (<code>==</code>), the object is converted into a primitive value before comparing. Exactly what value should be used was previously an internal operation that is exposed in ECMAScript 6 through the <code>@@toPrimitive</code> method.</p>

        <p>The <code>@@toPrimitive</code> method is defined on the prototype of each standard type and prescribes the exact behavior. When a primitive conversion is needed, <code>@@toPrimitive</code> is called with a single argument, referred to as <code>hint</code> in the specification. The <code>hint</code> argument is <code>"default"</code>, specifying that the operation has no preference as to the type, <code>"string"</code>, indicating a string should be returned, or <code>"number"</code>, if a number is necessary to perform the operation. Most standard objects treat <code>"default"</code> as equivalent to <code>"number"</code> (except for <code>Date</code>, which treats <code>"default"</code> as <code>"string"</code>).</p>

        <p>TODO</p>

        <h4 id="leanpub-auto-isconcatspreadable">@@isConcatSpreadable</h4>

        <p>TODO</p>

        <h4 id="leanpub-auto-species">@@species</h4>

        <p>TODO</p>

        <h4 id="leanpub-auto-unscopeables">@@unscopeables</h4>

        <p>TODO</p>

        <p>Only applied to <code>with</code> statement object records - does not refer to other scopes.</p>

        <h4 id="leanpub-auto-hasinstance">@@hasInstance</h4>

        <p>TODO</p>

        <h3 id="leanpub-auto-summary-5">Summary</h3>

        <p>TODO</p>

        <h2 id="leanpub-auto-iterators-and-generators">Iterators and Generators</h2>

        <p>Iterators have been used in many programming languages as a way to more easily work with collections of data. In ECMAScript 6, JavaScript adds iterators as an important feature of the language. When coupled with new array methods and new types of collections (such as sets and maps), iterators become even more important for efficient processing of data.</p>

        <h3 id="leanpub-auto-what-are-iterators">What are Iterators?</h3>

        <p>Iterators are nothing more than objects with a certain interface. That interface consists of a method called <code>next()</code> that returns a result object. The result object has two properties, <code>value</code>, which is the next value, and <code>done</code>, which is a boolean value that’s <code>true</code> when there are no more values to return. The iterator keeps an internal pointer to a location within a collection of values and, with each call to <code>next()</code>, returns the next appropriate value.</p>

        <p>If you call <code>next()</code> after the last value has been returned, the method returns <code>done</code> as <code>true</code> and <code>value</code> contains the return value for the iterator. The <em>return value</em> is not considered part of the data set, but rather a final piece of related data or <code>undefined</code> if no such data exists. (This concept will become clearer in the generators section later in this chapter.)</p>

        <p>With that understanding, it’s fairly easy to create an iterator using ECMAScript 5, for example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">createIterator</code><code class="p">(</code><code class="nx">items</code><code class="p">)</code> <code class="p">{</code>

    <code class="kd">var</code> <code class="nx">i</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>

    <code class="k">return</code> <code class="p">{</code>
        <code class="nx">next</code><code class="o">:</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>

            <code class="kd">var</code> <code class="nx">done</code> <code class="o">=</code> <code class="p">(</code><code class="nx">i</code> <code class="o">&gt;=</code> <code class="nx">items</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>
            <code class="kd">var</code> <code class="nx">value</code> <code class="o">=</code> <code class="o">!</code><code class="nx">done</code> <code class="o">?</code> <code class="nx">items</code><code class="p">[</code><code class="nx">i</code><code class="o">++</code><code class="p">]</code> <code class="o">:</code> <code class="kc">undefined</code><code class="p">;</code>

            <code class="k">return</code> <code class="p">{</code>
                <code class="nx">done</code><code class="o">:</code> <code class="nx">done</code><code class="p">,</code>
                <code class="nx">value</code><code class="o">:</code> <code class="nx">value</code>
            <code class="p">};</code>

        <code class="p">}</code>
    <code class="p">};</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">createIterator</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 1, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 2, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 3, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: undefined, done: true }"</code>

<code class="c1">// for all further calls</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: undefined, done: true }"</code>
</pre></div>

        </figure>

        <p>The <code>createIterator()</code> function in this example returns an object with a <code>next()</code> method. Each time the method is called, the next value in the <code>items</code> array is returned as <code>value</code>. When <code>i</code> is 3, <code>items[i++]</code> returns <code>undefined</code> and <code>done</code> is <code>true</code>, which fulfills the special last case for iterators in ECMAScript 6.</p>

        <p>ECMAScript 6 makes use of iterators in a number of places to make dealing with collections of data easier, so having a good basic understanding allows you to better understand the language as a whole.</p>

        <h3 id="leanpub-auto-generators">Generators</h3>

        <p>You might be thinking that iterators sound interesting but they look like a bunch of work. Indeed, writing iterators so that they adhere to the correct behavior is a bit difficult, which is why ECMAScript 6 provides generators. A <em>generator</em> is a special kind of function that returns an iterator. Generator functions are indicated by inserting a star character (<code>*</code>) after the <code>function</code> keyword (it doesn’t matter if the star is directly next to <code>function</code> or if there’s some whitespace between them). The <code>yield</code> keyword is used inside of generators to specify the values that the iterator should return when <code>next()</code> is called. So if you want to return three different values for each successive call to <code>next()</code>, you can do so as follows:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// generator</code>
<code class="kd">function</code> <code class="o">*</code><code class="nx">createIterator</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">yield</code> <code class="mi">1</code><code class="p">;</code>
    <code class="k">yield</code> <code class="mi">2</code><code class="p">;</code>
    <code class="k">yield</code> <code class="mi">3</code><code class="p">;</code>
<code class="p">}</code>

<code class="c1">// generators are called like regular functions but return an iterator</code>
<code class="kd">let</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">createIterator</code><code class="p">();</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code> <code class="nx">of</code> <code class="nx">iterator</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">i</code><code class="p">);</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This code outputs the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="mi">1</code>
<code class="mi">2</code>
<code class="mi">3</code>
</pre></div>

        </figure>

        <p>In this example, the <code>createIterator()</code> function is a generator (as indicated by the <code>*</code> before the name) and it’s called like any other function. The value returned is an object that adheres to the iterator pattern. Multiple <code>yield</code> statements inside the generator indicate the progression of values that should be returned when <code>next()</code> is called on the iterator. First, <code>next()</code> should return <code>1</code>, then <code>2</code>, and then <code>3</code> before the iterator is finished.</p>

        <p>Perhaps the most interesting aspect of generator functions is that they stop execution after each <code>yield</code> statement, so <code>yield 1</code> executes and then the function doesn’t execute anything else until the iterator’s <code>next()</code> method is called. At that point, execution resumes with the next statement after <code>yield 1</code>, which in this case is <code>yield 2</code>. This ability to stop execution in the middle of a function is extremely powerful and lends to some interesting uses of generator functions (discussed later in this chapter).</p>

        <p>The <code>yield</code> keyword can be used with any value or expression, so you can do interesting things like use <code>yield</code> inside of a <code>for</code> loop:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="o">*</code><code class="nx">createIterator</code><code class="p">(</code><code class="nx">items</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">items</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">yield</code> <code class="nx">items</code><code class="p">[</code><code class="nx">i</code><code class="p">];</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">createIterator</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 1, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 2, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 3, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: undefined, done: true }"</code>

<code class="c1">// for all further calls</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: undefined, done: true }"</code>
</pre></div>

        </figure>

        <p>In this example, an array is used in a <code>for</code> loop, yielding each item as the loop progresses. Each time <code>yield</code> is encountered, the loop stops, and each time <code>next()</code> is called on <code>iterator</code>, the loop picks back up where it left off.</p>

        <p>Generator functions are an important part of ECMAScript 6, and since they are just functions, they can be used in all the same places.</p>

        <h4 id="leanpub-auto-generator-function-expressions">Generator Function Expressions</h4>

        <p>Generators can be created using function expressions in the same way as using function declarations by including a star (<code>*</code>) character between the <code>function</code> keyword and the opening paren, for example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">createIterator</code> <code class="o">=</code> <code class="kd">function</code> <code class="o">*</code><code class="p">(</code><code class="nx">items</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">items</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">yield</code> <code class="nx">items</code><code class="p">[</code><code class="nx">i</code><code class="p">];</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="kd">let</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">createIterator</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 1, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 2, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 3, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: undefined, done: true }"</code>

<code class="c1">// for all further calls</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: undefined, done: true }"</code>
</pre></div>

        </figure>

        <p>In this code, <code>createIterator()</code> is created by using a generator function expression. This behaves exactly the same as the example in the previous section.</p>

        <h4 id="leanpub-auto-generator-object-methods">Generator Object Methods</h4>

        <p>Because generators are just functions, they can be added to objects the same way as any other functions. For example, you can use an ECMAScript 5-style object literal with a function expression:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">o</code> <code class="o">=</code> <code class="p">{</code>

    <code class="nx">createIterator</code><code class="o">:</code> <code class="kd">function</code> <code class="o">*</code><code class="p">(</code><code class="nx">items</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">items</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">yield</code> <code class="nx">items</code><code class="p">[</code><code class="nx">i</code><code class="p">];</code>
        <code class="p">}</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="kd">let</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">o</code><code class="p">.</code><code class="nx">createIterator</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]);</code>
</pre></div>

        </figure>

        <p>You can also use the ECMAScript 6 method shorthand by prepending the method name with a star (<code>*</code>):</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">o</code> <code class="o">=</code> <code class="p">{</code>

    <code class="o">*</code><code class="nx">createIterator</code><code class="p">(</code><code class="nx">items</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">items</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">yield</code> <code class="nx">items</code><code class="p">[</code><code class="nx">i</code><code class="p">];</code>
        <code class="p">}</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="kd">let</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">o</code><code class="p">.</code><code class="nx">createIterator</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]);</code>
</pre></div>

        </figure>

        <p>This example is functionally equivalent to the previous one, the only difference is the syntax used.</p>

        <h4 id="leanpub-auto-generator-class-methods">Generator Class Methods</h4>

        <p>Similar to objects, you can add generator methods directly to classes using almost the same syntax:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">MyClass</code> <code class="p">{</code>

    <code class="o">*</code><code class="nx">createIterator</code><code class="p">(</code><code class="nx">items</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">items</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">yield</code> <code class="nx">items</code><code class="p">[</code><code class="nx">i</code><code class="p">];</code>
        <code class="p">}</code>
    <code class="p">}</code>

<code class="p">}</code>

<code class="kd">let</code> <code class="nx">o</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">MyClass</code><code class="p">();</code>
<code class="kd">let</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">o</code><code class="p">.</code><code class="nx">createIterator</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]);</code>
</pre></div>

        </figure>

        <p>The syntax is very similar to using shorthand object literal methods, as the asterisk needs to come before the method name.</p>

        <h3 id="leanpub-auto-iterables-and-for-of">Iterables and for-of</h3>

        <p>Closely related to the concept of an iterator is an iterable. An <em>iterable</em> is an object that has a default iterator specified using the <code>@@iterator</code> symbol. More specifically, <code>@@iterator</code> contains a function that returns an iterator for the given object. All of the collection objects, including arrays, sets, and maps, as well as strings, are iterables and so have a default iterator specified. Iterables are designed to be used with a new addition to ECMAScript: the <code>for-of</code> loop.</p>

        <p>The <code>for-of</code> loop is similar to the other loops in ECMAScript except that it is designed to work with iterables. The loop itself calls <code>next()</code> behind the scenes and exits when the <code>done</code> property of the returned object is <code>true</code>. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">values</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">];</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code> <code class="nx">of</code> <code class="nx">values</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">i</code><code class="p">);</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This code outputs the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="mi">1</code>
<code class="mi">2</code>
<code class="mi">3</code>
</pre></div>

        </figure>

        <p>The <code>for-of</code> loop in this example is first calling the <code>@@iterator</code> method to retrieve an iterator, and then calling <code>iterator.next()</code> and assigning the variable <code>i</code> to the value returned on the <code>value</code> property. So <code>i</code> is first 1, then 2, and finally 3. When <code>done</code> is <code>true</code>, the loop exits, so <code>i</code> is never assigned the value of <code>undefined</code>.</p>

        <aside class="warning blurb">
            <p>The <code>for-of</code> statement will throw an error when used on, a non-iterable, <code>null</code>, or <code>undefined</code>.</p>

        </aside>

        <h4 id="leanpub-auto-accessing-the-default-iterator">Accessing the Default Iterator</h4>

        <p>You can access the default iterator for an object using <code>Symbol.iterator</code>, for example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">values</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">];</code>
<code class="kd">let</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">values</code><code class="p">[</code><code class="nx">Symbol</code><code class="p">.</code><code class="nx">iterator</code><code class="p">]();</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 1, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 2, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 3, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: undefined, done: true }"</code>
</pre></div>

        </figure>

        <p>This code gets the default iterator for <code>values</code> and uses that to iterate over the values in the array. Knowing that <code>Symbol.iterator</code> specifies the default iterator, it’s possible to detect if an object is iterable by using the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">isIterable</code><code class="p">(</code><code class="nx">object</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">typeof</code> <code class="nx">object</code><code class="p">[</code><code class="nx">Symbol</code><code class="p">.</code><code class="nx">iterator</code><code class="p">]</code> <code class="o">===</code> <code class="s2">"function"</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">isIterable</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]));</code>     <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">isIterable</code><code class="p">(</code><code class="s2">"Hello"</code><code class="p">));</code>       <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">isIterable</code><code class="p">(</code><code class="k">new</code> <code class="nx">Map</code><code class="p">()));</code>     <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">isIterable</code><code class="p">(</code><code class="k">new</code> <code class="nx">Set</code><code class="p">()));</code>     <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>The <code>isIterable()</code> function simply checks to see if a default iterator exists on the object and is a function. This is similar to the check that the <code>for-of</code> loop does before executing.</p>

        <h4 id="leanpub-auto-creating-iterables">Creating Iterables</h4>

        <p>Developer-defined objects are not iterable by default, but you can make them iterable by using the <code>@@iterator</code> symbol. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">collection</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">items</code><code class="o">:</code> <code class="p">[],</code>
    <code class="o">*</code><code class="p">[</code><code class="nx">Symbol</code><code class="p">.</code><code class="nx">iterator</code><code class="p">]()</code> <code class="p">{</code>
        <code class="k">yield</code> <code class="o">*</code><code class="k">this</code><code class="p">.</code><code class="nx">items</code><code class="p">.</code><code class="nx">values</code><code class="p">();</code>
    <code class="p">}</code>

<code class="p">};</code>

<code class="nx">collection</code><code class="p">.</code><code class="nx">items</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="mi">1</code><code class="p">);</code>
<code class="nx">collection</code><code class="p">.</code><code class="nx">items</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="mi">2</code><code class="p">);</code>
<code class="nx">collection</code><code class="p">.</code><code class="nx">items</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="mi">3</code><code class="p">);</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">x</code> <code class="nx">of</code> <code class="nx">collection</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">x</code><code class="p">);</code>
<code class="p">}</code>

<code class="c1">// Output:</code>
<code class="c1">// 1</code>
<code class="c1">// 2</code>
<code class="c1">// 3</code>
</pre></div>

        </figure>

        <p>This code defines a default iterator for a variable called <code>collection</code> using object literal method shorthand and a computed property using <code>Symbol.iterator</code>. The generator then delegates to the <code>values()</code> iterator of <code>this.items</code> using the <code>yield *</code> notation, discussed later in this chapter. The <code>for-of</code> loop then uses the generator to create an iterator and execute the loop.</p>

        <p>You can also define a default iterator using classes, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">Collection</code> <code class="p">{</code>

    <code class="nx">constructor</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">items</code> <code class="o">=</code> <code class="p">[];</code>
    <code class="p">}</code>

    <code class="o">*</code><code class="p">[</code><code class="nx">Symbol</code><code class="p">.</code><code class="nx">iterator</code><code class="p">]()</code> <code class="p">{</code>
        <code class="k">yield</code> <code class="o">*</code><code class="k">this</code><code class="p">.</code><code class="nx">items</code><code class="p">.</code><code class="nx">values</code><code class="p">();</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">collection</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Collection</code><code class="p">();</code>
<code class="nx">collection</code><code class="p">.</code><code class="nx">items</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="mi">1</code><code class="p">);</code>
<code class="nx">collection</code><code class="p">.</code><code class="nx">items</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="mi">2</code><code class="p">);</code>
<code class="nx">collection</code><code class="p">.</code><code class="nx">items</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="mi">3</code><code class="p">);</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">x</code> <code class="nx">of</code> <code class="nx">collection</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">x</code><code class="p">);</code>
<code class="p">}</code>

<code class="c1">// Output:</code>
<code class="c1">// 1</code>
<code class="c1">// 2</code>
<code class="c1">// 3</code>
</pre></div>

        </figure>

        <p>This example mirrors the previous one with the exception that a class is used instead of an object literal.</p>

        <p>Default iterators can be added to any object by assigning a generator to <code>Symbol.iterator</code>. It doesn’t matter if the property is an own or prototype property, as <code>for-of</code> normal prototype chain lookup applies.</p>

        <h3 id="leanpub-auto-built-in-iterators">Built-in Iterators</h3>

        <p>Another way that ECMAScript 6 makes using iterators easier is by making iterators available on many objects by default. You don’t actually need to create your own iterators for many of the built-in types because the language has them already. You only need to create iterators when you find that the built-in ones don’t serve your purpose.</p>

        <h4 id="leanpub-auto-collection-iterators">Collection Iterators</h4>

        <p>The ECMAScript 6 collection objects, arrays, maps, and sets, all have three default iterators to help you navigate data. You can retrieve an iterator for a collection by calling one of these methods:</p>

        <ul>
            <li>
                <code>entries()</code> - returns an iterator whose values are a key-value pair.</li>
            <li>
                <code>values()</code> - returns an iterator whose values are the values of the collection.</li>
            <li>
                <code>keys()</code> - returns an iterator whose values are the keys contained in the collection.</li>
        </ul>

        <p>The <code>entries()</code> iterator actually returns a two-item array where the first item is the key and the second item is the value. For arrays, the first item is the numeric index; for sets, the first item is also the value (since values double as keys in sets). Here are some examples:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">colors</code> <code class="o">=</code> <code class="p">[</code> <code class="s2">"red"</code><code class="p">,</code> <code class="s2">"green"</code><code class="p">,</code> <code class="s2">"blue"</code> <code class="p">];</code>
<code class="kd">let</code> <code class="nx">tracking</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Set</code><code class="p">([</code><code class="mi">1234</code><code class="p">,</code> <code class="mi">5678</code><code class="p">,</code> <code class="mi">9012</code><code class="p">]);</code>
<code class="kd">let</code> <code class="nx">data</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Map</code><code class="p">();</code>

<code class="nx">data</code><code class="p">.</code><code class="nx">set</code><code class="p">(</code><code class="s2">"title"</code><code class="p">,</code> <code class="s2">"Understanding ECMAScript 6"</code><code class="p">);</code>
<code class="nx">data</code><code class="p">.</code><code class="nx">set</code><code class="p">(</code><code class="s2">"format"</code><code class="p">,</code> <code class="s2">"ebook"</code><code class="p">);</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">entry</code> <code class="nx">of</code> <code class="nx">colors</code><code class="p">.</code><code class="nx">entries</code><code class="p">())</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">entry</code><code class="p">);</code>
<code class="p">}</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">entry</code> <code class="nx">of</code> <code class="nx">tracking</code><code class="p">.</code><code class="nx">entries</code><code class="p">())</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">entry</code><code class="p">);</code>
<code class="p">}</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">entry</code> <code class="nx">of</code> <code class="nx">data</code><code class="p">.</code><code class="nx">entries</code><code class="p">())</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">entry</code><code class="p">);</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This example outputs the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="k">[0, "red"]</code>
<code class="k">[1, "green"]</code>
<code class="k">[2, "blue"]</code>
<code class="k">[1234, 1234]</code>
<code class="k">[5678, 5678]</code>
<code class="k">[9012, 9012]</code>
<code class="k">["title", "Understanding ECMAScript 6"]</code>
<code class="k">["format", "ebook"]</code>
</pre></div>

        </figure>

        <p>The <code>values()</code> iterator simply returns the values as they are stored in the collection. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">colors</code> <code class="o">=</code> <code class="p">[</code> <code class="s2">"red"</code><code class="p">,</code> <code class="s2">"green"</code><code class="p">,</code> <code class="s2">"blue"</code> <code class="p">];</code>
<code class="kd">let</code> <code class="nx">tracking</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Set</code><code class="p">([</code><code class="mi">1234</code><code class="p">,</code> <code class="mi">5678</code><code class="p">,</code> <code class="mi">9012</code><code class="p">]);</code>
<code class="kd">let</code> <code class="nx">data</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Map</code><code class="p">();</code>

<code class="nx">data</code><code class="p">.</code><code class="nx">set</code><code class="p">(</code><code class="s2">"title"</code><code class="p">,</code> <code class="s2">"Understanding ECMAScript 6"</code><code class="p">);</code>
<code class="nx">data</code><code class="p">.</code><code class="nx">set</code><code class="p">(</code><code class="s2">"format"</code><code class="p">,</code> <code class="s2">"ebook"</code><code class="p">);</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">value</code> <code class="nx">of</code> <code class="nx">colors</code><code class="p">.</code><code class="nx">values</code><code class="p">())</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
<code class="p">}</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">value</code> <code class="nx">of</code> <code class="nx">tracking</code><code class="p">.</code><code class="nx">values</code><code class="p">())</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
<code class="p">}</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">value</code> <code class="nx">of</code> <code class="nx">data</code><code class="p">.</code><code class="nx">values</code><code class="p">())</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This example outputs the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="s">"red"</code>
<code class="s">"green"</code>
<code class="s">"blue"</code>
<code class="mi">1234</code>
<code class="mi">5678</code>
<code class="mi">9012</code>
<code class="s">"Understanding ECMAScript 6"</code>
<code class="s">"ebook"</code>
</pre></div>

        </figure>

        <p>In this case, using <code>values()</code> returns the exact data contained in the <code>value</code> property returned from <code>next()</code>.</p>

        <p>The <code>keys()</code> iterator returns each key present in the collection. For arrays, this is the numeric keys only (it never returns other own properties of the array); for sets, the keys are the same as the values and so <code>keys()</code> and <code>values()</code> return the same iterator.</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">colors</code> <code class="o">=</code> <code class="p">[</code> <code class="s2">"red"</code><code class="p">,</code> <code class="s2">"green"</code><code class="p">,</code> <code class="s2">"blue"</code> <code class="p">];</code>
<code class="kd">let</code> <code class="nx">tracking</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Set</code><code class="p">([</code><code class="mi">1234</code><code class="p">,</code> <code class="mi">5678</code><code class="p">,</code> <code class="mi">9012</code><code class="p">]);</code>
<code class="kd">let</code> <code class="nx">data</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Map</code><code class="p">();</code>

<code class="nx">data</code><code class="p">.</code><code class="nx">set</code><code class="p">(</code><code class="s2">"title"</code><code class="p">,</code> <code class="s2">"Understanding ECMAScript 6"</code><code class="p">);</code>
<code class="nx">data</code><code class="p">.</code><code class="nx">set</code><code class="p">(</code><code class="s2">"format"</code><code class="p">,</code> <code class="s2">"ebook"</code><code class="p">);</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">key</code> <code class="nx">of</code> <code class="nx">colors</code><code class="p">.</code><code class="nx">keys</code><code class="p">())</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">key</code><code class="p">);</code>
<code class="p">}</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">key</code> <code class="nx">of</code> <code class="nx">tracking</code><code class="p">.</code><code class="nx">keys</code><code class="p">())</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">key</code><code class="p">);</code>
<code class="p">}</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">key</code> <code class="nx">of</code> <code class="nx">data</code><code class="p">.</code><code class="nx">keys</code><code class="p">())</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">key</code><code class="p">);</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This example outputs the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="mi">0</code>
<code class="mi">1</code>
<code class="mi">2</code>
<code class="mi">1234</code>
<code class="mi">5678</code>
<code class="mi">9012</code>
<code class="s">"title"</code>
<code class="s">"format"</code>
</pre></div>

        </figure>

        <p>Additionally, each collection type has a default iterator that is used by <code>for-of</code> whenever an iterator isn’t explicitly specified. The default iterator for arrays and sets is <code>values()</code> while the default iterator for maps is <code>entries()</code>. This makes it a little bit easier to use collection objects in <code>for-of</code>:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">colors</code> <code class="o">=</code> <code class="p">[</code> <code class="s2">"red"</code><code class="p">,</code> <code class="s2">"green"</code><code class="p">,</code> <code class="s2">"blue"</code> <code class="p">];</code>
<code class="kd">let</code> <code class="nx">tracking</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Set</code><code class="p">([</code><code class="mi">1234</code><code class="p">,</code> <code class="mi">5678</code><code class="p">,</code> <code class="mi">9012</code><code class="p">]);</code>
<code class="kd">let</code> <code class="nx">data</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Map</code><code class="p">();</code>

<code class="nx">data</code><code class="p">.</code><code class="nx">set</code><code class="p">(</code><code class="s2">"title"</code><code class="p">,</code> <code class="s2">"Understanding ECMAScript 6"</code><code class="p">);</code>
<code class="nx">data</code><code class="p">.</code><code class="nx">set</code><code class="p">(</code><code class="s2">"format"</code><code class="p">,</code> <code class="s2">"ebook"</code><code class="p">);</code>

<code class="c1">// same as using colors.values()</code>
<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">value</code> <code class="nx">of</code> <code class="nx">colors</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
<code class="p">}</code>

<code class="c1">// same as using tracking.values()</code>
<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">num</code> <code class="nx">of</code> <code class="nx">tracking</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">num</code><code class="p">);</code>
<code class="p">}</code>

<code class="c1">// same as using data.entries()</code>
<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">entry</code> <code class="nx">of</code> <code class="nx">data</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">entry</code><code class="p">);</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This example outputs the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="s">"red"</code>
<code class="s">"green"</code>
<code class="s">"blue"</code>
<code class="mi">1234</code>
<code class="mi">5678</code>
<code class="mi">9012</code>
<code class="p">[</code><code class="s">"title"</code><code class="p">,</code> <code class="s">"Understanding ECMAScript 6"</code><code class="p">]</code>
<code class="p">[</code><code class="s">"format"</code><code class="p">,</code> <code class="s">"ebook"</code><code class="p">]</code>
</pre></div>

        </figure>

        <h4 id="leanpub-auto-string-iterators">String Iterators</h4>

        <p>Beginning with ECMAScript 5, JavaScript strings have slowly been evolving to be more array-like. ECMAScript 5 formalizes bracket notation for access characters (<code>text[0]</code> to get the first character). Unfortunately, bracket notation works on code units rather than characters, so it cannot be used to access double-byte characters correctly. ECMAScript 6 has added a lot of functionality to fully support Unicode (see Chapter 1) and as such, the default iterator for strings works on characters rather than code units.</p>

        <p>Using bracket notation and the <code>length</code> property, the code units are used instead of characters and the output is a bit unexpected:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">message</code> <code class="o">=</code> <code class="s2">"A ð ®· B"</code><code class="p">;</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">message</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">message</code><code class="p">[</code><code class="nx">i</code><code class="p">]);</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This code outputs the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="n">A</code>
<code class="p">(</code><code class="n">blank</code><code class="p">)</code>
<code class="p">(</code><code class="n">blank</code><code class="p">)</code>
<code class="p">(</code><code class="n">blank</code><code class="p">)</code>
<code class="p">(</code><code class="n">blank</code><code class="p">)</code>
<code class="n">B</code>
</pre></div>

        </figure>

        <p>Since the double-byte character is treated as two separate code units, there are four empty lines between <code>A</code> and <code>B</code> in the output.</p>

        <p>Using the default string iterator with a <code>for-of</code> loop results in a more appropriate result:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">message</code> <code class="o">=</code> <code class="s2">"A ð ®· B"</code><code class="p">;</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">c</code> <code class="nx">of</code> <code class="nx">message</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">c</code><code class="p">);</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This code outputs the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="n">A</code>
<code class="p">(</code><code class="n">blank</code><code class="p">)</code>
<code class="err">ð</code> <code class="err">®·</code>
<code class="p">(</code><code class="n">blank</code><code class="p">)</code>
<code class="n">B</code>
</pre></div>

        </figure>

        <p>This output is more in line with what you might expect when working with characters. The default string iterator is ECMAScript 6’s attempt at solving the iteration problem by using characters instead of code units.</p>

        <h4 id="leanpub-auto-nodelist-iterators">NodeList Iterators</h4>

        <p>In the Document Object Model (DOM), there is a <code>NodeList</code> type that represents a collection of elements in a document. For those who write JavaScript to run in web browsers, understanding the difference between <code>NodeList</code> objects and arrays has always been a bit difficult. Both use the <code>length</code> property to indicate the number of items and both use bracket notation to access individual items. However, internally a <code>NodeList</code> and an array behave quite differently, and so that has led to a lot of confusion.</p>

        <p>With the addition of default iterators in ECMAScript 6, the DOM definition of <code>NodeList</code> now specifically includes a default iterator that behaves in the same manner as the array default iterator. That means you can use <code>NodeList</code> in a <code>for-of</code> loop or any other place that uses an object’s default iterator. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">divs</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementsByTagName</code><code class="p">(</code><code class="s2">"div"</code><code class="p">);</code>

<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">div</code> <code class="nx">of</code> <code class="nx">divs</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">div</code><code class="p">.</code><code class="nx">id</code><code class="p">);</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This code uses <code>getElementsByTagName()</code> method to retrieve a <code>NodeList</code> that represents all of the <code>&lt;div&gt;</code> elements in the document. The <code>for-of</code> loop then iterates over each element and outputs its ID, effectively making the code the same as it would be for a standard array.</p>

        <h3 id="leanpub-auto-advanced-functionality">Advanced Functionality</h3>

        <p>There’s a lot that can be accomplished with the basic functionality of iterators and the convenience of creating them using generators. However, developers have discovered that iterators are much more powerful when used for tasks other than simply iterating over a collection of values. During the development of ECMAScript 6, a lot of unique ideas and patterns emerged that caused the addition of more functionality. Some of the changes are subtle, but when used together, can accomplish some interesting interactions.</p>

        <h4 id="leanpub-auto-passing-arguments-to-iterators">Passing Arguments to Iterators</h4>

        <p>Throughout this chapter, you’ve seen that iterators can pass values out via the <code>next()</code> method or by using <code>yield</code> in a generator. It’s also possible to pass arguments into the iterator through the <code>next()</code> method. When an argument is passed to <code>next()</code>, it becomes the value of the <code>yield</code> statement inside a generator. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="o">*</code><code class="nx">createIterator</code><code class="p">()</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">first</code> <code class="o">=</code> <code class="k">yield</code> <code class="mi">1</code><code class="p">;</code>
    <code class="kd">let</code> <code class="nx">second</code> <code class="o">=</code> <code class="k">yield</code> <code class="nx">first</code> <code class="o">+</code> <code class="mi">2</code><code class="p">;</code>       <code class="c1">// 4 + 2</code>
    <code class="k">yield</code> <code class="nx">second</code> <code class="o">+</code> <code class="mi">3</code><code class="p">;</code>                   <code class="c1">// 5 + 3</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">createIterator</code><code class="p">();</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 1, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">(</code><code class="mi">4</code><code class="p">));</code>          <code class="c1">// "{ value: 6, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">(</code><code class="mi">5</code><code class="p">));</code>          <code class="c1">// "{ value: 8, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: undefined, done: true }"</code>
</pre></div>

        </figure>

        <p>The first call to <code>next()</code> is a special case where any argument passed to it is lost. Since arguments passed to <code>next()</code> become the value returned by <code>yield</code>, there would have to be a way to access that argument before the first <code>yield</code> in the generator function. That’s not possible, so there’s no reason to pass an argument the first time <code>next()</code> is called.</p>

        <p>On the second call to <code>next()</code>, the value <code>4</code> is passed as the argument. The <code>4</code> ends up assigned to the variable <code>first</code> inside the generator function. In a <code>yield</code> statement including an assignment the right side of the expression is evaluated on the first call to <code>next()</code> and the left side is evaluated on the second call to <code>next()</code> before the function continues executing. Since the second call to <code>next()</code> passes in <code>4</code>, that value is assigned to <code>first</code> and then execution continues.</p>

        <p>The second <code>yield</code> uses the result of the first <code>yield</code> and adds two, which means it returns a value of six. When <code>next()</code> is called a third time, the value <code>5</code> is passed as an argument. That value is assigned to the variable <code>second</code> and then used in the third <code>yield</code> statement to return eight.</p>

        <p>It’s a bit easier to think about what’s happening by considering which code is executing each time execution continues inside the generator function. Figure 6-1 uses colors to show the code being executed before yielding.</p>


        <figure class="image center">
            <img src="/site_images/understandinges6/fg0601.png" alt="Figure 6-1: Code execution inside a generator">
            <figcaption>Figure 6-1: Code execution inside a generator</figcaption>
        </figure>


        <p>The color yellow represents the first call to <code>next()</code> and all of the code that is executed inside of the generator as a result; the color aqua represents the call to <code>next(4)</code> and the code that is executed; the color purple represents the call to <code>next(5)</code> and the code that is executed as a result. The tricky part is the code on the right side of each expression executing and stopping before the left side is executed. This makes debugging complicated generators a bit more involved than regular functions.</p>

        <h4 id="leanpub-auto-throwing-errors-in-iterators">Throwing Errors in Iterators</h4>

        <p>It’s not only possible to pass data into iterators, it’s also possible to pass error conditions. Iterators can choose to implement a <code>throw()</code> method that instructs the iterator to throw an error when it resumes. You can pass in an error object that should be thrown when the iterator continues processing. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="o">*</code><code class="nx">createIterator</code><code class="p">()</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">first</code> <code class="o">=</code> <code class="k">yield</code> <code class="mi">1</code><code class="p">;</code>
    <code class="kd">let</code> <code class="nx">second</code> <code class="o">=</code> <code class="k">yield</code> <code class="nx">first</code> <code class="o">+</code> <code class="mi">2</code><code class="p">;</code>       <code class="c1">// yield 4 + 2, then throw</code>
    <code class="k">yield</code> <code class="nx">second</code> <code class="o">+</code> <code class="mi">3</code><code class="p">;</code>                   <code class="c1">// never is executed</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">createIterator</code><code class="p">();</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>                   <code class="c1">// "{ value: 1, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">(</code><code class="mi">4</code><code class="p">));</code>                  <code class="c1">// "{ value: 6, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="k">throw</code><code class="p">(</code><code class="k">new</code> <code class="nb">Error</code><code class="p">(</code><code class="s2">"Boom"</code><code class="p">)));</code> <code class="c1">// error thrown from generator</code>
</pre></div>

        </figure>

        <p>In this example, the first two <code>yield</code> expressions are evaluated as normal, but when <code>throw()</code> is called, an error is thrown before <code>let second</code> is evaluated. This effectively halts code execution similar to directly throwing an error. The only difference is the location in which the error is thrown. Figure 6-2 shows which code is executed at each step.</p>


        <figure class="image center">
            <img src="/site_images/understandinges6/fg0602.png" alt="Figure 6-2: Throwing an error inside a generator">
            <figcaption>Figure 6-2: Throwing an error inside a generator</figcaption>
        </figure>


        <p>In this figure, the color red represents the code executed when <code>throw()</code> is called and the red star shows approximately when the error is thrown inside the generator. The first two <code>yield</code> statements are evaluated fine, it’s only when <code>throw()</code> is called that an error is thrown before any other code is executed. Knowing this, it’s possible to catch such errors inside the generator using a <code>try-catch</code> block, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="o">*</code><code class="nx">createIterator</code><code class="p">()</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">first</code> <code class="o">=</code> <code class="k">yield</code> <code class="mi">1</code><code class="p">;</code>
    <code class="kd">let</code> <code class="nx">second</code><code class="p">;</code>

    <code class="k">try</code> <code class="p">{</code>
        <code class="nx">second</code> <code class="o">=</code> <code class="k">yield</code> <code class="nx">first</code> <code class="o">+</code> <code class="mi">2</code><code class="p">;</code>       <code class="c1">// yield 4 + 2, then throw</code>
    <code class="p">}</code> <code class="k">catch</code> <code class="p">(</code><code class="nx">ex</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">second</code> <code class="o">=</code> <code class="mi">6</code><code class="p">;</code>                     <code class="c1">// on error, assign a different value</code>
    <code class="p">}</code>
    <code class="k">yield</code> <code class="nx">second</code> <code class="o">+</code> <code class="mi">3</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">createIterator</code><code class="p">();</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>                   <code class="c1">// "{ value: 1, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">(</code><code class="mi">4</code><code class="p">));</code>                  <code class="c1">// "{ value: 6, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="k">throw</code><code class="p">(</code><code class="k">new</code> <code class="nb">Error</code><code class="p">(</code><code class="s2">"Boom"</code><code class="p">)));</code> <code class="c1">// "{ value: 9, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>            <code class="c1">// "{ value: undefined, done: true }"</code>
</pre></div>

        </figure>

        <p>In this example, a <code>try-catch</code> block is wrapped around the second <code>yield</code> statement. While this <code>yield</code> executes without error, the error is thrown before any value can be assigned to <code>second</code>, so the <code>catch</code> block assigns it a value of six. Execution then flows to the next <code>yield</code> and returns nine.</p>

        <p>You’ll also notice something interesting happened - the <code>throw()</code> method returned a value similar to that returned by <code>next()</code>. Because the error was caught inside the generator, code execution continued on to the next <code>yield</code> and returned the appropriate value.</p>

        <p>It helps to think of <code>next()</code> and <code>throw()</code> as both being instructions to the iterator: <code>next()</code> instructs the iterator to continue executing (possibly with a given value) and <code>throw()</code> instructs the iterator to continue executing by throwing an error. What happens after that point depends on the code inside the generator.</p>

        <h4 id="leanpub-auto-generator-return-statements">Generator Return Statements</h4>

        <p>Since generators are functions, you can use the <code>return</code> statement both to exit early and to specify a return value for the last call to <code>next()</code>. For most of this chapter you’ve seen examples where the last call to <code>next()</code> on an iterator returns <code>undefined</code>. It’s possible to specify an alternate value by using <code>return</code> as you would in any other function. In a generator, <code>return</code> indicates that all processing is done, so the <code>done</code> property is set to <code>true</code> and the value, if provided, becomes the <code>value</code> field. Here’s an example that simply exits early using <code>return</code>:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="o">*</code><code class="nx">createIterator</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">yield</code> <code class="mi">1</code><code class="p">;</code>
    <code class="k">return</code><code class="p">;</code>
    <code class="k">yield</code> <code class="mi">2</code><code class="p">;</code>
    <code class="k">yield</code> <code class="mi">3</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">createIterator</code><code class="p">();</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 1, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: undefined, done: true }"</code>
</pre></div>

        </figure>

        <p>In this code, the generator has a <code>yield</code> statement followed by a <code>return</code> statement. The <code>return</code> indicates that there are no more values to come and so the rest of the <code>yield</code> statements will not execute (they are unreachable).</p>

        <p>You can also specify a return value that will end up in the <code>value</code> field of the returned object. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="o">*</code><code class="nx">createIterator</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">yield</code> <code class="mi">1</code><code class="p">;</code>
    <code class="k">return</code> <code class="mi">42</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">createIterator</code><code class="p">();</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 1, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 42, done: true }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: undefined, done: true }"</code>
</pre></div>

        </figure>

        <p>Here, the value <code>42</code> is returned in the <code>value</code> field on the second call to <code>next()</code> (which is the first time that <code>done</code> is <code>true</code>). The third call to <code>next()</code> returns an object whose <code>value</code> property is once again <code>undefined</code>. Any value you specify with <code>return</code> is only available on the returned object one time before the <code>value</code> field is reset to <code>undefined</code>.</p>

        <aside class="information blurb">
            <p>Any value specified by <code>return</code> is ignored by <code>for-of</code>.</p>

        </aside>

        <h4 id="leanpub-auto-delegating-generators">Delegating Generators</h4>

        <p>In some cases it may be useful to combine the values from two iterators into one. Using generators, it’s possible to delegate to another generator using a special form of <code>yield</code> with a star (<code>*</code>). As with generator definitions, it doesn’t matter where the star appears so as long as it is between the keyword <code>yield</code> and the generator function name. Here’s an example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="o">*</code><code class="nx">createNumberIterator</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">yield</code> <code class="mi">1</code><code class="p">;</code>
    <code class="k">yield</code> <code class="mi">2</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="o">*</code><code class="nx">createColorIterator</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">yield</code> <code class="s2">"red"</code><code class="p">;</code>
    <code class="k">yield</code> <code class="s2">"green"</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="o">*</code><code class="nx">createCombinedIterator</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">yield</code> <code class="o">*</code><code class="nx">createNumberIterator</code><code class="p">();</code>
    <code class="k">yield</code> <code class="o">*</code><code class="nx">createColorIterator</code><code class="p">();</code>
    <code class="k">yield</code> <code class="kc">true</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">createCombinedIterator</code><code class="p">();</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 1, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 2, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: "red", done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: "green", done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: true, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: undefined, done: true }"</code>
</pre></div>

        </figure>

        <p>In this example, the <code>createCombinedIterator()</code> generator delegates first to <code>createNumberIterator()</code> and then to <code>createColorIterator()</code>. The returned iterator appears, from the outside, to be one consistent iterator that has produced all of the values. Each call to <code>next()</code> is delegated to the appropriate iterator until they are empty, and then the final <code>yield</code> is executed to return <code>true</code>.</p>

        <p>Generator delegation also lets you use make of generator return values (as seen in the previous section). This is the easiest way to access such returned values and can be quite useful in performing complex tasks. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="o">*</code><code class="nx">createNumberIterator</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">yield</code> <code class="mi">1</code><code class="p">;</code>
    <code class="k">yield</code> <code class="mi">2</code><code class="p">;</code>
    <code class="k">return</code> <code class="mi">3</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="o">*</code><code class="nx">createRepeatingIterator</code><code class="p">(</code><code class="nx">count</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">count</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">yield</code> <code class="s2">"repeat"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="o">*</code><code class="nx">createCombinedIterator</code><code class="p">()</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">result</code> <code class="o">=</code> <code class="k">yield</code> <code class="o">*</code><code class="nx">createNumberIterator</code><code class="p">();</code>
    <code class="k">yield</code> <code class="o">*</code><code class="nx">createRepeatingIterator</code><code class="p">(</code><code class="nx">result</code><code class="p">);</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">createCombinedIterator</code><code class="p">();</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 1, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 2, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: "repeat", done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: "repeat", done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: "repeat", done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: undefined, done: true }"</code>
</pre></div>

        </figure>

        <p>Here, the <code>createCombinedIterator()</code> generator delegates to <code>createNumberIterator()</code> and assigns the return value to <code>result</code>. Since <code>createNumberIterator()</code> contains <code>return 3</code>, the returned value is <code>3</code>. The <code>result</code> variable is then passed to <code>createRepeatingIterator()</code> as an argument indicating how many times to yield the same string (in this case, three times).</p>

        <p>Notice that the value <code>3</code> was never output from any call to <code>next()</code>, it existed solely inside of <code>createCombinedIterator()</code>. It is possible to output that value as well by adding another <code>yield</code> statement, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="o">*</code><code class="nx">createNumberIterator</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">yield</code> <code class="mi">1</code><code class="p">;</code>
    <code class="k">yield</code> <code class="mi">2</code><code class="p">;</code>
    <code class="k">return</code> <code class="mi">3</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="o">*</code><code class="nx">createRepeatingIterator</code><code class="p">(</code><code class="nx">count</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code><code class="o">=</code><code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">count</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">yield</code> <code class="s2">"repeat"</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="o">*</code><code class="nx">createCombinedIterator</code><code class="p">()</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">result</code> <code class="o">=</code> <code class="k">yield</code> <code class="o">*</code><code class="nx">createNumberIterator</code><code class="p">();</code>
    <code class="k">yield</code> <code class="nx">result</code><code class="p">;</code>
    <code class="k">yield</code> <code class="o">*</code><code class="nx">createRepeatingIterator</code><code class="p">(</code><code class="nx">result</code><code class="p">);</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">iterator</code> <code class="o">=</code> <code class="nx">createCombinedIterator</code><code class="p">();</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 1, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 2, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: 3, done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: "repeat", done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: "repeat", done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: "repeat", done: false }"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">iterator</code><code class="p">.</code><code class="nx">next</code><code class="p">());</code>           <code class="c1">// "{ value: undefined, done: true }"</code>
</pre></div>

        </figure>

        <p>In this code, the extra <code>yield</code> statement explicitly outputs the returned value from <code>createNumberIterator()</code>.</p>

        <p>Generator delegation using the return value is a very powerful paradigm that allows for some very interesting possibilities, especially when used in conjunction with asynchronous operations.</p>

        <aside class="information blurb">
            <p>You can use <code>yield *</code> directly on strings, such as <code>yield * "hello"</code> and the string’s default iterator will be used.</p>

        </aside>

        <h4 id="leanpub-auto-asynchronous-task-scheduling">Asynchronous Task Scheduling</h4>

        <p>A lot of the excitement around generators is directly related to usage with asynchronous programming. Asynchronous programming in JavaScript is a double-edged sword: it’s very easy to do simple things while complex things become an errand in code organization. Since generators allow you to effectively pause code in the middle of execution, this opens up a lot of possibilities as it relates to asynchronous processing.</p>

        <p>The traditional way to perform asynchronous operations is to call a function that has a callback. For example, consider reading a file from disk in Node.js:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">fs</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s2">"fs"</code><code class="p">);</code>

<code class="kd">function</code> <code class="nx">readConfigFile</code><code class="p">(</code><code class="nx">callback</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">fs</code><code class="p">.</code><code class="nx">readFile</code><code class="p">(</code><code class="s2">"config.json"</code><code class="p">,</code> <code class="nx">callback</code><code class="p">);</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="nx">init</code><code class="p">(</code><code class="nx">callback</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">readConfigFile</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">,</code> <code class="nx">contents</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">if</code> <code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">throw</code> <code class="nx">err</code><code class="p">;</code>
        <code class="p">}</code>

        <code class="nx">doSomethingWith</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Done"</code><code class="p">);</code>
    <code class="p">});</code>
<code class="p">}</code>

<code class="nx">init</code><code class="p">();</code>
</pre></div>

        </figure>

        <p>Instead of providing a callback, you can <code>yield</code> and just wait for a response before starting again:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">fs</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s2">"fs"</code><code class="p">);</code>

<code class="kd">var</code> <code class="nx">task</code><code class="p">;</code>

<code class="kd">function</code> <code class="nx">readConfigFile</code><code class="p">()</code> <code class="p">{</code>
    <code class="nx">fs</code><code class="p">.</code><code class="nx">readFile</code><code class="p">(</code><code class="s2">"config.json"</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">,</code> <code class="nx">contents</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">if</code> <code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
            <code class="nx">task</code><code class="p">.</code><code class="k">throw</code><code class="p">(</code><code class="nx">err</code><code class="p">);</code>
        <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
            <code class="nx">task</code><code class="p">.</code><code class="nx">next</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>
        <code class="p">}</code>
    <code class="p">});</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="o">*</code><code class="nx">init</code><code class="p">()</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">contents</code> <code class="o">=</code> <code class="k">yield</code> <code class="nx">readConfigFile</code><code class="p">();</code>
    <code class="nx">doSomethingWith</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Done"</code><code class="p">);</code>
<code class="p">}</code>

<code class="nx">task</code> <code class="o">=</code> <code class="nx">init</code><code class="p">();</code>
<code class="nx">task</code><code class="p">.</code><code class="nx">next</code><code class="p">();</code>
</pre></div>

        </figure>

        <p>The difference between <code>init()</code> in this example and the previous one is why developers are excited about generators for asynchronous operation. Instead of using callbacks, <code>init()</code> yields to <code>readConfigFile()</code>, which does the asynchronous read operation and, when complete, either calls <code>throw()</code> if there’s an error or <code>next()</code> if the contents have been ready. That means the <code>yield</code> operation inside of <code>init()</code> will throw an error if there’s a read error or else the file contents will be returned almost as if the operation was synchronous.</p>

        <p>Managing the <code>task</code> variable is a bit cumbersome in this example, but it’s only important that you understand the theory. There are more powerful ways of doing asynchronous task scheduling using promises, and that will be covered further in Chapter 10.</p>

        <h3 id="leanpub-auto-summary-6">Summary</h3>

        <p>Iterators are an important part of ECMAScript 6 and are at the root of several important parts of the language. On the surface, iterators provide a simple way to return a sequence of values using a simple API. However, there are far more complex ways to use iterators in ECMAScript 6.</p>

        <p>The <code>@@iterator</code> symbol is used to define default iterators for objects. Both built-in objects and developer-defined objects can use this symbol to provide a method that returns an iterator. When <code>@@iterator</code> is provided, the object is considered an iterable.</p>

        <p>The <code>for-of</code> loop uses iterables to return a series of values in a loop. This makes creating loops easier than the traditional <code>for</code> loop because you no longer need to track values and control when the loop ends. The <code>for-of</code> loop automatically reads all values from the iterator until there are no more and then exits.</p>

        <p>To make it easier to use <code>for-of</code>, many values in ECMAScript 6 have default iterators. All the collection types, arrays, maps, and sets, have iterators designed for easy access to their contents. Strings also have a default iterator so it’s easy to iterate over the code points of the string (rather than the code units).</p>

        <p>Generators are a special type of function that automatically creates an iterator when called. These functions are indicated by the start (<code>*</code>) and make use of the <code>yield</code> keyword to indicate which value to return for each successive call to <code>next()</code>.</p>

        <p>Generator delegation encourages good encapsulation of iterator behavior by letting you reuse existing generators in new ones. This is done using <code>yield *</code> instead of <code>yield</code>, allowing you to create an iterator that returns values from multiple iterators.</p>

        <p>Perhaps the most interesting and exciting aspect of generators and iterators is the possibility of creating cleaner-looking asynchronous code. Instead of needing to use callbacks everywhere, you can setup code that looks synchronous but in fact uses <code>yield</code> to wait for asynchronous operations to complete.</p>

        <h2 id="leanpub-auto-classes">Classes</h2>

        <p>Ever since JavaScript was first created, many developers have been confused by its lack of classes. Most formal object-oriented programming languages support classes and classical inheritance as the primary way of defining similar and related objects. From pre-ECMAScript 1 all the way through ECMAScript 5, this point of confusion led many libraries to create utilities designed to make JavaScript look like it had support for classes.</p>

        <p>While there are some JavaScript developers who feel strongly that the language doesn’t need classes, the fact that so many libraries were created specifically for this purpose led to the inclusion of classes in ECMAScript 6. However, ECMAScript 6 classes aren’t exactly the same as classes in other language. There’s a uniqueness about them that embraces the dynamic of JavaScript as a language.</p>

        <h3 id="leanpub-auto-class-like-structures-in-ecmascript-5">Class-Like Structures in ECMAScript 5</h3>

        <p>Before exploring classes, it’s helpful to understand the underlying mechanisms that classes use. In ECMAScript 5 and earlier, there were no classes, and the closest equivalent was creating a constructor and then assigning methods to its prototype. This approach is called creating a custom type. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">PersonType</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">PersonType</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">sayName</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>
<code class="p">};</code>

<code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">PersonType</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>
<code class="nx">person</code><code class="p">.</code><code class="nx">sayName</code><code class="p">();</code>   <code class="c1">// outputs "Nicholas"</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code> <code class="k">instanceof</code> <code class="nx">PersonType</code><code class="p">);</code>  <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code> <code class="k">instanceof</code> <code class="nb">Object</code><code class="p">);</code>      <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>In this code, <code>PersonType</code> is a constructor function that creates a single property called <code>name</code>. The <code>sayName()</code> method is assigned to the prototype so the same function is shared by all instances of <code>PersonType</code>. Then, a new instance of <code>PersonType</code> is created via the <code>new</code> operator, and the resulting <code>person</code> object is considered an instance of <code>PersonType</code> and of <code>Object</code> (through prototypal inheritance).</p>

        <p>This same basic pattern underlies a lot of the class-mimicking JavaScript libraries. And that’s where ECMAScript 6 classes start.</p>

        <h3 id="leanpub-auto-class-declarations">Class Declarations</h3>

        <p>The simplest form of classes to understand is the one that looks similar to other languages: the class declaration. Class declarations begin with the <code>class</code> keyword followed by the name of the class. The rest of the syntax looks similar to concise methods in object literals without requiring commas between them. For example, here’s the class equivalent of the previous example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">PersonClass</code> <code class="p">{</code>

    <code class="c1">// equivalent of the PersonType constructor</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="c1">// equivalent of PersonType.prototype.sayName</code>
    <code class="nx">sayName</code><code class="p">()</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">PersonClass</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>
<code class="nx">person</code><code class="p">.</code><code class="nx">sayName</code><code class="p">();</code>   <code class="c1">// outputs "Nicholas"</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code> <code class="k">instanceof</code> <code class="nx">PersonClass</code><code class="p">);</code>     <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code> <code class="k">instanceof</code> <code class="nb">Object</code><code class="p">);</code>          <code class="c1">// true</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">PersonClass</code><code class="p">);</code>                    <code class="c1">// "function"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">PersonClass</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">sayName</code><code class="p">);</code>  <code class="c1">// "function"</code>
</pre></div>

        </figure>

        <p>The class declaration <code>PersonClass</code> behaves quite similarly to <code>PersonType</code> from the previous example. Instead of defining a function as the constructor, class declarations allow you to define the constructor directly inside of the class using the special <code>constructor</code> method name. Since class methods use the concise syntax, there’s no need to use the <code>function</code> keyword. All other method names have no special meaning, so you can add as many as you want.</p>

        <aside class="information blurb">
            <p>Own properties, properties that occur on the instance rather than the prototype, can only be created inside of a class constructor or method. In the previous example, <code>name</code> is an own property. It’s recommended to create all possible own properties inside of the constructor function so there’s a single place that’s responsible for all of them.</p>

        </aside>

        <p>Perhaps the worst-kept secret in ECMAScript 6 is that class declarations such as this example are actually just syntactic sugar on top of the existing custom type declarations. The <code>PersonClass</code> declaration actually creates a function that has the behavior of the <code>constructor</code> method, which is why <code>typeof PersonClass</code> is <code>"function"</code>. Similarly, the <code>sayName()</code> method ends up as a method on <code>PersonClass.prototype</code>, similar to <code>PersonType.prototype</code> in the earlier example. These similarities allow you to mix custom types and classes without worry too much about which you’re using.</p>

        <p>Despite the similarities, there are some important differences to keep in mind:</p>

        <ol class="numeric">
            <li>Class declarations, unlike function declarations, are not hoisted. Class declarations act like <code>let</code> declarations and so exist in the temporal dead zone until execution reaches the declaration.</li>
            <li>All code inside of class declarations runs in strict mode automatically. There’s no way to opt-out of strict mode inside of classes.</li>
            <li>All methods are non-enumerable. This is a significant change from custom types, where you need to use <code>Object.defineProperty()</code> to make a method non-enumerable.</li>
            <li>Calling the class constructor without <code>new</code> throws an error.</li>
            <li>Attempting to overwrite the class name within a class method throws an error.</li>
        </ol>

        <p>With all of this in mind, the <code>PersonClass</code> declaration from the previous example is directly equivalent to the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// direct equivalent of PersonClass</code>
<code class="kd">let</code> <code class="nx">PersonType2</code> <code class="o">=</code> <code class="p">(</code><code class="kd">function</code><code class="p">()</code> <code class="p">{</code>

    <code class="s2">"use strict"</code><code class="p">;</code>

    <code class="kr">const</code> <code class="nx">PersonType2</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>

        <code class="c1">// make sure the function was called with new</code>
        <code class="k">if</code> <code class="p">(</code><code class="k">typeof</code> <code class="k">new</code><code class="p">.</code><code class="nx">target</code> <code class="o">===</code> <code class="s2">"undefined"</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">throw</code> <code class="k">new</code> <code class="nb">Error</code><code class="p">(</code><code class="s2">"Constructor must be called with new."</code><code class="p">);</code>
        <code class="p">}</code>

        <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="nb">Object</code><code class="p">.</code><code class="nx">defineProperty</code><code class="p">(</code><code class="nx">PersonType2</code><code class="p">.</code><code class="nx">prototype</code><code class="p">,</code> <code class="s2">"sayName"</code><code class="p">,</code> <code class="p">{</code>
        <code class="nx">value</code><code class="o">:</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
            <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>
        <code class="p">},</code>
        <code class="nx">enumerable</code><code class="o">:</code> <code class="kc">false</code><code class="p">,</code>
        <code class="nx">writable</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">configurable</code><code class="o">:</code> <code class="kc">true</code>
    <code class="p">});</code>

    <code class="k">return</code> <code class="nx">PersonType2</code><code class="p">;</code>
<code class="p">}());</code>
</pre></div>

        </figure>

        <p>While it was possible to do everything that classes do without adding new syntax, you can see how the class syntax makes all of the functionality a lot simpler than it would be otherwise.</p>

        <aside>
            <h4 id="leanpub-auto-constant-class-names">Constant Class Names</h4>

            <p>The name of a class is specified as if using <code>const</code>, but only inside of the class itself. That means you can overwrite the class name outside of the class but not inside a class method. For example:</p>

            <figure class="code">
                <div class="highlight"><pre><code class="kr">class</code> <code class="nx">Foo</code> <code class="p">{</code>
   <code class="nx">constructor</code><code class="p">()</code> <code class="p">{</code>
       <code class="nx">Foo</code> <code class="o">=</code> <code class="s2">"bar"</code><code class="p">;</code>    <code class="c1">// throws an error when executed</code>
   <code class="p">}</code>
<code class="p">}</code>

<code class="c1">// but this is okay</code>
<code class="nx">Foo</code> <code class="o">=</code> <code class="s2">"baz"</code><code class="p">;</code>
</pre></div>

            </figure>

            <p>In this code, the <code>Foo</code> inside of the class constructor is a separate binding than the <code>Foo</code> outside of the class. The internal <code>Foo</code> is defined as if it’s a <code>const</code> and so cannot be overwritten, which means and error is thrown when an attempt is made to do so; the external <code>Foo</code> is defined as if it’s a <code>let</code> declaration and so its value may be overwritten at any time.</p>

        </aside>

        <h3 id="leanpub-auto-class-expressions">Class Expressions</h3>

        <p>Classes and functions are similar in that they have two forms: declarations and expressions. Function and class declarations begin with an appropriate keyword (<code>function</code> or <code>class</code>, respectively) followed by an identifier. Functions have an expression form that doesn’t require an identifier after <code>function</code>, and similarly, classes have an expression form that doesn’t require an identifier after <code>class</code>.</p>

        <p>These <em>class expressions</em> are designed to be used in variable declarations or passed into functions as arguments. Here’s the class expression equivalent of the previous examples:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// class expressions do not require identifiers after "class"</code>
<code class="kd">let</code> <code class="nx">PersonClass</code> <code class="o">=</code> <code class="kr">class</code> <code class="p">{</code>

    <code class="c1">// equivalent of the PersonType constructor</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="c1">// equivalent of PersonType.prototype.sayName</code>
    <code class="nx">sayName</code><code class="p">()</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">PersonClass</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>
<code class="nx">person</code><code class="p">.</code><code class="nx">sayName</code><code class="p">();</code>   <code class="c1">// outputs "Nicholas"</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code> <code class="k">instanceof</code> <code class="nx">PersonClass</code><code class="p">);</code>     <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">person</code> <code class="k">instanceof</code> <code class="nb">Object</code><code class="p">);</code>          <code class="c1">// true</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">PersonClass</code><code class="p">);</code>                    <code class="c1">// "function"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">PersonClass</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">sayName</code><code class="p">);</code>  <code class="c1">// "function"</code>
</pre></div>

        </figure>

        <p>Aside from the syntax, class expressions are exactly equivalent to class declarations. This example omits the identifier after <code>class</code>, but you can also include it:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">PersonClass</code> <code class="o">=</code> <code class="kr">class</code> <code class="nx">PersonClass2</code> <code class="p">{</code>

    <code class="c1">// equivalent of the PersonType constructor</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="c1">// equivalent of PersonType.prototype.sayName</code>
    <code class="nx">sayName</code><code class="p">()</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">PersonClass</code> <code class="o">===</code> <code class="nx">PersonClass2</code><code class="p">);</code>  <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>In this case, <code>PersonClass</code> and <code>PersonClass2</code> both reference the same class, and so they can be used interchangeably.</p>

        <p>Class expressions can also be used in some interesting ways. For example, they can be passed into functions as arguments:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">createObject</code><code class="p">(</code><code class="nx">classDef</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">new</code> <code class="nx">classDef</code><code class="p">();</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">obj</code> <code class="o">=</code> <code class="nx">createObject</code><code class="p">(</code><code class="kr">class</code> <code class="p">{</code>

    <code class="nx">sayHi</code><code class="p">()</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Hi!"</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">});</code>

<code class="nx">obj</code><code class="p">.</code><code class="nx">sayHi</code><code class="p">();</code>        <code class="c1">// "Hi!"</code>
</pre></div>

        </figure>

        <p>In this example, an anonymous class expression is passed into <code>createObject()</code>. An instance is then created by using <code>new</code> and that object is returned.</p>

        <p>Another interesting use of class expressions is to create singletons by immediately invoking the class constructor. To do so, you must use <code>new</code> with a class expression and include parentheses at the end. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="k">new</code> <code class="kr">class</code> <code class="p">{</code>

    <code class="nx">constructor</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="nx">sayName</code><code class="p">()</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>
    <code class="p">}</code>

<code class="p">}(</code><code class="s2">"Nicholas"</code><code class="p">);</code>

<code class="nx">person</code><code class="p">.</code><code class="nx">sayName</code><code class="p">();</code>       <code class="c1">// "Nicholas"</code>
</pre></div>

        </figure>

        <p>Here, the anonymous class expression is created and then executed immediately. This pattern allows you to use the class syntax for creating singletons without leaving a class reference available for inspection. The parentheses at the end are the indicator that you’re calling a function while also allowing you to pass in an argument.</p>

        <p>Whether you use class declarations or class expressions is purely a matter of style. Unlike function declarations and function expressions, both class declarations and class expressions are not hoisted, and so the choice has little bearing on the runtime behavior of the code.</p>

        <h3 id="leanpub-auto-accessor-properties">Accessor Properties</h3>

        <p>While own properties should be created inside of class constructors, classes allow you to define accessor properties on the prototype by using a syntax similar to that of object literal accessor format. To create a getter, use the keyword <code>get</code> followed by a space followed by an identifier; to create a setter, do the same using the keyword <code>set</code>. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">CustomHTMLElement</code> <code class="p">{</code>

    <code class="nx">constructor</code><code class="p">(</code><code class="nx">element</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">element</code> <code class="o">=</code> <code class="nx">element</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="nx">get</code> <code class="nx">html</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">element</code><code class="p">.</code><code class="nx">innerHTML</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="nx">set</code> <code class="nx">html</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">element</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="nx">value</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">descriptor</code> <code class="o">=</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">getOwnPropertyDescriptor</code><code class="p">(</code><code class="nx">CustomHTMLElement</code><code class="p">.</code><code class="nx">prototype</code><code class="p">,</code><code class="o">\</code>
 <code class="s2">"html"</code><code class="p">);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"get"</code> <code class="k">in</code> <code class="nx">descriptor</code><code class="p">);</code>   <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"set"</code> <code class="k">in</code> <code class="nx">descriptor</code><code class="p">);</code>   <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">descriptor</code><code class="p">.</code><code class="nx">enumerable</code><code class="p">);</code> <code class="c1">// false</code>
</pre></div>

        </figure>

        <p>In this example, the <code>CustomHTMLElement</code> class is made as a simple wrapper around an existing DOM element. It has both a getter and setter for <code>html</code> that simply delegates to the <code>innerHTML</code> method on the element itself. This accessor property is created as non-enumerable, just like any other method would be, and is created on the <code>CustomHTMLElement.prototype</code>. The equivalent non-class representation is:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// direct equivalent to previous example</code>
<code class="k">let</code> <code class="n">CustomHTMLElement</code> <code class="o">=</code> <code class="p">(</code><code class="k">function</code><code class="p">()</code> <code class="p">{</code>

    <code class="s">"use strict"</code><code class="p">;</code>

    <code class="k">const</code> <code class="n">CustomHTMLElement</code> <code class="o">=</code> <code class="k">function</code><code class="p">(</code><code class="n">element</code><code class="p">)</code> <code class="p">{</code>

        <code class="c1">// make sure the function was called with new</code>
        <code class="k">if</code> <code class="p">(</code><code class="n">typeof</code> <code class="k">new</code><code class="p">.</code><code class="n">target</code> <code class="o">===</code> <code class="s">"undefined"</code><code class="p">)</code> <code class="p">{</code>
            <code class="n">throw</code> <code class="k">new</code> <code class="n">Error</code><code class="p">(</code><code class="s">"Constructor must be called with new."</code><code class="p">);</code>
        <code class="p">}</code>

        <code class="k">this</code><code class="p">.</code><code class="n">element</code> <code class="o">=</code> <code class="n">element</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="n">Object</code><code class="p">.</code><code class="n">defineProperty</code><code class="p">(</code><code class="n">CustomHTMLElement</code><code class="p">.</code><code class="n">prototype</code><code class="p">,</code> <code class="s">"html"</code><code class="p">,</code> <code class="p">{</code>
        <code class="nl">enumerable:</code> <code class="n">false</code><code class="p">,</code>
        <code class="nl">configurable:</code> <code class="n">true</code><code class="p">,</code>
        <code class="nl">get:</code> <code class="k">function</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="n">element</code><code class="p">.</code><code class="n">innerHTML</code><code class="p">;</code>
        <code class="p">},</code>
        <code class="nl">set:</code> <code class="k">function</code><code class="p">(</code><code class="n">value</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="n">element</code><code class="p">.</code><code class="n">innerHTML</code> <code class="o">=</code> <code class="n">value</code><code class="p">;</code>
        <code class="p">}</code>
    <code class="p">});</code>

    <code class="k">return</code> <code class="n">CustomHTMLElement</code><code class="p">;</code>
<code class="p">}());</code>
</pre></div>

        </figure>

        <p>As with previous examples, this one shows just how much code you’re saving by using a class instead of the non-class equivalent. The accessor property definition alone is almost the size of the equivalent class declaration.</p>

        <h3 id="leanpub-auto-static-members">Static Members</h3>

        <p>Another common pattern in JavaScript is adding addition methods directly onto constructors to simulate static members. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">PersonType</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
<code class="p">}</code>

<code class="c1">// static method</code>
<code class="nx">PersonType</code><code class="p">.</code><code class="nx">create</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">new</code> <code class="nx">PersonType</code><code class="p">(</code><code class="nx">name</code><code class="p">);</code>
<code class="p">};</code>

<code class="c1">// instance method</code>
<code class="nx">PersonType</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">sayName</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>
<code class="p">};</code>

<code class="kd">var</code> <code class="nx">person</code> <code class="o">=</code> <code class="nx">PersonType</code><code class="p">.</code><code class="nx">create</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>This code creates a factory method called <code>PersonType.create()</code>. In other programming languages, this would be considered a static method as it is not dependent on an instance of <code>PersonType</code> for its data.</p>

        <p>Classes simplify the creation of static members by using the formal <code>static</code> annotation before the method or accessor property name. Here’s the equivalent of the last example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">PersonClass</code> <code class="p">{</code>

    <code class="c1">// equivalent of the PersonType constructor</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="c1">// equivalent of PersonType.prototype.sayName</code>
    <code class="nx">sayName</code><code class="p">()</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>
    <code class="p">}</code>

    <code class="c1">// equivalent of PersonType.create</code>
    <code class="kr">static</code> <code class="nx">create</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="k">new</code> <code class="nx">PersonClass</code><code class="p">(</code><code class="nx">name</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">person</code> <code class="o">=</code> <code class="nx">PersonClass</code><code class="p">.</code><code class="nx">create</code><code class="p">(</code><code class="s2">"Nicholas"</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>The <code>PersonClass</code> definition defines a single static method called <code>create()</code> by adding the <code>static</code> keyword.</p>

        <p>You can use the <code>static</code> keyword on any method or accessor property definition within a class. The only restriction is that you cannot use <code>static</code> with the <code>constructor</code> method definition.</p>

        <aside class="information blurb">
            <p>Just as with other class members, static members are not enumerable by default.</p>

        </aside>

        <h3 id="leanpub-auto-derived-classes">Derived Classes</h3>

        <p>Another problem with custom types in ECMAScript 5 and earlier was the extensive process necessary to implement inheritance. To properly inherit, you would need multiple steps. For instance:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">Rectangle</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">width</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="nx">length</code><code class="p">;</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">width</code> <code class="o">=</code> <code class="nx">width</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">Rectangle</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">getArea</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">*</code> <code class="k">this</code><code class="p">.</code><code class="nx">width</code><code class="p">;</code>
<code class="p">};</code>

<code class="kd">function</code> <code class="nx">Square</code><code class="p">(</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">Rectangle</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="k">this</code><code class="p">,</code> <code class="nx">length</code><code class="p">,</code> <code class="nx">length</code><code class="p">);</code>
<code class="p">}</code>

<code class="nx">Square</code><code class="p">.</code><code class="nx">prototype</code> <code class="o">=</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">create</code><code class="p">(</code><code class="nx">Rectangle</code><code class="p">.</code><code class="nx">prototype</code><code class="p">,</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="o">:</code> <code class="p">{</code>
        <code class="nx">value</code><code class="o">:</code><code class="nx">Square</code><code class="p">,</code>
        <code class="nx">enumerable</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">writable</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">configurable</code><code class="o">:</code> <code class="kc">true</code>
    <code class="p">}</code>
<code class="p">});</code>

<code class="kd">var</code> <code class="nx">square</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Square</code><code class="p">(</code><code class="mi">3</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">square</code><code class="p">.</code><code class="nx">getArea</code><code class="p">());</code>              <code class="c1">// 9</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">square</code> <code class="k">instanceof</code> <code class="nx">Square</code><code class="p">);</code>      <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">square</code> <code class="k">instanceof</code> <code class="nx">Rectangle</code><code class="p">);</code>   <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>Here, <code>Square</code> inherits from <code>Rectangle</code>, and to do so, it must be overwrite <code>Square.prototype</code> with a new object created from <code>Rectangle.prototype</code> as well as call <code>Rectangle.call()</code>. These steps often confused newcomers to the language and were a source of errors for experienced developers.</p>

        <p>Derived classes use the <code>extends</code> keyword to specify the function from which the class should inherit. The prototypes are automatically adjusted and you can access the base class constructor using <code>super()</code>. Here’s the equivalent of the previous example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">width</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="nx">length</code><code class="p">;</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">width</code> <code class="o">=</code> <code class="nx">width</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="nx">getArea</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">*</code> <code class="k">this</code><code class="p">.</code><code class="nx">width</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kr">class</code> <code class="nx">Square</code> <code class="kr">extends</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>

        <code class="c1">// same as Rectangle.call(this, length, length)</code>
        <code class="kr">super</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">length</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">square</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Square</code><code class="p">(</code><code class="mi">3</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">square</code><code class="p">.</code><code class="nx">getArea</code><code class="p">());</code>              <code class="c1">// 9</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">square</code> <code class="k">instanceof</code> <code class="nx">Square</code><code class="p">);</code>      <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">square</code> <code class="k">instanceof</code> <code class="nx">Rectangle</code><code class="p">);</code>   <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>In this example, the <code>Square</code> class inherits from <code>Rectangle</code> using the <code>extends</code> keyword. The <code>Square</code> constructor uses <code>super()</code> to call the <code>Rectangle</code> constructor with the specified arguments. Note that unlike the ECMAScript 5 version of the code, the identifier <code>Rectangle</code> is only used within the class declaration (after <code>extends</code>).</p>

        <p>Using <code>super()</code> is a requirement of derived classes if you specify a constructor (if you don’t, an error will occur). If you choose not to use a constructor, then <code>super()</code> is automatically called for you with all arguments upon creating a new instance of the class. For instance, the following two classes are identical:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">Square</code> <code class="kr">extends</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="c1">// no constructor</code>
<code class="p">}</code>

<code class="c1">// Is equivalent to</code>

<code class="kr">class</code> <code class="nx">Square</code> <code class="kr">extends</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(...</code><code class="nx">args</code><code class="p">)</code> <code class="p">{</code>
        <code class="kr">super</code><code class="p">(...</code><code class="nx">args</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>The second class in this example shows the equivalent of the default constructor for all derived classes. All of the arguments are passed, in order, to the base class constructor. In this case, the functionality isn’t quite correct because the <code>Square</code> constructor needs only one argument and so it’s best to manually define the constructor.</p>

        <aside class="warning blurb">
            <p>There are a few things to keep in mind when using <code>super()</code>:</p>

            <ol class="numeric">
                <li>You can only use <code>super()</code> in a derived class. If you try to use it in a non-derived class (a class that doesn’t use <code>extends</code>) or a function, it will throw an error.</li>
                <li>You must call <code>super()</code> before accessing <code>this</code> in the constructor. Since <code>super()</code> is responsible for initializing <code>this</code>, attempting to access <code>this</code> before calling <code>super()</code> results in an error.</li>
                <li>The only way to avoid calling <code>super()</code> is to return an object from the class constructor.</li>
            </ol>

        </aside>

        <h4 id="leanpub-auto-class-methods">Class Methods</h4>

        <p>The methods on derived classes always shadow methods of the same name on the base class. For instance, you can add <code>getArea()</code> to <code>Square</code> in order to redefine that functionality:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">Square</code> <code class="kr">extends</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
        <code class="kr">super</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">length</code><code class="p">);</code>
    <code class="p">}</code>

    <code class="c1">// override and shadow Rectangle.prototype.getArea()</code>
    <code class="nx">getArea</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">*</code> <code class="k">this</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>In this code, <code>getArea()</code> is now defined as part of <code>Square</code> and therefore <code>Rectangle.prototype.getArea()</code> will no longer be called by any instances of <code>Square</code>. Of course, you can always decide to call the base class version of the method by using <code>super.getArea()</code>, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">Square</code> <code class="kr">extends</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
        <code class="kr">super</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">length</code><code class="p">);</code>
    <code class="p">}</code>

    <code class="c1">// override, shadow, and call Rectangle.prototype.getArea()</code>
    <code class="nx">getArea</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="kr">super</code><code class="p">.</code><code class="nx">getArea</code><code class="p">();</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>Using <code>super</code> in this way is the same as discussed in Chapter 3: the <code>this</code> value is automatically set correctly so you can make a simple method call.</p>

        <p>Another interesting aspect of class methods is that they are missing the <code>[[Construct]]</code> internal method and therefore cannot be used with <code>new</code>. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// throws an error</code>
<code class="kd">var</code> <code class="nx">x</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Square</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">getArea</code><code class="p">();</code>
</pre></div>

        </figure>

        <p>Since class methods can’t be called with <code>new</code>, you are prevented from accidentally calling these methods in a manner for which they were not intended.</p>

        <p>Class methods can have computed names, just like computed names in object literals, by using square brackets around an expression. Here’s an example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">methodName</code> <code class="o">=</code> <code class="s2">"getArea"</code><code class="p">;</code>
<code class="kr">class</code> <code class="nx">Square</code> <code class="kr">extends</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
        <code class="kr">super</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">length</code><code class="p">);</code>
    <code class="p">}</code>

    <code class="c1">// override, shadow, and call Rectangle.prototype.getArea()</code>
    <code class="p">[</code><code class="nx">methodName</code><code class="p">]()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="kr">super</code><code class="p">.</code><code class="nx">getArea</code><code class="p">();</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This example is equivalent to the previous. The only difference is that a computed name is used for the <code>getArea()</code> method.</p>

        <h4 id="leanpub-auto-static-members-1">Static Members</h4>

        <p>If a base class has static members then those static members are also available on the derived class. This maps to how inheritance works in other languages, but is a new concept for JavaScript. Here’s an example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">width</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="nx">length</code><code class="p">;</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">width</code> <code class="o">=</code> <code class="nx">width</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="nx">getArea</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">*</code> <code class="k">this</code><code class="p">.</code><code class="nx">width</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="kr">static</code> <code class="nx">create</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">width</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="k">new</code> <code class="nx">Rectangle</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">width</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kr">class</code> <code class="nx">Square</code> <code class="kr">extends</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>

        <code class="c1">// same as Rectangle.call(this, length, length)</code>
        <code class="kr">super</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">length</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">rect</code> <code class="o">=</code> <code class="nx">Square</code><code class="p">.</code><code class="nx">create</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">);</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">rect</code> <code class="k">instanceof</code> <code class="nx">Rectangle</code><code class="p">);</code>     <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">rect</code><code class="p">.</code><code class="nx">getArea</code><code class="p">());</code>                <code class="c1">// 12</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">rect</code> <code class="k">instanceof</code> <code class="nx">Square</code><code class="p">);</code>        <code class="c1">// false</code>
</pre></div>

        </figure>

        <p>In this code, a new static <code>create()</code> method is added to <code>Rectangle</code>. Through inheritance, that method is available as <code>Square.create()</code> and behaves in the same manner as <code>Rectangle.create()</code>.</p>

        <h4 id="leanpub-auto-derived-classes-from-expressions">Derived Classes from Expressions</h4>

        <p>Perhaps the most powerful aspect of derived classes in ECMAScript 6 is the ability to derive a class from an expression. You can use <code>extends</code> with any expression, and if the expression resolves to a function with <code>[[Construct]]</code> and a prototype, the class will work. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">Rectangle</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">width</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="nx">length</code><code class="p">;</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">width</code> <code class="o">=</code> <code class="nx">width</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">Rectangle</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">getArea</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">*</code> <code class="k">this</code><code class="p">.</code><code class="nx">width</code><code class="p">;</code>
<code class="p">};</code>

<code class="kr">class</code> <code class="nx">Square</code> <code class="kr">extends</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
        <code class="kr">super</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">length</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">x</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Square</code><code class="p">(</code><code class="mi">3</code><code class="p">);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">x</code><code class="p">.</code><code class="nx">getArea</code><code class="p">());</code>               <code class="c1">// 9</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">x</code> <code class="k">instanceof</code> <code class="nx">Rectangle</code><code class="p">);</code>    <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>This example defines <code>Rectangle</code> as an ECMAScript 5-style constructor while <code>Square</code> is a class. Since <code>Rectangle</code> has <code>[[Construct]]</code> and a prototype, the class can still inherit directly from it.</p>

        <p>Accepting any type of expression after <code>extends</code> allows for some powerful possibilities, such as dynamically determining what to inherit from. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">Rectangle</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">width</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="nx">length</code><code class="p">;</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">width</code> <code class="o">=</code> <code class="nx">width</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">Rectangle</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">getArea</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">*</code> <code class="k">this</code><code class="p">.</code><code class="nx">width</code><code class="p">;</code>
<code class="p">};</code>

<code class="kd">function</code> <code class="nx">getBase</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">Rectangle</code><code class="p">;</code>
<code class="p">}</code>

<code class="kr">class</code> <code class="nx">Square</code> <code class="kr">extends</code> <code class="nx">getBase</code><code class="p">()</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
        <code class="kr">super</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">length</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">x</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Square</code><code class="p">(</code><code class="mi">3</code><code class="p">);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">x</code><code class="p">.</code><code class="nx">getArea</code><code class="p">());</code>               <code class="c1">// 9</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">x</code> <code class="k">instanceof</code> <code class="nx">Rectangle</code><code class="p">);</code>    <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>Here, the <code>getBase()</code> function is called directly as part of the class declaration. It returns <code>Rectangle</code>, which means this example is functionally equivalent to the previous one. And since you can determine the base dynamically, that means it’s possible to create different inheritance approaches. For instance, you can effectively create mixins:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">SerializableMixin</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">serialize</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="k">this</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="kd">let</code> <code class="nx">AreaMixin</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">getArea</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">*</code> <code class="k">this</code><code class="p">.</code><code class="nx">width</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="kd">function</code> <code class="nx">mixin</code><code class="p">(...</code><code class="nx">mixins</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">base</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{};</code>
    <code class="nb">Object</code><code class="p">.</code><code class="nx">assign</code><code class="p">(</code><code class="nx">base</code><code class="p">.</code><code class="nx">prototype</code><code class="p">,</code> <code class="p">...</code><code class="nx">mixins</code><code class="p">);</code>
    <code class="k">return</code> <code class="nx">base</code><code class="p">;</code>
<code class="p">}</code>

<code class="kr">class</code> <code class="nx">Square</code> <code class="kr">extends</code> <code class="nx">mixin</code><code class="p">(</code><code class="nx">AreaMixin</code><code class="p">,</code> <code class="nx">SerializableMixin</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
        <code class="kr">super</code><code class="p">();</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="nx">length</code><code class="p">;</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">width</code> <code class="o">=</code> <code class="nx">length</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">x</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Square</code><code class="p">(</code><code class="mi">3</code><code class="p">);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">x</code><code class="p">.</code><code class="nx">getArea</code><code class="p">());</code>               <code class="c1">// 9</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">x</code><code class="p">.</code><code class="nx">serialize</code><code class="p">());</code>             <code class="c1">// "{"length":3,"width":3}"</code>
</pre></div>

        </figure>

        <p>In this example, mixins are used instead of classical inheritance. The <code>mixin()</code> function takes any number of arguments that represent mixin objects. It creates a function called <code>base</code> and assigns the properties of each mixin object to the prototype. The function is then returned so <code>Square</code> can use <code>extends</code>. Keep in mind that since <code>extends</code> is still used, you are required to call <code>super()</code> in the constructor.</p>

        <p>The instance of <code>Square</code> has both <code>getArea()</code> from <code>AreaMixin</code> and <code>serialize</code> from <code>SerializableMixin</code>. This is accomplished through prototypal inheritance, as the <code>mixin()</code> function dynamically populates the prototype of a new function with all of the own properties of each mixin.</p>

        <aside class="warning blurb">
            <p>Even though any expression can be used after <code>extends</code>, not all expressions result in a valid class. Specifically, the following expression types causes errors:</p>

            <ul>
                <li><code>null</code></li>
                <li>generator functions (chapter 8)</li>
            </ul>

            <p>In these cases, attempting to create a new instance of the class will throw an error because there is <code>[[Construct]]</code> to call.</p>

        </aside>

        <h4 id="leanpub-auto-inheriting-from-built-ins">Inheriting from Built-ins</h4>

        <p>For almost as long as there have been JavaScript arrays, developers have wanted to inherit from arrays to create their own special array types. However, in ECMAScript 5 and earlier, this wasn’t possible. Here’s an example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// built-in array behavior</code>
<code class="kd">var</code> <code class="nx">colors</code> <code class="o">=</code> <code class="p">[];</code>
<code class="nx">colors</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"red"</code><code class="p">;</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">colors</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>         <code class="c1">// 1</code>

<code class="nx">colors</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">colors</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>             <code class="c1">// undefined</code>

<code class="c1">// trying to inherit from array in ES5</code>

<code class="kd">function</code> <code class="nx">MyArray</code><code class="p">()</code> <code class="p">{</code>
    <code class="nb">Array</code><code class="p">.</code><code class="nx">apply</code><code class="p">(</code><code class="k">this</code><code class="p">,</code> <code class="nx">arguments</code><code class="p">);</code>
<code class="p">}</code>

<code class="nx">MyArray</code><code class="p">.</code><code class="nx">prototype</code> <code class="o">=</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">create</code><code class="p">(</code><code class="nb">Array</code><code class="p">.</code><code class="nx">prototype</code><code class="p">,</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="o">:</code> <code class="p">{</code>
        <code class="nx">value</code><code class="o">:</code> <code class="nx">MyArray</code><code class="p">,</code>
        <code class="nx">writable</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">configurable</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
        <code class="nx">enumerable</code><code class="o">:</code> <code class="kc">true</code>
    <code class="p">}</code>
<code class="p">});</code>

<code class="kd">var</code> <code class="nx">colors</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">MyArray</code><code class="p">();</code>
<code class="nx">colors</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"red"</code><code class="p">;</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">colors</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>         <code class="c1">// 0</code>

<code class="nx">colors</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">colors</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>             <code class="c1">// "red"</code>
</pre></div>

        </figure>

        <p>As you can see, using the classical form of JavaScript inheritance results in unexpected behavior. The <code>length</code> and numeric properties don’t behave the same as they built-in array because this functionality isn’t covered either by <code>Array.apply()</code> or by assigning the prototype.</p>

        <p>One of the goals of ECMAScript 6 classes is to allow inheritance from all built-ins. In order to accomplish this, the inheritance model of classes is slightly different than the classical inheritance model found in ECMAScript 5 and earlier:</p>

        <ul>
            <li>In ECMAScript 5 classical inheritance, the value of <code>this</code> is first created by the derived type (for example, <code>MyArray</code>) and then the base type constructor is called (<code>Array.apply()</code>). That means <code>this</code> starts out as an instance of <code>MyArray</code> and then is decorated with additional properties from <code>Array</code>.</li>
            <li>In ECMAScript 6 class-based inheritance, the value of <code>this</code> is first created by the base (<code>Array</code>) and then modified by the derived class constructor (<code>MyArray</code>). The result is that <code>this</code> is starts out with all of the built-in functionality of the base and correctly receives all functionality related to it.</li>
        </ul>

        <p>The following class-based special array works as you would expect:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">MyArray</code> <code class="kr">extends</code> <code class="nb">Array</code> <code class="p">{</code>
    <code class="c1">// ...</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">colors</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">MyArray</code><code class="p">();</code>
<code class="nx">colors</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"red"</code><code class="p">;</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">colors</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>         <code class="c1">// 1</code>

<code class="nx">colors</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">colors</code><code class="p">[</code><code class="mi">0</code><code class="p">]);</code>             <code class="c1">// undefined</code>
</pre></div>

        </figure>

        <p>In this example, <code>MyArray</code> inherits directly from <code>Array</code> and therefore works in the exact same way. Interacting with numeric properties updates the <code>length</code> property, and manipulating the <code>length</code> property updates the numeric properties.</p>

        <p>Additionally, <code>MyArray</code> inherits all static members from <code>Array</code>, which means that <code>MyArray.of()</code> already exists and can be used:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">MyArray</code> <code class="kr">extends</code> <code class="nb">Array</code> <code class="p">{</code>
    <code class="c1">// ...</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">colors</code> <code class="o">=</code> <code class="nx">MyArray</code><code class="p">.</code><code class="nx">of</code><code class="p">([</code><code class="s2">"red"</code><code class="p">,</code> <code class="s2">"green"</code><code class="p">,</code> <code class="s2">"blue"</code><code class="p">]);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">colors</code> <code class="k">instanceof</code> <code class="nx">MyArray</code><code class="p">);</code>     <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>The inherited <code>MyArray.of()</code> behaves the same as <code>Array.of()</code> except that it creates an instance of <code>MyArray</code> rather than an instance of <code>Array</code>. Many built-in objects are specifically defined so that their static methods work appropriately for derived classes.</p>

        <p>This same approach can be used to inherit from any of the built-in JavaScript objects, with a full guarantee that it will work the same way as the built-ins.</p>

        <h3 id="leanpub-auto-newtarget">new.target</h3>

        <p>In Chapter 2, you learned about <code>new.target</code> and how its value changes depending on how a function is called. You can also use <code>new.target</code> in class constructors to determine how the class is being invoked. In the simple case, <code>new.target</code> is equal to the constructor function for the class, as in this example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">width</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">new</code><code class="p">.</code><code class="nx">target</code> <code class="o">===</code> <code class="nx">Rectangle</code><code class="p">);</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="nx">length</code><code class="p">;</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">width</code> <code class="o">=</code> <code class="nx">width</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="c1">// new.target is Rectangle</code>
<code class="kd">var</code> <code class="nx">obj</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Rectangle</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">);</code>      <code class="c1">// outputs true</code>
</pre></div>

        </figure>

        <p>In this code, you can see that <code>new.target</code> is equivalent to <code>Rectangle</code> when <code>new Rectangle(3, 4)</code> is called. Since class constructors cannot be called without <code>new</code>, <code>new.target</code> is always defined inside of class constructors. However, the value may not always be the same.</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">width</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">new</code><code class="p">.</code><code class="nx">target</code> <code class="o">===</code> <code class="nx">Rectangle</code><code class="p">);</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="nx">length</code><code class="p">;</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">width</code> <code class="o">=</code> <code class="nx">width</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kr">class</code> <code class="nx">Square</code> <code class="kr">extends</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
        <code class="kr">super</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">length</code><code class="p">)</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="c1">// new.target is Square</code>
<code class="kd">var</code> <code class="nx">obj</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Square</code><code class="p">(</code><code class="mi">3</code><code class="p">);</code>      <code class="c1">// outputs false</code>
</pre></div>

        </figure>

        <p>Here, <code>Square</code> is calling the <code>Rectangle</code> constructor, so <code>new.target</code> is equal to <code>Square</code> when the <code>Rectangle</code> constructor is called. This is important because it gives each constructor the ability to alter its behavior based on how it’s being called. For instance, you can create an abstract base class (one that cannot be instantiated directly) by using <code>new.target</code>:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// abstract base class</code>
<code class="kr">class</code> <code class="nx">Shape</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">if</code> <code class="p">(</code><code class="k">new</code><code class="p">.</code><code class="nx">target</code> <code class="o">===</code> <code class="nx">Shape</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">throw</code> <code class="k">new</code> <code class="nb">Error</code><code class="p">(</code><code class="s2">"This class cannot be instantiated directly."</code><code class="p">)</code>
        <code class="p">}</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kr">class</code> <code class="nx">Rectangle</code> <code class="kr">extends</code> <code class="nx">Shape</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">width</code><code class="p">)</code> <code class="p">{</code>
        <code class="kr">super</code><code class="p">();</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="nx">length</code><code class="p">;</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">width</code> <code class="o">=</code> <code class="nx">width</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">x</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Shape</code><code class="p">();</code>                <code class="c1">// throws error</code>

<code class="kd">var</code> <code class="nx">y</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Rectangle</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">);</code>        <code class="c1">// no error</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">y</code> <code class="k">instanceof</code> <code class="nx">Shape</code><code class="p">);</code>    <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>In this example, the <code>Shape</code> class constructor throws an error whenever <code>new.target</code> is <code>Shape</code>, meaning that <code>new Shape()</code> always throws an error. However, you can still use it as a base class, which is what <code>Rectangle</code> does.</p>

        <h3 id="leanpub-auto-summary-7">Summary</h3>

        <p>For those who have struggled to understand JavaScript in the absence of classes, ECMAScript 6 classes provide an easier way to become acclimated with the language without needing to completely throw away their understanding of inheritance. ECMAScript 6 classes start out as syntatic sugar for the classical inheritance model of ECMAScript 5, but adds a lot of features to reduce mistakes.</p>

        <p>ECMAScript 6 classes work with prototypal inheritance by defining non-static methods on the class prototype while static methods end up on the constructor itself. All methods are non-enumerable, which better matches the behavior of built-in objects for which methods are typically not enumerable by default. Additionally, class constructors cannot be called without <code>new</code>, ensuring that you can’t accidentally call a class as a function.</p>

        <p>Class-based inheritance allows you to derive a class from another class, function, or expression. This ability means you can call function to determine the correct base to inherit from, allowing you to use mixins and other different composition patterns to create a new class. Inheritance works in such a way that inheriting from built-in objects, such as <code>Array</code>, is now possible and works as expected.</p>

        <p>You can use <code>new.target</code> in class constructors to behave differently depending on how the class is called. The most common use is to create an abstract base class that throws an error when instantiated directly but still allows inheritance via other classes.</p>

        <p>Overall, classes are an important addition to the language that provides a more concise syntax and better functionality for defining custom object types in a safe, consistent manner.</p>

        <h2 id="leanpub-auto-promises">Promises</h2>

        <p>One of the most powerful aspects of JavaScript is how easy it handles asynchronous programming. Since JavaScript originated as a language for the web, it was a requirement to be able to respond to user interactions such as clicks and key presses. Node.js further popularized asynchronous programming in JavaScript by using callbacks as an alternative to events. As more and more programs started using asynchronous programming, there was a growing sense that these two models, events and callbacks, weren’t powerful enough to support everything that developers wanted to do. Promises are the solution to this problem.</p>

        <p>Promises are another option for asynchronous programming, and similar functionality is available in other languages under names such as futures and deferreds. The basic idea is to specify some code to be executed later (as with events and callbacks) and also explicitly indicate if the code succeeded or failed in its job. In that way, you can chain promises together based on success or failure in ways that are easier to understand and debug.</p>

        <p>Before you can get a good understanding of how promises work, however, it’s important to understand some of the basic concepts upon which they are built.</p>

        <h3 id="leanpub-auto-asynchronous-programming-background">Asynchronous Programming Background</h3>

        <p>JavaScript engines are built on the concept of a single-threaded event loop. Single-threaded means that only one piece of code is executed at any given point in time. This stands in contrast to other languages such as Java or C++ that may use threads to allow multiple different pieces of code to execute at the same time. Maintaining, and protecting, state when multiple pieces of code can access and change that state is a difficult problem and the source of frequent bugs in thread-based software.</p>

        <p>Because JavaScript engines can only execute one piece of code at a time, it’s necessary to keep track of code that is meant to run. That code is kept in a <em>job queue</em>. Whenever a piece of code is ready to be executed, it is added to the job queue. When the JavaScript engine is finished executing code, the event loop picks the next job in the queue and executes it. The <em>event loop</em> is a process inside of the JavaScript engine that monitors code execution and manages the job queue. Keep in mind that as a queue, job execution runs from the first job in the queue to the last.</p>

        <h4 id="leanpub-auto-events">Events</h4>

        <p>When a user clicks a button or presses a key on the keyboard, an <em>event</em> is triggered (such as <code>onclick</code>). That event may be used to respond to the interaction by adding a new job to the back of the job queue. This is the most basic form of asynchronous programming JavaScript has: the event handler code doesn’t execute until the event fires, and when it does execute, it has the appropriate context. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">button</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s2">"my-btn"</code><code class="p">);</code>
<code class="nx">button</code><code class="p">.</code><code class="nx">onclick</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">event</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Clicked"</code><code class="p">);</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>In this code, <code>console.log("Clicked")</code> will not be executed until <code>button</code> is clicked. When <code>button</code> is clicked, the function assigned to <code>onclick</code> is added to the back of the job queue and will be executed when all other jobs ahead of it are complete.</p>

        <p>Events work well for simple interactions such as this, but chaining multiple separate asynchronous calls together becomes more complicated because you must keep track of the event target (<code>button</code> in the previous example) for each event. Additionally, you need to ensure all appropriate event handlers are added before the first instance of an event occurs. For instance, if <code>button</code> in the previous example was clicked before <code>onclick</code> is assigned, then nothing will happen.</p>

        <p>So while events are useful for responding to user interactions and similar functionality that occurs infrequently, they aren’t very flexible for more complex needs.</p>

        <h4 id="leanpub-auto-callbacks">Callbacks</h4>

        <p>When Node.js was created, it furthered the asynchronous programming model by popularizing the callback pattern. The callback pattern is similar to the event model because it doesn’t execute code until a later point in time; it is different because the function to call is passed in as an argument. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">readFile</code><code class="p">(</code><code class="s2">"example.txt"</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">,</code> <code class="nx">contents</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">if</code> <code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">throw</code> <code class="nx">err</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>
<code class="p">});</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Hi!"</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>This example uses the traditional Node.js style of error-first callback. The <code>readFile()</code> function is intended to read from a file on disk (specified as the first argument) and then execute the callback (the second argument) when complete. If there’s an error, the <code>err</code> argument of the callback is an error object; otherwise, the <code>contents</code> argument contains the file contents as a string.</p>

        <p>Using the callback pattern, <code>readFile()</code> begins executing immediately and pauses when it begins reading from the disk. That means <code>console.log("Hi!")</code> is output immediately after <code>readFile()</code> is called (before <code>console.log(contents)</code>). When <code>readFile()</code> has finished, it adds a new job to the end of the job queue with the callback function and its arguments. That job is then executed upon completion of all other jobs ahead of it.</p>

        <p>The callback pattern is more flexible than events because it is easier to chain multiple calls together. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">readFile</code><code class="p">(</code><code class="s2">"example.txt"</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">,</code> <code class="nx">contents</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">if</code> <code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">throw</code> <code class="nx">err</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="nx">writeFile</code><code class="p">(</code><code class="s2">"example.txt"</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">if</code> <code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">throw</code> <code class="nx">err</code><code class="p">;</code>
        <code class="p">}</code>

        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"File was written!"</code><code class="p">);</code>
    <code class="p">});</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this code, a successful call to <code>readFile()</code> results in another asynchronous call, this time to <code>writeFile()</code>. Note that the same basic pattern of checking <code>err</code> is present in both functions. When <code>readFile()</code> is complete, it adds a job to the job queue that results in <code>writeFile()</code> being called (assuming no errors). Then, <code>writeFile()</code> adds a job to the job queue when it is complete.</p>

        <p>While this works fairly well, you can quickly get into a pattern that has come to be known as <em>callback hell</em>. Callback hell occurs when you nest too many callbacks:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">method1</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">,</code> <code class="nx">result</code><code class="p">)</code> <code class="p">{</code>

    <code class="k">if</code> <code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">throw</code> <code class="nx">err</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="nx">method2</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">,</code> <code class="nx">result</code><code class="p">)</code> <code class="p">{</code>

        <code class="k">if</code> <code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">throw</code> <code class="nx">err</code><code class="p">;</code>
        <code class="p">}</code>

        <code class="nx">method3</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">,</code> <code class="nx">result</code><code class="p">)</code> <code class="p">{</code>

            <code class="k">if</code> <code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
                <code class="k">throw</code> <code class="nx">err</code><code class="p">;</code>
            <code class="p">}</code>

            <code class="nx">method4</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">,</code> <code class="nx">result</code><code class="p">)</code> <code class="p">{</code>

                <code class="k">if</code> <code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
                    <code class="k">throw</code> <code class="nx">err</code><code class="p">;</code>
                <code class="p">}</code>

                <code class="nx">method5</code><code class="p">(</code><code class="nx">result</code><code class="p">);</code>
            <code class="p">});</code>

        <code class="p">});</code>

    <code class="p">});</code>

<code class="p">});</code>
</pre></div>

        </figure>

        <p>Nesting multiple method calls, as in this example, creates a tangled web of code that is hard to understand and debug.</p>

        <p>Callbacks also present problems when you want to accomplish more complex functionality. What if you’d like two asynchronous operations to run in parallel and be notified when they both are complete? What if you’d like to kick off two asynchronous operations but only take the first one to complete? In these cases, you end up needing to keep track of multiple callbacks and cleanup operations. This is precisely where promises greatly improve the situation.</p>

        <h3 id="leanpub-auto-promise-basics">Promise Basics</h3>

        <p>A promise is a placeholder for the result of an asynchronous operation. Instead of subscribing to an event or passing a callback to a function, the function can return a promise, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// readFile promises to complete at some point in the future</code>
<code class="kd">let</code> <code class="nx">promise</code> <code class="o">=</code> <code class="nx">readFile</code><code class="p">(</code><code class="s2">"example.txt"</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>In this code, <code>readFile()</code> doesn’t actually start reading the file immediately (that will happen later). It returns a promise object that represents the asynchronous operation so you can work with it later.</p>

        <h4 id="leanpub-auto-lifecycle">Lifecycle</h4>

        <p>Each promise goes through a short lifecycle. It starts in the <em>pending</em> state, which is an indicator that the asynchronous operation has not yet completed. The promise in the last example is in the pending state as soon as it is returned from <code>readFile()</code>. Once the asynchronous operation completes, the promise is considered <em>settled</em> and enters one of two possible states:</p>

        <ol class="numeric">
            <li>
                <em>Fulfilled</em> - the promise’s asynchronous operation has completed successfully</li>
            <li>
                <em>Rejected</em> - the promise’s asynchronous operation did not complete successfully (either due to error or some other cause)</li>
        </ol>

        <p>You can’t determine which state the promise is in programmatically, but you can take a specific action when a promise changes state by using the <code>then()</code> method.</p>

        <aside class="information blurb">
            <p>There is an internal <code>[[PromiseState]]</code> property that is set to <code>"pending"</code>, <code>"fulfilled"</code>, or <code>"rejected"</code> to reflect the promise’s state.</p>

        </aside>

        <p>The <code>then()</code> method is present on all promises and takes two arguments (any object that implements <code>then()</code> is called a <em>thenable</em>). The first argument is a function to call when the promise is fulfilled. Any additional data related to the asynchronous operation is passed into this fulfillment function. The second argument is a function to call when the promise is rejected. Similar to the fulfillment function, the rejection function is passed any additional data related to the rejection.</p>

        <p>Both arguments are optional, so you can listen for any combination of fulfillment and rejection. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">promise</code> <code class="o">=</code> <code class="nx">readFile</code><code class="p">(</code><code class="s2">"example.txt"</code><code class="p">);</code>

<code class="c1">// listen for both fulfillment and rejection</code>
<code class="nx">promise</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">contents</code><code class="p">)</code> <code class="p">{</code>
    <code class="c1">// fulfillment</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>
<code class="p">},</code> <code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
    <code class="c1">// rejection</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">error</code><code class="p">(</code><code class="nx">err</code><code class="p">.</code><code class="nx">message</code><code class="p">);</code>
<code class="p">});</code>

<code class="c1">// listen for just fulfillment - errors are not reported</code>
<code class="nx">promise</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">contents</code><code class="p">)</code> <code class="p">{</code>
    <code class="c1">// fulfillment</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>
<code class="p">});</code>

<code class="c1">// listen for just rejection - success is not reported</code>
<code class="nx">promise</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kc">null</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
    <code class="c1">// rejection</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">error</code><code class="p">(</code><code class="nx">err</code><code class="p">.</code><code class="nx">message</code><code class="p">);</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>There is also a <code>catch()</code> method that behaves the same as <code>then()</code> when only a rejection handler is passed. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">promise</code><code class="p">.</code><code class="k">catch</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
    <code class="c1">// rejection</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">error</code><code class="p">(</code><code class="nx">err</code><code class="p">.</code><code class="nx">message</code><code class="p">);</code>
<code class="p">});</code>

<code class="c1">// is the same as:</code>

<code class="nx">promise</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kc">null</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
    <code class="c1">// rejection</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">error</code><code class="p">(</code><code class="nx">err</code><code class="p">.</code><code class="nx">message</code><code class="p">);</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>The intent is to use a combination of <code>then()</code> and <code>catch()</code> to properly handle the result of asynchronous operations. The benefit of this over both events and callbacks is that it’s completely clear whether the operation succeeded or failed. (Events tend not to fire when there’s an error and in callbacks you must always remember to check the error argument.)</p>

        <aside class="warning blurb">
            <p>If you don’t attach a rejection handler to a promise, all failures happen silently. It’s a good idea to always attach a rejection handler even if it just logs the failure.</p>

        </aside>

        <p>One of the unique aspects of promises is that a fulfillment or rejection handler will still be executed if it is added after the promise is already settled. This allows you to add new fulfillment and rejection handlers at any point in time and be assured that they will be called. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">promise</code> <code class="o">=</code> <code class="nx">readFile</code><code class="p">(</code><code class="s2">"example.txt"</code><code class="p">);</code>

<code class="c1">// original fulfillment handler</code>
<code class="nx">promise</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">contents</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>

    <code class="c1">// now add another</code>
    <code class="nx">promise</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">contents</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>
    <code class="p">});</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this example, the fulfillment handler adds another fulfillment handler to the same promise.The promise is already fulfilled at this point, so the new fulfillment handler is added to the job queue and called when ready. Rejection handlers work the same way in that they can be added at any point and are guaranteed to be called.</p>

        <aside class="information blurb">
            <p>Each call to <code>then()</code> or <code>catch()</code> creates a new job to be executed when the promise is resolved. However, these jobs end up in a separate job queue that is reserved strictly for promises. The precise details of this second job queue aren’t all that important for understanding how to use promises so long as you understand how job queues work in general.</p>

        </aside>

        <h4 id="leanpub-auto-creating-unsettled-promises">Creating Unsettled Promises</h4>

        <p>New promises are created through the <code>Promise</code> constructor. This constructor accepts a single argument, which is a function (called the <em>executor</em>) containing the code to execute when the promise is added to the job queue. The executor is passed two functions as arguments, <code>resolve()</code> and <code>reject()</code>. The <code>resolve()</code> function is called when the executor has finished successfully in order to signal that the promise is ready to be resolved while the <code>reject()</code> function indicates that the executor has failed. Here’s an example using a promise in Node.js to implement the <code>readFile()</code> function from earlier in this chapter:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// Node.js example</code>

<code class="kd">let</code> <code class="nx">fs</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s2">"fs"</code><code class="p">);</code>

<code class="kd">function</code> <code class="nx">readFile</code><code class="p">(</code><code class="nx">filename</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>

        <code class="c1">// trigger the asynchronous operation</code>
        <code class="nx">fs</code><code class="p">.</code><code class="nx">readFile</code><code class="p">(</code><code class="nx">filename</code><code class="p">,</code> <code class="p">{</code> <code class="nx">encoding</code><code class="o">:</code> <code class="s2">"utf8"</code> <code class="p">},</code> <code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">,</code> <code class="nx">contents</code><code class="p">)</code> <code class="p">{</code>

            <code class="c1">// check for errors</code>
            <code class="k">if</code> <code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
                <code class="nx">reject</code><code class="p">(</code><code class="nx">err</code><code class="p">);</code>
                <code class="k">return</code><code class="p">;</code>
            <code class="p">}</code>

            <code class="c1">// the read succeeded</code>
            <code class="nx">resolve</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>

        <code class="p">});</code>
    <code class="p">});</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">promise</code> <code class="o">=</code> <code class="nx">readFile</code><code class="p">(</code><code class="s2">"example.txt"</code><code class="p">);</code>

<code class="c1">// listen for both fulfillment and rejection</code>
<code class="nx">promise</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">contents</code><code class="p">)</code> <code class="p">{</code>
    <code class="c1">// fulfillment</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>
<code class="p">},</code> <code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
    <code class="c1">// rejection</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">error</code><code class="p">(</code><code class="nx">err</code><code class="p">.</code><code class="nx">message</code><code class="p">);</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this example, the native Node.js <code>fs.readFile()</code> asynchronous call is wrapped in a promise. The executor either passes the error object to <code>reject()</code> or the file contents to <code>resolve()</code>.</p>

        <p>Keep in mind that the executor doesn’t run immediately when <code>readFile()</code> is called. Instead, it is added as a job to the job queue. This is called <em>job scheduling</em>, and if you’ve ever used <code>setTimeout()</code> or <code>setInterval()</code>, then you’re already familiar with it. The idea is that a new job is added to the job queue so as to say, “don’t execute this right now, but execute later.” In the case of <code>setTimeout()</code> and <code>setInterval()</code>, you’re specifying a delay before the job is added to the queue:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// add this function to the job queue after 500ms have passed</code>
<code class="nx">setTimeout</code><code class="p">(</code><code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Timeout"</code><code class="p">);</code>
<code class="p">},</code> <code class="mi">500</code><code class="p">)</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Hi!"</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>In this example, the code schedules a job to be added to the job queue after 500ms. That results in the following output:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="n">Hi</code><code class="o">!</code>
<code class="n">Timeout</code>
</pre></div>

        </figure>

        <p>You can tell from the output that the function passed to <code>setTimeout()</code> was executed after <code>console.log("Hi!")</code>. Promises work in a similar way.</p>

        <p>The promise executor is added to the job queue immediately, meaning it will execute only after all previous jobs are complete. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">promise</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Promise"</code><code class="p">);</code>
    <code class="nx">resolve</code><code class="p">();</code>
<code class="p">});</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Hi!"</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>The output for this example is:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="n">Hi</code><code class="o">!</code>
<code class="n">Promise</code>
</pre></div>

        </figure>

        <p>The takeaway is that the executor doesn’t run until sometime after the current job has finished executing. The same is true for the functions passed to <code>then()</code> and <code>catch()</code>, as these will also be added to the job queue, but only after the executor job. Here’s an example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">promise</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Promise"</code><code class="p">);</code>
    <code class="nx">resolve</code><code class="p">();</code>
<code class="p">});</code>

<code class="nx">promise</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Resolved."</code><code class="p">);</code>
<code class="p">});</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Hi!"</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>The output for this example is:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="n">Hi</code><code class="o">!</code>
<code class="n">Promise</code>
<code class="n">Resolved</code>
</pre></div>

        </figure>

        <p>The fulfillment and rejection handlers are always added to the end of the job queue after the executor has completed.</p>

        <h4 id="leanpub-auto-creating-settled-promises">Creating Settled Promises</h4>

        <p>The <code>Promise</code> constructor is the best way to create unsettled promises due to the dynamic nature of what the promise executor does. However, if you want a promise to represent just a single known value, then it doesn’t make sense to go through the work of scheduling a job that simply passes a value to <code>resolve()</code>. Instead, there are two methods that create settled promises given a specific value.</p>

        <p>The <code>Promise.resolve()</code> method accepts a single argument and returns a promise in the fulfilled state. That means there is no job scheduling that occurs and you need to add one or more fulfillment handlers to the promise to retrieve the value. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">promise</code> <code class="o">=</code> <code class="nx">Promise</code><code class="p">.</code><code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>

<code class="nx">promise</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>         <code class="c1">// 42</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>This code creates a fulfilled promise so the fulfillment handler receives 42 as <code>value</code>. If a rejection handler were added to this promise, it would never be called because the promise will never be in the rejected state.</p>

        <p>You can also create rejected promises by using the <code>Promise.reject()</code> method. This works in the same way as <code>Promise.resolve()</code> except that the created promise is in the rejected state. That means any additional rejection handlers added to the promise will be called but not fulfillment handlers will be called:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">promise</code> <code class="o">=</code> <code class="nx">Promise</code><code class="p">.</code><code class="nx">reject</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>

<code class="nx">promise</code><code class="p">.</code><code class="k">catch</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>         <code class="c1">// 42</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <aside class="information blurb">
            <p>If you pass a promise to either <code>Promise.resolve()</code> or <code>Promise.reject()</code>, the promise is returned without modification.</p>

        </aside>

        <p>Both <code>Promise.resolve()</code> and <code>Promise.reject()</code> also accept non-promise thenables as arguments and will create a new promise that is called after <code>then()</code>. A non-promise thenable is created when a object has a <code>then()</code> method that accepts two arguments: <code>resolve</code> and <code>reject</code>. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">thenable</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">then</code><code class="o">:</code> <code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>The <code>thenable</code> object in this example has no characteristics associated with a promise other than the <code>then()</code> method. It can be converted into a fulfilled promise using <code>Promise.resolve()</code>:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">thenable</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">then</code><code class="o">:</code> <code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="nx">Promise</code><code class="p">.</code><code class="nx">resolve</code><code class="p">(</code><code class="nx">thenable</code><code class="p">);</code>
<code class="nx">p1</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 42</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this example, <code>Promise.resolve()</code> calls <code>thenable.then()</code> so that a promise state can be determined. Since this code calls <code>resolve(42)</code>, the promise state for <code>thenable</code> is fulfilled. A new promise is created in the fulfilled state with the value passed from the thenable (42) so the fulfillment handler for <code>p1</code> receives 42 as the value. The same process can be used with <code>Promise.reject()</code> in order to create a rejected promise from a thenable:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">thenable</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">then</code><code class="o">:</code> <code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">reject</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">};</code>

<code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="nx">Promise</code><code class="p">.</code><code class="nx">reject</code><code class="p">(</code><code class="nx">thenable</code><code class="p">);</code>
<code class="nx">p1</code><code class="p">.</code><code class="k">catch</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 42</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>This example is similar to the last except that <code>Promise.reject()</code> is used on <code>thenable</code>. Doing so executes <code>thenable.then()</code> and creates a new promise in the rejected state with a value of 42. That value is then passed to the rejection handler for <code>p1</code>.</p>

        <p>Both <code>Promise.resolve()</code> and <code>Promise.reject()</code> work in this way to allow you to easily work with non-promise thenables. Whenever you’re unsure if an object is a promise, passing the object through <code>Promise.resolve()</code> or <code>Promise.reject()</code> (depending on your anticipated result) is the best approach since promises are just passed through without any change.</p>

        <h4 id="leanpub-auto-executor-errors">Executor Errors</h4>

        <p>If an error is thrown inside of an executor, then the promise’s rejection handler is called. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">promise</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">throw</code> <code class="k">new</code> <code class="nb">Error</code><code class="p">(</code><code class="s2">"Explosion!"</code><code class="p">);</code>
<code class="p">});</code>

<code class="nx">promise</code><code class="p">.</code><code class="k">catch</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">error</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">error</code><code class="p">.</code><code class="nx">message</code><code class="p">);</code>     <code class="c1">// "Explosion!"</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this code, the executor intentionally throws an error. There is an implicit <code>try-catch</code> inside of every executor such that the error is caught and then passed to the rejection handler. In effect, the previous example is equivalent to:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// equivalent of previous example</code>
<code class="kd">let</code> <code class="nx">promise</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">try</code> <code class="p">{</code>
        <code class="k">throw</code> <code class="k">new</code> <code class="nb">Error</code><code class="p">(</code><code class="s2">"Explosion!"</code><code class="p">);</code>
    <code class="p">}</code> <code class="k">catch</code> <code class="p">(</code><code class="nx">ex</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">reject</code><code class="p">(</code><code class="nx">ex</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">});</code>

<code class="nx">promise</code><code class="p">.</code><code class="k">catch</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">error</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">error</code><code class="p">.</code><code class="nx">message</code><code class="p">);</code>     <code class="c1">// "Explosion!"</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>The executor handles catching any thrown errors in order to simplify this common use case.</p>

        <h3 id="leanpub-auto-chaining-promises">Chaining Promises</h3>

        <p>To this point, promises may seem like little more than an incremental improvement over using some combination of a callback and <code>setTimeout()</code>, but there is much more to promises than meets the eye. More specifically, there are a number of ways to chain promises together to accomplish more complex asynchronous behavior.</p>

        <p>Each call to <code>then()</code> or <code>catch()</code> actually creates and returns another promise. This second promise is resolved only once the first has been fulfilled or rejected. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="nx">p1</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
<code class="p">}).</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Finished"</code><code class="p">);</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>The output from this example is:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="mi">42</code>
<code class="n">Finished</code>
</pre></div>

        </figure>

        <p>The call to <code>p1.then()</code> returns a second promise on which <code>then()</code> is called. The second <code>then()</code> fulfillment handler is only called after the first promise has been resolved. If you unchain this example, it looks like this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="c1">// same as</code>

<code class="kd">let</code> <code class="nx">p2</code> <code class="o">=</code> <code class="nx">p1</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
<code class="p">})</code>

<code class="nx">p2</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Finished"</code><code class="p">);</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>As you might have guessed, <code>p2.then()</code> also returns a promise, but it’s not used in this example.</p>

        <h4 id="leanpub-auto-catching-errors">Catching Errors</h4>

        <p>Promise chaining allows you to catch errors that may occur in a fulfillment or rejection handler from a previous promise. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="nx">p1</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">throw</code> <code class="k">new</code> <code class="nb">Error</code><code class="p">(</code><code class="s2">"Boom!"</code><code class="p">);</code>
<code class="p">}).</code><code class="k">catch</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">error</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">error</code><code class="p">.</code><code class="nx">message</code><code class="p">);</code>     <code class="c1">// "Boom!"</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this example, the fulfillment handler for <code>p1</code> throws an error. The chained call to <code>catch()</code>, which is on a second promise, is able to receive that error through its rejection handler. The same is true if a rejection handler throws an error:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">throw</code> <code class="k">new</code> <code class="nb">Error</code><code class="p">(</code><code class="s2">"Explosion!"</code><code class="p">);</code>
<code class="p">});</code>

<code class="nx">p1</code><code class="p">.</code><code class="k">catch</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">error</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">error</code><code class="p">.</code><code class="nx">message</code><code class="p">);</code>     <code class="c1">// "Explosion!"</code>
    <code class="k">throw</code> <code class="k">new</code> <code class="nb">Error</code><code class="p">(</code><code class="s2">"Boom!"</code><code class="p">);</code>
<code class="p">}).</code><code class="k">catch</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">error</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">error</code><code class="p">.</code><code class="nx">message</code><code class="p">);</code>     <code class="c1">// "Boom!"</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>Here, the executor throws an error then triggers <code>p1</code>’s rejection handler. That handler then throws another error that is caught by the second promise’s rejection handler. In this way, chained promise calls can be made aware of errors in other promises in the chain.</p>

        <aside class="information blurb">
            <p>It’s recommended to always have a rejection handler at the end of a promise chain to ensure that you can properly handle any errors that may occur.</p>

        </aside>

        <h4 id="leanpub-auto-returning-values-in-promise-chains">Returning Values in Promise Chains</h4>

        <p>Another important aspect of promise chains is the ability to pass data from one promise to the next. You’ve already seen that a value passed to the <code>resolve()</code> handler inside an executor is passed to the fulfillment handler for that promise. You can continue passing data along by specifying a return value from the fulfillment handler. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="nx">p1</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>         <code class="c1">// "42"</code>
    <code class="k">return</code> <code class="nx">value</code> <code class="o">+</code> <code class="mi">1</code><code class="p">;</code>
<code class="p">}).</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>         <code class="c1">// "43"</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this example, the fulfillment handler for <code>p1</code> returns a value (<code>value + 1</code>). Since <code>value</code> is 42 (from the executor) then the fulfillment handler returns 43. That value is then passed to the fulfillment handler of the second promise that can output it to the console.</p>

        <p>The same thing is possible using the rejection handler. When a rejection handler is called, it has the option of return a value. That value is then used to fulfill the next promise in the chain. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">reject</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="nx">p1</code><code class="p">.</code><code class="k">catch</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>         <code class="c1">// "42"</code>
    <code class="k">return</code> <code class="nx">value</code> <code class="o">+</code> <code class="mi">1</code><code class="p">;</code>
<code class="p">}).</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>         <code class="c1">// "43"</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>Here, the executor calls <code>reject()</code> with 42. That value is passed into the rejection handler for the promise, where <code>value + 1</code> is returned. Even though this return value is coming from a rejection handler, it is still used in the fulfillment handler of the next promise in the chain. This allows for the failure of one promise to allow recovery of the entire chain if necessary.</p>

        <h3 id="leanpub-auto-returning-promise-in-promise-chains">Returning Promise in Promise Chains</h3>

        <p>Returning primitive values from fulfillment and rejection handlers allows passing of data between promises, but what if you return an object? If the object is a promise, then there’s an extra step that’s taken to determine how to proceed. Consider the following example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p2</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">43</code><code class="p">);</code>
<code class="p">});</code>

<code class="nx">p1</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 42</code>
    <code class="k">return</code> <code class="nx">p2</code><code class="p">;</code>
<code class="p">}).</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 43</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this code, <code>p1</code> schedules a job that resolves to 42. In the fulfillment handler for <code>p1</code>, <code>p2</code>, a promise is already in the resolved state, is returned. The second fulfillment handler is called because <code>p2</code> has been fulfilled. If <code>p2</code> was rejected, the second fulfillment handler would not be called and instead a rejection handler (if present) would be called.</p>

        <p>The important thing to recognize about this pattern is that the second fulfillment handler is not added to <code>p2</code>, but rather to a third promise. It’s this third promise that the second fulfillment handler is attached to. The previous example is equivalent to this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p2</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">43</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p3</code> <code class="o">=</code> <code class="nx">p1</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 42</code>
    <code class="k">return</code> <code class="nx">p2</code><code class="p">;</code>
<code class="p">});</code>

<code class="nx">p3</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 43</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>Here, it’s clear that the second fulfillment handler is attached to <code>p3</code> rather than <code>p2</code>. This is a subtle but important distinction as the second fulfillment handler will not be called if <code>p2</code> is rejected. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p2</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">reject</code><code class="p">(</code><code class="mi">43</code><code class="p">);</code>
<code class="p">});</code>

<code class="nx">p1</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 42</code>
    <code class="k">return</code> <code class="nx">p2</code><code class="p">;</code>
<code class="p">}).</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// never called</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this example, the second fulfillment handler is never called because <code>p2</code> is rejected. You could, however, attach a rejection handler instead:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p2</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">reject</code><code class="p">(</code><code class="mi">43</code><code class="p">);</code>
<code class="p">});</code>

<code class="nx">p1</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 42</code>
    <code class="k">return</code> <code class="nx">p2</code><code class="p">;</code>
<code class="p">}).</code><code class="k">catch</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 43</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>Here, the rejection handler is called as a result of <code>p2</code> being rejected. The rejected value 43 from <code>p2</code> is passed into that rejection handler.</p>

        <p>Returning thenables from fulfillment or rejection handlers doesn’t change when the promise executors are executed. The first defined promise will run its executor first, followed by the second, and so on. Returning thenables simply allows you to define additional responses. You defer the execution of fulfillment handlers by creating a new promise within a fulfillment handler. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="nx">p1</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 42</code>

    <code class="c1">// create a new promise</code>
    <code class="kd">let</code> <code class="nx">p2</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">resolve</code><code class="p">(</code><code class="mi">43</code><code class="p">);</code>
    <code class="p">});</code>

    <code class="k">return</code> <code class="nx">p2</code>
<code class="p">}).</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 43</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this example, a new promise is created within the fulfillment handler for <code>p1</code>. That means the second fulfillment handler will not be executed until after <code>p2</code> has been fulfilled. This pattern useful when you want to wait until a previous promise has been settled before before triggering another promise.</p>

        <h3 id="leanpub-auto-responding-to-multiple-promises">Responding to Multiple Promises</h3>

        <p>Up to this point, each example has dealt with responding to one promise at a time. There are times, however, when you’ll want to monitor the progress of multiple promises in order to determine the next action. ECMAScript 6 provides two methods that monitor multiple promises: <code>Promise.all()</code> and <code>Promise.race()</code>.</p>

        <h4 id="leanpub-auto-promiseall">Promise.all()</h4>

        <p>The <code>Promise.all()</code> method accepts a single argument, which is an iterable of promises to monitor, and returns a promise that is resolved only when every promise in the iterable is resolved. The returned promise is fulfilled when every promise in the iterable is fulfilled, for example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p2</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">43</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p3</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">44</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p4</code> <code class="o">=</code> <code class="nx">Promise</code><code class="p">.</code><code class="nx">all</code><code class="p">([</code><code class="nx">p1</code><code class="p">,</code> <code class="nx">p2</code><code class="p">,</code> <code class="nx">p3</code><code class="p">]);</code>

<code class="nx">p4</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// [42, 43, 44]</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>Each of the promises in this example resolves with a number. The call to <code>Promise.all()</code> creates a new promise, <code>p4</code>, that ultimately is fulfilled because each of the promises is fulfilled. The result passed to the fulfillment handler for <code>p4</code> is an array containing each resolved value: 42, 43, and 44. In this way, you can match promise results to the promises that resolved to them.</p>

        <p>If any of the promises passed to <code>Promise.all()</code> is rejected, the returned promise is immediately rejected without waiting for the other promises to complete:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p2</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">reject</code><code class="p">(</code><code class="mi">43</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p3</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">44</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p4</code> <code class="o">=</code> <code class="nx">Promise</code><code class="p">.</code><code class="nx">all</code><code class="p">([</code><code class="nx">p1</code><code class="p">,</code> <code class="nx">p2</code><code class="p">,</code> <code class="nx">p3</code><code class="p">]);</code>

<code class="nx">p4</code><code class="p">.</code><code class="k">catch</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 43</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this example, <code>p2</code> is rejected with a value of 43. The rejection handler for <code>p4</code> is called immediately without waiting for either <code>p1</code> or <code>p3</code> to finish executing (they still finish executing, it’s just that <code>p4</code> doesn’t wait). The rejection handler is passed 43 to reflect the rejection from <code>p2</code>.</p>

        <h4 id="leanpub-auto-promiserace">Promise.race()</h4>

        <p>The <code>Promise.race()</code> method provides a slightly different take on monitoring multiple promises. This method also accepts an iterable of promises to monitor and returns a promise, however, the returned promise is settled as soon as the first promise is settled. So instead of waiting for all promises to be fulfilled, as in <code>Promise.all()</code>, the returned promise is fulfilled as soon as any of the promises is fulfilled. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="nx">Promise</code><code class="p">.</code><code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>

<code class="kd">let</code> <code class="nx">p2</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">43</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p3</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">44</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p4</code> <code class="o">=</code> <code class="nx">Promise</code><code class="p">.</code><code class="nx">race</code><code class="p">([</code><code class="nx">p1</code><code class="p">,</code> <code class="nx">p2</code><code class="p">,</code> <code class="nx">p3</code><code class="p">]);</code>

<code class="nx">p4</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 42</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this code, <code>p1</code> is created as a fulfilled promise while the others schedule jobs. The fulfillment handler for <code>p4</code> is then called with the value of 42 and ignores the other promises completely. The promises passed to <code>Promise.race()</code> are truly in a race to see which is settled first. If the first promise to settle is fulfilled, then the returned promise is fulfilled; if the first promise to settle is rejected, then the returned promise is rejected. Here’s an example with a rejection:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p2</code> <code class="o">=</code> <code class="nx">Promise</code><code class="p">.</code><code class="nx">reject</code><code class="p">(</code><code class="mi">43</code><code class="p">);</code>

<code class="kd">let</code> <code class="nx">p3</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">44</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p4</code> <code class="o">=</code> <code class="nx">Promise</code><code class="p">.</code><code class="nx">race</code><code class="p">([</code><code class="nx">p1</code><code class="p">,</code> <code class="nx">p2</code><code class="p">,</code> <code class="nx">p3</code><code class="p">]);</code>

<code class="nx">p4</code><code class="p">.</code><code class="k">catch</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>     <code class="c1">// 43</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>Here, <code>p4</code> is rejected because <code>p2</code> is already in the rejected state when <code>Promise.race()</code> is called. Even though <code>p1</code> and <code>p3</code> are fulfilled, those results are ignored because they occur after <code>p2</code> is rejected.</p>

        <h4 id="leanpub-auto-asynchronous-task-scheduling-1">Asynchronous Task Scheduling</h4>

        <p>Back in chapter 8, you learned about generators and how they can be used for asynchronous task scheduling such as the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">fs</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s2">"fs"</code><code class="p">);</code>

<code class="kd">let</code> <code class="nx">task</code><code class="p">;</code>

<code class="kd">function</code> <code class="nx">readConfigFile</code><code class="p">()</code> <code class="p">{</code>
    <code class="nx">fs</code><code class="p">.</code><code class="nx">readFile</code><code class="p">(</code><code class="s2">"config.json"</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">,</code> <code class="nx">contents</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">if</code> <code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
            <code class="nx">task</code><code class="p">.</code><code class="k">throw</code><code class="p">(</code><code class="nx">err</code><code class="p">);</code>
        <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
            <code class="nx">task</code><code class="p">.</code><code class="nx">next</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>
        <code class="p">}</code>
    <code class="p">});</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="o">*</code><code class="nx">init</code><code class="p">()</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">contents</code> <code class="o">=</code> <code class="k">yield</code> <code class="nx">readConfigFile</code><code class="p">();</code>
    <code class="nx">doSomethingWith</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Done"</code><code class="p">);</code>
<code class="p">}</code>

<code class="nx">task</code> <code class="o">=</code> <code class="nx">init</code><code class="p">();</code>
<code class="nx">task</code><code class="p">.</code><code class="nx">next</code><code class="p">();</code>
</pre></div>

        </figure>

        <p>The pain point of this implementation was needing to keep track of <code>task</code> and calling the appropriate methods on it in every single asynchronous function you use (such as <code>readConfigFile()</code>). With promises, you can greatly simplify and generalize this process by ensuring that each asynchronous operation returns a promise. That common interface means you can greatly simplify asynchronous code:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">fs</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s2">"fs"</code><code class="p">);</code>

<code class="kd">function</code> <code class="nx">run</code><code class="p">(</code><code class="nx">taskDef</code><code class="p">)</code> <code class="p">{</code>

    <code class="c1">// create the iterator</code>
    <code class="kd">let</code> <code class="nx">task</code> <code class="o">=</code> <code class="nx">taskDef</code><code class="p">();</code>

    <code class="c1">// start the task</code>
    <code class="kd">let</code> <code class="nx">result</code> <code class="o">=</code> <code class="nx">task</code><code class="p">.</code><code class="nx">next</code><code class="p">();</code>

    <code class="c1">// recursive function to iterate through</code>
    <code class="p">(</code><code class="kd">function</code> <code class="nx">step</code><code class="p">()</code> <code class="p">{</code>

        <code class="c1">// if there's more to do</code>
        <code class="k">if</code> <code class="p">(</code><code class="o">!</code><code class="nx">result</code><code class="p">.</code><code class="nx">done</code><code class="p">)</code> <code class="p">{</code>

            <code class="c1">// resolve to a promise to make it easy</code>
            <code class="kd">let</code> <code class="nx">promise</code> <code class="o">=</code> <code class="nx">Promise</code><code class="p">.</code><code class="nx">resolve</code><code class="p">(</code><code class="nx">result</code><code class="p">.</code><code class="nx">value</code><code class="p">);</code>
            <code class="nx">promise</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
                <code class="nx">result</code> <code class="o">=</code> <code class="nx">task</code><code class="p">.</code><code class="nx">next</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
                <code class="nx">step</code><code class="p">();</code>
            <code class="p">}).</code><code class="k">catch</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">error</code><code class="p">)</code> <code class="p">{</code>
                <code class="nx">result</code> <code class="o">=</code> <code class="nx">task</code><code class="p">.</code><code class="k">throw</code><code class="p">(</code><code class="nx">error</code><code class="p">);</code>
                <code class="nx">step</code><code class="p">();</code>
            <code class="p">});</code>
        <code class="p">}</code>
    <code class="p">}());</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="nx">readConfigFile</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">fs</code><code class="p">.</code><code class="nx">readFile</code><code class="p">(</code><code class="s2">"config.json"</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">err</code><code class="p">,</code> <code class="nx">contents</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">if</code> <code class="p">(</code><code class="nx">err</code><code class="p">)</code> <code class="p">{</code>
                <code class="nx">reject</code><code class="p">(</code><code class="nx">err</code><code class="p">);</code>
            <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
                <code class="nx">resolve</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>
            <code class="p">}</code>
        <code class="p">});</code>
    <code class="p">});</code>
<code class="p">}</code>

<code class="nx">run</code><code class="p">(</code><code class="kd">function</code> <code class="o">*</code><code class="p">()</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">contents</code> <code class="o">=</code> <code class="k">yield</code> <code class="nx">readConfigFile</code><code class="p">();</code>
    <code class="nx">doSomethingWith</code><code class="p">(</code><code class="nx">contents</code><code class="p">);</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Done"</code><code class="p">);</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this version of the code, a generic <code>run()</code> function is used to execute a generator. The <code>run()</code> function executes the generator to create an iterator, starts the task by calling <code>task.next()</code>, and then recursively calls <code>step()</code> until the iterator is complete. Inside of <code>step()</code>, if there’s more work to do then <code>result.done</code> is <code>false</code>. At that point, <code>result.value</code> should be a promise, but <code>Promise.resolve()</code> is used just in case the function in question didn’t return a promise. Then, a fulfillment handler is added that retrieves the promise value and passes it back to the iterator and <code>result</code> is assigned to the next yield result before calling <code>step()</code>. A rejection handler is also added and assumes any rejection results in an error object. That error object is passed back into the iterator using <code>task.throw()</code> and <code>result</code> is assigned to the next yield result if the error is catched in the task, and then <code>step()</code> is called to continue.</p>

        <p>This same <code>run()</code> function can be used to run any generator that uses <code>yield</code> as a way to achieve asynchronous code without exposing promises (or callbacks) to the developer.</p>

        <h3 id="leanpub-auto-inheriting-from-promises">Inheriting from Promises</h3>

        <p>Just like other built-in types, promises can be used as a base upon which you can create a derived class. This allows you to define your own variation of promises to extend what the built-in promises can do. Suppose, for instance, you’d like to create a promise that uses <code>success()</code> and <code>failure()</code> in addition to <code>then()</code> and <code>catch()</code>. You could do so as follows:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">class</code> <code class="nx">MyPromise</code> <code class="kr">extends</code> <code class="nx">Promise</code> <code class="p">{</code>

    <code class="c1">// use default constructor</code>

    <code class="nx">success</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">);</code>
    <code class="p">}</code>

    <code class="nx">failure</code><code class="p">(</code><code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="k">catch</code><code class="p">(</code><code class="nx">reject</code><code class="p">);</code>
    <code class="p">}</code>

<code class="p">}</code>

<code class="kd">let</code> <code class="nx">promise</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">MyPromise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="nx">promise</code><code class="p">.</code><code class="nx">success</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>             <code class="c1">// 42</code>
<code class="p">}).</code><code class="nx">failure</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
<code class="p">});</code>
</pre></div>

        </figure>

        <p>In this example, <code>MyPromise</code> is derived from <code>Promise</code> and two additional methods are added. Both <code>success()</code> and <code>failure()</code> use <code>this</code> to call the appropriate method they are mimicking. The created promise functions the same as the built-in version, except now you can use <code>success()</code> and <code>failure()</code> in addition to <code>then()</code> and <code>catch()</code>.</p>

        <p>Since static methods are also inherited, that means <code>MyPromise.resolve()</code>, <code>MyPromise.reject()</code>, <code>MyPromise.race()</code>, and <code>MyPromise.all()</code> are also present. While the last two behave the same as the built-in methods, the first two are slightly different.</p>

        <p>Both <code>MyPromise.resolve()</code> and <code>MyPromise.reject()</code> will return an instance of <code>MyPromise</code> regardless of the value passed. So if a built-in promise is passed to either, it will be resolved or rejected and a new <code>MyPromise</code> so you can assign fulfillment and rejection handlers. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">let</code> <code class="nx">p1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Promise</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">resolve</code><code class="p">,</code> <code class="nx">reject</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">resolve</code><code class="p">(</code><code class="mi">42</code><code class="p">);</code>
<code class="p">});</code>

<code class="kd">let</code> <code class="nx">p2</code> <code class="o">=</code> <code class="nx">MyPromise</code><code class="p">.</code><code class="nx">resolve</code><code class="p">(</code><code class="nx">p1</code><code class="p">);</code>
<code class="nx">p2</code><code class="p">.</code><code class="nx">success</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>         <code class="c1">// 42</code>
<code class="p">});</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">p2</code> <code class="k">instanceof</code> <code class="nx">MyPromise</code><code class="p">);</code>   <code class="c1">// true</code>
</pre></div>

        </figure>

        <p>Here, <code>p1</code> is a built-in promise that is passed to <code>MyPromise.resolve()</code>. The result, <code>p2</code>, is an instance of <code>MyPromise</code> where the resolved value from <code>p1</code> is passed into the fulfillment handler.</p>

        <p>If an instance of <code>MyPromise</code> is passed to <code>MyPromise.resolve()</code> or <code>MyPromise.reject()</code>, it will just be returned directly without being resolved. In all other ways these two methods behave the same as <code>Promise.resolve()</code> and <code>Promise.reject()</code>.</p>

        <h3 id="leanpub-auto-summary-8">Summary</h3>

        <p>Promises are designed to improve asynchronous programming in JavaScript. Whereas events and callbacks have several limitations, the permutations available via promises mean more control and composability over asynchronous operations. This is accomplished by scheduling jobs to be added to the JavaScript engine’s job queue for execution later. A second job queue keeps track of promise fulfillment and rejection handlers to ensure proper execution.</p>

        <p>Promises have three states: pending, fulfilled, and rejected. A promise starts out in a pending state and is either fulfilled (a success) or rejected (a failure). In either case, handlers can be added to be notified when a promise is settled. The <code>then()</code> method allows you to assign a fulfillment and rejection handler and the <code>catch()</code> method allows you to assign only a rejection handler.</p>

        <p>You can chain promises together in a variety of ways and pass information between them. Each call to <code>then()</code> creates and returns a new promise that is resolved when the previous one is resolved. Such chains can be used to trigger responses to a series of asynchronous events. You can also use <code>Promise.race()</code> and <code>Promise.all()</code> to monitor the progress of multiple promises and respond accordingly.</p>

        <p>Asynchronous task scheduling is made easier using generators in addition to promises, as promises give a common interface that asynchronous operations can return. You can then use generators and the <code>yield</code> operator to wait for asynchronous responses and respond appropriately.</p>

        <p>Most new web APIs are being built on top of promises, and you can expect many more to follow suit in the future.</p>

        <h2 id="leanpub-auto-modules">Modules</h2>

        <p>One of the most error-prone and confusing aspects of JavaScript has long been the “shared everything” approach to loading code. Whereas other languages have concepts such as packages, JavaScript lagged behind, and everything defined in every file shared the same global scope. As web applications became more complex and the amount of JavaScript used grew, the “shared everything” approach began to show problems with naming collisions, security concerns, and more. One of the goals of ECMAScript 6 was to solve this problem and bring some order into JavaScript applications. That’s where modules come in.</p>

        <h3 id="leanpub-auto-what-are-modules">What are Modules?</h3>

        <p><em>Modules</em> are JavaScript files that are loaded in a special mode (as opposed to <em>scripts</em>, which are loaded in the original way JavaScript worked). At the time of my writing, neither browsers nor Node.js have a way to natively load ECMAScript 6 modules, but both have indicated that there will need to be some sort of opt-in to do so. The reason this opt-in is necessary is because module files have very different semantics than non-module files:</p>

        <ol class="numeric">
            <li>Module code automatically runs in strict mode and there’s no way to opt-out of strict mode.</li>
            <li>Variables created in the top level of a module are not automatically added to the shared global scope. They exist only within the top-level scope of the module.</li>
            <li>The value of <code>this</code> in the top level of a module is <code>undefined</code>.</li>
            <li>Does not allow HTML-style comments within the code (a leftover feature from the early browser days).</li>
            <li>Modules must export anything that should be available to code outside of the module.</li>
        </ol>

        <p>These differences may seem small at first glance, however, they represent a significant change in how JavaScript code is loaded and evaluated.</p>

        <p>Module JavaScript files are created just like any other JavaScript file: in a text editor and typically with the <code>.js</code> extension. The only difference during development is that you use some different syntax.</p>

        <h3 id="leanpub-auto-basic-exporting-and-importing">Basic Exporting and Importing</h3>

        <p>The <code>export</code> keyword is used to expose parts of published code to other modules. In the simplest case, you can place <code>export</code> in front of any variable, function, or class declaration to export it from the module. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// export data</code>
<code class="kr">export</code> <code class="kd">var</code> <code class="nx">color</code> <code class="o">=</code> <code class="s2">"red"</code><code class="p">;</code>
<code class="kr">export</code> <code class="kd">let</code> <code class="nx">name</code> <code class="o">=</code> <code class="s2">"Nicholas"</code><code class="p">;</code>
<code class="kr">export</code> <code class="kr">const</code> <code class="nx">magicNumber</code> <code class="o">=</code> <code class="mi">7</code><code class="p">;</code>

<code class="c1">// export function</code>
<code class="kr">export</code> <code class="kd">function</code> <code class="nx">sum</code><code class="p">(</code><code class="nx">num1</code><code class="p">,</code> <code class="nx">num2</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">num1</code> <code class="o">+</code> <code class="nx">num1</code><code class="p">;</code>
<code class="p">}</code>

<code class="c1">// export class</code>
<code class="kr">export</code> <code class="kr">class</code> <code class="nx">Rectangle</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">,</code> <code class="nx">width</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="nx">length</code><code class="p">;</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">width</code> <code class="o">=</code> <code class="nx">width</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>

<code class="c1">// this function is private to the module</code>
<code class="kd">function</code> <code class="nx">subtract</code><code class="p">(</code><code class="nx">num1</code><code class="p">,</code> <code class="nx">num2</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">num1</code> <code class="o">-</code> <code class="nx">num2</code><code class="p">;</code>
<code class="p">}</code>

<code class="c1">// define a function</code>
<code class="kd">function</code> <code class="nx">multiply</code><code class="p">(</code><code class="nx">num1</code><code class="p">,</code> <code class="nx">num2</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">num1</code> <code class="o">*</code> <code class="nx">num2</code><code class="p">;</code>
<code class="p">}</code>

<code class="c1">// export later</code>
<code class="kr">export</code> <code class="nx">multiply</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>There are a few things to notice in this example:</p>

        <ol class="numeric">
            <li>Every declaration is exactly the same as it would otherwise be without the <code>export</code> keyword.</li>
            <li>Both function and class declarations require a name. You cannot export anonymous functions or classes using this syntax.</li>
            <li>You need not always export the declaration, you can also export references, as with <code>multiply</code> in this example.</li>
            <li>Any variables, functions, or classes that are not explicitly exported remain private to the module. In this example, <code>subtract()</code> is not exported and is therefore not accessible from outside the module.</li>
        </ol>

        <p>An important limitation of <code>export</code> is that it must be used in the top-level of the module. For instance, this is a syntax error:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="k">if</code> <code class="p">(</code><code class="nx">flag</code><code class="p">)</code> <code class="p">{</code>
    <code class="kr">export</code> <code class="nx">flag</code><code class="p">;</code>    <code class="c1">// syntax error</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This example is a syntax error because <code>export</code> is inside of an <code>if</code> statement. Exports cannot be condition or done dynamically in any way. Part of the benefit of module syntax is so the JavaScript engine can staticly determine what will be exported. As such, you can only use <code>export</code> at the top-level of a module.</p>

        <aside class="warning blurb">
            <p>If you are using a transpiler like Babel.js, you may find that <code>export</code> can be used anywhere. This only works when code is converted to ECMAScript 5 and will not work with a native ECMAScript 6 module system.</p>

        </aside>

        <p>Once you have a module with exports, you can access the functionality in another module by using the <code>import</code> keyword. An <code>import</code> statement has two parts: the identifiers you’re importing and the module from which those identifiers should be imported. The basic form is as follows:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">import</code> <code class="p">{</code> <code class="nx">identifier1</code><code class="p">,</code> <code class="nx">identifier2</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"module"</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>The curly braces after <code>import</code> indicate the identifiers to import from the given module. The keyword <code>from</code> is used to indicate the module from which to import the given identifiers. The module is specified using a string. At the time of my writing, it is still undecided what module identifiers will look like. They may end up being full file paths (such as “../mymodule.js”), file paths without extensions (such as “../mymodule”), or something else. This likely won’t be determined until browsers and Node.js begin implementing modules natively.</p>

        <aside class="information blurb">
            <p>Even though it looks similar, the list of identifiers to import is not a destructured object.</p>

        </aside>

        <p>When importing an identifier from a module, the identifier acts as if were defined using <code>const</code>. That means you cannot define another variable with the same name, use the identifier prior to the <code>import</code> statement, or change its value.</p>

        <p>Suppose that the first example in this section is in a module named <code>"example"</code>. You can import and use identifiers from that module in a number of ways. You can just import one identifier:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// import just one</code>
<code class="kr">import</code> <code class="p">{</code> <code class="nx">sum</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">sum</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">));</code>     <code class="c1">// 3</code>

<code class="nx">sum</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>        <code class="c1">// error</code>
</pre></div>

        </figure>

        <p>This example imports only <code>sum()</code> from the example module. Even though the example module exports more than just that one function, they are not exposed here. If you try to assign a new value to <code>sum</code>, the result is an error, as you cannot reassign imported identifiers.</p>

        <p>If you want to import multiple identifiers from the example module, you can explicitly list them out:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// import multiple</code>
<code class="kr">import</code> <code class="p">{</code> <code class="nx">sum</code><code class="p">,</code> <code class="nx">multiply</code><code class="p">,</code> <code class="nx">magicNumber</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">sum</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="nx">magicNumber</code><code class="p">));</code>   <code class="c1">// 8</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">multiply</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">));</code>        <code class="c1">// 2</code>
</pre></div>

        </figure>

        <p>Here, three identifiers are imported from the example module: <code>sum</code>, <code>multiply</code>, and <code>magicNumber</code>. They are then used as if they were locally defined.</p>

        <p>There’s also a special case that allows you to import the entire module as a single object. All of the exports are then available on that object as properties. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// import everything</code>
<code class="kr">import</code> <code class="o">*</code> <code class="nx">as</code> <code class="nx">example</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">example</code><code class="p">.</code><code class="nx">sum</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code>
        <code class="nx">example</code><code class="p">.</code><code class="nx">magicNumber</code><code class="p">));</code>          <code class="c1">// 8</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">example</code><code class="p">.</code><code class="nx">multiply</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">));</code>    <code class="c1">// 2</code>
</pre></div>

        </figure>

        <p>In this code, the entirety of the example module is loaded into an object called <code>example</code>. The named exports <code>sum()</code>, <code>multiple()</code>, and <code>magicNumber</code> are then accessible as properties on <code>example</code>.</p>

        <p>Keep in mind that the code inside of a module will only ever be executed once, regardless of the number of times it’s used in an <code>import</code> statement. Consider the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">import</code> <code class="p">{</code> <code class="nx">sum</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>
<code class="kr">import</code> <code class="p">{</code> <code class="nx">multiply</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>
<code class="kr">import</code> <code class="p">{</code> <code class="nx">magicNumber</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>Even though there are three <code>import</code> statements in this module, the code in <code>"example"</code> will only be executed once. The instantiated module is then kept in memory and reused whenever another <code>import</code> statement references it. It doesn’t matter if the <code>import</code> statements are all in the module, or are spread across multiple modules - they each will use the same module instance.</p>

        <h3 id="leanpub-auto-renaming-exports-and-imports">Renaming Exports and Imports</h3>

        <p>Sometimes the original name of a variable, function, or class isn’t what you want to use. It’s possible to change the name of an export both during the export and when the identifier is being imported.</p>

        <p>In the first case, suppose you have a function that you’d like to export with a different name. You can use the <code>as</code> keyword to specify the name that the function should be known as outside of the module:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">function</code> <code class="nx">sum</code><code class="p">(</code><code class="nx">num1</code><code class="p">,</code> <code class="nx">num2</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">num1</code> <code class="o">+</code> <code class="nx">num2</code><code class="p">;</code>
<code class="p">}</code>

<code class="kr">export</code> <code class="p">{</code> <code class="nx">sum</code> <code class="nx">as</code> <code class="nx">add</code> <code class="p">};</code>
</pre></div>

        </figure>

        <p>Here, the <code>sum()</code> function (<code>sum</code> is the <em>local name</em>) is exported as <code>add()</code> (<code>add</code> is the <em>exported name</em>). That means when another module wants to import this function, it will have to use the name <code>add</code> instead:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">import</code> <code class="p">{</code> <code class="nx">add</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>If the module importing the function wants to use a different name, it can also use <code>as</code>:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">import</code> <code class="p">{</code> <code class="nx">add</code> <code class="nx">as</code> <code class="nx">sum</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">add</code><code class="p">);</code>            <code class="c1">// "undefined"</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">sum</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">));</code>             <code class="c1">// 3</code>
</pre></div>

        </figure>

        <p>This code imports the <code>add()</code> function (the <em>import name</em>) and renames it to <code>sum()</code> (the local name). That means there is no identifier named <code>add</code> in this module.</p>

        <aside>
            <h4 id="leanpub-auto-imported-bindings">Imported Bindings</h4>

            <p>A subtle but important point about the <code>import</code> statements is that they create bindings to variables, functions, and classes rather than simply referencing them. That means even though you cannot change an imported identifier, it can still change on its own. For example, suppose you have this module:</p>

            <figure class="code">
                <div class="highlight"><pre><code class="kr">export</code> <code class="kd">var</code> <code class="nx">name</code> <code class="o">=</code> <code class="s2">"Nicholas"</code><code class="p">;</code>
<code class="kr">export</code> <code class="kd">function</code> <code class="nx">setName</code><code class="p">(</code><code class="nx">newName</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">name</code> <code class="o">=</code> <code class="nx">newName</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

            </figure>

            <p>When you import <code>name</code> and <code>setName()</code>, you can see that <code>setName()</code> is able to change the value of <code>name</code>:</p>

            <figure class="code">
                <div class="highlight"><pre><code class="kr">import</code> <code class="p">{</code> <code class="nx">name</code><code class="p">,</code> <code class="nx">setName</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">name</code><code class="p">);</code>       <code class="c1">// "Nicholas"</code>
<code class="nx">setName</code><code class="p">(</code><code class="s2">"Greg"</code><code class="p">);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">name</code><code class="p">);</code>       <code class="c1">// "Greg"</code>

<code class="nx">name</code> <code class="o">=</code> <code class="s2">"Nicholas"</code><code class="p">;</code>       <code class="c1">// error</code>
</pre></div>

            </figure>

            <p>The call to <code>setName("Greg")</code> goes back into the module from which <code>setName()</code> was exported and executes there, setting <code>name</code> to <code>"Greg"</code>. Note this change is automatically reflected on the imported <code>name</code> binding. That’s because <code>name</code> is the local name for the exported <em>name</em> identifier so they are not the same thing.</p>

        </aside>

        <h3 id="leanpub-auto-exporting-and-importing-defaults">Exporting and Importing Defaults</h3>

        <p>The module syntax is really optimized for exporting and importing default values from modules. The default value for a module is a single variable, function, or class as specified by the <code>default</code> keyword. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">export</code> <code class="k">default</code> <code class="kd">function</code><code class="p">(</code><code class="nx">num1</code><code class="p">,</code> <code class="nx">num2</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">num1</code> <code class="o">+</code> <code class="nx">num2</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>This module exports a function as the default. The <code>default</code> keyword indicates that this is a default export and the function doesn’t require a name because the module itself represents the function.</p>

        <p>You can also specify an identifier as being the default export using the renaming syntax, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// equivalent to previous example</code>
<code class="kd">function</code> <code class="nx">sum</code><code class="p">(</code><code class="nx">num1</code><code class="p">,</code> <code class="nx">num2</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">num1</code> <code class="o">+</code> <code class="nx">num2</code><code class="p">;</code>
<code class="p">}</code>

<code class="kr">export</code> <code class="p">{</code> <code class="nx">sum</code> <code class="nx">as</code> <code class="k">default</code> <code class="p">};</code>
</pre></div>

        </figure>

        <p>The <code>as default</code> specifies that <code>sum</code> should be the default export of the module. This syntax is equivalent to the previous example.</p>

        <aside class="warning blurb">
            <p>You can only have one default export per module. It is a syntax error to use the <code>default</code> keyword with multiple exports.</p>

        </aside>

        <p>You can import a default value from a module using the following syntax:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// import the default</code>
<code class="kr">import</code> <code class="nx">sum</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">sum</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">));</code>     <code class="c1">// 3</code>
</pre></div>

        </figure>

        <p>This import statement imports the default from the module <code>"example"</code>. Note that there are no curly braces used in this case, as would be with a non-default export. The local name <code>sum</code> is used to represent the function that the module exports. This syntax is the cleanest as it’s anticipated to be the dominant form of import on the web, allowing you to use already-existing object, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">import</code> <code class="nx">$</code> <code class="nx">from</code> <code class="s2">"jquery"</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>For modules that export both a default and one or more non-defaults, you can import them with one statment. For instance, suppose you have this module:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">export</code> <code class="kd">let</code> <code class="nx">color</code> <code class="o">=</code> <code class="s2">"red"</code><code class="p">;</code>

<code class="kr">export</code> <code class="k">default</code> <code class="kd">function</code><code class="p">(</code><code class="nx">num1</code><code class="p">,</code> <code class="nx">num2</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">num1</code> <code class="o">+</code> <code class="nx">num2</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

        </figure>

        <p>You can then import both <code>color</code> and the default function using the following:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">import</code> <code class="nx">sum</code><code class="p">,</code> <code class="p">{</code> <code class="nx">color</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">sum</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">));</code>     <code class="c1">// 3</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">color</code><code class="p">);</code>         <code class="c1">// "red"</code>
</pre></div>

        </figure>

        <p>The comma separates the default local name from the non-defaults (which are also surrounded by curly braces).</p>

        <p>As with exporting defaults, importing defaults can also be accomplished using the renaming syntax:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// equivalent to previous example</code>
<code class="kr">import</code> <code class="p">{</code> <code class="k">default</code> <code class="nx">as</code> <code class="nx">sum</code><code class="p">,</code> <code class="nx">color</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">sum</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">));</code>     <code class="c1">// 3</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">color</code><code class="p">);</code>         <code class="c1">// "red"</code>
</pre></div>

        </figure>

        <p>In this code, the default export (<code>default</code>) is renamed to <code>sum</code> and the additional <code>color</code> export is also imported. This example is equivalent to the previous example.</p>

        <h3 id="leanpub-auto-re-exporting">Re-exporting</h3>

        <p>There may be a time when you’d like to re-export something that your module has imported. You can do this using the patterns already discussed in this chapter, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">import</code> <code class="p">{</code> <code class="nx">sum</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>
<code class="kr">export</code> <code class="p">{</code> <code class="nx">sum</code> <code class="p">}</code>
</pre></div>

        </figure>

        <p>However, there’s also a single statement that can accomplish the same thing:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">export</code> <code class="p">{</code> <code class="nx">sum</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>This form of <code>export</code> looks into the specified module for the declaration of <code>sum</code> and then exports it. Of course, you can also choose to export a different name for the same thing:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">export</code> <code class="p">{</code> <code class="nx">sum</code> <code class="nx">as</code> <code class="nx">add</code> <code class="p">}</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>Here, <code>sum</code> is imported from <code>"example"</code> and then exported as <code>add</code>.</p>

        <p>If you’d like to export everything from another module, you can use the <code>*</code> pattern:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">export</code> <code class="o">*</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>
</pre></div>

        </figure>

        <p>By exporting everything, you’re including the default as well as any named exports, which may affect what you can export from your module. For instance, if <code>"example"</code> has a default export, you’ll be unable to define a new default export when using this syntax.</p>

        <h3 id="leanpub-auto-importing-without-bindings">Importing Without Bindings</h3>

        <p>Some modules may not export anything, and instead, only make modifications to objects in the global scope. Even though top-level variables, functions, and classes inside of modules do not automatically end up in the global scope, that doesn’t mean modules cannot access the global scope. The shared definitions of built-in objects such as <code>Array</code> and <code>Object</code> are accessible inside of a module and changes to those objects will be reflected in other modules.</p>

        <p>For instance, suppose you want to add a method to all arrays called <code>pushAll()</code>, you may define a module like this:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// module code without exports or imports</code>
<code class="nb">Array</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">pushAll</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">items</code><code class="p">)</code> <code class="p">{</code>

    <code class="c1">// items must be an array</code>
    <code class="k">if</code> <code class="p">(</code><code class="o">!</code><code class="nb">Array</code><code class="p">.</code><code class="nx">isArray</code><code class="p">(</code><code class="nx">items</code><code class="p">))</code> <code class="p">{</code>
        <code class="k">throw</code> <code class="k">new</code> <code class="nx">TypeError</code><code class="p">(</code><code class="s2">"Argument must be an array."</code><code class="p">);</code>
    <code class="p">}</code>

    <code class="c1">// use built-in push() and spread operator</code>
    <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">push</code><code class="p">(...</code><code class="nx">items</code><code class="p">);</code>
<code class="p">};</code>
</pre></div>

        </figure>

        <p>This is a valid module even though there are no exports or imports. This code can be used both as a module and a script. Since it doesn’t export anything, you can use a simplified import to execute the module code without importing any bindings:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kr">import</code> <code class="nx">from</code> <code class="s2">"example"</code><code class="p">;</code>

<code class="kd">let</code> <code class="nx">colors</code> <code class="o">=</code> <code class="p">[</code><code class="s2">"red"</code><code class="p">,</code> <code class="s2">"green"</code><code class="p">,</code> <code class="s2">"blue"</code><code class="p">];</code>
<code class="kd">let</code> <code class="nx">items</code> <code class="o">=</code> <code class="p">[];</code>

<code class="nx">items</code><code class="p">.</code><code class="nx">pushAll</code><code class="p">(</code><code class="nx">colors</code><code class="p">);</code>
</pre></div>

        </figure>

        <p>In this example, the module is imported and executed, so <code>pushAll()</code> is added to the array prototype. That means <code>pushAll()</code> is now available for use on all arrays inside of this module.</p>

        <aside class="information blurb">
            <p>Imports without bindings are most likely to be used to create polyfills and shims.</p>

        </aside>

        <h3 id="leanpub-auto-summary-9">Summary</h3>

        <p>ECMAScript 6 adds modules to the language as a way to package up and encapsulate functionality. Modules behave differently than scripts, as they do not modify the global scope with their top-level variables, functions, and classes, and <code>this</code> is <code>undefined</code>. In order to work differently than scripts, modules must be loaded using a different mode.</p>

        <p>You must export any functionality you’d like to make available to consumers of a module. Variables, functions, and classes can all be exported, and there is also one default export allowed per module. After exporting, another module can import all or some of the exported names. These names act as if defined by <code>let</code>, and so operate as block bindings that cannot be redeclared in the same module.</p>

        <p>Modules need not export anything if they are manipulating something in the global scope. In that case, it’s possible to import from such a module without introducing any bindings into the module scope.</p>

        <h2 id="leanpub-auto-appendix-a-other-changes">Appendix A: Other Changes</h2>

        <p>Along with the changes already mentioned in the book, ECMAScript 6 has made some very small changes and improvements. This appendix lists out those changes.</p>

        <h3 id="leanpub-auto-working-with-integers">Working with Integers</h3>

        <p>A lot of confusion has been caused over the years related to JavaScript’s single number type that is used to represent both integers and floats. The language goes through great pains to ensure that developers don’t need to worry about the details, but problems still leak through from time to time. ECMAScript 6 seeks to address this by making it easier to identify and work with integers.</p>

        <h4 id="leanpub-auto-identifying-integers">Identifying Integers</h4>

        <p>The first addition is <code>Number.isInteger()</code>, which allows you to determine if a value represents an integer in JavaScript. Since integers and floats are stored differently, the JavaScript engine looks at the underlying representation of the value to make this determination. That means numbers that look like floats might actually be stored as integers and therefore return <code>true</code> from <code>Number.isInteger()</code>. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Number</code><code class="p">.</code><code class="nx">isInteger</code><code class="p">(</code><code class="mi">25</code><code class="p">));</code>      <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Number</code><code class="p">.</code><code class="nx">isInteger</code><code class="p">(</code><code class="mf">25.0</code><code class="p">));</code>    <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Number</code><code class="p">.</code><code class="nx">isInteger</code><code class="p">(</code><code class="mf">25.1</code><code class="p">));</code>    <code class="c1">// false</code>
</pre></div>

        </figure>

        <p>In this code, <code>Number.isInteger()</code> returns <code>true</code> for both <code>25</code> and <code>25.0</code> even though the latter looks like a float. Simply adding a decimal point to a number doesn’t automatically make it a float in JavaScript. Since <code>25.0</code> is really just <code>25</code>, it is stored as an integer. The number <code>25.1</code>, however, is stored as a float because there is a fraction value.</p>

        <h4 id="leanpub-auto-safe-integers">Safe Integers</h4>

        <p>However, all is not so simple with integers. JavaScript can only accurately represent integers between -2<sup>53</sup> and 2<sup>53</sup>, and outside of this “safe” range, binary representations end up reused for multiple numeric values. For example:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Math</code><code class="p">.</code><code class="nx">pow</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">53</code><code class="p">));</code>      <code class="c1">// 9007199254740992</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Math</code><code class="p">.</code><code class="nx">pow</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">53</code><code class="p">)</code> <code class="o">+</code> <code class="mi">1</code><code class="p">);</code>  <code class="c1">// 9007199254740992</code>
</pre></div>

        </figure>

        <p>This example doesn’t contain a typo, two different numbers end up represented by the same JavaScript integer. The effect becomes more prevalent the further the value is outside of the safe range.</p>

        <p>ECMAScript 6 introduces <code>Number.isSafeInteger()</code> to better identify integers that can accurately be represented in the language. There is also <code>Number.MAX_SAFE_INTEGER</code> and <code>Number.MIN_SAFE_INTEGER</code> that represent the upper and lower bounds of the same range, respectively. The <code>Number.isSafeInteger()</code> method ensures that a value is an integer and falls within the safe range of integer values:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="kd">var</code> <code class="nx">inside</code> <code class="o">=</code> <code class="nb">Number</code><code class="p">.</code><code class="nx">MAX_SAFE_INTEGER</code><code class="p">,</code>
    <code class="nx">outside</code> <code class="o">=</code> <code class="nx">inside</code> <code class="o">+</code> <code class="mi">1</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Number</code><code class="p">.</code><code class="nx">isInteger</code><code class="p">(</code><code class="nx">inside</code><code class="p">));</code>          <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Number</code><code class="p">.</code><code class="nx">isSafeInteger</code><code class="p">(</code><code class="nx">inside</code><code class="p">));</code>      <code class="c1">// true</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Number</code><code class="p">.</code><code class="nx">isInteger</code><code class="p">(</code><code class="nx">outside</code><code class="p">));</code>         <code class="c1">// true</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nb">Number</code><code class="p">.</code><code class="nx">isSafeInteger</code><code class="p">(</code><code class="nx">outside</code><code class="p">));</code>     <code class="c1">// false</code>
</pre></div>

        </figure>

        <p>The number <code>inside</code> is the largest safe integer, so it returns <code>true</code> for both <code>Number.isInteger()</code> and <code>Number.isSafeInteger()</code>. The number <code>outside</code> is the first questionable integer value, so it is no longer considered safe even though it’s still an integer.</p>

        <p>Most of the time, you only want to deal with safe integers when doing integer arithmetic or comparisons in JavaScript, so it’s a good idea to use <code>Number.isSafeInteger()</code> as part of input validation.</p>

        <h3 id="leanpub-auto-new-math-methods">New Math Methods</h3>

        <p>The aforementioned new emphasis on gaming and graphics in JavaScript led to the realization that many mathematical calculations could be done more efficiently by a JavaScript engine than with pure JavaScript code. Optimization strategies like asm.js, which works on a subset of JavaScript to improve performance, need more information to perform calculations in the fastest way possible. It’s important, for instance, to know whether the numbers should be treated as 32-bit integers or as 64-bit floats.</p>

        <p>As a result, ECMAScript 6 adds several new methods to the <code>Math</code> object. These new methods are important for improving the speed of common mathematical calculations, and therefore, improving the speed of applications that must perform many calculations (such as graphics programs). The new methods are listed below.</p>

        <table style="width: 80%;">
            <thead>
            <tr>
                <th>Method</th>
                <th>Description</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td><code>Math.acosh(x)</code></td>
                <td>Returns the inverse hyperbolic cosine of <code>x</code>.</td>
            </tr>
            <tr>
                <td><code>Math.asinh(x)</code></td>
                <td>Returns the inverse hyperbolic sine of <code>x</code>.</td>
            </tr>
            <tr>
                <td><code>Math.atanh(x)</code></td>
                <td>Returns the inverse hyperbolic tangent of <code>x</code>
                </td>
            </tr>
            <tr>
                <td><code>Math.cbrt(x)</code></td>
                <td>Returns the cubed root of <code>x</code>.</td>
            </tr>
            <tr>
                <td><code>Math.clz32(x)</code></td>
                <td>Returns the number of leading zero bits in the 32-bit integer representation of <code>x</code>.</td>
            </tr>
            <tr>
                <td><code>Math.cosh(x)</code></td>
                <td>Returns the hyperbolic cosine of <code>x</code>.</td>
            </tr>
            <tr>
                <td><code>Math.expm1(x)</code></td>
                <td>Returns the result of subtracting 1 from the exponential function of <code>x</code>
                </td>
            </tr>
            <tr>
                <td><code>Math.fround(x)</code></td>
                <td>Returns the nearest single-precision float of <code>x</code>.</td>
            </tr>
            <tr>
                <td><code>Math.hypot(...values)</code></td>
                <td>Returns the square root of the sum of the squares of each argument.</td>
            </tr>
            <tr>
                <td><code>Math.imul(x, y)</code></td>
                <td>Returns the result of performing true 32-bit multiplication of the two arguments.</td>
            </tr>
            <tr>
                <td><code>Math.log1p(x)</code></td>
                <td>Returns the natural logarithm of <code>1 + x</code>.</td>
            </tr>
            <tr>
                <td><code>Math.log10(x)</code></td>
                <td>Returns the base 10 logarithm of <code>x</code>.</td>
            </tr>
            <tr>
                <td><code>Math.log2(x)</code></td>
                <td>Returns the base 2 logarithm of <code>x</code>.</td>
            </tr>
            <tr>
                <td><code>Math.sign(x)</code></td>
                <td>Returns -1 if the <code>x</code> is negative, 0 if <code>x</code> is +0 or -0, or 1 if <code>x</code> is positive.</td>
            </tr>
            <tr>
                <td><code>Math.sinh(x)</code></td>
                <td>Returns the hyperbolic sine of <code>x</code>.</td>
            </tr>
            <tr>
                <td><code>Math.tanh(x)</code></td>
                <td>Returns the hyperbolic tangent of <code>x</code>.</td>
            </tr>
            <tr>
                <td><code>Math.trunc(x)</code></td>
                <td>Removes fraction digits from a float and returns an integer.</td>
            </tr>
            </tbody>

        </table>

        <p>It’s beyond the scope of this book to explain each new method and what it does in detail. However, if you are looking for a reasonably common calculation, be sure to check the new <code>Math</code> methods before implementing it yourself.</p>

        <h3 id="leanpub-auto-unicode-identifiers">Unicode Identifiers</h3>

        <p>Better Unicode support in ECMAScript 6 also means changes to what characters may be used for an identifier. In ECMAScript 5, it was already possible to use Unicode escape sequences for identifiers, such as:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// Valid in ECMAScript 5 and 6</code>
<code class="kd">var</code> <code class="err">\</code><code class="nx">u0061</code> <code class="o">=</code> <code class="s2">"abc"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="err">\</code><code class="nx">u0061</code><code class="p">);</code>        <code class="c1">// "abc"</code>

<code class="c1">// equivalent to</code>
<code class="c1">// console.log(a);          // "abc"</code>
</pre></div>

        </figure>

        <p>In ECMAScript 6, you can also use Unicode code point escape sequences as identifiers:</p>

        <figure class="code">
            <div class="highlight"><pre><code class="c1">// Valid in ECMAScript 5 and 6</code>
<code class="kd">var</code> <code class="err">\</code><code class="nx">u</code><code class="p">{</code><code class="mi">61</code><code class="p">}</code> <code class="o">=</code> <code class="s2">"abc"</code><code class="p">;</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="err">\</code><code class="nx">u</code><code class="p">{</code><code class="mi">61</code><code class="p">});</code>        <code class="c1">// "abc"</code>

<code class="c1">// equivalent to</code>
<code class="c1">// console.log(a);          // "abc"</code>
</pre></div>

        </figure>

        <p>Additionally, ECMAScript 6 formally specifies valid identifiers in terms of <a href="http://unicode.org/reports/tr31/">Unicode Standard Annex #31: Unicode Identifier and Pattern Syntax</a>:</p>

        <ol class="numeric">
            <li>The first character must be <code>$</code>, <code>_</code>, or any Unicode symbol with a derived core property of <code>ID_Start</code>.</li>
            <li>Each subsequent character must be <code>$</code>, <code>_</code>, <code>\u200c</code> (zero-width non-joiner), <code>\u200d</code> (zero-width joiner), or any Unicode symbol with a derived core property of <code>ID_Continue</code>.</li>
        </ol>

        <p>The <code>ID_Start</code> and <code>ID_Continue</code> derived core properties are defined in Unicode Identifier and Pattern Syntax as a way to identify symbols that are appropriate for use in identifiers such as variables and domain names (the specification is not specific to JavaScript).</p>


    </div>


</div>
</body>
</html>