###使用精灵表来减少HTTP请求

一个精灵表，通常被成为sprites或spriting，包含多张图片文件至一个文件中。虽然一张大图的带宽相对于许多小图的带宽而言是一样的，却只需发起一次HTTP请求来传输精灵表。虽然你的图片会被缓存在浏览器中，以防止之后的重复加载，用户初次访问每个资源只会需要一次HTTP连接。每个资源在尝试连接服务器的时候，都会遇到延迟或滞后。如果你有五十个单张图片，其中的每张图片都会经历延迟。虽然延迟可能很短暂，但会很快累加起来，这取决于要下载图片的个数。精灵表能够加速你站点的下载时间，这是通过减少你服务器的延迟达到的。通过请求一个资源而不是五十个，用户也将节省电量和CPU周期。

适合选作精灵图的是那些在整个站点都会出现的小图片，如一些小UI装饰图，图标，社交按钮，平铺背景等等，如**图3-1**所示。大图没必要作为精灵图。

**图3-1**一张不同app图标组成的精灵图

<img src="img/7up_2x.png" style="width:200px;height:104px;">


###实现精灵图

在你站点上实现精灵图是十分简单的。一旦你将精灵表合并至你所选图片编辑器生成的图片中，就可以将它使用在所有你期望设置的元素上面，设置它们的`background-image`属性即可。之后调整`background-position`属性，在精灵图上对齐即可，如**清单3-1**所示。`width`和`height`属性作为坐标系，值应该设置为单个精灵图的高度和宽度值。

**表单3-1**在CSS中定义的一个精灵表

	.spritesheet {
    	background-image: url(images/spritesheet.png);
	    background-size: 324px 88px;
    	height: 22px;
	    width: 27px;
	}
	/* pseudo-states for the closed-caption button */
	#cc { background-position: 0 0; }
	#cc:hover { background-position: 0 22px; }
	#cc:active { background-position: 0 44px; }
	
###精灵和内存

内存，尤其对于移动设备来说，是一个宝贵的资源。你应该尽你所能来减少加载页面所要消耗的内存量，以便界面保持流畅和可响应的。理解图片是如何占用内存是很重要的。

一张图片的每个像素都会占用内存的4个字节，每个都用于颜色通道(宏，绿，栏和透明度)。所以对于一张500\*800像素的图片，你会占用500\*800\*4=1，600，000字节，刚好超过1.5MB的内存。这与文件大小是不同的。一个500*800像素透明的PNG图片仅占用磁盘几KB的样子，但当显示在屏幕上时，它会占用1.5MB的内存！


鉴于此，你应该尝试使你的精灵表尽可能的密集。消除无用的透明度或者白色空间，将图片归置紧密，以收缩你Web内容的内存面积。

因为`background-position`属性是以CSS像素单位定义的，对于Retina显示你无需做任何其它特殊的事，如果浏览你站点的显示器是Retina显示器，提供一张高清精灵图即可。Safari会自动正确定位2x的精灵图。




































	
	

